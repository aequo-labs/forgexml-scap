<ds:data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:sce="http://open-scap.org/page/SCE_xccdf_stream" xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_org.cisecurity_collection_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark" schematron-version="1.0">
   <ds:data-stream id="scap_org.cisecurity_datastream_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark" scap-version="1.2" timestamp="2023-10-20T13:12:33" use-case="CONFIGURATION">
      <ds:checklists>
         <ds:component-ref id="scap_org.cisecurity_cref_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-xccdf" xlink:href="#scap_org.cisecurity_comp_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-xccdf">
            <cat:catalog>
               <cat:uri name="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" uri="scap_org.cisecurity_cref_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-oval"></cat:uri>
               <cat:uri name="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test" uri="#scap_org.cisecurity_cref_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-scriptkubelet_test"></cat:uri>
            </cat:catalog>
         </ds:component-ref>
      </ds:checklists>
      <ds:checks>
         <ds:component-ref id="scap_org.cisecurity_cref_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-oval" xlink:href="#scap_org.cisecurity_comp_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-oval"></ds:component-ref>
      </ds:checks>
      <ds:extended-components>
         <ds:component-ref id="scap_org.cisecurity_cref_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-scriptkubelet_test" xlink:href="#scap_org.cisecurity_ecomp_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-scriptkubelet_test"></ds:component-ref>
      </ds:extended-components>
   </ds:data-stream>
   <ds:component id="scap_org.cisecurity_comp_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-xccdf" timestamp="2023-10-20T13:12:33">
      <xccdf:Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
         <xccdf:status date="2023-10-20">accepted</xccdf:status>
         <xccdf:title xml:lang="en">CIS Amazon Elastic Kubernetes Service (EKS) Benchmark</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This document provides prescriptive guidance for running Amazon Elastic Kubernetes Service (EKS) following recommended security controls. This benchmark only includes controls which can be modified by an end user of Amazon EKS.</xhtml:p>
            <xhtml:p>


To obtain the latest version of this guide, please visit                       <xhtml:a href="http://www.cisecurity.org">www.cisecurity.org</xhtml:a>


. If you have questions, comments, or have identified ways to improve this guide, please write us at                       <xhtml:a href="mailto:support@cisecurity.org">support@cisecurity.org</xhtml:a>


.                </xhtml:p>
         </xccdf:description>
         <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
         <xccdf:version>1.1.0</xccdf:version>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
            <xccdf:title xml:lang="en">Level 1</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Level 1 profile for running Automated Assessment</xhtml:p>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Enable_audit_Logs" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_that_the_kubeconfig_file_permissions_are_set_to_644_or_more_restrictive" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_that_the_kubelet_kubeconfig_file_ownership_is_set_to_rootroot" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_that_the_kubelet_configuration_file_has_permissions_set_to_644_or_more_restrictive" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_set_to_true" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.9_Ensure_that_the_--eventRecordQPS_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.11_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Minimize_access_to_create_pods" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_default_service_accounts_are_not_actively_used." selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_latest_CNI_version_is_used" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_using_Amazon_ECR_image_scanning_or_a_third_party_provider" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_Amazon_ECR" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_Amazon_ECR" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Prefer_using_managed_identities_for_workloads" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_Customer_Master_Keys_CMKs_managed_in_AWS_KMS" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Restrict_Access_to_the_Control_Plane_Endpoint" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.3_Ensure_clusters_are_created_with_Private_Nodes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.4_Ensure_Network_Policy_is_Enabled_and_set_as_appropriate" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Consider_Fargate_for_running_untrusted_workloads" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
            <xccdf:title xml:lang="en">Level 2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Level 2 profile for running Automated Assessment</xhtml:p>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Enable_audit_Logs" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_that_the_kubeconfig_file_permissions_are_set_to_644_or_more_restrictive" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_that_the_kubelet_kubeconfig_file_ownership_is_set_to_rootroot" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_that_the_kubelet_configuration_file_has_permissions_set_to_644_or_more_restrictive" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_set_to_true" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.9_Ensure_that_the_--eventRecordQPS_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.11_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.1_Prefer_using_Container-Optimized_OS_when_possible" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Minimize_access_to_create_pods" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_default_service_accounts_are_not_actively_used." selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_latest_CNI_version_is_used" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.2_Ensure_that_all_Namespaces_have_Network_Policies_defined" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.2_Consider_external_secret_storage" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.2_Apply_Security_Context_to_Your_Pods_and_Containers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.3_The_default_namespace_should_not_be_used" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_using_Amazon_ECR_image_scanning_or_a_third_party_provider" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_Amazon_ECR" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_Amazon_ECR" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_Container_Registries_to_only_those_approved" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Prefer_using_managed_identities_for_workloads" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_Customer_Master_Keys_CMKs_managed_in_AWS_KMS" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Restrict_Access_to_the_Control_Plane_Endpoint" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_clusters_are_created_with_Private_Endpoint_Enabled_and_Public_Access_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.3_Ensure_clusters_are_created_with_Private_Nodes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.4_Ensure_Network_Policy_is_Enabled_and_set_as_appropriate" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.5_Encrypt_traffic_to_HTTPS_load_balancers_with_TLS_certificates" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Manage_Kubernetes_RBAC_users_with_AWS_IAM_Authenticator_for_Kubernetes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Consider_Fargate_for_running_untrusted_workloads" selected="true"></xccdf:select>
         </xccdf:Profile>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278535_var" operator="equals" type="string">
            <title>Ensure that the --anonymous-auth argument is set to false</title>
            <description>This value is used in Rule: Ensure that the --anonymous-auth argument is set to false</description>
            <value>authentication.*anonymous.*{.enabled.:false}</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278536_var" operator="equals" type="string">
            <title>Ensure that the --authorization-mode argument is not set to AlwaysAllow</title>
            <description>This value is used in Rule: Ensure that the --authorization-mode argument is not set to AlwaysAllow</description>
            <value>authentication.*webhook.*{"enabled":true</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278537_var" operator="equals" type="string">
            <title>Ensure that the --client-ca-file argument is set as appropriate</title>
            <description>This value is used in Rule: Ensure that the --client-ca-file argument is set as appropriate</description>
            <value>authentication.*clientCAFile":".[a-zA-Z]</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278542_var" operator="equals" type="string">
            <title>Ensure that the --streaming-connection-idle-timeout argument is not set to 0</title>
            <description>This value is used in Rule: Ensure that the --streaming-connection-idle-timeout argument is not set to 0</description>
            <value>streamingConnectionIdleTimeout":"4h0m0s</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278544_var" operator="equals" type="string">
            <title>Ensure that the --protect-kernel-defaults argument is set to true</title>
            <description>This value is used in Rule: Ensure that the --protect-kernel-defaults argument is set to true</description>
            <value>protectKernelDefaults.:true</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278546_var" operator="equals" type="string">
            <title>Ensure that the --make-iptables-util-chains argument is set to true</title>
            <description>This value is used in Rule: Ensure that the --make-iptables-util-chains argument is set to true</description>
            <value>makeIPTablesUtilChains.:true</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278551_var" operator="equals" type="string">
            <title>Ensure that the --eventRecordQPS argument is set to 0 or a level which ensures appropriate event capture</title>
            <description>This value is used in Rule: Ensure that the --eventRecordQPS argument is set to 0 or a level which ensures appropriate event capture</description>
            <value>"eventRecordQPS":[1-9]\d*</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278558_var" operator="equals" type="string">
            <title>Ensure that the RotateKubeletServerCertificate argument is set to true</title>
            <description>This value is used in Rule: Ensure that the RotateKubeletServerCertificate argument is set to true</description>
            <value>RotateKubeletServerCertificate":true</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278539_var" operator="pattern match" type="string">
            <title>Minimize the admission of privileged containers</title>
            <description>This value is used in Rule: Minimize the admission of privileged containers</description>
            <value>privileged..:false</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278541_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers wishing to share the host process ID namespace</title>
            <description>This value is used in Rule: Minimize the admission of containers wishing to share the host process ID namespace</description>
            <value>hostPID..:false</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278543_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers wishing to share the host process ID namespace</title>
            <description>This value is used in Rule: Minimize the admission of containers wishing to share the host process ID namespace</description>
            <value>hostPID</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278545_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers wishing to share the host IPC namespace</title>
            <description>This value is used in Rule: Minimize the admission of containers wishing to share the host IPC namespace</description>
            <value>hostIPC..:false</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278547_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers wishing to share the host IPC namespace</title>
            <description>This value is used in Rule: Minimize the admission of containers wishing to share the host IPC namespace</description>
            <value>hostIPC</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278549_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers wishing to share the host network namespace</title>
            <description>This value is used in Rule: Minimize the admission of containers wishing to share the host network namespace</description>
            <value>hostNetwork..:false</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278550_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers wishing to share the host network namespace</title>
            <description>This value is used in Rule: Minimize the admission of containers wishing to share the host network namespace</description>
            <value>hostNetwork</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278552_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers with allowPrivilegeEscalation</title>
            <description>This value is used in Rule: Minimize the admission of containers with allowPrivilegeEscalation</description>
            <value>allowPrivilegeEscalation...false</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278554_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers with allowPrivilegeEscalation</title>
            <description>This value is used in Rule: Minimize the admission of containers with allowPrivilegeEscalation</description>
            <value>allowPrivilegeEscalation</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278556_var" operator="pattern match" type="string">
            <title>Minimize the admission of root containers</title>
            <description>This value is used in Rule: Minimize the admission of root containers</description>
            <value>MustRunAsNonRoot</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278557_var" operator="pattern match" type="string">
            <title>Minimize the admission of root containers</title>
            <description>This value is used in Rule: Minimize the admission of root containers</description>
            <value>MustRunAs</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278559_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers with the NET_RAW capability</title>
            <description>This value is used in Rule: Minimize the admission of containers with the NET_RAW capability</description>
            <value>requiredDropCapabilities......NET_RAW</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278560_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers with the NET_RAW capability</title>
            <description>This value is used in Rule: Minimize the admission of containers with the NET_RAW capability</description>
            <value>requiredDropCapabilities......ALL</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_1278561_var" operator="pattern match" type="string">
            <title>Minimize the admission of containers with added capabilities</title>
            <description>This value is used in Rule: Minimize the admission of containers with added capabilities</description>
            <value>allowedCapabilities</value>
         </Value>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Control_Plane_Components">
            <xccdf:title xml:lang="en">Control Plane Components</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>


Security is a shared responsibility between AWS and the Amazon EKS customer.                             <xhtml:a href="https://aws.amazon.com/compliance/shared-responsibility-model/">The shared responsibility model</xhtml:a>


 describes this as security of the cloud and security in the cloud:                      </xhtml:p>
               <xhtml:p>
                  <xhtml:strong>Security of the cloud</xhtml:strong>


 – AWS is responsible for protecting the infrastructure that runs AWS services in the AWS Cloud. For Amazon EKS, AWS is responsible for the Kubernetes control plane, which includes the control plane nodes and etcd database. Third-party auditors regularly test and verify the effectiveness of our security as part of the                             <xhtml:a href="https://aws.amazon.com/compliance/programs/">AWS compliance programs</xhtml:a>


. To learn about the compliance programs that apply to Amazon EKS, see                             <xhtml:a href="https://aws.amazon.com/compliance/services-in-scope/">AWS Services in Scope by Compliance Program.</xhtml:a>
               </xhtml:p>
               <xhtml:p>Security in the cloud – Your responsibility includes the following areas.</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>
                     <xhtml:p>The security configuration of the data plane, including the configuration of the security groups that allow traffic to pass from the Amazon EKS control plane into the customer VPC</xhtml:p>
                  </xhtml:li>
                  <xhtml:li>
                     <xhtml:p>The configuration of the worker nodes and the containers themselves</xhtml:p>
                  </xhtml:li>
                  <xhtml:li>
                     <xhtml:p>The worker node guest operating system (including updates and security patches)</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Amazon EKS follows the shared responsibility model for CVEs and security patches on managed node groups. Because managed nodes run the Amazon EKS-optimized AMIs, Amazon EKS is responsible for building patched versions of these AMIs when bugs or issues are reported and we are able to publish a fix. However, customers are responsible for deploying these patched AMI versions to your managed node groups.</xhtml:li>
                     </xhtml:ul>
                  </xhtml:li>
                  <xhtml:li>
                     <xhtml:p>Other associated application software:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>
                           <xhtml:p>Setting up and managing network controls, such as firewall rules</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                           <xhtml:p>Managing platform-level identity and access management, either with or in addition to IAM</xhtml:p>
                        </xhtml:li>
                     </xhtml:ul>
                  </xhtml:li>
                  <xhtml:li>
                     <xhtml:p>The sensitivity of your data, your company’s requirements, and applicable laws and regulations</xhtml:p>
                  </xhtml:li>
               </xhtml:ul>
               <xhtml:p>AWS is responsible for securing the control plane, though you might be able to configure certain options based on your requirements. Section 2 of this Benchmark addresses these configurations.</xhtml:p>
            </xccdf:description>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Control_Plane_Configuration">
            <xccdf:title xml:lang="en">Control Plane Configuration</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations for Amazon EKS control plane logging configuration. Customers are able to configure logging for control plane in Amazon EKS.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Logging">
               <xccdf:title xml:lang="en">Logging</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Enable_audit_Logs" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Enable audit Logs</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Control plane logs provide visibility into operation of the EKS Control plane component systems. The API server audit logs record all accepted and rejected requests in the cluster. When enabled via EKS configuration the control plane logs for a cluster are exported to a CloudWatch Log Group for persistence.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Audit logs enable visibility into all API server requests from authentic and anonymous sources. Stored log data can be analysed manually or with tools to identify and understand anomalous or negative activity and lead to intelligent remediations.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
                  <xccdf:ident system="URL">https://aws.github.io/aws-eks-best-practices/detective/</xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html</xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/eks/latest/userguide/logging-using-cloudtrail.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>From Console:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>For each EKS Cluster in each region;</xhtml:li>
                              <xhtml:li>Go to 'Amazon EKS' &gt; 'Clusters' &gt; '' &gt; 'Configuration' &gt; 'Logging'.</xhtml:li>
                              <xhtml:li>Click 'Manage logging'.</xhtml:li>
                              <xhtml:li>Ensure that all options are toggled to 'Enabled'.</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


API server: Enabled                                                    <br></br>


Audit: Enabled	                                                    <br></br>


Authenticator: Enabled                                                    <br></br>


Controller manager: Enabled                                                    <br></br>


Scheduler: Enabled
                                              </xhtml:code>
                           <xhtml:ol start="5">
                              <xhtml:li>Click 'Save Changes'.</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>From CLI:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:code class="code_block">


# For each EKS Cluster in each region;                                                    <br></br>


aws eks update-cluster-config \                                                    <br></br>


    --region '${REGION_CODE}' \                                                    <br></br>


    --name '${CLUSTER_NAME}' \                                                    <br></br>


    --logging '{"clusterLogging":[{"types":["api","audit","authenticator","controllerManager","scheduler"],"enabled":true}]}'
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Audit logs will be created on the master nodes, which will consume disk space. Care should be taken to avoid generating too large volumes of log information as this could impact the available of the cluster nodes.
S3 lifecycle features can be used to manage the accumulation and management of logs over time.</xhtml:p>
                              <xhtml:p>


See the following AWS resource for more information on these features:
                                                          <xhtml:a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/object-lifecycle-mgmt.html">http://docs.aws.amazon.com/AmazonS3/latest/dev/object-lifecycle-mgmt.html</xhtml:a>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Worker_Nodes">
            <xccdf:title xml:lang="en">Worker Nodes</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section consists of security recommendations for the components that run on Amazon EKS worker nodes.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1_Worker_Node_Configuration_Files">
               <xccdf:title xml:lang="en">Worker Node Configuration Files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section covers recommendations for configuration files on Amazon EKS worker nodes.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_that_the_kubeconfig_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the kubeconfig file permissions are set to 644 or more restrictive</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


If                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 is running, and if it is using a file-based kubeconfig file, ensure that the proxy kubeconfig file has permissions of                                         <xhtml:span class="inline_block">644</xhtml:span>


 or more restrictive.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


The                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 kubeconfig file controls various parameters of the                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.                                  </xhtml:p>
                     <xhtml:p>


It is possible to run                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 with the kubeconfig parameters configured as a Kubernetes ConfigMap instead of a file. In this case, there is no proxy kubeconfig file.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-proxy/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Run the below command (based on the file location on your system) on the each worker
node. For example,</xhtml:p>
                           <xhtml:code class="code_block">chmod 644 &lt;kubeconfig file&gt;
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_that_the_kubelet_kubeconfig_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the kubelet kubeconfig file ownership is set to root:root</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


If                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 is running, ensure that the file ownership of its kubeconfig file is set to                                         <xhtml:span class="inline_block">root:root</xhtml:span>


.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:6.0">
                           <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                              <controls:implementation_groups></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


The kubeconfig file for                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 controls various parameters for the                                         <xhtml:span class="inline_block">kubelet</xhtml:span>


 service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by                                         <xhtml:span class="inline_block">root:root</xhtml:span>


.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-proxy/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Run the below command (based on the file location on your system) on the each worker node. For example,</xhtml:p>
                           <xhtml:code class="code_block">chown root:root &lt;proxy kubeconfig file&gt;
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_that_the_kubelet_configuration_file_has_permissions_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the kubelet configuration file has permissions set to 644 or more restrictive</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Ensure that if the kubelet refers to a configuration file with the                                         <xhtml:span class="inline_block">--config</xhtml:span>


 argument, that file has permissions of 644 or more restrictive.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


The kubelet reads various parameters, including security settings, from a config file specified by the                                         <xhtml:span class="inline_block">--config</xhtml:span>


 argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Run the following command (using the config file location identied in the Audit step)</xhtml:p>
                           <xhtml:code class="code_block">chmod 644 /etc/kubernetes/kubelet/kubelet-config.json
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the kubelet configuration file ownership is set to root:root</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Ensure that if the kubelet refers to a configuration file with the                                         <xhtml:span class="inline_block">--config</xhtml:span>


 argument, that file is owned by root:root.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


The kubelet reads various parameters, including security settings, from a config file specified by the                                         <xhtml:span class="inline_block">--config</xhtml:span>


 argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-proxy/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Run the following command (using the config file location identified in the Audit step)</xhtml:p>
                           <xhtml:code class="code_block">chown root:root /etc/kubernetes/kubelet/kubelet-config.json
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2_Kubelet">
               <xccdf:title xml:lang="en">Kubelet</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations for kubelet configuration.</xhtml:p>
                  <xhtml:p>Kubelet settings may be configured using arguments on the running kubelet executable, or they may be taken from a Kubelet config file. If both are specified, the executable argument takes precedence.</xhtml:p>
                  <xhtml:p>To find the Kubelet config file, run the following command:</xhtml:p>
                  <xhtml:code class="code_block">ps -ef | grep kubelet | grep config
</xhtml:code>
                  <xhtml:p>


If the                                   <xhtml:span class="inline_block">--config</xhtml:span>


 argument is present, this gives the location of the Kubelet config file. This config file could be in JSON or YAML format depending on your distribution.                            </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure that the --anonymous-auth argument is set to false</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Disable anonymous requests to the Kubelet server.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to false                                              </xhtml:p>
                           <xhtml:code class="code_block">"authentication": { "anonymous": { "enabled": false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--anonymous-auth=false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"authentication.*anonymous.*{"enabled":false}"</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Anonymous requests will be rejected.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278535_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure that the --authorization-mode argument is not set to AlwaysAllow</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not allow all requests. Enable explicit authorization.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Change Default Passwords" urn="urn:cisecurity.org:controls:7.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to false                                              </xhtml:p>
                           <xhtml:code class="code_block">"authentication"... "webhook.*{"enabled":true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--authorization-mode=Webhook
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"authentication.*webhook.*{"enabled":true"</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Unauthorized requests will be denied.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278536_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the --client-ca-file argument is set as appropriate</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Enable Kubelet authentication using certificates.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet’s port-forwarding functionality. These connections terminate at the kubelet’s HTTPS endpoint. By default, the apiserver does not verify the kubelet’s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to false                                              </xhtml:p>
                           <xhtml:code class="code_block">"authentication": { "x509": {"clientCAFile:" to the location of the client CA file.
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--client-ca-file=&lt;path/to/client-ca-file&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"authentication.*x509":("clientCAFile":"/etc/kubernetes/pki/ca.crt"</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:code class="code_block"></xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>You require TLS to be configured on apiserver as well as kubelets.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278537_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the --read-only-port is secured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Disable the read-only port.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use of Secure Network Management and Communication Protocols " urn="urn:cisecurity.org:controls:8.0:12:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to false                                              </xhtml:p>
                           <xhtml:code class="code_block">readOnlyPort to 0
</xhtml:code>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--read-only-port=0
</xhtml:code>
                           <xhtml:p>


For all three remediations:
Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Removal of the read-only port will require that any service which made use of it will need to be re-configured to use the main Kubelet API.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278538"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278540"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the --streaming-connection-idle-timeout argument is not set to 0</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not disable timeouts on streaming connections.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use of Secure Network Management and Communication Protocols " urn="urn:cisecurity.org:controls:8.0:12:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>


 By default,                                         <xhtml:span class="inline_block">--streaming-connection-idle-timeout</xhtml:span>


 is set to 4 hours which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/18552</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to a non-zero value in the format of #h#m#s                                              </xhtml:p>
                           <xhtml:code class="code_block">"streamingConnectionIdleTimeout": 
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using a Kubelet config file, edit the file to set                                                     <xhtml:span class="inline_block">streamingConnectionIdleTimeout</xhtml:span>


 to a value other than 0.                                              </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--streaming-connection-idle-timeout=4h0m0s
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"streamingConnectionIdleTimeout":</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Long-lived connections could be interrupted.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278542_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_set_to_true" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure that the --protect-kernel-defaults argument is set to true</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Protect tuned kernel parameters from overriding kubelet default kernel parameter values.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Implement Automated Configuration Monitoring Systems" urn="urn:cisecurity.org:controls:7.0:5:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to true                                              </xhtml:p>
                           <xhtml:code class="code_block">"protectKernelDefaults": 
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using a Kubelet config file, edit the file to set                                                     <xhtml:span class="inline_block">protectKernelDefaults</xhtml:span>


 to                                                     <xhtml:span class="inline_block">true</xhtml:span>


.                                              </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">----protect-kernel-defaults=true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"protectKernelDefaults":</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>You would have to re-tune kernel parameters to match kubelet parameters.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278544_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure that the --make-iptables-util-chains argument is set to true</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Allow Kubelet to manage iptables.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:12:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to false                                              </xhtml:p>
                           <xhtml:code class="code_block">"makeIPTablesUtilChains": true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--make-iptables-util-chains:true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"makeIPTablesUtilChains.: true</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Kubelet would manage the iptables on the system and keep it in sync. If you are using any other iptables management solution, then there might be some conflicts.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278546_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the --hostname-override argument is not set</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not override node hostnames.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Secure Configuration for Hardware and Software on Mobile Devices, Laptops, Workstations and Servers" urn="urn:cisecurity.org:controls:7.0:5"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/22063</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to null                                              </xhtml:p>
                           <xhtml:code class="code_block">"hostname-override"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--hostname-override
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Some cloud providers may require this flag to ensure that hostname matches names issued by the cloud provider.  In these environments, this recommendation should not apply.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278548"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.9_Ensure_that_the_--eventRecordQPS_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure that the --eventRecordQPS argument is set to 0 or a level which ensures appropriate event capture</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Security relevant information should be captured.  The                                         <xhtml:span class="inline_block">--eventRecordQPS</xhtml:span>


 flag on the Kubelet can be used to limit the rate at which events are gathered.  Setting this too low could result in relevant events not being logged, however the unlimited setting of                                         <xhtml:span class="inline_block">0</xhtml:span>


 could result in a denial of service on the kubelet.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/kubeletconfig/v1beta1/types.go</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to 5 or a value greater or equal to 0                                              </xhtml:p>
                           <xhtml:code class="code_block">"eventRecordQPS": 5
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--eventRecordQPS=5
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"eventRecordQPS"</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Setting this parameter to                                                           <xhtml:span class="inline_block">0</xhtml:span>


 could result in a denial of service condition due to excessive events being created.  The cluster's event processing and storage systems should be scaled to handle expected event loads.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278551_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the --rotate-certificates argument is not set to false</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Enable kubelet client certificate rotation.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


The                                         <xhtml:span class="inline_block">--rotate-certificates</xhtml:span>


 setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there is no downtime due to expired certificates and thus addressing availability in the CIA security triad.                                  </xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>


 This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.                                  </xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>


 This feature also require the                                         <xhtml:span class="inline_block">RotateKubeletClientCertificate</xhtml:span>


 feature gate to be enabled (which is the default since Kubernetes v1.7)                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/41912</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#kubelet-configuration</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/imported/release/notes/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to false                                              </xhtml:p>
                           <xhtml:code class="code_block">"RotateCertificate":true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--RotateCertificate=true
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278553"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278555"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.11_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the RotateKubeletServerCertificate argument is set to true</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Enable kubelet server certificate rotation.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>
                        <xhtml:span class="inline_block">RotateKubeletServerCertificate</xhtml:span>


 causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.                                  </xhtml:p>
                     <xhtml:p>Note: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/45059</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet-tls-bootstrapping/#kubelet-configuration</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 1:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If modifying the Kubelet config file, edit the kubelet-config.json file                                                     <xhtml:span class="inline_block">/etc/kubernetes/kubelet/kubelet-config.json</xhtml:span>


 and set the below parameter to true                                              </xhtml:p>
                           <xhtml:code class="code_block">"RotateKubeletServerCertificate":true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 2:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using a Kubelet config file, edit the file to set                                                     <xhtml:span class="inline_block">RotateKubeletServerCertificate to true</xhtml:span>


.                                              </xhtml:p>
                           <xhtml:p>


If using executable arguments, edit the kubelet service file                                                     <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</xhtml:span>


 on each worker node and add the below parameter at the end of the                                                     <xhtml:span class="inline_block">KUBELET_ARGS</xhtml:span>


 variable string.                                              </xhtml:p>
                           <xhtml:code class="code_block">--rotate-kubelet-server-certificate=true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Remediation Method 3:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


If using the api configz endpoint consider searching for the status of                                                     <xhtml:span class="inline_block">"RotateKubeletServerCertificate":</xhtml:span>


 by extracting the live configuration from the nodes running kubelet.                                              </xhtml:p>
                           <xhtml:p>


**See detailed step-by-step configmap procedures in                                                     <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>


, and then rerun the curl statement from audit process to check for kubelet configuration changes                                              </xhtml:p>
                           <xhtml:code class="code_block">


kubectl proxy --port=8001 &amp;                                                    <br></br>
                              <br></br>


export HOSTNAME_PORT=localhost:8001 (example host and port number)                                                    <br></br>


export NODE_NAME=ip-192.168.31.226.ec2.internal (example node name from "kubectl get nodes")                                                    <br></br>
                              <br></br>


curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>For all three remediations:</xhtml:strong>



Based on your system, restart the                                                     <xhtml:span class="inline_block">kubelet</xhtml:span>


 service and check status                                              </xhtml:p>
                           <xhtml:code class="code_block">


systemctl daemon-reload                                                    <br></br>


systemctl restart kubelet.service                                                    <br></br>


systemctl status kubelet -l
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1278558_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-SCRIPTkubelet_test"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.3_Container_Optimized_OS">
               <xccdf:title xml:lang="en">Container Optimized OS</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.1_Prefer_using_Container-Optimized_OS_when_possible" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Prefer using Container-Optimized OS when possible</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Container-Optimized OS is an operating system image that is designed for quick, secure deployment on Compute Engine VMs.</xhtml:p>
                     <xhtml:p>Use cases for Container-Optimized OS might include:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Docker container or Kubernetes support with minimal setup.</xhtml:li>
                        <xhtml:li>A small-secure container footprint.</xhtml:li>
                        <xhtml:li>An OS that is tested, hardened and verified for running Kubernetes in your Compute Engine Instances.</xhtml:li>
                     </xhtml:ul>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Container-Optimized OS have a smaller footprint which will reduce the instance's potential attack surface. Docker runtime and cloud-init is pre-installed and security settings like locked-down firewall is configured by default. Container-Optimized images are also configured to automatically update weekly in the background.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://aws.amazon.com/blogs/containers/bottlerocket-a-special-purpose-container-operating-system/</xccdf:ident>
                  <xccdf:ident system="URL">https://aws.amazon.com/blogs/aws/bottlerocket-open-source-os-for-container-hosting/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Container-Optimized OS can run most Docker containers.  Container-Optimized OS have limited or no support for package managers, execution of non-containerized applications, or ability to install third-party drivers or kernel modules.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Policies">
            <xccdf:title xml:lang="en">Policies</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations for various Kubernetes policies which are important to the security of Amazon EKS customer environment.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.1_RBAC_and_Service_Accounts">
               <xccdf:title xml:lang="en">RBAC and Service Accounts</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that the cluster-admin role is only used where required</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


The RBAC role                                         <xhtml:span class="inline_block">cluster-admin</xhtml:span>


 provides wide-ranging powers over the environment and should be used only where and when needed.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as                                         <xhtml:span class="inline_block">cluster-admin</xhtml:span>


 provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as                                         <xhtml:span class="inline_block">cluster-admin</xhtml:span>


 allow super-user access to perform any action on any resource. When used in a                                         <xhtml:span class="inline_block">ClusterRoleBinding</xhtml:span>


, it gives full control over every resource in the cluster and in all namespaces. When used in a                                         <xhtml:span class="inline_block">RoleBinding</xhtml:span>


, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/admin/authorization/rbac/#user-facing-roles</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Identify all clusterrolebindings to the cluster-admin role. Check if they are used and if they need this role or if they could use a role with fewer privileges.</xhtml:p>
                           <xhtml:p>Where possible, first bind users to a lower privileged role and then remove the clusterrolebinding to the cluster-admin role :</xhtml:p>
                           <xhtml:code class="code_block">kubectl delete clusterrolebinding [name]
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Care should be taken before removing any                                                           <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>


 from the environment to ensure they were not required for operation of the cluster. Specifically, modifications should not be made to                                                           <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>


 with the                                                           <xhtml:span class="inline_block">system:</xhtml:span>


 prefix as they are required for the operation of system components.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize access to secrets</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster.  Access to these secrets should be restricted to the smallest possible group of users to reduce the risk of privilege escalation.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Inappropriate access to secrets stored within the Kubernetes cluster can allow for an attacker to gain additional access to the Kubernetes cluster or external resources whose credentials are stored as secrets.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Where possible, remove                                                     <xhtml:span class="inline_block">get</xhtml:span>


,                                                     <xhtml:span class="inline_block">list</xhtml:span>


 and                                                     <xhtml:span class="inline_block">watch</xhtml:span>


 access to                                                     <xhtml:span class="inline_block">secret</xhtml:span>


 objects in the cluster.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Care should be taken not to remove access to secrets to system components which require this for their operation</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize wildcard use in Roles and ClusterRoles</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects.  It is possible to set either of these to be the wildcard "*" which matches all items.</xhtml:p>
                     <xhtml:p>Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The principle of least privilege recommends that users are provided only the access required for their role and nothing more.  The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Where possible replace any use of wildcards in clusterroles and roles with specific objects or actions.</xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Minimize_access_to_create_pods" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize access to create pods</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The ability to create pods in a namespace can provide a number of opportunities for privilege escalation, such as assigning privileged service accounts to these pods or mounting hostPaths with access to sensitive data (unless Pod Security Policies are implemented to restrict this access)</xhtml:p>
                     <xhtml:p>As such, access to create new pods should be restricted to the smallest possible group of users.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Allowlist Authorized Scripts" urn="urn:cisecurity.org:controls:8.0:2:7">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Limit Access to Script Tools" urn="urn:cisecurity.org:controls:7.0:4:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The ability to create pods in a cluster opens up possibilities for privilege escalation and should be restricted, where possible.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Where possible, remove                                                     <xhtml:span class="inline_block">create</xhtml:span>


 access to                                                     <xhtml:span class="inline_block">pod</xhtml:span>


 objects in the cluster.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Care should be taken not to remove access to pods to system components which require this for their operation</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_default_service_accounts_are_not_actively_used." role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that default service accounts are not actively used.</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


The                                         <xhtml:span class="inline_block">default</xhtml:span>


 service account should not be used to ensure that rights granted to applications can be more easily audited and reviewed.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:7.0:16:9">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Kubernetes provides a                                         <xhtml:span class="inline_block">default</xhtml:span>


 service account which is used by cluster workloads where no specific service account is assigned to the pod.                                  </xhtml:p>
                     <xhtml:p>Where access to the Kubernetes API from a pod is required, a specific service account should be created for that pod, and rights granted to that service account.</xhtml:p>
                     <xhtml:p>The default service account should be configured such that it does not provide a service account token and does not have any explicit rights assignments.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
                  <xccdf:ident system="URL">https://aws.github.io/aws-eks-best-practices/iam/#disable-auto-mounting-of-service-account-tokens</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Create explicit service accounts wherever a Kubernetes workload requires specific access to the Kubernetes API server.</xhtml:p>
                           <xhtml:p>Modify the configuration of each default service account to include this value</xhtml:p>
                           <xhtml:code class="code_block">automountServiceAccountToken: false
</xhtml:code>
                           <xhtml:p>Automatic remediation for the default account:</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">kubectl patch serviceaccount default -p $'automountServiceAccountToken: false'</xhtml:span>
                           </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>All workloads which require access to the Kubernetes API will require an explicit service account to be created.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that Service Account Tokens are only mounted where necessary</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Enforce Access Control to Data through Automated Tools" urn="urn:cisecurity.org:controls:7.0:14:7">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.</xhtml:p>
                     <xhtml:p>Avoiding mounting these tokens removes this attack avenue.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Modify the definition of pods and service accounts which do not need to mount service account tokens to disable it.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Pods mounted without service account tokens will not be able to communicate with the API server, except where the resource is available to unauthenticated principals.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.2_Pod_Security_Policies">
               <xccdf:title xml:lang="en">Pod Security Policies</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>A Pod Security Policy (PSP) is a cluster-level resource that controls security settings for pods. Your cluster may have multiple PSPs. You can query PSPs with the following command:</xhtml:p>
                  <xhtml:code class="code_block">kubectl get psp
</xhtml:code>
                  <xhtml:p>PodSecurityPolicies are used in conjunction with the PodSecurityPolicy admission controller plugin.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of privileged containers</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Do not generally permit containers to be run with the                                         <xhtml:span class="inline_block">securityContext.privileged</xhtml:span>


 flag set to                                         <xhtml:span class="inline_block">true</xhtml:span>


.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Privileged containers have access to all Linux Kernel capabilities and devices. A container running with full privileges can do almost everything that the host can do. This flag exists to allow special use-cases, like manipulating the network stack and accessing devices.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit privileged containers.</xhtml:p>
                     <xhtml:p>If you need to run privileged containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
                  <xccdf:ident system="URL">https://aws.github.io/aws-eks-best-practices/pods/#restrict-the-containers-that-can-run-as-privileged</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.privileged</xhtml:span>


 field is omitted or set to                                                     <xhtml:span class="inline_block">false</xhtml:span>


.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Pods defined with                                                           <xhtml:span class="inline_block">spec.containers[].securityContext.privileged: true</xhtml:span>


 will not be permitted.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278539" value-id="xccdf_org.cisecurity.benchmarks_value_1278539_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278539"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host process ID namespace</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Do not generally permit containers to be run with the                                         <xhtml:span class="inline_block">hostPID</xhtml:span>


 flag set to true.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>A container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host PID namespace.</xhtml:p>
                     <xhtml:p>If you need to run containers which require hostPID, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.hostPID</xhtml:span>


 field is omitted or set to false.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Pods defined with                                                           <xhtml:span class="inline_block">spec.hostPID: true</xhtml:span>


 will not be permitted unless they are run under a specific PSP.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278541" value-id="xccdf_org.cisecurity.benchmarks_value_1278541_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278541"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278543" value-id="xccdf_org.cisecurity.benchmarks_value_1278543_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278543"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host IPC namespace</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Do not generally permit containers to be run with the                                         <xhtml:span class="inline_block">hostIPC</xhtml:span>


 flag set to true.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>A container running in the host's IPC namespace can use IPC to interact with processes outside the container.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host IPC namespace.</xhtml:p>
                     <xhtml:p>If you have a requirement to containers which require hostIPC, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.hostIPC</xhtml:span>


 field is omitted or set to false.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Pods defined with                                                           <xhtml:span class="inline_block">spec.hostIPC: true</xhtml:span>


 will not be permitted unless they are run under a specific PSP.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278545" value-id="xccdf_org.cisecurity.benchmarks_value_1278545_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278545"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278547" value-id="xccdf_org.cisecurity.benchmarks_value_1278547_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278547"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host network namespace</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Do not generally permit containers to be run with the                                         <xhtml:span class="inline_block">hostNetwork</xhtml:span>


 flag set to true.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>A container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host network namespace.</xhtml:p>
                     <xhtml:p>If you have need to run containers which require hostNetwork, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.hostNetwork</xhtml:span>


 field is omitted or set to false.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Pods defined with                                                           <xhtml:span class="inline_block">spec.hostNetwork: true</xhtml:span>


 will not be permitted unless they are run under a specific PSP.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278549" value-id="xccdf_org.cisecurity.benchmarks_value_1278549_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278549"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278550" value-id="xccdf_org.cisecurity.benchmarks_value_1278550_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278550"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers with allowPrivilegeEscalation</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Do not generally permit containers to be run with the                                         <xhtml:span class="inline_block">allowPrivilegeEscalation</xhtml:span>


 flag set to true.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


A container running with the                                         <xhtml:span class="inline_block">allowPrivilegeEscalation</xhtml:span>


 flag set to                                         <xhtml:span class="inline_block">true</xhtml:span>


 may have processes that can gain more privileges than their parent.                                  </xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run.</xhtml:p>
                     <xhtml:p>If you have need to run containers which use setuid binaries or require privilege escalation, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.allowPrivilegeEscalation</xhtml:span>


 field is omitted or set to false.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Pods defined with                                                           <xhtml:span class="inline_block">spec.allowPrivilegeEscalation: true</xhtml:span>


 will not be permitted unless they are run under a specific PSP.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278552" value-id="xccdf_org.cisecurity.benchmarks_value_1278552_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278552"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278554" value-id="xccdf_org.cisecurity.benchmarks_value_1278554_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278554"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of root containers</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not generally permit containers to be run as the root user.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Containers may run as any Linux user.  Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout.</xhtml:p>
                     <xhtml:p>Ideally, all containers should run as a defined non-UID 0 user.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.</xhtml:p>
                     <xhtml:p>If you need to run root containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.runAsUser.rule</xhtml:span>


 is set to either                                                     <xhtml:span class="inline_block">MustRunAsNonRoot</xhtml:span>


 or                                                     <xhtml:span class="inline_block">MustRunAs</xhtml:span>


 with the range of UIDs not including 0.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Pods with containers which run as the root user will not be permitted.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278556" value-id="xccdf_org.cisecurity.benchmarks_value_1278556_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278556"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278557" value-id="xccdf_org.cisecurity.benchmarks_value_1278557_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278557"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers with the NET_RAW capability</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not generally permit containers with the potentially dangerous NET_RAW capability.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime.  By default this can include potentially dangerous capabilities.  With Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers.</xhtml:p>
                     <xhtml:p>Ideally, all containers should drop this capability.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which prevents containers with the NET_RAW capability from launching.</xhtml:p>
                     <xhtml:p>If you need to run containers with this capability, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
                  <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Create a PSP as described in the Kubernetes documentation, ensuring that the                                                     <xhtml:span class="inline_block">.spec.requiredDropCapabilities</xhtml:span>


 is set to include either                                                     <xhtml:span class="inline_block">NET_RAW</xhtml:span>


 or                                                     <xhtml:span class="inline_block">ALL</xhtml:span>


.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Pods with containers which run with the NET_RAW capability will not be permitted.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278559" value-id="xccdf_org.cisecurity.benchmarks_value_1278559_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278559"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278560" value-id="xccdf_org.cisecurity.benchmarks_value_1278560_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278560"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers with added capabilities</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not generally permit containers with capabilities assigned beyond the default set.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. Capabilities outside this set can be added to containers which could expose them to risks of container breakout attacks.</xhtml:p>
                     <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which prevents containers with capabilities beyond the default set from launching.</xhtml:p>
                     <xhtml:p>If you need to run containers with additional capabilities, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
                  <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Ensure that                                                     <xhtml:span class="inline_block">allowedCapabilities</xhtml:span>


 is not present in PSPs for the cluster unless it is set to an empty array.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Pods with containers which require capabilities outwith the default set will not be permitted.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:1278561" value-id="xccdf_org.cisecurity.benchmarks_value_1278561_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:1278561"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize the admission of containers with capabilities assigned</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Do not generally permit containers with capabilities</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. Capabilities are parts of the rights generally granted on a Linux system to the root user.</xhtml:p>
                     <xhtml:p>In many cases applications running in containers do not require any capabilities to operate, so from the perspective of the principal of least privilege use of capabilities should be minimized.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
                  <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Review the use of capabilites in applications runnning on your cluster.  Where a namespace contains applicaions which do not require any Linux capabities to operate consider adding a PSP which forbids the admission of containers which do not drop all capabilities.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Pods with containers require capabilities to operate will not be permitted.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.3_CNI_Plugin">
               <xccdf:title xml:lang="en">CNI Plugin</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_latest_CNI_version_is_used" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure latest CNI version is used</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>There are a variety of CNI plugins available for Kubernetes. If the CNI in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Only Use Up-to-date And Trusted Third-Party Components" urn="urn:cisecurity.org:controls:7.0:18:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>


One example here is Flannel (                                              <xhtml:a href="https://github.com/coreos/flannel">https://github.com/coreos/flannel</xhtml:a>


) which does not support Network policy unless Calico is also in use.                                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kubernetes network policies are enforced by the CNI plugin in use.  As such it is important to ensure that the CNI plugin supports both Ingress and Egress network policies.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/</xccdf:ident>
                  <xccdf:ident system="URL">https://aws.github.io/aws-eks-best-practices/network/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>As with RBAC policies, network policies should adhere to the policy of least privileged access. Start by creating a deny all policy that restricts all inbound and outbound traffic from a namespace or create a global policy using Calico.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.2_Ensure_that_all_Namespaces_have_Network_Policies_defined" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure that all Namespaces have Network Policies defined</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Use network policies to isolate traffic in your cluster network.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Enable Firewall Filtering Between VLANs" urn="urn:cisecurity.org:controls:7.0:14:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints.</xhtml:p>
                     <xhtml:p>Network Policies are namespace scoped.  When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace all traffic will be allowed into and out of the pods in that namespace.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/services-networking/networkpolicies/</xccdf:ident>
                  <xccdf:ident system="URL">https://octetz.com/posts/k8s-network-policy-apis</xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/declare-network-policy/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Follow the documentation and create                                                     <xhtml:span class="inline_block">NetworkPolicy</xhtml:span>


 objects as you need them.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Once network policies are in use within a given namespace, traffic not explicitly allowed by a network policy will be denied.  As such it is important to ensure that, when introducing network policies, legitimate traffic is not blocked.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.4_Secrets_Management">
               <xccdf:title xml:lang="en">Secrets Management</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Prefer using secrets as files over secrets as environment variables</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Kubernetes supports mounting secrets as data volumes or as environment variables. Minimize the use of environment variable secrets.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>Mounting secrets as volumes has the additional benefit that secret values can be updated without restarting the pod</xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>It is reasonably common for application code to log out its environment (particularly in the event of an error). This will include any secret values passed in as environment variables, so secrets can easily be exposed to any user or entity who has access to the logs.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>If possible, rewrite application code to read secrets from mounted secret files, rather than from environment variables.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Application code which expects to read secrets in the form of environment variables would need modification</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.2_Consider_external_secret_storage" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Consider external secret storage</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Consider the use of an external secrets storage and management system, instead of using Kubernetes Secrets directly, if you have more complex secret management needs. Ensure the solution requires authentication to access secrets, has auditing of access to and use of secrets, and encrypts secrets. Some solutions also make it easier to rotate secrets.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kubernetes supports secrets as first-class objects, but care needs to be taken to ensure that access to secrets is carefully limited. Using an external secrets provider can ease the management of access to secrets, especially where secrests are used across both Kubernetes and non-Kubernetes environments.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Refer to the secrets management options offered by your cloud provider or a third-party secrets management solution.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.5_Extensible_Admission_Control">
               <xccdf:title xml:lang="en">Extensible Admission Control</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.6_General_Policies">
               <xccdf:title xml:lang="en">General Policies</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>These policies relate to general cluster management topics, like namespace best practices and policies applied to pod objects in the cluster.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Create administrative boundaries between resources using namespaces</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Use namespaces to isolate your Kubernetes objects.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain Dedicated Computing Resources for All Administrative Work" urn="urn:cisecurity.org:controls:8.0:12:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain an Inventory of Network Boundaries" urn="urn:cisecurity.org:controls:7.0:12:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in an Amazon EKS cluster runs in a default namespace, called                                         <xhtml:span class="inline_block">default</xhtml:span>


. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</xccdf:ident>
                  <xccdf:ident system="URL">http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Follow the documentation and create namespaces for objects in your deployment as you need them.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>You need to switch between namespaces for administration.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.2_Apply_Security_Context_to_Your_Pods_and_Containers" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Apply Security Context to Your Pods and Containers</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apply Security Context to Your Pods and Containers</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/security-context/</xccdf:ident>
                  <xccdf:ident system="URL">https://learn.cisecurity.org/benchmarks</xccdf:ident>
                  <xccdf:ident system="URL">https://aws.github.io/aws-eks-best-practices/pods/#restrict-the-containers-that-can-run-as-privileged</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>As a best practice we recommend that you scope the binding for privileged pods to service accounts within a particular namespace, e.g. kube-system, and limiting access to that namespace. For all other serviceaccounts/namespaces, we recommend implementing a more restrictive policy such as this:</xhtml:p>
                           <xhtml:code class="code_block">


apiVersion: policy/v1beta1                                                    <br></br>


kind: PodSecurityPolicy                                                    <br></br>


metadata:                                                    <br></br>


    name: restricted                                                    <br></br>


    annotations:                                                    <br></br>


    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'                                                    <br></br>


    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'                                                    <br></br>


    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'                                                    <br></br>


    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'                                                    <br></br>


spec:                                                    <br></br>


    privileged: false                                                    <br></br>


    # Required to prevent escalations to root.                                                    <br></br>


    allowPrivilegeEscalation: false                                                    <br></br>


    # This is redundant with non-root + disallow privilege escalation,                                                    <br></br>


    # but we can provide it for defense in depth.                                                    <br></br>


    requiredDropCapabilities:                                                    <br></br>


    - ALL                                                    <br></br>


    # Allow core volume types.                                                    <br></br>


    volumes:                                                    <br></br>


    - 'configMap'                                                    <br></br>


    - 'emptyDir'                                                    <br></br>


    - 'projected'                                                    <br></br>


    - 'secret'                                                    <br></br>


    - 'downwardAPI'                                                    <br></br>


    # Assume that persistentVolumes set up by the cluster admin are safe to use.                                                    <br></br>


    - 'persistentVolumeClaim'                                                    <br></br>


    hostNetwork: false                                                    <br></br>


    hostIPC: false                                                    <br></br>


    hostPID: false                                                    <br></br>


    runAsUser:                                                    <br></br>


    # Require the container to run without root privileges.                                                    <br></br>


    rule: 'MustRunAsNonRoot'                                                    <br></br>


    seLinux:                                                    <br></br>


    # This policy assumes the nodes are using AppArmor rather than SELinux.                                                    <br></br>


    rule: 'RunAsAny'                                                    <br></br>


    supplementalGroups:                                                    <br></br>


    rule: 'MustRunAs'                                                    <br></br>


    ranges:                                                    <br></br>


        # Forbid adding the root group.                                                    <br></br>


        - min: 1                                                    <br></br>


        max: 65535                                                    <br></br>


    fsGroup:                                                    <br></br>


    rule: 'MustRunAs'                                                    <br></br>


    ranges:                                                    <br></br>


        # Forbid adding the root group.                                                    <br></br>


        - min: 1                                                    <br></br>


        max: 65535                                                    <br></br>


    readOnlyRootFilesystem: false
                                              </xhtml:code>
                           <xhtml:p>This policy prevents pods from running as privileged or escalating privileges. It also restricts the types of volumes that can be mounted and the root supplemental groups that can be added.</xhtml:p>
                           <xhtml:p>Another, albeit similar, approach is to start with policy that locks everything down and incrementally add exceptions for applications that need looser restrictions such as logging agents which need the ability to mount a host path.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If you incorrectly apply security contexts, you may have trouble running the pods.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.3_The_default_namespace_should_not_be_used" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">The default namespace should not be used</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Kubernetes provides a default namespace, where objects are placed if no namespace is specified for them.  Placing objects in this namespace makes application of RBAC and other controls more difficult.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Resources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Ensure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>None</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Managed_services">
            <xccdf:title xml:lang="en">Managed services</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section consists of security recommendations for the Amazon EKS. These recommendations are applicable for configurations that Amazon EKS customers own and manage.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_Image_Registry_and_Image_Scanning">
               <xccdf:title xml:lang="en">Image Registry and Image Scanning</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations relating to container image registries and securing images in those registries, such as Amazon Elastic Container Registry (ECR).</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_using_Amazon_ECR_image_scanning_or_a_third_party_provider" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Image Vulnerability Scanning using Amazon ECR image scanning or a third party provider</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Scan images being deployed to Amazon EKS for vulnerabilities.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Perform Automated Vulnerability Scans of Internal Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Run Automated Vulnerability Scanning Tools" urn="urn:cisecurity.org:controls:7.0:3:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Perform Authenticated Vulnerability Scanning" urn="urn:cisecurity.org:controls:7.0:3:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Vulnerabilities in software packages can be exploited by hackers or malicious users to obtain unauthorized access to local cloud resources. Amazon ECR and other third party products allow images to be scanned for known vulnerabilities.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To utilize AWS ECR for Image scanning please follow the steps below:</xhtml:p>
                           <xhtml:p>To create a repository configured for scan on push (AWS CLI)</xhtml:p>
                           <xhtml:code class="code_block">aws ecr create-repository --repository-name $REPO_NAME --image-scanning-configuration scanOnPush=true --region $REGION_CODE
</xhtml:code>
                           <xhtml:p>To edit the settings of an existing repository (AWS CLI)</xhtml:p>
                           <xhtml:code class="code_block">aws ecr put-image-scanning-configuration --repository-name $REPO_NAME --image-scanning-configuration scanOnPush=true --region $REGION_CODE
</xhtml:code>
                           <xhtml:p>Use the following steps to start a manual image scan using the AWS Management Console.</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open the Amazon ECR console at                                                           <xhtml:a href="https://console.aws.amazon.com/ecr/repositories">https://console.aws.amazon.com/ecr/repositories</xhtml:a>


.                                                    </xhtml:li>
                              <xhtml:li>From the navigation bar, choose the Region to create your repository in.</xhtml:li>
                              <xhtml:li>In the navigation pane, choose Repositories.</xhtml:li>
                              <xhtml:li>On the Repositories page, choose the repository that contains the image to scan.</xhtml:li>
                              <xhtml:li>On the Images page, select the image to scan and then choose Scan.</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If you are utilizing AWS ECR</xhtml:p>
                              <xhtml:p>The following are common image scan failures. You can view errors like this in the Amazon ECR console by displaying the image details or through the API or AWS CLI by using the DescribeImageScanFindings API.</xhtml:p>
                              <xhtml:p>UnsupportedImageError
You may get an UnsupportedImageError error when attempting to scan an image that was built using an operating system that Amazon ECR doesn't support image scanning for. Amazon ECR supports package vulnerability scanning for major versions of Amazon Linux, Amazon Linux 2, Debian, Ubuntu, CentOS, Oracle Linux, Alpine, and RHEL Linux distributions. Amazon ECR does not support scanning images built from the Docker scratch image.</xhtml:p>
                              <xhtml:p>An UNDEFINED severity level is returned
You may receive a scan finding that has a severity level of UNDEFINED. The following are the common causes for this:</xhtml:p>
                              <xhtml:p>The vulnerability was not assigned a priority by the CVE source.</xhtml:p>
                              <xhtml:p>The vulnerability was assigned a priority that Amazon ECR did not recognize.</xhtml:p>
                              <xhtml:p>To determine the severity and description of a vulnerability, you can view the CVE directly from the source.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_Amazon_ECR" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize user access to Amazon ECR</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Restrict user access to Amazon ECR, limiting interaction with build images to only authorized personnel and service accounts.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Weak access control to Amazon ECR may allow malicious users to replace built images with vulnerable containers.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html#scanning-repository</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Before you use IAM to manage access to Amazon ECR, you should understand what IAM features are available to use with Amazon ECR. To get a high-level view of how Amazon ECR and other AWS services work with IAM, see AWS Services That Work with IAM in the IAM User Guide.</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Topics</xhtml:strong>
                           </xhtml:p>
                           <xhtml:ul>
                              <xhtml:li>Amazon ECR Identity-Based Policies</xhtml:li>
                              <xhtml:li>Amazon ECR Resource-Based Policies</xhtml:li>
                              <xhtml:li>Authorization Based on Amazon ECR Tags</xhtml:li>
                              <xhtml:li>Amazon ECR IAM Roles</xhtml:li>
                           </xhtml:ul>
                           <xhtml:p>
                              <xhtml:strong>Amazon ECR Identity-Based Policies</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>With IAM identity-based policies, you can specify allowed or denied actions and resources as well as the conditions under which actions are allowed or denied. Amazon ECR supports specific actions, resources, and condition keys. To learn about all of the elements that you use in a JSON policy, see IAM JSON Policy Elements Reference in the IAM User Guide.</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Actions</xhtml:strong>



The Action element of an IAM identity-based policy describes the specific action or actions that will be allowed or denied by the policy. Policy actions usually have the same name as the associated AWS API operation. The action is used in a policy to grant permissions to perform the associated operation.                                              </xhtml:p>
                           <xhtml:p>Policy actions in Amazon ECR use the following prefix before the action: ecr:. For example, to grant someone permission to create an Amazon ECR repository with the Amazon ECR CreateRepository API operation, you include the ecr:CreateRepository action in their policy. Policy statements must include either an Action or NotAction element. Amazon ECR defines its own set of actions that describe tasks that you can perform with this service.</xhtml:p>
                           <xhtml:p>To specify multiple actions in a single statement, separate them with commas as follows:</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">"Action": [ "ecr:action1", "ecr:action2"</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>You can specify multiple actions using wildcards (*). For example, to specify all actions that begin with the word Describe, include the following action:</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">"Action": "ecr:Describe*"</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>To see a list of Amazon ECR actions, see Actions, Resources, and Condition Keys for Amazon Elastic Container Registry in the IAM User Guide.</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Resources</xhtml:strong>



The Resource element specifies the object or objects to which the action applies. Statements must include either a Resource or a NotResource element. You specify a resource using an ARN or using the wildcard (*) to indicate that the statement applies to all resources.                                              </xhtml:p>
                           <xhtml:p>An Amazon ECR repository resource has the following ARN:</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">arn:${Partition}:ecr:${Region}:${Account}:repository/${Repository-name}</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>For more information about the format of ARNs, see Amazon Resource Names (ARNs) and AWS Service Namespaces.</xhtml:p>
                           <xhtml:p>For example, to specify the my-repo repository in the us-east-1 Region in your statement, use the following ARN:</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">"Resource": "arn:aws:ecr:us-east-1:123456789012:repository/my-repo"</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>To specify all repositories that belong to a specific account, use the wildcard (*):</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">"Resource": "arn:aws:ecr:us-east-1:123456789012:repository/*"</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>To specify multiple resources in a single statement, separate the ARNs with commas.</xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">"Resource": [ "resource1", "resource2"</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>To see a list of Amazon ECR resource types and their ARNs, see Resources Defined by Amazon Elastic Container Registry in the IAM User Guide. To learn with which actions you can specify the ARN of each resource, see Actions Defined by Amazon Elastic Container Registry.</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Condition Keys</xhtml:strong>



The Condition element (or Condition block) lets you specify conditions in which a statement is in effect. The Condition element is optional. You can build conditional expressions that use condition operators, such as equals or less than, to match the condition in the policy with values in the request.                                              </xhtml:p>
                           <xhtml:p>If you specify multiple Condition elements in a statement, or multiple keys in a single Condition element, AWS evaluates them using a logical AND operation. If you specify multiple values for a single condition key, AWS evaluates the condition using a logical OR operation. All of the conditions must be met before the statement's permissions are granted.</xhtml:p>
                           <xhtml:p>You can also use placeholder variables when you specify conditions. For example, you can grant an IAM user permission to access a resource only if it is tagged with their IAM user name. For more information, see IAM Policy Elements: Variables and Tags in the IAM User Guide.</xhtml:p>
                           <xhtml:p>Amazon ECR defines its own set of condition keys and also supports using some global condition keys. To see all AWS global condition keys, see AWS Global Condition Context Keys in the IAM User Guide.</xhtml:p>
                           <xhtml:p>Most Amazon ECR actions support the aws:ResourceTag and ecr:ResourceTag condition keys. For more information, see Using Tag-Based Access Control.</xhtml:p>
                           <xhtml:p>To see a list of Amazon ECR condition keys, see Condition Keys Defined by Amazon Elastic Container Registry in the IAM User Guide. To learn with which actions and resources you can use a condition key, see Actions Defined by Amazon Elastic Container Registry.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Care should be taken not to remove access to Amazon ECR for accounts that require this for their operation.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_Amazon_ECR" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize cluster access to read-only for Amazon ECR</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Configure the Cluster Service Account with Storage Object Viewer Role to only allow read-only access to Amazon ECR.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The Cluster Service Account does not require administrative access to Amazon ECR, only requiring pull access to containers to deploy onto Amazon EKS. Restricting permissions follows the principles of least privilege and prevents credentials from being abused beyond the required role.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/AmazonECR/latest/userguide/ECR_on_EKS.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>You can use your Amazon ECR images with Amazon EKS, but you need to satisfy the following prerequisites.</xhtml:p>
                           <xhtml:p>The Amazon EKS worker node IAM role (NodeInstanceRole) that you use with your worker nodes must possess the following IAM policy permissions for Amazon ECR.</xhtml:p>
                           <xhtml:code class="code_block">


{                                                    <br></br>


    "Version": "2012-10-17",                                                    <br></br>


    "Statement": [                                                    <br></br>


        {                                                    <br></br>


            "Effect": "Allow",                                                    <br></br>


            "Action": [                                                    <br></br>


                "ecr:BatchCheckLayerAvailability",                                                    <br></br>


                "ecr:BatchGetImage",                                                    <br></br>


                "ecr:GetDownloadUrlForLayer",                                                    <br></br>


                "ecr:GetAuthorizationToken"                                                    <br></br>


            ],                                                    <br></br>


            "Resource": "*"                                                    <br></br>


        }                                                    <br></br>


    ]                                                    <br></br>


}
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>A separate dedicated service account may be required for use by build servers and other robot users pushing or managing container images.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_Container_Registries_to_only_those_approved" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Minimize Container Registries to only those approved</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Use approved container registries.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Securely Store Master Images" urn="urn:cisecurity.org:controls:7.0:5:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Only Allow Access to Authorized Cloud Storage or Email Providers" urn="urn:cisecurity.org:controls:7.0:13:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Allowing unrestricted access to external container registries provides the opportunity for malicious or unapproved containers to be deployed into the cluster. Allowlisting only approved container registries reduces this risk.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://aws.amazon.com/blogs/opensource/using-open-policy-agent-on-amazon-eks/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>All container images to be deployed to the cluster must be hosted within an approved container image registry.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Identity_and_Access_Management_IAM">
               <xccdf:title xml:lang="en">Identity and Access Management (IAM)</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations relating to using AWS IAM with Amazon EKS.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Prefer_using_managed_identities_for_workloads" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Prefer using managed identities for workloads</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Managed identities eliminate the need for developers to manage credentials. Managed identities provide an identity for applications to use when connecting to resources that support Azure AD authentication. When a managed identity is enabled, a service principal representing that managed identity is created in your tenant.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>To access resources that are secured by an Azure AD tenant, the entity that requires access must be represented by a security principal. This requirement is true for both users (user principal) and applications (service principal). The security principal defines the access policy and permissions for the user/application in the Azure AD tenant. This enables core features such as authentication of the user/application during sign-in, and authorization during resource access.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals</xccdf:ident>
                  <xccdf:ident system="URL">https://docs.microsoft.com/en-us/azure/aks/use-managed-identity</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To update an AKS cluster currently working with service principals to work with managed identities by using the following CLI commands.</xhtml:p>
                           <xhtml:code class="code_block">az aks update -g &lt;RGName&gt; -n &lt;AKSName&gt; --enable-managed-identity
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Any changes that you make to your application object are also reflected in its service principal object in the application's home tenant only (the tenant where it was registered). This means that deleting an application object will also delete its home tenant service principal object. However, restoring that application object will not restore its corresponding service principal.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.3_AWS_EKS_Key_Management_Service">
               <xccdf:title xml:lang="en">AWS EKS Key Management Service</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations relating to using AWS EKS Key Management.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_Customer_Master_Keys_CMKs_managed_in_AWS_KMS" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs) managed in AWS KMS</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Encrypt Kubernetes secrets, stored in etcd, using secrets encryption feature during Amazon EKS cluster creation.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kubernetes can store secrets that pods can access via a mounted volume. Today, Kubernetes secrets are stored with Base64 encoding, but encrypting is the recommended approach. Amazon EKS clusters version 1.13 and higher support the capability of encrypting your Kubernetes secrets using AWS Key Management Service (KMS) Customer Managed Keys (CMK). The only requirement is to enable the encryption provider support during EKS cluster creation.</xhtml:p>
                     <xhtml:p>Use AWS Key Management Service (KMS) keys to provide envelope encryption of Kubernetes secrets stored in Amazon EKS. Implementing envelope encryption is considered a security best practice for applications that store sensitive data and is part of a defense in depth security strategy.</xhtml:p>
                     <xhtml:p>Application-layer Secrets Encryption provides an additional layer of security for sensitive data, such as user defined Secrets and Secrets required for the operation of the cluster, such as service account keys, which are all stored in etcd.</xhtml:p>
                     <xhtml:p>Using this functionality, you can use a key, that you manage in AWS KMS, to encrypt data at the application layer. This protects against attackers in the event that they manage to gain access to etcd.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://aws.amazon.com/about-aws/whats-new/2020/03/amazon-eks-adds-envelope-encryption-for-secrets-with-aws-kms/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>This process can only be performed during Cluster Creation.</xhtml:p>
                           <xhtml:p>Enable 'Secrets Encryption' during Amazon EKS cluster creation as described in the links within the 'References' section.</xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.4_Cluster_Networking">
               <xccdf:title xml:lang="en">Cluster Networking</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations relating to network security configurations in Amazon EKS.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Restrict_Access_to_the_Control_Plane_Endpoint" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Restrict Access to the Control Plane Endpoint</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Enable Endpoint Private Access to restrict access to the cluster's control plane to only an allowlist of authorized IPs.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:8.0:9:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:7.0:7:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Authorized networks are a way of specifying a restricted range of IP addresses that are permitted to access your cluster's control plane. Kubernetes Engine uses both Transport Layer Security (TLS) and authentication to provide secure access to your cluster's control plane from the public internet. This provides you the flexibility to administer your cluster from anywhere; however, you might want to further restrict access to a set of IP addresses that you control. You can set this restriction by specifying an authorized network.</xhtml:p>
                     <xhtml:p>Restricting access to an authorized network can provide additional security benefits for your container cluster, including:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Better protection from outsider attacks: Authorized networks provide an additional layer of security by limiting external access to a specific set of addresses you designate, such as those that originate from your premises. This helps protect access to your cluster in the case of a vulnerability in the cluster's authentication or authorization mechanism.</xhtml:li>
                        <xhtml:li>Better protection from insider attacks: Authorized networks help protect your cluster from accidental leaks of master certificates from your company's premises. Leaked certificates used from outside Azure Cloud Services and outside the authorized IP ranges (for example, from addresses outside your company) are still denied access.</xhtml:li>
                     </xhtml:ul>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>When implementing Endpoint Private Access, be careful to ensure all desired networks are on the allowlist (whitelist) to prevent inadvertently blocking external access to your cluster's control plane.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_clusters_are_created_with_Private_Endpoint_Enabled_and_Public_Access_Disabled" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Disable access to the Kubernetes API from outside the node network if it is not required.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Boundary Defense" urn="urn:cisecurity.org:controls:7.0:12"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>In a private cluster, the master node has two endpoints, a private and public endpoint. The private endpoint is the internal IP address of the master, behind an internal load balancer in the master's VPC network. Nodes communicate with the master using the private endpoint. The public endpoint enables the Kubernetes API to be accessed from outside the master's VPC network.</xhtml:p>
                     <xhtml:p>Although Kubernetes API requires an authorized token to perform sensitive actions, a vulnerability could potentially expose the Kubernetes publically with unrestricted access. Additionally, an attacker may be able to identify the current cluster and Kubernetes API version and determine whether it is vulnerable to an attack. Unless required, disabling public endpoint will help prevent such threats, and require the attacker to be on the master's VPC network to perform any attack on the Kubernetes API.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Configure the EKS cluster endpoint to be private.</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>
                                    <xhtml:p>Leave the cluster endpoint public and specify which CIDR blocks can communicate with the cluster endpoint. The blocks are effectively a whitelisted set of public IP addresses that are allowed to access the cluster endpoint.</xhtml:p>
                                 </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:p>Configure public access with a set of whitelisted CIDR blocks and set private endpoint access to enabled. This will allow public access from a specific range of public IPs while forcing all network traffic between the kubelets (workers) and the Kubernetes API through the cross-account ENIs that get provisioned into the cluster VPC when the control plane is provisioned.</xhtml:p>
                                 </xhtml:li>
                              </xhtml:ol>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.3_Ensure_clusters_are_created_with_Private_Nodes" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure clusters are created with Private Nodes</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Boundary Defense" urn="urn:cisecurity.org:controls:7.0:12"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling public IP addresses on cluster nodes restricts access to only internal networks, forcing attackers to obtain local network access before attempting to compromise the underlying Kubernetes hosts.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>To enable Private Nodes, the cluster has to also be configured with a private master IP range and IP Aliasing enabled.</xhtml:p>
                              <xhtml:p>Private Nodes do not have outbound access to the public internet. If you want to provide outbound Internet access for your private nodes, you can use Cloud NAT or you can manage your own NAT gateway.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.4_Ensure_Network_Policy_is_Enabled_and_set_as_appropriate" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Network Policy is Enabled and set as appropriate</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Amazon EKS provides two ways to implement network policy. You choose a network policy option when you create an EKS cluster. The policy option can't be changed after the cluster is created:
Calico Network Policies, an open-source network and network security solution founded by Tigera.
Both implementations use Linux IPTables to enforce the specified policies. Policies are translated into sets of allowed and disallowed IP pairs. These pairs are then programmed as IPTable filter rules.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use of Secure Network Management and Communication Protocols " urn="urn:cisecurity.org:controls:8.0:12:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>By default, all pod to pod traffic within a cluster is allowed. Network Policy creates a pod-level firewall that can be used to restrict traffic between sources. Pod traffic is restricted by having a Network Policy that selects it (through the use of labels). Once there is any Network Policy in a namespace selecting a particular pod, that pod will reject any connections that are not allowed by any Network Policy. Other pods in the namespace that are not selected by any Network Policy will continue to accept all traffic.</xhtml:p>
                     <xhtml:p>Network Policies are managed via the Kubernetes Network Policy API and enforced by a network plugin, simply creating the resource without a compatible network plugin to implement it will have no effect.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Network Policy requires the Network Policy add-on. This add-on is included automatically when a cluster with Network Policy is created, but for an existing cluster, needs to be added prior to enabling Network Policy.</xhtml:p>
                              <xhtml:p>Enabling/Disabling Network Policy causes a rolling update of all cluster nodes, similar to performing a cluster upgrade. This operation is long-running and will block other operations on the cluster (including delete) until it has run to completion.</xhtml:p>
                              <xhtml:p>Enabling Network Policy enforcement consumes additional resources in nodes. Specifically, it increases the memory footprint of the kube-system process by approximately 128MB, and requires approximately 300 millicores of CPU.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.5_Encrypt_traffic_to_HTTPS_load_balancers_with_TLS_certificates" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Encrypt traffic to HTTPS load balancers with TLS certificates</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Encrypt traffic to HTTPS load balancers using TLS certificates.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Encrypting traffic between users and your Kubernetes workload is fundamental to protecting data sent over the web.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/data-protection.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p></xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.5_Authentication_and_Authorization">
               <xccdf:title xml:lang="en">Authentication and Authorization</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations relating to authentication and authorization in Amazon EKS.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Manage_Kubernetes_RBAC_users_with_AWS_IAM_Authenticator_for_Kubernetes" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Manage Kubernetes RBAC users with AWS IAM Authenticator for Kubernetes</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Amazon EKS uses IAM to provide authentication to your Kubernetes cluster through the AWS IAM Authenticator for Kubernetes. You can configure the stock kubectl client to work with Amazon EKS by installing the AWS IAM Authenticator for Kubernetes and modifying your kubectl configuration file to use it for authentication.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>On- and off-boarding users is often difficult to automate and prone to error. Using a single source of truth for user permissions reduces the number of locations that an individual must be off-boarded from, and prevents users gaining unique permissions sets that increase the cost of audit.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/eks/latest/userguide/add-user-role.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


Refer to the '                                                    <xhtml:a href="https://docs.aws.amazon.com/eks/latest/userguide/add-user-role.html">Managing users or IAM roles for your cluster</xhtml:a>


' in Amazon EKS documentation.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Users must now be assigned to the IAM group created to use this namespace and deploy applications.  If they are not they will not be able to access the namespace or deploy.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.6_Other_Cluster_Configurations">
               <xccdf:title xml:lang="en">Other Cluster Configurations</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations relating to any remaining security-related cluster configurations in Amazon EKS.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Consider_Fargate_for_running_untrusted_workloads" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Consider Fargate for running untrusted workloads</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>It is Best Practice to restrict or fence untrusted workloads when running in a multi-tenant environment.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:8.0:16:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:7.0:18:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://docs.aws.amazon.com/eks/latest/userguide/fargate.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Create a Fargate profile for your cluster</xhtml:strong>



Before you can schedule pods running on Fargate in your cluster, you must define a Fargate profile that specifies which pods should use Fargate when they are launched. For more information, see AWS Fargate profile.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note</xhtml:strong>



If you created your cluster with eksctl using the --fargate option, then a Fargate profile has already been created for your cluster with selectors for all pods in the kube-system and default namespaces. Use the following procedure to create Fargate profiles for any other namespaces you would like to use with Fargate.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>via eksctl CLI</xhtml:strong>



Create your Fargate profile with the following eksctl command, replacing the variable text with your own values. You must specify a namespace, but the labels option is not required.                                              </xhtml:p>
                           <xhtml:code class="code_block">eksctl create fargateprofile --cluster cluster_name --name fargate_profile_name --namespace kubernetes_namespace --labels key=value
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>via AWS Management Console</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>To create a Fargate profile for a cluster with the AWS Management Console</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open the Amazon EKS console at                                                           <xhtml:a href="https://console.aws.amazon.com/eks/home#/clusters">https://console.aws.amazon.com/eks/home#/clusters</xhtml:a>


.                                                    </xhtml:li>
                              <xhtml:li>Choose the cluster to create a Fargate profile for.</xhtml:li>
                              <xhtml:li>Under Fargate profiles, choose Add Fargate profile.</xhtml:li>
                              <xhtml:li>On the Configure Fargate profile page, enter the following information and choose Next.</xhtml:li>
                           </xhtml:ol>
                           <xhtml:ul>
                              <xhtml:li>For Name, enter a unique name for your Fargate profile.</xhtml:li>
                              <xhtml:li>For Pod execution role, choose the pod execution role to use with your Fargate profile. Only IAM roles with the eks-fargate-pods.amazonaws.com service principal are shown. If you do not see any roles listed here, you must create one. For more information, see Pod execution role.</xhtml:li>
                              <xhtml:li>For Subnets, choose the subnets to use for your pods. By default, all subnets in your cluster's VPC are selected. Only private subnets are supported for pods running on Fargate; you must deselect any public subnets.</xhtml:li>
                              <xhtml:li>For Tags, you can optionally tag your Fargate profile. These tags do not propagate to other resources associated with the profile, such as its pods.</xhtml:li>
                           </xhtml:ul>
                           <xhtml:ol start="5">
                              <xhtml:li>On the Configure pods selection page, enter the following information and choose Next.</xhtml:li>
                           </xhtml:ol>
                           <xhtml:ul>
                              <xhtml:li>list text hereFor Namespace, enter a namespace to match for pods, such as kube-system or default.</xhtml:li>
                              <xhtml:li>list text here(Optional) Add Kubernetes labels to the selector that pods in the specified namespace must have to match the selector. For example, you could add the label infrastructure: fargate to the selector so that only pods in the specified namespace that also have the infrastructure: fargate Kubernetes label match the selector.</xhtml:li>
                           </xhtml:ul>
                           <xhtml:ol start="6">
                              <xhtml:li>On the Review and create page, review the information for your Fargate profile and choose Create.</xhtml:li>
                           </xhtml:ol>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
      </xccdf:Benchmark>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-oval" timestamp="2023-10-20T13:12:33">
      <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://oval.cisecurity.org/schemas/validator-oval-definitions-5.11.2.xsd">
         <generator>
            <oval:product_name>Center for Internet Security - Optimus</oval:product_name>
            <oval:schema_version>5.11.2</oval:schema_version>
            <oval:timestamp>2023-10-20T13:12:31.000Z</oval:timestamp>
         </generator>
         <definitions>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278538" version="1">
               <metadata>
                  <title>Ensure that the --read-only-port is secured</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured"></reference>
                  <description>Ensure that the --read-only-port is secured</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278538"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278548" version="1">
               <metadata>
                  <title>Ensure that the --hostname-override argument is not set</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set"></reference>
                  <description>Ensure that the --hostname-override argument is not set</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278548"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278553" version="1">
               <metadata>
                  <title>Ensure that the --rotate-certificates argument is not set to false</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false"></reference>
                  <description>Ensure that the --rotate-certificates argument is not set to false</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278553"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278540" version="1">
               <metadata>
                  <title>Ensure that the --read-only-port is secured</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_is_secured"></reference>
                  <description>Ensure that the --read-only-port is secured</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278540"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278555" version="1">
               <metadata>
                  <title>Ensure that the --rotate-certificates argument is not set to false</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false"></reference>
                  <description>Ensure that the --rotate-certificates argument is not set to false</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278555"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278539" version="1">
               <metadata>
                  <title>Minimize the admission of privileged containers</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers"></reference>
                  <description>Minimize the admission of privileged containers</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278539"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278541" version="1">
               <metadata>
                  <title>Minimize the admission of containers wishing to share the host process ID namespace</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace"></reference>
                  <description>Minimize the admission of containers wishing to share the host process ID namespace</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278541"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278543" version="1">
               <metadata>
                  <title>Minimize the admission of containers wishing to share the host process ID namespace</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace"></reference>
                  <description>Minimize the admission of containers wishing to share the host process ID namespace</description>
               </metadata>
               <criteria negate="true" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278543"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278545" version="1">
               <metadata>
                  <title>Minimize the admission of containers wishing to share the host IPC namespace</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace"></reference>
                  <description>Minimize the admission of containers wishing to share the host IPC namespace</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278545"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278547" version="1">
               <metadata>
                  <title>Minimize the admission of containers wishing to share the host IPC namespace</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace"></reference>
                  <description>Minimize the admission of containers wishing to share the host IPC namespace</description>
               </metadata>
               <criteria negate="true" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278547"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278549" version="1">
               <metadata>
                  <title>Minimize the admission of containers wishing to share the host network namespace</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace"></reference>
                  <description>Minimize the admission of containers wishing to share the host network namespace</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278549"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278550" version="1">
               <metadata>
                  <title>Minimize the admission of containers wishing to share the host network namespace</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace"></reference>
                  <description>Minimize the admission of containers wishing to share the host network namespace</description>
               </metadata>
               <criteria negate="true" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278550"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278552" version="1">
               <metadata>
                  <title>Minimize the admission of containers with allowPrivilegeEscalation</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation"></reference>
                  <description>Minimize the admission of containers with allowPrivilegeEscalation</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278552"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278554" version="1">
               <metadata>
                  <title>Minimize the admission of containers with allowPrivilegeEscalation</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation"></reference>
                  <description>Minimize the admission of containers with allowPrivilegeEscalation</description>
               </metadata>
               <criteria negate="true" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278554"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278556" version="1">
               <metadata>
                  <title>Minimize the admission of root containers</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers"></reference>
                  <description>Minimize the admission of root containers</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278556"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278557" version="1">
               <metadata>
                  <title>Minimize the admission of root containers</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers"></reference>
                  <description>Minimize the admission of root containers</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278557"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278559" version="1">
               <metadata>
                  <title>Minimize the admission of containers with the NET_RAW capability</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability"></reference>
                  <description>Minimize the admission of containers with the NET_RAW capability</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278559"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278560" version="1">
               <metadata>
                  <title>Minimize the admission of containers with the NET_RAW capability</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability"></reference>
                  <description>Minimize the admission of containers with the NET_RAW capability</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278560"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:1278561" version="1">
               <metadata>
                  <title>Minimize the admission of containers with added capabilities</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities"></reference>
                  <description>Minimize the admission of containers with added capabilities</description>
               </metadata>
               <criteria negate="true" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:1278561"></criterion>
               </criteria>
            </definition>
         </definitions>
         <tests>
            <process58_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" check="all" check_existence="at_least_one_exists" comment="Ensure that the --read-only-port argument is set to 0" id="oval:org.cisecurity.benchmarks:tst:1278538" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278538"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278538"></state>
            </process58_test>
            <process58_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" check="none satisfy" check_existence="any_exist" comment="Ensure that the --hostname-override argument is not set" id="oval:org.cisecurity.benchmarks:tst:1278548" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278548"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278548"></state>
            </process58_test>
            <process58_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" check="all" check_existence="at_least_one_exists" comment="Ensure that the --rotate-certificates argument is not set to false" id="oval:org.cisecurity.benchmarks:tst:1278553" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278553"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278553"></state>
            </process58_test>
            <textfilecontent54_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure at least one file named /etc/systemd/system/kubelet.service.d/10-kubeadm.conf exists and matches pattern ^.*KUBELET_SYSTEM_PODS_ARGS.+--read-only-port=0.+$" id="oval:org.cisecurity.benchmarks:tst:1278540" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278540"></object>
            </textfilecontent54_test>
            <textfilecontent54_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure at least one file named /etc/systemd/system/kubelet.service.d/10-kubeadm.conf exists and matches pattern ^.*KUBELET_CERTIFICATE_ARGS.+--rotate-certificates=true.+$" id="oval:org.cisecurity.benchmarks:tst:1278555" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278555"></object>
            </textfilecontent54_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Minimize the admission of privileged containers" id="oval:org.cisecurity.benchmarks:tst:1278539" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278539"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278539"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o json' output Pattern Match 'hostPID..:false' (string)" id="oval:org.cisecurity.benchmarks:tst:1278541" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278541"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278541"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o json' output Pattern Not Match 'hostPID' (string)" id="oval:org.cisecurity.benchmarks:tst:1278543" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278543"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278543"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'hostIPC..:false' (string)" id="oval:org.cisecurity.benchmarks:tst:1278545" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278545"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278545"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'hostIPC' (string)" id="oval:org.cisecurity.benchmarks:tst:1278547" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278547"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278547"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'hostNetwork..:false' (string)" id="oval:org.cisecurity.benchmarks:tst:1278549" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278549"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278549"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'hostNetwork' (string)" id="oval:org.cisecurity.benchmarks:tst:1278550" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278550"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278550"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'allowPrivilegeEscalation...false' (string)" id="oval:org.cisecurity.benchmarks:tst:1278552" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278552"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278552"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'allowPrivilegeEscalation' (string)" id="oval:org.cisecurity.benchmarks:tst:1278554" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278554"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278554"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'MustRunAsNonRoot' (string)" id="oval:org.cisecurity.benchmarks:tst:1278556" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278556"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278556"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'MustRunAs' (string)" id="oval:org.cisecurity.benchmarks:tst:1278557" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278557"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278557"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'requiredDropCapabilities......NET_RAW' (string)" id="oval:org.cisecurity.benchmarks:tst:1278559" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278559"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278559"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'requiredDropCapabilities......ALL' (string)" id="oval:org.cisecurity.benchmarks:tst:1278560" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278560"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278560"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'allowedCapabilities' (string)" id="oval:org.cisecurity.benchmarks:tst:1278561" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:1278561"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:1278561"></state>
            </shellcommand_test>
         </tests>
         <objects>
            <process58_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" comment="Ensure that the --read-only-port argument is set to 0" id="oval:org.cisecurity.benchmarks:obj:1278538" version="1">
               <command_line operation="pattern match">kubelet</command_line>
               <pid datatype="int" operation="greater than">0</pid>
            </process58_object>
            <process58_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" comment="Ensure that the --hostname-override argument is not set" id="oval:org.cisecurity.benchmarks:obj:1278548" version="1">
               <command_line operation="pattern match">kubelet</command_line>
               <pid datatype="int" operation="greater than">0</pid>
            </process58_object>
            <process58_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" comment="Ensure that the --rotate-certificates argument is not set to false" id="oval:org.cisecurity.benchmarks:obj:1278553" version="1">
               <command_line operation="pattern match">kubelet</command_line>
               <pid datatype="int" operation="greater than">0</pid>
            </process58_object>
            <textfilecontent54_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure at least one file named /etc/systemd/system/kubelet.service.d/10-kubeadm.conf exists and matches pattern ^.*KUBELET_SYSTEM_PODS_ARGS.+--read-only-port=0.+$" id="oval:org.cisecurity.benchmarks:obj:1278540" version="1">
               <filepath>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</filepath>
               <pattern datatype="string" operation="pattern match">^.*KUBELET_SYSTEM_PODS_ARGS.+--read-only-port=0.+$</pattern>
               <instance datatype="int" operation="equals">1</instance>
            </textfilecontent54_object>
            <textfilecontent54_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure at least one file named /etc/systemd/system/kubelet.service.d/10-kubeadm.conf exists and matches pattern ^.*KUBELET_CERTIFICATE_ARGS.+--rotate-certificates=true.+$" id="oval:org.cisecurity.benchmarks:obj:1278555" version="1">
               <filepath>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</filepath>
               <pattern datatype="string" operation="pattern match">^.*KUBELET_CERTIFICATE_ARGS.+--rotate-certificates=true.+$</pattern>
               <instance datatype="int" operation="equals">1</instance>
            </textfilecontent54_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Minimize the admission of privileged containers" id="oval:org.cisecurity.benchmarks:obj:1278539" version="1">
               <command>kubectl get psp -o json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o json' output Pattern Match 'hostPID..:false' (string)" id="oval:org.cisecurity.benchmarks:obj:1278541" version="1">
               <command>kubectl get psp -o json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o json' output Pattern Not Match 'hostPID' (string)" id="oval:org.cisecurity.benchmarks:obj:1278543" version="1">
               <command>kubectl get psp -o json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'hostIPC..:false' (string)" id="oval:org.cisecurity.benchmarks:obj:1278545" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'hostIPC' (string)" id="oval:org.cisecurity.benchmarks:obj:1278547" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'hostNetwork..:false' (string)" id="oval:org.cisecurity.benchmarks:obj:1278549" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'hostNetwork' (string)" id="oval:org.cisecurity.benchmarks:obj:1278550" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'allowPrivilegeEscalation...false' (string)" id="oval:org.cisecurity.benchmarks:obj:1278552" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'allowPrivilegeEscalation' (string)" id="oval:org.cisecurity.benchmarks:obj:1278554" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'MustRunAsNonRoot' (string)" id="oval:org.cisecurity.benchmarks:obj:1278556" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'MustRunAs' (string)" id="oval:org.cisecurity.benchmarks:obj:1278557" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'requiredDropCapabilities......NET_RAW' (string)" id="oval:org.cisecurity.benchmarks:obj:1278559" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'requiredDropCapabilities......ALL' (string)" id="oval:org.cisecurity.benchmarks:obj:1278560" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'allowedCapabilities' (string)" id="oval:org.cisecurity.benchmarks:obj:1278561" version="1">
               <command>kubectl get psp -o=json</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
         </objects>
         <states>
            <process58_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" comment="Ensure that the --read-only-port argument is set to 0" id="oval:org.cisecurity.benchmarks:ste:1278538" version="1">
               <command_line datatype="string" operation="pattern match">--read-only-port=0</command_line>
            </process58_state>
            <process58_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" comment="Ensure that the --hostname-override argument is not set" id="oval:org.cisecurity.benchmarks:ste:1278548" version="1">
               <command_line datatype="string" operation="pattern match">--hostname-override</command_line>
            </process58_state>
            <process58_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" comment="Ensure that the --rotate-certificates argument is not set to false" id="oval:org.cisecurity.benchmarks:ste:1278553" version="1">
               <command_line datatype="string" operation="pattern match">--rotate-certificates=true</command_line>
            </process58_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Minimize the admission of privileged containers" id="oval:org.cisecurity.benchmarks:ste:1278539" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278539"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o json' output Pattern Match 'hostPID..:false' (string)" id="oval:org.cisecurity.benchmarks:ste:1278541" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278541"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o json' output Pattern Not Match 'hostPID' (string)" id="oval:org.cisecurity.benchmarks:ste:1278543" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278543"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'hostIPC..:false' (string)" id="oval:org.cisecurity.benchmarks:ste:1278545" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278545"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'hostIPC' (string)" id="oval:org.cisecurity.benchmarks:ste:1278547" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278547"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'hostNetwork..:false' (string)" id="oval:org.cisecurity.benchmarks:ste:1278549" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278549"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'hostNetwork' (string)" id="oval:org.cisecurity.benchmarks:ste:1278550" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278550"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'allowPrivilegeEscalation...false' (string)" id="oval:org.cisecurity.benchmarks:ste:1278552" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278552"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'allowPrivilegeEscalation' (string)" id="oval:org.cisecurity.benchmarks:ste:1278554" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278554"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'MustRunAsNonRoot' (string)" id="oval:org.cisecurity.benchmarks:ste:1278556" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278556"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'MustRunAs' (string)" id="oval:org.cisecurity.benchmarks:ste:1278557" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278557"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'requiredDropCapabilities......NET_RAW' (string)" id="oval:org.cisecurity.benchmarks:ste:1278559" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278559"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Match 'requiredDropCapabilities......ALL' (string)" id="oval:org.cisecurity.benchmarks:ste:1278560" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278560"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure 'kubectl get psp -o=json' output Pattern Not Match 'allowedCapabilities' (string)" id="oval:org.cisecurity.benchmarks:ste:1278561" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:1278561"></stdout_line>
            </shellcommand_state>
         </states>
         <variables>
            <external_variable comment="This value is used in Rule: Minimize the admission of privileged containers" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278539" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers wishing to share the host process ID namespace" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278541" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers wishing to share the host process ID namespace" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278543" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers wishing to share the host IPC namespace" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278545" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers wishing to share the host IPC namespace" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278547" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers wishing to share the host network namespace" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278549" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers wishing to share the host network namespace" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278550" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers with allowPrivilegeEscalation" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278552" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers with allowPrivilegeEscalation" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278554" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of root containers" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278556" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of root containers" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278557" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers with the NET_RAW capability" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278559" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers with the NET_RAW capability" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278560" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Minimize the admission of containers with added capabilities" datatype="string" id="oval:org.cisecurity.benchmarks:var:1278561" version="1"></external_variable>
         </variables>
      </oval_definitions>
   </ds:component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_1.1.0_CIS_Amazon_Elastic_Kubernetes_Service_EKS_Benchmark-scriptkubelet_test" timestamp="2023-10-20T13:12:33">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
#
# Name         Date       Description
# -------------------------------------------------------------------
# R. Mowen   7/25/20   Check if enabled
# XCCDF_VALUE_REGEX='authentication.*anonymous":{"enabled":false}'

curl -sSLv "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz" 2&gt;&amp;1 | grep -Eq "$XCCDF_VALUE_REGEX" &amp;&amp; passing="true"

# If the regex matched, output would be generated.  If so, we pass
if [ "$passing" = true ] ; then
	echo "pass"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
  echo "fail"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></ds:DigestMethod>
<ds:DigestValue>liCHAmX33Z7QO7fMZ0zRVnXlztI=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
TY6ti83ZTjlW5xfV71hD5+BfVx3H85glUyY/oL20PruDsUuHet+3qHF5O7Nsu2a3I2G6W4WYJaze
0RcB8uBcIN0BRQK/B7HQv0MJn6DQNfBqKFmNMeT1gSpWFAF5HORA0u8t21frrV4rObcFSs2qdJyy
oc7QD1gUQD+PE5IhsJ6cz83RiyWxAlgFNgymevFUKKIqevxg27Uhlw3CVgOFQKSE5tBjHCI0GMcT
7SIbAvWg/Bp4SzRvhmaS5gGOUKwqP8w4B0Iw2PSTsqYUPyMp2ymCdGoJw94qmQLVaBaQr4KWFulA
N6X0fVoPxbAF2U+h0uVvhyD4QbZcKZkUiPQfAQ==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIPx+qZKptEY4wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMjAw
OTA4MTMzOTM5WhcNMjMxMDI4MDAzMjA1WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS02LmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAT0XLw2vmuq6e58bkLDXdqKeGQjREDChLw2Mae9LI
JB93QgdA2OCLA1FwU2s7lawEDcma9wPiugxVGoaQNOfRw2/+cz0xmR3uaKQq6I24dWbHF20N2tSz
1RAAK1lRZKewA1fj+qqKWjzETA0LpqZlaFF+CKBpQcyfYyQRZxpHkB1vvKMf4kMIRKruvl4ixLjN
uAZrbQUWlXuq/MUkVP3FgdxWBPfmMGyngHs4hNMaSQGb1TEhBjj+PGoSunAyaOgO/P94XJPQQX3O
2oNDsPou6gKcNtbZrH+iYTJ8rcqQTontMwSP/HrYj8lgG3neG53vk05p0jCn2M5W0ukJ4LPEnA==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></ds:data-stream-collection>