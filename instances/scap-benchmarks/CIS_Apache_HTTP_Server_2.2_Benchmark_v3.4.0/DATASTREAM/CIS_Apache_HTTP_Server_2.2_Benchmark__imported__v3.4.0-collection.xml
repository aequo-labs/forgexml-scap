<ds:data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:sce="http://open-scap.org/page/SCE_xccdf_stream" xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_org.cisecurity_collection_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported" schematron-version="1.0">
   <ds:data-stream id="scap_org.cisecurity_datastream_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported" scap-version="1.2" timestamp="2024-09-24T14:19:51" use-case="CONFIGURATION">
      <ds:checklists>
         <ds:component-ref id="scap_org.cisecurity_cref_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-xccdf" xlink:href="#scap_org.cisecurity_comp_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-xccdf">
            <cat:catalog>
               <cat:uri name="scap_org.cisecurity_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-OVAL" uri="scap_org.cisecurity_cref_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-oval"></cat:uri>
            </cat:catalog>
         </ds:component-ref>
      </ds:checklists>
      <ds:checks>
         <ds:component-ref id="scap_org.cisecurity_cref_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-oval" xlink:href="#scap_org.cisecurity_comp_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-oval"></ds:component-ref>
      </ds:checks>
   </ds:data-stream>
   <ds:component id="scap_org.cisecurity_comp_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-xccdf" timestamp="2024-09-24T14:19:51">
      <xccdf:Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
         <xccdf:status date="2024-09-24">accepted</xccdf:status>
         <xccdf:title xml:lang="en">CIS Apache HTTP Server 2.2 Benchmark [imported]</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:h3>
               <xhtml:strong>This is the archive of the Apache HTTP Server 2.2 Benchmark v3.4.0. CIS encourages you to migrate to a more recent, supported version of this technology.</xhtml:strong>
            </xhtml:h3>
            <xhtml:p>This document is intended for system and application administrators, security specialists, auditors, help desk, and platform deployment personnel who plan to develop, deploy, assess, or secure solutions that incorporate Apache HTTP Server 2.2 running on Linux.</xhtml:p>
         </xccdf:description>
         <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
         <xccdf:platform idref="cpe:2.3:a:apache_foundation:apache_http_server:2.2.*:*:*:*:*:*:*:*"></xccdf:platform>
         <xccdf:version>3.4.0</xccdf:version>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
            <xccdf:title xml:lang="en">Level 1</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Items in this profile intend to:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>be practical and prudent;</xhtml:li>
                  <xhtml:li>provide a clear security benefit; and</xhtml:li>
                  <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Installing_Apache" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Enable_only_necessary_Authentication_and_Authorization_Modules" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Enable_the_Log_Config_Module" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Disable_WebDAV_Modules" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Disable_Status_Module" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_Disable_Autoindex_Module" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Disable_Proxy_Modules" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_Disable_User_Directories_Modules" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_Disable_Info_Module" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Run_the_Apache_Web_Server_as_a_non-root_user" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Give_the_Apache_User_Account_an_Invalid_Shell" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Lock_the_Apache_User_Account" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Set_Ownership_on_Apache_Directories_and_Files" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Set_Group_Id_on_Apache_Directories_and_Files" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Restrict_Other_Write_Access_on_Apache_Directories_and_Files" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Secure_the_Core_Dump_Directory" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_Secure_the_Lock_File" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_Secure_the_Pid_File" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_Secure_the_ScoreBoard_File" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_Restrict_Group_Write_Access_for_the_Apache_Directories_and_Files" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.12_Restrict_Group_Write_Access_for_the_Document_Root_Directories_and_Files" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Deny_Access_to_OS_Root_Directory" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Allow_Appropriate_Access_to_Web_Content" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Restrict_OverRide_for_the_OS_Root_Directory" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_Restrict_OverRide_for_All_Directories" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_Restrict_Options_for_the_OS_Root_Directory" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_Restrict_Options_for_the_Web_Root_Directory" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Minimize_Options_for_Other_Directories" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Remove_Default_HTML_Content" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Remove_Default_CGI_Content_printenv" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Remove_Default_CGI_Content_test-cgi" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Limit_HTTP_Request_Methods" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_HTTP_TRACE_Method" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Restrict_HTTP_Protocol_Versions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Restrict_Access_to_.ht_files" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_Configure_the_Error_Log" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_Configure_the_Access_Log" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4_Log_Storage_and_Rotation" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5_Apply_Applicable_Patches" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Install_mod_ssl_andor_mod_nss" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_Install_a_Valid_Trusted_Certificate" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_Protect_the_Servers_Private_Key" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_Disable_Weak_SSL_Protocols" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_Restrict_Weak_SSL_Ciphers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_Restrict_Insecure_SSL_Renegotiation" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_SSL_Compression_is_Not_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1_Set_ServerToken_to_Prod" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2_Set_ServerSignature_to_Off" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.1_Set_the_TimeOut_to_10_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.2_Set_the_KeepAlive_to_On" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.3_Set_the_MaxKeepAliveRequests_to_100_or_greater" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.4_Set_the_KeepAliveTimeout_to_15_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.5_Set_Timeout_Limits_for_Request_Headers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.6_Set_Timeout_Limits_for_the_Request_Body" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
            <xccdf:title xml:lang="en">Level 2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
                  <xhtml:li>acts as defense in depth measure</xhtml:li>
                  <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Do_Not_Install_a_Multi-Use_System" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Restrict_File_Extensions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.12_Deny_IP_Address_Based_Requests" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.13_Restrict_Listen_Directive" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.14_Restrict_Browser_Frame_Options" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Configure_a_Syslog_Facility_for_Error_Logging" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.6_Install_and_Enable_ModSecurity" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.7_Install_and_Enable_OWASP_ModSecurity_Core_Rule_Set" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_Disable_the_TLS_v1.0_Protocol" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_Enable_OCSP_Stapling" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_Enable_HTTP_Strict_Transport_Security" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3_Information_Leakage_via_Default_Apache_Content" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.1_Set_the_LimitRequestLine_directive_to_512_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.2_Ensure_the_LimitRequestFields_directive_is_set_to_100_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.3_Set_the_LimitRequestFieldsize_directive_to_1024_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.4_Set_the_LimitRequestBody_directive_to_102400_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.1_Enable_SELinux_in_Enforcing_Mode" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.2_Run_Apache_Processes_in_the_httpd_t_Confined_Context" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.3_Ensure_the_httpd_t_Type_is_Not_in_Permissive_Mode" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.4_Ensure_Only_the_Necessary_SELinux_Booleans_are_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_12.1_Enable_the_AppArmor_Framework" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_12.2_Customize_the_Apache_AppArmor_Profile" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_12.3_Ensure_Apache_AppArmor_Profile_is_in_Enforce_Mode" selected="true"></xccdf:select>
         </xccdf:Profile>
         <Value id="xccdf_org.cisecurity.benchmarks_value_27577_var" operator="pattern match" type="string">
            <title>Enable the Log Config Module</title>
            <description>This value is used in Rule: Enable the Log Config Module</description>
            <value>/log_config/</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_27578_var" operator="pattern match" type="string">
            <title>Disable WebDAV Modules</title>
            <description>This value is used in Rule: Disable WebDAV Modules</description>
            <value>/syntax ok/i</value>
         </Value>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Planning_and_Installation">
            <xccdf:title xml:lang="en">Planning and Installation</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations for the planning and installation of an Apache HTTP Server.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1_Pre-Installation_Planning_Checklist">
               <xccdf:title xml:lang="en">Pre-Installation Planning Checklist</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Review and implement the following items as appropriate:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>Reviewed and implemented my company's security policies as they relate to web security.</xhtml:li>
                     <xhtml:li>Implemented a secure network infrastructure by controlling access to/from your web server by using firewalls, routers and switches.</xhtml:li>
                     <xhtml:li>Harden the Underlying Operating System of the web server, by minimizing listening network services, applying proper patches and hardening the configurations as recommended in the appropriate Center for Internet Security benchmark for the platform.</xhtml:li>
                     <xhtml:li>Implement central log monitoring processes.</xhtml:li>
                     <xhtml:li>Implemented a disk space monitoring process and log rotation mechanism.</xhtml:li>
                     <xhtml:li>


Educated developers about developing secure applications.                                         <xhtml:a href="http://www.owasp.org/">http://www.owasp.org/</xhtml:a>
                        <xhtml:a href="http://www.webappsec.org/">http://www.webappsec.org/</xhtml:a>
                     </xhtml:li>
                     <xhtml:li>Ensure the WHOIS Domain information registered for our web presence does not reveal sensitive personnel information, which may be leveraged for Social Engineering (Individual POC Names), War Dialing (Phone Numbers) and Brute Force Attacks (Email addresses matching actual system usernames).</xhtml:li>
                     <xhtml:li>Ensure your Domain Name Service (DNS) servers have been properly secured to prevent attacks, as recommended in the CIS BIND DNS benchmark.</xhtml:li>
                     <xhtml:li>Implemented a Network Intrusion Detection System to monitor attacks against the web server.</xhtml:li>
                  </xhtml:ul>
               </xccdf:description>
            </xccdf:Group>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Do_Not_Install_a_Multi-Use_System" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Do Not Install a Multi-Use System</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Default server configurations often expose a wide variety of services unnecessarily increasing the risk to the system. Just because a server can perform many services doesn't mean it is wise to do so. The number of services and daemons executing on the Apache Web server should be limited to those necessary, with the Web server being the only primary function of the server.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: Depends on OS Platform</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Maintaining a server for a single purpose increases the security of your application and system. The more services which are exposed to an attacker, the more potential vectors an attacker has to exploit the system and therefore the higher the risk for the server. A Web server should function as only a web server and if possible should not be mixed with other primary functions such as mail, DNS, database or middleware.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Leverage the package or services manager for your OS to uninstall or disable unneeded services. On Red Hat systems, the following will disable a given service:</xhtml:p>
                        <xhtml:code class="code_block">
chkconfig &lt;servicename&gt; off 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_Installing_Apache" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Installing Apache</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The CIS Apache Benchmark recommends using the Apache binary provided by your vendor for most situations in order to reduce the effort and increase the effectiveness of maintenance and security patches. However to keep the benchmark as generic and applicable to all Unix/Linux platforms as possible, a default source build has been used for this benchmark.                                   <xhtml:strong>Important Note</xhtml:strong>


: There is a major difference between source builds and most vendor packages that is very important to highlight. The default source build of Apache is fairly conservative and minimalist in the modules included and is therefore starts off in a fairly strong security state, while most vendor binaries are typically very well loaded with most of the functionality that one may be looking for. _                                  <xhtml:strong>Therefore it is important that you don't assume the default value shown in the benchmark will match default values in your installation.</xhtml:strong>


_You should always test any new installation in your environment before putting it into production. Also keep in mind you can install and run a new version alongside the old one by using a different Apache prefix and a different IP address or port number in the Listen directive                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The benefits of using the vendor supplied binaries include:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>Ease of installation as it will just work, straight out of the box.</xhtml:li>
                     <xhtml:li>It is customized for your OS environment.</xhtml:li>
                     <xhtml:li>It will be tested and have gone through QA procedures.</xhtml:li>
                     <xhtml:li>


Everything you need is likely to be included, probably including some third party modules. Many OS vendors ship Apache with                                         <xhtml:span class="inline_block">mod\_ssl</xhtml:span>


 and OpenSSL and PHP,                                         <xhtml:span class="inline_block">mod\_perl</xhtml:span>


 and                                         <xhtml:span class="inline_block">mod\_security</xhtml:span>


 for example.                                  </xhtml:li>
                     <xhtml:li>Your vendor will tell you about security issues so you have to look in less places.</xhtml:li>
                     <xhtml:li>Updates to fix security issues will be easy to apply. The vendor will have already verified the problem, checked the signature on the Apache download, worked out the impact and so on.</xhtml:li>
                     <xhtml:li>You may be able to get the updates automatically, reducing the window of risk.</xhtml:li>
                  </xhtml:ul>
               </xccdf:rationale>
               <xccdf:ident system="URL">Apache Compiling and Installation  http://httpd.apache.org/docs/2.2/install.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Installation depends on the operating system platform. For a source build consult the Apache 2.2 documentation on compiling and installing                                               <xhtml:a href="http://httpd.apache.org/docs/2.2/install.html">http://httpd.apache.org/docs/2.2/install.html</xhtml:a>


 for a Red Hat Enterprise Linux 5 the following yum command could be used.                                        </xhtml:p>
                        <xhtml:code class="code_block">
# yum install httpd 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Minimize_Apache_Modules">
            <xccdf:title xml:lang="en">Minimize Apache Modules</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>It's crucially important to have a minimal and compact Apache installation based on documented business requirements. The remaining of this section covers specific modules that should be reviewed and disabled if not required for business purposes. However, it's very important that the review and analysis of which modules are required for business purpose not be limited to the modules explicitly listed.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_Enable_only_necessary_Authentication_and_Authorization_Modules" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Enable only necessary Authentication and Authorization Modules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache 2.2 modules for authentication and authorization have been refactored to provide finer granularity, more consistent and logical names and to simplify configuration. The                                   <xhtml:span class="inline_block">authn\_\*</xhtml:span>


 modules provide authentication, while the                                   <xhtml:span class="inline_block">authz\_\*</xhtml:span>


 modules provide authorization. Apache provides 2 types of authentication; basic and digest. Enable only the modules that are required.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following are the modules statically loaded for a default source build:                                         <xhtml:span class="inline_block">authn\_file\_module (static) authn\_default\_module (static) authz\_host\_module (static) authz\_groupfile\_module (static) authz\_user\_module (static) authz\_default\_module (static) auth\_basic\_module (static)</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Authentication and authorization are your front doors to the protected information in your web site. Most installation only need a small subset of the modules available. By minimizing the enabled modules to those that are actually used, we reduce the number of "doors" and have therefore reduce the attack surface of the web site. Likewise having fewer modules means less software that could have vulnerabilities.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">Apache AAA how-to  http://httpd.apache.org/docs/2.2/howto/auth.html</xccdf:ident>
               <xccdf:ident system="URL">Apache Module Documentation http://httpd.apache.org/docs/2.2/mod/</xccdf:ident>
               <xccdf:ident system="URL">Apache Source Configuration  http://httpd.apache.org/docs/2.2/programs/configure.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Consult Apache module documentation for descriptions of each module in order to determine the necessary modules for the specific installation. The unnecessary static compiled modules are disabled through compile time configuration options. The dynamically loaded modules are disabled by commenting out or removing the                                               <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive from the Apache configuration files (typically                                               <xhtml:span class="inline_block">httpd.conf</xhtml:span>


). Some modules may be separate packages, and may be removed.                                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_Enable_the_Log_Config_Module" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Enable the Log Config Module</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">log\_config</xhtml:span>


 module provides for flexible logging of client requests, and provides for the configuration of the information in each log.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: The module is loaded by default.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Logging is critical for monitoring usage and potential abuse of your web server. To configure the web server logging using the                                   <xhtml:span class="inline_block">log\_format</xhtml:span>


 directive this module is required                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">Mod Log Config  http://httpd.apache.org/docs/2.2/mod/mod_log_config.html </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either one of the following:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>


For source builds with static modules run the Apache                                                     <xhtml:span class="inline_block">./configure</xhtml:span>


 script without including the                                                     <xhtml:span class="inline_block">--disable-log-config</xhtml:span>


 script options.                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure 
  
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>


For dynamically loaded modules, add or modify the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive so that it is present in the apache configuration as below and not commented out:                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">  LoadModule log_config_module modules/mod_log_config.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:27577" value-id="xccdf_org.cisecurity.benchmarks_value_27577_var"></check-export>
                     <check-content-ref href="scap_org.cisecurity_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-OVAL" name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:def:27577"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_Disable_WebDAV_Modules" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable WebDAV Modules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">mod\_dav</xhtml:span>


 and                                   <xhtml:span class="inline_block">mod\_dav\_fs</xhtml:span>


 modules support WebDAV ('Web-based Distributed Authoring and Versioning') functionality for Apache. WebDAV is an extension to the HTTP protocol which allows clients to create, move, and delete files and resources on the web server.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: The WebDav modules are not enabled with a default source build.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


WebDAV is not widely used, and has serious security concerns as it may allow clients to modify unauthorized files on the web server. Therefore, the WebDav modules                                   <xhtml:span class="inline_block">mod\_dav</xhtml:span>


, and                                   <xhtml:span class="inline_block">mod\_dav\_fs</xhtml:span>


 should be disabled.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_dav.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either one of the following to disable WebDAV module:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For source builds with static modules run the Apache ./configure script without including the                                                     <xhtml:span class="inline_block">mod\_dav</xhtml:span>


, and                                                     <xhtml:span class="inline_block">mod\_dav\_fs</xhtml:span>


 in the                                                     <xhtml:span class="inline_block">--enable-modules=configure</xhtml:span>


 script options.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For dynamically loaded modules comment out or remove the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive for                                                     <xhtml:span class="inline_block">mod\_dav</xhtml:span>


, and                                                     <xhtml:span class="inline_block">mod\_dav\_fs</xhtml:span>


 modules the from the                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ##LoadModule dav_module modules/mod_dav.so
  ##LoadModule dav_fs_module modules/mod_dav_fs.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:27578" value-id="xccdf_org.cisecurity.benchmarks_value_27578_var"></check-export>
                     <check-content-ref href="scap_org.cisecurity_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-OVAL" name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:def:27578"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_Disable_Status_Module" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable Status Module</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">mod\_status</xhtml:span>


 module provides current server performance statistics.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The                                         <xhtml:span class="inline_block">mod\_status</xhtml:span>


 module IS enabled with a default source build.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>While having server performance status information available as a web page may be convenient, it's recommended that this module be disabled:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>


When                                         <xhtml:span class="inline_block">mod\_status</xhtml:span>


 is loaded into the server, its handler capability is available in all configuration files, including per-directory files (e.g., .                                        <xhtml:span class="inline_block">htaccess</xhtml:span>


) and may have security-related ramifications.                                  </xhtml:li>
                  </xhtml:ul>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_status.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either one of the following to disable the mod_status module:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For source builds with static modules run the Apache ./configure script with the                                                     <xhtml:span class="inline_block">--disable-status configure</xhtml:span>


 script options.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure --disable-status 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For dynamically loaded modules comment out or remove the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive for the                                                     <xhtml:span class="inline_block">mod\_status</xhtml:span>


 module from the                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ##LoadModule status_module modules/mod_status.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_Disable_Autoindex_Module" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable Autoindex Module</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">autoindex</xhtml:span>


 module automatically generates web page listing the contents of directories on the server, typically used so that an                                   <xhtml:span class="inline_block">index.html</xhtml:span>


 does not have to generated                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The                                         <xhtml:span class="inline_block">mod\_autoindex</xhtml:span>


 module IS enabled with a default source build.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Automated directory listings should not be enabled as it will also reveal information helpful to an attacker such as naming conventions and directory paths, it may reveal files that were not intended to be revealed.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_autoindex.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Perform either one of the following to disable the                                               <xhtml:span class="inline_block">mod\_autoindex</xhtml:span>


 module:                                        </xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For source builds with static modules run the Apache                                                     <xhtml:span class="inline_block">./configure</xhtml:span>


 script with the                                                     <xhtml:span class="inline_block">--disable-autoindex configure</xhtml:span>


 script options                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure -disable-autoindex 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For dynamically loaded modules comment out or remove the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive for the                                                     <xhtml:span class="inline_block">mod\_autoindex</xhtml:span>


 module from the                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ## LoadModule autoindex_module modules/mod_autoindex.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_Disable_Proxy_Modules" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable Proxy Modules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The Apache proxy modules allow the server to act as a proxy (either forward or reverse proxy) of http and other protocols with additional proxy modules loaded. If the Apache installation is not intended to proxy requests to or from another network, then the proxy module should not be loaded.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The                                         <xhtml:span class="inline_block">mod\_proxy</xhtml:span>


 module and other proxy modules are NOT enabled with a default source build.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Proxy servers can act as an important security control when properly configured, however a secure proxy server is not within the scope of this benchmark. A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended. Scanning for web servers that will also proxy requests is a very common attack, as proxy servers are useful for anonymizing attacks on other servers, or possibly proxying requests into an otherwise protected network.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_proxy.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either one of the following to disable the proxy module:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For source builds with static modules run the Apache                                                     <xhtml:span class="inline_block">./configure</xhtml:span>


 script without including the                                                     <xhtml:span class="inline_block">mod\_proxy</xhtml:span>


 in the                                                     <xhtml:span class="inline_block">--enable-modules=configure</xhtml:span>


 script options.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For dynamically loaded modules comment out or remove the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive for                                                     <xhtml:span class="inline_block">mod\_proxy</xhtml:span>


 module and all other proxy modules the from the                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ##LoadModule proxy_module modules/mod_proxy.so
  ##LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
  ##LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
  ##LoadModule proxy_http_module modules/mod_proxy_http.so
  ##LoadModule proxy_connect_module modules/mod_proxy_connect.so
  ##LoadModule proxy_ajp_module modules/mod_proxy_ajp.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_Disable_User_Directories_Modules" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable User Directories Modules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">UserDir</xhtml:span>


 directive must be disabled so that user home directories are not accessed via the web site with a tilde (~) preceding the username. The directive also sets the path name of the directory that will be accessed. For example:                            </xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>
                        <xhtml:a href="http://example.com/~ralph/">http://example.com/~ralph/</xhtml:a>


 might access a                                         <xhtml:span class="inline_block">public\_html</xhtml:span>


 sub-directory of                                         <xhtml:span class="inline_block">ralph</xhtml:span>


 user's home directory.                                  </xhtml:li>
                     <xhtml:li>


The directive                                         <xhtml:span class="inline_block">UserDir ./</xhtml:span>


 might map                                         <xhtml:span class="inline_block">/~root</xhtml:span>


 to the root directory (                                        <xhtml:span class="inline_block">/</xhtml:span>


).                                  </xhtml:li>
                  </xhtml:ul>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The                                         <xhtml:span class="inline_block">mod\_userdir</xhtml:span>


 module IS enabled with a default source build.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The user directories should not be globally enabled since it allows anonymous access to anything users may want to share with other users on the network. Also consider that every time a new account is created on the system, there is potentially new content available via the web site.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_userdir.html </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either one of the following to disable the user directories module:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For source builds with static modules run the Apache                                                     <xhtml:span class="inline_block">./configure</xhtml:span>


 script with the                                                     <xhtml:span class="inline_block">--disable-userdir configure</xhtml:span>


 script options.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure --disable-userdir 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For dynamically loaded modules comment out or remove the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive for                                                     <xhtml:span class="inline_block">mod\_userdir</xhtml:span>


 module from the                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ##LoadModule userdir_module modules/mod_userdir.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_Disable_Info_Module" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable Info Module</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">mod\_info</xhtml:span>


 module provides information on the server configuration via access to a                                   <xhtml:span class="inline_block">/server-info</xhtml:span>


 URL location.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The                                         <xhtml:span class="inline_block">mod\_info</xhtml:span>


 module is not enabled with a default source build.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>While having server configuration information available as a web page may be convenient it's recommended that this module NOT be enabled:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>


Once                                         <xhtml:span class="inline_block">mod\_info</xhtml:span>


 is loaded into the server, its handler capability is available in per-directory                                         <xhtml:span class="inline_block">.``htaccess</xhtml:span>


 files and can leak sensitive information from the configuration directives of other Apache modules such as system paths, usernames/passwords, database names, etc.                                  </xhtml:li>
                  </xhtml:ul>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_info.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either one of the following to disable the mod_info module:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For source builds with static modules run the Apache                                                     <xhtml:span class="inline_block">./configure</xhtml:span>


 script without including the                                                     <xhtml:span class="inline_block">mod\_info</xhtml:span>


 in the                                                     <xhtml:span class="inline_block">--enable-modules= configure</xhtml:span>


 script options.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  $ cd $DOWNLOAD/httpd-2.2.22
  $ ./configure 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For dynamically loaded modules comment out or remove the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive for the                                                     <xhtml:span class="inline_block">mod\_info</xhtml:span>


 module from the                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ##LoadModule info_module modules/mod_info.so 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Principles_Permissions_and_Ownership">
            <xccdf:title xml:lang="en">Principles, Permissions, and Ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Security at the operating system (OS) level is the vital foundation required for a secure web server. This section will focus on OS platform permissions and privileges.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Run_the_Apache_Web_Server_as_a_non-root_user" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Run the Apache Web Server as a non-root user</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Although Apache typically is started with root privileges in order to listen on port 80 and 443, it can and should run as another non-root user in order to perform the web services. The Apache User and Group directives are used to designate the user and group to be used.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: The default Apache User and Group is configured as daemon.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>One of the best ways to reduce your exposure to attack when running a web server is to create a unique, unprivileged user and group for the server application. The "nobody" or "daemon" user and group that comes default on Unix variants should NOT be used to run the web server, since the account is commonly used for other separate daemon services. Instead, an account used only by the apache software so as to not give unnecessary access to other services. Also the user used for the apache user should be a unique value between 1 and 499 as these lower values are reserved for the special system accounts not used by regular users, such as discussed in User Accounts section of the CIS Red Hat benchmark. As an even more secure alternative, if the Apache web server can be run on high unprivileged ports, then it is not necessary to start Apache as root, and all of the Apache processes may be run as the Apache specific user as described below.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>If the Apache user and group do not already exist, create the account and group as a unique system account:</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # groupadd -r apache
  # useradd apache -r -g apache -d /var/www -s /sbin/nologin 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Configure the Apache user and group in the Apache configuration file                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


:                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  User apache
  Group apache 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Give_the_Apache_User_Account_an_Invalid_Shell" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Give the Apache User Account an Invalid Shell</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The apache account must not be used as a regular login account, and should be assigned an invalid or                                   <xhtml:span class="inline_block">nologin</xhtml:span>


 shell to ensure that the account cannot be used to login.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default Apache user account is daemon with a shell of                                         <xhtml:span class="inline_block">/dev/null</xhtml:span>


 or                                         <xhtml:span class="inline_block">/sbin/nologin</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Service accounts such as the apache account represent a risk if they can be used to get a login shell to the system.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Change the apache account to use the                                               <xhtml:span class="inline_block">nologin</xhtml:span>


 shell or an invalid shell such as                                               <xhtml:span class="inline_block">/dev/null</xhtml:span>


:                                        </xhtml:p>
                        <xhtml:code class="code_block">
# chsh -s /sbin/nologin apache 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Lock_the_Apache_User_Account" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Lock the Apache User Account</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The user account under which Apache runs, should not have a valid password, but should be locked.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: The default user is daemon and is locked.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


As a defense-in-depth measure the Apache user account should be locked to prevent logins, and to prevent a user from                                   <xhtml:span class="inline_block">su</xhtml:span>


-ing to apache using the password. In general there shouldn't be a need for anyone to have to                                   <xhtml:span class="inline_block">su</xhtml:span>


 as apache, and when there is a need, then                                   <xhtml:span class="inline_block">sudo</xhtml:span>


 should be used instead, which would not require the apache account password.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Use the                                               <xhtml:span class="inline_block">passwd</xhtml:span>


 command to lock the apache account:                                        </xhtml:p>
                        <xhtml:code class="code_block">
# passwd -l apache 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Set_Ownership_on_Apache_Directories_and_Files" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set Ownership on Apache Directories and Files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The Apache directories and files should be owned by root. This applies to all of the Apache software directories and files installed.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Restricting ownership of the Apache files and directories will reduce the probability of unauthorized modifications to those resources.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>


Set ownership on the                                                     <xhtml:span class="inline_block">$APACHE\_PREFIX</xhtml:span>


 directories such as                                                     <xhtml:span class="inline_block">/usr/local/apache2</xhtml:span>


:                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">  $ chown -R root $APACHE_PREFIX 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Set_Group_Id_on_Apache_Directories_and_Files" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set Group Id on Apache Directories and Files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache directories and files should be set to have a group Id of root, (or a root equivalent) group. This applies to all of the Apache software directories and files installed. The only expected exception is that the Apache web document root ($                                  <xhtml:span class="inline_block">APACHE\_PREFIX/htdocs</xhtml:span>


) is likely to need a designated group to allow web content to be updated (such as webupdate) through a change management process.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Securing Apache files and directories will reduce the probability of unauthorized modifications to those resources.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>


Set ownership on the $                                                    <xhtml:span class="inline_block">APACHE\_PREFIX</xhtml:span>


 directories such as /usr/local/apache2:                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
 $ chgrp -R root $APACHE_PREFIX
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Restrict_Other_Write_Access_on_Apache_Directories_and_Files" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Other Write Access on Apache Directories and Files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The permission on the Apache directories should be                                   <xhtml:span class="inline_block">rwxr-xr-x</xhtml:span>


 (755) and the file permissions should be similar except not executable if executable is not appropriate. This applies to all of the Apache software directories and files installed with the possible exception in some cases may have a designated group with write access for the Apache web document root (                                  <xhtml:span class="inline_block">$APACHE\_PREFIX/htdocs</xhtml:span>


) are likely to need a designated group to allow web content to be updated. In addition, the /bin directory and executables should be set to not be readable by other.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default permissions are mostly                                         <xhtml:span class="inline_block">rwXr-Xr-X</xhtml:span>


 except for some files which have group or other permissions which seem affected by the umask of the user performing the build.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>None of the Apache files and directories, including the Web document root must allow other write access. Other write access is likely to be very useful for unauthorized modification of web content, configuration files or software for malicious attacks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Perform the following to remove other write access on the                                               <xhtml:span class="inline_block">$APACHE\_PREFIX</xhtml:span>


 directories.                                        </xhtml:p>
                        <xhtml:code class="code_block">
# chmod -R o-w $APACHE_PREFIX
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_Secure_the_Core_Dump_Directory" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Secure the Core Dump Directory</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">CoreDumpDirectory</xhtml:span>


 directive can be used to specify a directory which Apache attempts to switch before dumping core for debugging. The default directory is the Apache                                   <xhtml:span class="inline_block">ServerRoot</xhtml:span>


 directory, however on Linux systems core dumps will be disabled by default. Most production environments should leave core dumps disabled. In the event that core dumps are needed, the directory needs to be a writable directory by Apache, and should meet the security requirements defined below in the remediation and audit.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default core dump directory is the                                         <xhtml:span class="inline_block">ServerRoot</xhtml:span>


 directory, which should not be writable. Core dumps will be disabled if the directory is not writable by the Apache user. Also on Linux systems core dumps will be disabled if the server is started as root and switches to a non-root user, as is typical.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Core dumps are snapshots of memory and may contain sensitive information that should not be accessible by other accounts on the system.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mpm_common.html#coredumpdirectory </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Either remove the                                               <xhtml:span class="inline_block">CoreDumpDirectory</xhtml:span>


 directive from the Apache configuration files or ensure that the configured directory meets the following requirements.                                        </xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>
                              <xhtml:span class="inline_block">CoreDumpDirectory</xhtml:span>


 is not to be within the Apache web document root (                                                    <xhtml:span class="inline_block">$APACHE\_PREFIX/htdocs</xhtml:span>


)                                              </xhtml:li>
                           <xhtml:li>must be owned by root and have a group ownership of the Apache group (as defined via the Group directive)</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # chown root:apache /var/log/httpd 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>must have no read-write-search access permission for other users.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # chmod o-rwx /var/log/httpd 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.8_Secure_the_Lock_File" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Secure the Lock File</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LockFile</xhtml:span>


 directive sets the path to the lock file used when Apache uses                                   <xhtml:span class="inline_block">fcntl(2)</xhtml:span>


 or                                   <xhtml:span class="inline_block">flock(2)</xhtml:span>


 system calls to implement a mutex. Most Linux systems will default to using semaphores instead, so the directive may not apply. However in the event a lock file is used, it is important for the lock file to be in a locally mounted directory that is not writable by other users.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default lock file is                                         <xhtml:span class="inline_block">logs/accept.lock</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


If the                                   <xhtml:span class="inline_block">LockFile</xhtml:span>


 is placed in a writable directory other accounts could create a denial of service attack and prevent the server from starting by creating a lock file with the same name.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mpm_common.html#lockfile </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Find the directory in which the                                                     <xhtml:span class="inline_block">LockFile</xhtml:span>


 would be created. The default value is the                                                     <xhtml:span class="inline_block">ServerRoot/logs</xhtml:span>


 directory.                                              </xhtml:li>
                           <xhtml:li>


Modify the directory if the                                                     <xhtml:span class="inline_block">LockFile</xhtml:span>


 if it is a directory within the Apache                                                     <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Change the ownership and group to be                                                     <xhtml:span class="inline_block">root:root</xhtml:span>


, if not already.                                              </xhtml:li>
                           <xhtml:li>Change the permissions so that the directory is only writable by root, or the user under which apache initially starts up (default is root),</xhtml:li>
                           <xhtml:li>Check that the lock file directory is on a locally mounted hard drive rather than an NFS mounted file system.</xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.9_Secure_the_Pid_File" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Secure the Pid File</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">PidFile</xhtml:span>


 directive sets the file path to the process ID file to which the server records the process id of the server, which is useful for sending a signal to the server process or for checking on the health of the process.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default process ID file is l                                        <xhtml:span class="inline_block">ogs/httpd.pid</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


If the                                   <xhtml:span class="inline_block">PidFile</xhtml:span>


 is placed in a writable directory, other accounts could create a denial of service attack and prevent the server from starting by creating a pid file with the same name.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mpm_common.html#pidfile</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Find the directory in which the                                                     <xhtml:span class="inline_block">PidFile</xhtml:span>


 would be created. The default value is the                                                     <xhtml:span class="inline_block">ServerRoot/logs</xhtml:span>


 directory.                                              </xhtml:li>
                           <xhtml:li>


Modify the directory if the                                                     <xhtml:span class="inline_block">PidFile</xhtml:span>


 is in a directory within the Apache                                                     <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Change the ownership and group to be                                                     <xhtml:span class="inline_block">root:root</xhtml:span>


, if not already.                                              </xhtml:li>
                           <xhtml:li>Change the permissions so that the directory is only writable by root, or the user under which apache initially starts up (default is root).</xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.10_Secure_the_ScoreBoard_File" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Secure the ScoreBoard File</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>


 directive sets a file path which the server will use for inter-process communication (IPC) among the Apache processes. On most Linux platforms shared memory will be used instead of a file in the file system, so this directive is not generally needed and does not need to be specified. However, if the directive is specified, then Apache will use the configured file for the inter-process communication. Therefore, if it is specified it needs to be located in a secure directory.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default scoreboard file is                                         <xhtml:span class="inline_block">logs/apache\_status</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


If the                                   <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>


 is placed in a writable directory, other accounts could create a denial of service attack and prevent the server from starting by creating a file with the same name, and or users could monitor and disrupt the communication between the processes by reading and writing to the file.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mpm_common.html#scoreboardfile </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Check to see if the                                                     <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>


 is specified in any of the Apache configuration files. If it is not present, no changes are required.                                              </xhtml:li>
                           <xhtml:li>


If the directive is present, find the directory in which the                                                     <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>


 would be created. The default value is the                                                     <xhtml:span class="inline_block">ServerRoot/logs</xhtml:span>


 directory.                                              </xhtml:li>
                           <xhtml:li>


Modify the directory if the                                                     <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>


 is in a directory within the Apache                                                     <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Change the ownership and group to be                                                     <xhtml:span class="inline_block">root:root</xhtml:span>


, if not already.                                              </xhtml:li>
                           <xhtml:li>Change the permissions so that the directory is only writable by root, or the user under which apache initially starts up (default is root),</xhtml:li>
                           <xhtml:li>Check that the scoreboard file directory is on a locally mounted hard drive rather than an NFS mounted file system.</xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.11_Restrict_Group_Write_Access_for_the_Apache_Directories_and_Files" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Group Write Access for the Apache Directories and Files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Group permissions on Apache directories should generally be r-x and file permissions should be similar except not executable if executable is not appropriate. This applies to all of the Apache software directories and files installed with the possible exception of the web document root $                                  <xhtml:span class="inline_block">DOCROOT</xhtml:span>


 defined by Apache                                   <xhtml:span class="inline_block">DocumentRoot</xhtml:span>


 and defaults to $                                  <xhtml:span class="inline_block">APACHE\_PREFIX/htdocs</xhtml:span>


. The directories and files in the web document root may have a designated web development group with write access to allow web content to be updated.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Restricting write permissions on the Apache files and directories can help mitigate attacks that modify web content to provide unauthorized access, or to attack web clients.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Perform the following to remove group write access on the $                                              <xhtml:span class="inline_block">APACHE\_PREFIX</xhtml:span>


 directories.                                        </xhtml:p>
                        <xhtml:code class="code_block">

# chmod -R g-w $APACHE_PREFIX 


</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.12_Restrict_Group_Write_Access_for_the_Document_Root_Directories_and_Files" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Group Write Access for the Document Root Directories and Files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Group permissions on Apache Document Root directories $                                  <xhtml:span class="inline_block">DOCROOT</xhtml:span>


 may need to be writeable by an authorized group such as development, support, or a production content management tool. However it is important that the Apache group used to run the server does not have write access to any directories or files in the document root.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Preventing Apache from writing to the web document root helps mitigate risk associated with web application vulnerabilities associated with file uploads or command execution. Typically, if an application hosted by Apache needs to write to directory, it is best practice to have that directory live outside the web root.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Perform the following to remove group write access on the $                                              <xhtml:span class="inline_block">DOCROOT</xhtml:span>


 directories and files with the apache group.                                        </xhtml:p>
                        <xhtml:code class="code_block">
# find -L $DOCROOT -group $GRP -perm /g=w -print | xargs chmod g-w 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Apache_Access_Control">
            <xccdf:title xml:lang="en">Apache Access Control</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section pertain to configurable access control mechanisms that are available in Apache HTTP server.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Deny_Access_to_OS_Root_Directory" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Deny Access to OS Root Directory</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">Directory</xhtml:span>


 directive allows for directory specific configuration of access controls and many other features and options. One important usage is to create a default deny policy that does not allow access to Operating system directories and files, except for those specifically allowed. This is done, with denying access to the OS root directory using either of two methods but not both:                            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Using the Apache Deny directive along with an Order directive.</xhtml:li>
                     <xhtml:li>Using the Apache Require directive.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>


Either method is effective. The                                   <xhtml:span class="inline_block">Order/Deny/Allow</xhtml:span>


 combination are now deprecated; they provide three passes where all the directives are processed in the specified order. In contrast, the                                   <xhtml:span class="inline_block">Require</xhtml:span>


 directive works on the first match similar to firewall rules. The                                   <xhtml:span class="inline_block">Require</xhtml:span>


 directive is the default for Apache 2.4 and is demonstrated in the remediation procedure as it may be less likely to be misunderstood.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following is the default root directory configuration:                                         <xhtml:span class="inline_block">&amp;amp;amp;lt;Directory&amp;amp;amp;amp;gt; . . . Order deny,allow Deny from all &amp;amp;amp;lt;/Directory</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>One aspect of Apache, which is occasionally misunderstood, is the feature of default access. That is, unless you take steps to change it, if the server can find its way to a file through normal URL mapping rules, it can and will serve it to clients. Having a default deny is a predominate security principal, and then helps prevent the unintended access, and we do that in this case by denying access to the OS root directory. The Order directive is important as it provides for other Allow directives to override the default deny.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#directory</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find a root                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 element.                                              </xhtml:li>
                           <xhtml:li>


Add a single                                                     <xhtml:span class="inline_block">Require</xhtml:span>


 directive and set the value to "                                                    <xhtml:span class="inline_block">all denied</xhtml:span>


"                                              </xhtml:li>
                           <xhtml:li>


Remove any                                                     <xhtml:span class="inline_block">Deny</xhtml:span>


 and                                                     <xhtml:span class="inline_block">Allow</xhtml:span>


 directives from the root element.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">
&lt;Directory&gt;
   . . .
   Require all denied
   . . .
&lt;/Directory&gt;   
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Allow_Appropriate_Access_to_Web_Content" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Allow Appropriate Access to Web Content</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


In order to serve Web content, the Apache                                   <xhtml:span class="inline_block">Allow</xhtml:span>


 directive will need to be used to allow for appropriate access to directories, locations and virtual hosts that contains web content.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Either the                                   <xhtml:span class="inline_block">Allow</xhtml:span>


 or                                   <xhtml:span class="inline_block">Require</xhtml:span>


 directives may be used within a directory, a location or other context to allow appropriate access. Access may be allowed to all, or to specific networks, or hosts, or users as appropriate. The                                   <xhtml:span class="inline_block">Allow/Deny/Order</xhtml:span>


 directives are deprecated and should be replaced by the                                   <xhtml:span class="inline_block">Require</xhtml:span>


 directive. It is also recommended that either the                                   <xhtml:span class="inline_block">Allow</xhtml:span>


 directive or the                                   <xhtml:span class="inline_block">Require</xhtml:span>


 directive be used, but not both in the same context.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#require</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find all                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 and                                                     <xhtml:span class="inline_block">&lt;Location&gt;</xhtml:span>


 elements. There should be one for the document root and any special purpose directories or locations. There are likely to be other access control directives in other contexts, such as virtual hosts or special elements like                                                     <xhtml:span class="inline_block">&lt;Proxy&gt;</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Include the appropriate                                                     <xhtml:span class="inline_block">Require</xhtml:span>


 directives, with values that are appropriate for the purposes of the directory.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>The configurations below are just a few possible examples.</xhtml:p>
                        <xhtml:code class="code_block">
&lt;Directory "/var/www/html/"&gt; 
    Require ip 192.169. 
&lt;/Directory&gt; 

&lt;Directory "/var/www/html/"&gt; 
    Require all granted 
&lt;/Directory&gt; 

&lt;Location /usage&gt;
    Require local
&lt;/Location&gt; 

&lt;Location /portal&gt;
    Requirevalid-user
&lt;/Location&gt;   
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Restrict_OverRide_for_the_OS_Root_Directory" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict OverRide for the OS Root Directory</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">OverRide</xhtml:span>


 directive allows for                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files to be used to override much of the configuration, including authentication, handling of document types, auto generated indexes, access control, and options. When the server finds an                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 file (as specified by                                   <xhtml:span class="inline_block">AccessFileName</xhtml:span>


) it needs to know which directives declared in that file can override earlier access information. When this directive is set to                                   <xhtml:span class="inline_block">None</xhtml:span>


, then                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files are completely ignored. In this case, the server will not even attempt to read                                   <xhtml:span class="inline_block">.htaccess </xhtml:span>


files in the filesystem. When this directive is set to                                   <xhtml:span class="inline_block">All</xhtml:span>


, then any directive which has the                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 Context is allowed in                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files. Refer to the Apache 2.2 documentation for details                                   <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride">http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


While the functionality of                                   <xhtml:span class="inline_block">htaccess</xhtml:span>


 files is sometimes convenient, usage decentralizes the access controls and increases the risk of configurations being changed or viewed inappropriately by an unintended or rogue                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 file. Consider also that some of the more common vulnerabilities in web servers and web applications allow the web files to be viewed or to be modified, then it is wise to keep the configuration out of the web server from being placed in                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride  </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find a root                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 element.                                              </xhtml:li>
                           <xhtml:li>


Add a single                                                     <xhtml:span class="inline_block">AllowOverride</xhtml:span>


 directive if there is none.                                              </xhtml:li>
                           <xhtml:li>


Set the value for                                                     <xhtml:span class="inline_block">AllowOverride</xhtml:span>


 to                                                     <xhtml:span class="inline_block">None</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  &lt;Directory&gt;
      . . .
      AllowOverride None
      . . .
  &lt;/Directory&gt; 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_Restrict_OverRide_for_All_Directories" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict OverRide for All Directories</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">AllowOverride</xhtml:span>


 directive allows for                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files to be used to override much of the configuration, including authentication, handling of document types, auto generated indexes, access control, and options. When the server finds an                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 file (as specified by                                   <xhtml:span class="inline_block">AccessFileName</xhtml:span>


) it needs to know which directives declared in that file can override earlier access information. When this directive is set to                                   <xhtml:span class="inline_block">None</xhtml:span>


, then                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files are completely ignored. In this case, the server will not even attempt to read                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files in the filesystem. When this directive is set to                                   <xhtml:span class="inline_block">All</xhtml:span>


, then any directive which has the                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 Context is allowed in                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files. Refer to the Apache 2.2 documentation for details                                   <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride">http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


While the functionality of                                   <xhtml:span class="inline_block">htaccess</xhtml:span>


 files is sometimes convenient, usage decentralizes the access controls and increases the risk of configurations being changed or viewed inappropriately by an unintended or rogue                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 file. Consider also that some of the more common vulnerabilities in web servers and web applications allow the web files to be viewed or to be modified, then it is wise to keep the configuration out of the web server from being placed in                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


 files                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride  </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find                                                     <xhtml:span class="inline_block">AllowOverride</xhtml:span>


 directives.                                              </xhtml:li>
                           <xhtml:li>


Set the value for all                                                     <xhtml:span class="inline_block">AllowOverride</xhtml:span>


 directives to                                                     <xhtml:span class="inline_block">None</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  . . .
  AllowOverride None
  . . . 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Minimize_Features_Content_and_Options">
            <xccdf:title xml:lang="en">Minimize Features, Content and Options</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section intend to reduce the effective attack surface of Apache HTTP server.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1_Restrict_Options_for_the_OS_Root_Directory" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Options for the OS Root Directory</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">Options</xhtml:span>


 directive allows for specific configuration of options, including execution of CGI, following symbolic links, server side includes, and content negotiation.                            </xhtml:p>
                  <xhtml:p>Refer to the Apache 2.2 documentation for details:</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#options">http://httpd.apache.org/docs/2.2/mod/core.html#options</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following is the default root directory configuration:                                         <xhtml:span class="inline_block">&amp;amp;amp;lt;Directory&amp;amp;amp;amp;gt; Options FollowSymLinks . . . &amp;amp;amp;lt;/Directory&amp;amp;amp;amp;gt;</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">Options</xhtml:span>


 directive for the root OS level is used to create a default minimal options policy that allows only the minimal options at the root directory level. Then for specific web sites or portions of the web site, options may be enabled as needed and appropriate. No options should be enabled and the value for the                                   <xhtml:span class="inline_block">Options</xhtml:span>


 Directive should be                                   <xhtml:span class="inline_block">None</xhtml:span>


.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#options</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find a root                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 element.                                              </xhtml:li>
                           <xhtml:li>


Add a single                                                     <xhtml:span class="inline_block">Options</xhtml:span>


 directive if there is none.                                              </xhtml:li>
                           <xhtml:li>


Set the value for                                                     <xhtml:span class="inline_block">Options</xhtml:span>


 to                                                     <xhtml:span class="inline_block">None</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  &lt;Directory&gt;
      . . .
      Options None
      . . .
  &lt;/Directory&gt; 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2_Restrict_Options_for_the_Web_Root_Directory" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Options for the Web Root Directory</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">Options</xhtml:span>


 directive allows for specific configuration of options, including                            </xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>execution of CGI,</xhtml:li>
                     <xhtml:li>following symbolic links,</xhtml:li>
                     <xhtml:li>server side includes, and</xhtml:li>
                     <xhtml:li>content negotiation.</xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>Refer to the Apache 2.2 documentation for details</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#options">http://httpd.apache.org/docs/2.2/mod/core.html#options</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following is the default document root directory configuration:                                         <xhtml:span class="inline_block">&amp;amp;amp;lt;Directory "/usr/local/apache2/htdocs"&amp;amp;amp;gt; Options Indexes FollowSymLinks . . . &amp;amp;amp;lt;/Directory&amp;amp;amp;amp;gt;</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">Options</xhtml:span>


 directive at the web root or document root level also needs to be restricted to the minimal options required. A setting of                                   <xhtml:span class="inline_block">None</xhtml:span>


 is highly recommended, however it is recognized that at this level content negotiation may be needed if multiple languages are supported. No other options should be enabled.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#options</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find the document root                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 element.                                              </xhtml:li>
                           <xhtml:li>


Add or modify any existing                                                     <xhtml:span class="inline_block">Options</xhtml:span>


 directive to have a value of                                                     <xhtml:span class="inline_block">None</xhtml:span>


 or                                                     <xhtml:span class="inline_block">Multiviews</xhtml:span>


, if multiviews are needed.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  &lt;Directory "/usr/local/apache2/htdocs"&gt;
      . . .
      Options None
      . . .
  &lt;/Directory&gt; 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Minimize_Options_for_Other_Directories" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Minimize Options for Other Directories</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">Options</xhtml:span>


 directive allows for specific configuration of options, including execution of CGI, following symbolic links, server side includes, and content negotiation.                            </xhtml:p>
                  <xhtml:p>Refer to the Apache 2.2 documentation for details</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#options">http://httpd.apache.org/docs/2.2/mod/core.html#options</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value:                                         <xhtml:span class="inline_block">&amp;amp;amp;lt;Directory "/usr/local/apache2/cgi-bin"&amp;amp;amp;gt; . . . Options None . . . &amp;amp;amp;lt;/Directory&amp;amp;amp;amp;gt;</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Likewise the options for other directories and hosts needs to be restricted to the minimal options required. A setting of                                   <xhtml:span class="inline_block">None</xhtml:span>


 is recommended, however it is recognized that other options may be needed in some cases:                            </xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>
                        <xhtml:span class="inline_block">Multiviews</xhtml:span>


 - Is appropriate if content negotiation is required such as for multiple language are supported.                                  </xhtml:li>
                     <xhtml:li>
                        <xhtml:span class="inline_block">ExecCGI</xhtml:span>


 - Is only appropriate for special directories dedicated to executable content such as a                                         <xhtml:span class="inline_block">cgi-bin/</xhtml:span>


 directory. That way you will know what is executed on the server. It is possible to enable CGI script execution based on file extension or permission settings however this makes script control and management almost impossible as developers may install scripts without your knowledge. This may become a factor in a hosting environment.                                  </xhtml:li>
                     <xhtml:li>
                        <xhtml:span class="inline_block">FollowSymLinks</xhtml:span>


 &amp;                                         <xhtml:span class="inline_block">SymLinksIfOwnerMatch</xhtml:span>


 - The following of symbolic links is not recommended and should be disabled if possible. The usage of symbolic links opens up additional risk for possible attacks that may use inappropriate symbolic links to access content outside of the document root of the web server. Also consider that it could be combined with a vulnerability that allowed an attacker or insider to create an inappropriate link. The option                                         <xhtml:span class="inline_block">SymLinksIfOwnerMatch</xhtml:span>


 is much safer in that the ownership must match in order for the link to be used, however keep in mind there is additional overhead created by requiring Apache to check the ownership.                                  </xhtml:li>
                     <xhtml:li>
                        <xhtml:span class="inline_block">Includes</xhtml:span>


 &amp;                                         <xhtml:span class="inline_block">IncludesNOEXEC</xhtml:span>


 - The                                         <xhtml:span class="inline_block">IncludesNOEXEC</xhtml:span>


 option should only be needed when server side includes are required. The full                                         <xhtml:span class="inline_block">Includes</xhtml:span>


 option should not be used as it also allows execution of arbitrary shell commands. See Apache Mod Include for details                                         <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_include.html">http://httpd.apache.org/docs/2.2/mod/mod_include.html</xhtml:a>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:span class="inline_block">Indexes</xhtml:span>


 - The                                         <xhtml:span class="inline_block">Indexes</xhtml:span>


 option causes automatic generation of indexes, if the default index page is missing, and should be disabled unless required.                                  </xhtml:li>
                  </xhtml:ul>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#options  </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files (                                                    <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and any included configuration files) to find all                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 elements.                                              </xhtml:li>
                           <xhtml:li>


Add or modify any existing                                                     <xhtml:span class="inline_block">Options</xhtml:span>


 directive to NOT have a value of                                                     <xhtml:span class="inline_block">Includes</xhtml:span>


. Other options may be set if necessary and appropriate as described above.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Remove_Default_HTML_Content" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Remove Default HTML Content</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apache installations have default content that is not needed or appropriate for production use. The primary function for these sample content is to provide a default web site, provide user manuals or to demonstrate special features of the web server. All content that is not needed should be removed.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The default source build extra content available in the                                         <xhtml:span class="inline_block">/usr/local/apache2/conf/extra/</xhtml:span>


 directory, but the configuration of the extra content is commented out by default. The only default content is a minimal barebones index.html in the document root which contains.                                  </xhtml:p>
                     <xhtml:p>
                        <xhtml:span class="inline_block">&amp;amp;amp;lt;html&amp;amp;amp;amp;gt;&amp;amp;amp;lt;body&amp;amp;amp;amp;gt;&amp;amp;amp;lt;h1&amp;amp;amp;amp;gt;It works!&amp;amp;amp;lt;/h1&amp;amp;amp;amp;gt;&amp;amp;amp;lt;/body&amp;amp;amp;amp;gt;&amp;amp;amp;lt;/html&amp;amp;amp;amp;gt;</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Historically these sample content and features have been remotely exploited and can provide different levels of access to the server. In the Microsoft arena, Code Red exploited a problem with the index service provided by the Internet Information Service. Usually these routines are not written for production use and consequently little thought was given to security in their development.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Review all pre-installed content and remove content which is not required. In particular look for the unnecessary content which may be found in the document root directory, a configuration directory such as                                               <xhtml:span class="inline_block">conf/extra</xhtml:span>


 directory, or as a Unix/Linux package                                        </xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Remove the default index.html or welcome page, if it is a separate package or comment out the configuration if it is part of main Apache                                                     <xhtml:span class="inline_block">httpd</xhtml:span>


 package such as it is on Red Hat Linux. Removing a file such as the                                                     <xhtml:span class="inline_block">welcome.conf</xhtml:span>


 shown below is not recommended as it may get replaced if the package is updated.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  #
  # This configuration file enables the default "Welcome"
  # page if there is no default index page present for
  # the root URL. To disable the Welcome page, comment
  # out all the lines below.
  #
  ##&lt;LocationMatch "^/+$"&gt;
  ##     Options -Indexes
  ##     ErrorDocument 403 /error/noindex.html
  ##&lt;/LocationMatch&gt; 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>Remove the Apache user manual content or comment out configurations referencing the manual</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # yum erase httpd-manual 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>Remove or comment out any Server Status handler configuration.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  #
  # Allow server status reports generated by mod_status,
  # with the URL of http://servername/server-status
  # Change the ".example.com" to match your domain to enable.
  #
  #&lt;Location /server-status&gt;
  #     SetHandler server-status
  #     Order deny,allow
  #     Deny from all
  #     Allow from .example.com
  #&lt;/Location&gt; 
  
</xhtml:code>
                        <xhtml:ol start="4">
                           <xhtml:li>Remove or comment out any Server Information handler configuration.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  #
  # Allow remote server configuration reports, with the URL of
  # http://servername/server-info (requires that mod_info.c be loaded).
  # Change the ".example.com" to match your domain to enable.
  #
  #&lt;Location /server-info&gt;
  #     SetHandler server-info
  #     Order deny,allow
  #     Deny from all
  #     Allow from .example.com
  #&lt;/Location&gt; 
  
</xhtml:code>
                        <xhtml:ol start="5">
                           <xhtml:li>Remove or comment out any other handler configuration such as perl-status.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # This will allow remote server configuration reports, with the URL of
  # http://servername/perl-status
  # Change the ".example.com" to match your domain to enable.
  #
  #&lt;Location /perl-status&gt;
  #     SetHandler perl-script
  #     PerlResponseHandler Apache2::Status
  #     Order deny,allow
  #     Deny from all
  #     Allow from .example.com
  #&lt;/Location&gt; 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_Remove_Default_CGI_Content_printenv" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Remove Default CGI Content printenv</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Most Web Servers, including Apache installations have default CGI content which is not needed or appropriate for production use. The primary function for these sample programs is to demonstrate the capabilities of the web server. One common default CGI content for apache installations is the script                                   <xhtml:span class="inline_block">printenv</xhtml:span>


. This script will print back to the requester all of the CGI environment variables which includes many server configuration details and system paths.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default source build does not include the                                         <xhtml:span class="inline_block">printenv</xhtml:span>


 script.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


CGI programs have a long history of security bugs and problems associated with improperly accepting user-input. Since these programs are often targets of attackers, we need to make sure that there are no unnecessary CGI programs that could potentially be used for malicious purposes. Usually these programs are not written for production use and consequently little thought was given to security in their development. The                                   <xhtml:span class="inline_block">printenv</xhtml:span>


 script in particular will disclose inappropriate information about the web server including directory paths and detailed version and configuration information.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Locate cgi-bin files and directories enabled in the Apache configuration via                                                     <xhtml:span class="inline_block">Script</xhtml:span>


,                                                     <xhtml:span class="inline_block">ScriptAlias</xhtml:span>


,                                                     <xhtml:span class="inline_block">ScriptAliasMatch</xhtml:span>


, or                                                     <xhtml:span class="inline_block">ScriptInterpreterSource</xhtml:span>


 directives.                                              </xhtml:li>
                           <xhtml:li>


Remove the                                                     <xhtml:span class="inline_block">printenv</xhtml:span>


 default CGI in cgi-bin directory if it is installed.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # rm $APACHE_PREFIX/cgi-bin/printenv 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_Remove_Default_CGI_Content_test-cgi" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Remove Default CGI Content test-cgi</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Most Web Servers, including Apache installations have default CGI content which is not needed or appropriate for production use. The primary function for these sample programs is to demonstrate the capabilities of the web server. A common default CGI content for apache installations is the script                                   <xhtml:span class="inline_block">test-cgi</xhtml:span>


. This script will print back to the requester CGI environment variables which includes many server configuration details.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The default source build does not include the                                         <xhtml:span class="inline_block">test-cgi</xhtml:span>


 script.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


CGI programs have a long history of security bugs and problems associated with improperly accepting user-input. Since these programs are often targets of attackers, we need to make sure that there are no unnecessary CGI programs that could potentially be used for malicious purposes. Usually these programs are not written for production use and consequently little thought was given to security in their development. The                                   <xhtml:span class="inline_block">test-cgi</xhtml:span>


 script in particular will disclose inappropriate information about the web server including directory paths and detailed version and configuration information.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Locate cgi-bin files and directories enabled in the Apache configuration via                                                     <xhtml:span class="inline_block">Script</xhtml:span>


,                                                     <xhtml:span class="inline_block">ScriptAlias</xhtml:span>


,                                                     <xhtml:span class="inline_block">ScriptAliasMatch</xhtml:span>


, or                                                     <xhtml:span class="inline_block">ScriptInterpreterSource</xhtml:span>


 directives.                                              </xhtml:li>
                           <xhtml:li>


Remove the                                                     <xhtml:span class="inline_block">test-cgi</xhtml:span>


 default CGI in cgi-bin directory if it is installed.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # rm $APACHE_PREFIX/cgi-bin/test-cgi 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_Limit_HTTP_Request_Methods" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Limit HTTP Request Methods</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Use the Apache                                   <xhtml:span class="inline_block">&lt;LimitExcept&gt;</xhtml:span>


 directive to restrict unnecessary HTTP request methods of the web server to only accept and process the                                   <xhtml:span class="inline_block">GET</xhtml:span>


,                                   <xhtml:span class="inline_block">HEAD</xhtml:span>


,                                   <xhtml:span class="inline_block">POST</xhtml:span>


 and                                   <xhtml:span class="inline_block">OPTIONS</xhtml:span>


 HTTP request methods.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The HTTP 1.1 protocol supports several request methods which are rarely used and potentially high risk. For example, methods such as                                   <xhtml:span class="inline_block">PUT</xhtml:span>


 and                                   <xhtml:span class="inline_block">DELETE</xhtml:span>


 are rarely used and should be disabled in keeping with the primary security principal of minimize features and options. Also since the usage of these methods is typically to modify resources on the web server, they should be explicitly disallowed. For normal web server operation, you will typically need to allow only the                                   <xhtml:span class="inline_block">GET</xhtml:span>


,                                   <xhtml:span class="inline_block">HEAD</xhtml:span>


 and                                   <xhtml:span class="inline_block">POST</xhtml:span>


 request methods. This will allow for downloading of web pages and submitting information to web forms. The                                   <xhtml:span class="inline_block">OPTIONS</xhtml:span>


 request method will also be allowed as it used to request which HTTP request methods are allowed. Unfortunately, the Apache                                   <xhtml:span class="inline_block">&lt;LimitExcept&gt;</xhtml:span>


 directive does not deny the                                   <xhtml:span class="inline_block">TRACE</xhtml:span>


 request method. The                                   <xhtml:span class="inline_block">TRACE</xhtml:span>


 request method will be disallowed in another benchmark recommendation with the                                   <xhtml:span class="inline_block">TraceEnable</xhtml:span>


 directive.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#limitexcept</xccdf:ident>
               <xccdf:ident system="URL">http://www.ietf.org/rfc/rfc2616.txt</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>Locate the Apache configuration files and included configuration files.</xhtml:li>
                           <xhtml:li>Search for the directive on the document root directory such as:</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">
&lt;Directory "/usr/local/apache2/htdocs"&gt;
    . . .
&lt;/Directory&gt; 
</xhtml:code>
                        <xhtml:ol>
                           <xhtml:li>Add a directive as shown below within the group of document root directives.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">
# Limit HTTP methods to standard methods. Note: Does not limit TRACE
&lt;LimitExcept GET POST OPTIONS&gt;
    Require all denied
&lt;/LimitExcept&gt;   
</xhtml:code>
                        <xhtml:ol>
                           <xhtml:li>Search for other directives in the Apache configuration files other than the OS root directory, and add the same directives to each. It is very important to understand that the directives are based on the OS file system hierarchy as accessed by Apache and not the hierarchy of the locations within web site URLs.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">
&lt;Directory "/usr/local/apache2/cgi-bin"&gt;
    . . .
    # Limit HTTP methods
    &lt;LimitExcept GET POST OPTIONS&gt;
        Require all denied
    &lt;/LimitExcept&gt;
&lt;/Directory&gt; 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_HTTP_TRACE_Method" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable HTTP TRACE Method</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Use the Apache                                   <xhtml:span class="inline_block">TraceEnable</xhtml:span>


 directive to disable the HTTP                                   <xhtml:span class="inline_block">TRACE</xhtml:span>


 request method. Refer to the Apache documentation for more details:                                   <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#traceenable">http://httpd.apache.org/docs/2.2/mod/core.html#traceenable</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The default value is for the TRACE method to be enabled.                                         <xhtml:span class="inline_block"> TraceEnable on</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The HTTP 1.1 protocol requires support for the                                   <xhtml:span class="inline_block">TRACE</xhtml:span>


 request method which reflects the request back as a response and was intended for diagnostics purposes. The                                   <xhtml:span class="inline_block">TRACE</xhtml:span>


 method is not needed and is easily subjected to abuse and should be disabled.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#traceenable</xccdf:ident>
               <xccdf:ident system="URL">http://www.ietf.org/rfc/rfc2616.txt</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Locate the main Apache configuration file such as                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Add a                                                     <xhtml:span class="inline_block">TraceEnable</xhtml:span>


 directive to the server level configuration with a value of                                                     <xhtml:span class="inline_block">off</xhtml:span>


. Server level configuration is the top level configuration, not nested within any other directives like                                                     <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>


 or                                                     <xhtml:span class="inline_block">&lt;Location&gt;</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  TraceEnable off 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_Restrict_HTTP_Protocol_Versions" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict HTTP Protocol Versions</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache modules                                   <xhtml:span class="inline_block">mod\_rewrite</xhtml:span>


 or                                   <xhtml:span class="inline_block">mod\_security</xhtml:span>


 can be used to disallow old and invalid HTTP protocols versions. The HTTP version 1.1 RFC is dated June 1999, and has been supported by Apache since version 1.2. It should no longer be necessary to allow ancient versions of HTTP such as 1.0 and prior. Refer to the Apache documentation on                                   <xhtml:span class="inline_block">mod\_rewrite</xhtml:span>


 for more details:                                   <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The default value is for the                                         <xhtml:span class="inline_block">RewriteEngine</xhtml:span>


:                                         <xhtml:span class="inline_block"> RewriteEngine off</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Many malicious automated programs, vulnerability scanners and fingerprinting tools will send abnormal HTTP protocol versions to see how the web server responds. These requests are usually part of the attacker's enumeration process and therefore it is important that we respond by denying these requests.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Load the                                                     <xhtml:span class="inline_block">mod\_rewrite </xhtml:span>


module for Apache by doing either one of the following:
                                                    <xhtml:ol>
                                 <xhtml:li>


Build Apache with                                                                 <xhtml:span class="inline_block">mod\_rewrite</xhtml:span>


 statically loaded during the build, by adding the                                                                 <xhtml:span class="inline_block">--enable-rewrite</xhtml:span>


 option to the                                                                 <xhtml:span class="inline_block">./configure</xhtml:span>


 script.                                                          </xhtml:li>
                              </xhtml:ol>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">      ./configure --enable-rewrite 
      
      ```
    2. Or dynamically loading the module with the `LoadModule` directive in the httpd.conf configuration file. 
</xhtml:code>
                        <xhtml:code class="code_block">  LoadModule rewrite_module modules/mod_rewrite.so 
  
  ```
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Add the                                                     <xhtml:span class="inline_block">RewriteEngine</xhtml:span>


 directive to the configuration within the global server context with the value of                                                     <xhtml:span class="inline_block">on</xhtml:span>


 so that the rewrite engine is enabled.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  RewriteEngine On 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>


Locate the main Apache configuration file such as                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and add the following rewrite condition to match HTTP/1.1 and the rewrite rule to the top server level configuration to disallow other protocol versions.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  RewriteEngine On
  RewriteCond %{THE_REQUEST} !HTTP/1\.1$
  RewriteRule .* - [F] 
  
</xhtml:code>
                        <xhtml:ol start="4">
                           <xhtml:li>


By default,                                                     <xhtml:span class="inline_block">mod\_rewrite</xhtml:span>


 configuration settings from the main server context are not inherited by virtual hosts. Therefore, it is also necessary to add the following directives in each section to inherit the main server settings.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  RewriteEngine On
  RewriteOptions Inherit 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_Restrict_Access_to_.ht_files" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Access to .ht* files</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Restrict access to any files beginning with                                   <xhtml:span class="inline_block">.ht</xhtml:span>


 using the                                   <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The default name for access filename which allows files in web directories to override the Apache configuration is                                   <xhtml:span class="inline_block">.htaccess</xhtml:span>


. The usage of access files should not be allowed, but as a defense in depth a                                   <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive is recommended to prevent web clients from viewing those files in case they are created. Also a common name for web password and group files is                                   <xhtml:span class="inline_block">.htpasswd </xhtml:span>


and                                   <xhtml:span class="inline_block">.htgroup</xhtml:span>


. Neither of these files should be placed in the document root, but in the event they are, the                                   <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive can be used to prevent them from being viewed by web clients.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#filesmatch</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>Add or modify the following lines in the apache configuration at the server configuration level.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  &lt;FilesMatch "^\.ht"&gt;
     Require all denied
  &lt;/FilesMatch&gt; 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_Restrict_File_Extensions" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict File Extensions</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Restrict access to inappropriate file extensions that are not expected to be a legitimate part of web sites using the                                   <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


There are many files that are often left within the web server document root that could provide an attacker with sensitive information. Most often these files are mistakenly left behind after installation, trouble-shooting, or backing up files before editing. Regardless of the reason for their creation, these files can still be served by Apache even when there is no hyperlink pointing to them. The web administrators should use the                                   <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive to restrict access to only those file extensions that are appropriate for the web server. Rather than create a list of potentially inappropriate file extensions such as                                   <xhtml:span class="inline_block">.bak, .config, .old</xhtml:span>


, etc, it is recommended instead that a white list of the appropriate and expected file extensions for the web server be created, reviewed and restricted with a                                   <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#filesmatch</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Compile a list of existing file extension on the web server. The following                                                     <xhtml:span class="inline_block">find/awk</xhtml:span>


 command may be useful, but is likely to need some customization according to the appropriate webroot directories for your web server. Please note that the find command skips over any files without a dot (.) in the file name, as these are not expected to be appropriate web content.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  find */htdocs -type f -name '*.*' | awk -F. '{print $NF }' | sort -u 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>Review the list of existing file extensions, for appropriate content for the web server, remove those that are inappropriate and add any additional file extensions expected to be added to the web server in the near future.</xhtml:li>
                           <xhtml:li>


Add the                                                     <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive below which denies access to all files by default.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # Block all files by default, unless specifically allowed.
  &lt;FilesMatch "^.*$"&gt;
      Require all denied 
  &lt;/FilesMatch&gt; 
  
</xhtml:code>
                        <xhtml:ol start="4">
                           <xhtml:li>


Add another a                                                     <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive that allows access to those file extensions specifically allowed from the review process in step 2. An example                                                     <xhtml:span class="inline_block">FilesMatch</xhtml:span>


 directive is below. The file extensions in the regular expression should match your approved list, and not necessarily the expression below.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # Allow files with specifically approved file extensions
  # Such as (css, htm; html; js; pdf; txt; xml; xsl; ...),
  # images (gif; ico; jpeg; jpg; png; ...), multimedia
  &lt;FilesMatch "^.*\.(css|html?|js|pdf|txt|xml|xsl|gif|ico|jpe?g|png)$"&gt;
      Require all granted
  &lt;/FilesMatch&gt;
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.12_Deny_IP_Address_Based_Requests" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Deny IP Address Based Requests</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache module                                   <xhtml:span class="inline_block">mod\_rewrite</xhtml:span>


 can be used to disallow access for requests that use an IP address instead of a host name for the URL. Most normal access to the website from browsers and automated software will use a host name, and will therefore include the host name in the HTTP HOST header.                            </xhtml:p>
                  <xhtml:p>


Refer to the Apache 2.2 documentation for details                                   <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following is the default value for the RewriteEngine:                                         <xhtml:span class="inline_block"> RewriteEngine off</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>A common malware propagation and automated network scanning technique is to use IP addresses rather than host names for web requests, since it's much simpler to automate. By denying IP based web requests, these automated techniques will be denied access to the website. Of course malicious web scanning techniques continue to evolve, and many are now using hostnames, however denying access to the IP based requests is still a worthwhile defense.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Load the                                                     <xhtml:span class="inline_block">mod\_rewrite </xhtml:span>


module for Apache by doing either one of the following:                                              </xhtml:li>
                           <xhtml:li>


Build Apache with                                                     <xhtml:span class="inline_block">mod\_rewrite</xhtml:span>


 statically loaded during the build, by adding the                                                     <xhtml:span class="inline_block">--enable-rewrite</xhtml:span>


 option to the                                                     <xhtml:span class="inline_block">./configure </xhtml:span>


script.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ./configure --enable-rewrite 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Or dynamically loading the module with the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive in the                                                     <xhtml:span class="inline_block">httpd.conf </xhtml:span>


configuration file.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  LoadModule rewrite_module modules/mod_rewrite.so 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>


Add the                                                     <xhtml:span class="inline_block">RewriteEngine</xhtml:span>


 directive to the configuration within the global server context with the value of                                                     <xhtml:span class="inline_block">on</xhtml:span>


 so that the rewrite engine is enabled.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  RewriteEngine On 
  
</xhtml:code>
                        <xhtml:ol start="4">
                           <xhtml:li>


Locate the Apache configuration file such as                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 and add the following rewrite condition to match the expected host name of the top server level configuration.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  RewriteCond %{HTTP_HOST} !^www\.example\.com [NC]
  RewriteCond %{REQUEST_URI} !^/error [NC]
  RewriteRule ^.(.*) - [L,F] 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.13_Restrict_Listen_Directive" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Listen Directive</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The Apache                                   <xhtml:span class="inline_block">Listen</xhtml:span>


 directive specifies the IP addresses and port numbers the Apache web server will listen for requests. Rather than be unrestricted to listen on all IP addresses available to the system, the specific IP address or addresses intended should be explicitly specified. Specifically, a                                   <xhtml:span class="inline_block">Listen</xhtml:span>


 directive with no IP address specified, or with an IP address of zeros should not be used.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


The following is the default value:                                         <xhtml:span class="inline_block"> Listen 80</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Having multiple interfaces on web servers is fairly common, and without explicit                                   <xhtml:span class="inline_block">Listen</xhtml:span>


 directives, the web server is likely to be listening on an inappropriate IP address / interface that was not intended for the web server. Single homed system with a single IP addressed are also required to have an explicit IP address in the                                   <xhtml:span class="inline_block">Listen</xhtml:span>


 directive, in case additional interfaces are added to the system at a later date.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mpm_common.html#listen </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Find any                                                     <xhtml:span class="inline_block">Listen</xhtml:span>


 directives in the Apache configuration file with no IP address specified, or with an IP address of all zeros similar to the examples below. Keep in mind there may be both IPv4 and IPv6 addresses on the system.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  Listen 80
  Listen 0.0.0.0:80
  Listen [::ffff:0.0.0.0]:80 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Modify the                                                     <xhtml:span class="inline_block">Listen</xhtml:span>


 directives in the Apache configuration file to have explicit IP addresses according to the intended usage. Multiple                                                     <xhtml:span class="inline_block">Listen</xhtml:span>


 directives may be specified for each IP address &amp; Port.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  Listen 10.1.2.3:80
  Listen 192.168.4.5:80
  Listen [2001:db8::a00:20ff:fea7:ccea]:80 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.14_Restrict_Browser_Frame_Options" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Browser Frame Options</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The Header directive allows server HTTP response headers to be added, replaced or merged. We will use the directive to add an server HTTP response header to tell browsers to restrict all of the web pages from being framed by other web sites.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


The                                         <xhtml:span class="inline_block">X-Frame-Options</xhtml:span>


 HTTP response header is not generated by default                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Using iframes and regular web frames to embed malicious content along with expected web content has been a favored attack vector for attacking web clients for a long time. This can happen when the attacker lures the victim to a malicious web site, which using frames to include the expected content from the legitimate site. The attack can also be performed via XSS (either reflected, DOM or stored XSS) to add the malicious content to the legitimate web site. To combat this vector, an HTTP Response header, X-Frame-Options, has been introduced that allows a server to specify whether a web page may be loaded in any frame (                                  <xhtml:span class="inline_block">DENY</xhtml:span>


) or those frames that share the page's origin (                                  <xhtml:span class="inline_block">SAMEORIGIN</xhtml:span>


).                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header </xccdf:ident>
               <xccdf:ident system="URL">https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header</xccdf:ident>
               <xccdf:ident system="URL">http://blogs.msdn.com/b/ie/archive/2009/01/27/ie8-security-part-vii-clickjacking-defenses.aspx </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">Header</xhtml:span>


 directive for the                                                     <xhtml:span class="inline_block">X-Frames-Options</xhtml:span>


 header in the Apache configuration to have the condition                                                     <xhtml:span class="inline_block">always</xhtml:span>


, an action of                                                     <xhtml:span class="inline_block">append</xhtml:span>


 and a value of                                                     <xhtml:span class="inline_block">SAMEORIGIN</xhtml:span>


 or                                                     <xhtml:span class="inline_block">DENY</xhtml:span>


, as shown below.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  Header always append X-Frame-Options SAMEORIGIN 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_Operations_-_Logging_Monitoring_and_Maintenance">
            <xccdf:title xml:lang="en">Operations - Logging, Monitoring and Maintenance</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Operational procedures of logging, monitoring and maintenance are vital to protecting your web servers as well as the rest of the infrastructure.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1_Configure_the_Error_Log" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Configure the Error Log</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LogLevel</xhtml:span>


 directive is used to configure the severity level for the error logs. While the                                   <xhtml:span class="inline_block">ErrorLog</xhtml:span>


 directive configures the error log file name. The log level values are the standard syslog levels of                                   <xhtml:span class="inline_block">emerg, alert, crit, error, warn, notice, info and debug</xhtml:span>


. The recommended level is                                   <xhtml:span class="inline_block">notice</xhtml:span>


, so that all errors from the                                   <xhtml:span class="inline_block">emerg</xhtml:span>


 level through                                   <xhtml:span class="inline_block">notice</xhtml:span>


 level will be logged.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following is the default configuration:                                         <xhtml:span class="inline_block">LogLevel warn ErrorLog "logs/error\_log"</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The server error logs are invaluable because they can also be used to spot any potential problems before they become serious. Most importantly, they can be used to watch for anomalous behavior such as a lot of "not found" or "unauthorized" errors may be an indication that an attack is pending or has occurred.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/logs.html</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#loglevel</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#errorlog</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">LogLevel</xhtml:span>


 in the apache configuration to have a value of                                                     <xhtml:span class="inline_block">notice</xhtml:span>


 or lower. Note that is it is compliant to have a value of                                                     <xhtml:span class="inline_block">info</xhtml:span>


 or                                                     <xhtml:span class="inline_block">debug</xhtml:span>


 if there is a need for a more verbose log and the storage and monitoring processes are capable of handling the extra load. The recommended value is                                                     <xhtml:span class="inline_block">notice</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  LogLevel notice 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Add an                                                     <xhtml:span class="inline_block">ErrorLog</xhtml:span>


 directive if not already configured. The file path may be relative or absolute, or the logs may be configured to be sent to a syslog server.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ErrorLog "logs/error_log" 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>


Add a similar                                                     <xhtml:span class="inline_block">ErrorLog</xhtml:span>


 directive for each virtual host configured if the virtual host will have different people responsible for the web site. Each responsible individual or organization needs access to their own web logs, and needs the skills/training/tools for monitor the logs.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_Configure_a_Syslog_Facility_for_Error_Logging" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Configure a Syslog Facility for Error Logging</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">ErrorLog</xhtml:span>


 directive should be configured to send logs to a                                   <xhtml:span class="inline_block">syslog</xhtml:span>


 facility so that the logs can be processed and monitored along with the system logs.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is easy for the web server error logs to be overlooked in the log monitoring process, and yet the application level attacks have become the most common and are extremely important for detecting attacks early, as well as detecting non-malicious problems such as a broken link, or internal errors. By including the Apache error logs with the system logging facility, the application logs are more likely to be included in the established log monitoring process.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/logs.html</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#loglevel</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#errorlog</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add an                                                     <xhtml:span class="inline_block">ErrorLog</xhtml:span>


 directive if not already configured. Any appropriate                                                     <xhtml:span class="inline_block">syslog</xhtml:span>


 facility may be used in place of                                                     <xhtml:span class="inline_block">local1</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ErrorLog "syslog:local1"
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Add a similar                                                     <xhtml:span class="inline_block">ErrorLog</xhtml:span>


 directive for each virtual host if necessary.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3_Configure_the_Access_Log" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Configure the Access Log</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LogFormat</xhtml:span>


 directive defines the format and information to be included in the access log entries. The                                   <xhtml:span class="inline_block">CustomLog</xhtml:span>


 directive specifies the log file, syslog facility or piped logging utility.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following are the default log configuration:                                         <xhtml:span class="inline_block"> LogFormat %h %l %u %t \\%r\\ %&amp;amp;amp;gt;s %b \\%{Referer}i\\ \\%{User-Agent}i\\ combined LogFormat %h %l %u %t \\%r\\ %&amp;amp;amp;gt;s %b common CustomLog logs/access\_log common</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The server access logs are also invaluable for a variety of reasons. They can be used to determine what resources are being used most. Most importantly, they can be used to investigate anomalous behavior that may be an indication that an attack is pending or has occurred. If the server only logs errors, and does not log successful access, then it is very difficult to investigate incidents. You may see that the errors stop, and wonder if the attacker gave up, or was the attack successful.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">LogFormat</xhtml:span>


 directives in the Apache configuration to use the standard and recommended                                                     <xhtml:span class="inline_block">combined</xhtml:span>


 format show as shown below.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  LogFormat "%h %l %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-agent}i\"" combined 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">CustomLog</xhtml:span>


 directives in the Apache configuration to use the combined format with an appropriate log file, syslog facility or piped logging utility.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  CustomLog log/access_log combined 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>


Add a similar                                                     <xhtml:span class="inline_block">CustomLog</xhtml:span>


 directives for each virtual host configured if the virtual host will have different people responsible for the web site. Each responsible individual or organization needs access to their own web logs, and needs the skills/training/tools for monitor the logs.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>The format string tokens provide the following information:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>%h = Remote hostname or IP address if HostnameLookups is set to Off, which is the default.</xhtml:li>
                           <xhtml:li>%l =Remote logname / identity.</xhtml:li>
                           <xhtml:li>%u =Remote user, if the request was authenticated.</xhtml:li>
                           <xhtml:li>%t = Time the request was received,</xhtml:li>
                           <xhtml:li>%r = First line of request.</xhtml:li>
                           <xhtml:li>%&gt;s = Final status.</xhtml:li>
                           <xhtml:li>%b = Size of response in bytes.</xhtml:li>
                           <xhtml:li>%{Referer}i = Variable value for Referer header.</xhtml:li>
                           <xhtml:li>%{User-agent}i = Variable value for User Agent header.</xhtml:li>
                        </xhtml:ul>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.4_Log_Storage_and_Rotation" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Log Storage and Rotation</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>It is important that there is adequate disk space on the partition that will hold all the log files, and that log rotation is configured to retain at least 3 months or 13 weeks if central logging is not used for storage.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>


The following is the default httpd log rotation configuration in /etc/logrotate.d/httpd:                                         <xhtml:span class="inline_block">/var/log/httpd/\*log { missingok notifempty sharedscripts postrotate /bin/kill -HUP</xhtml:span>


cat /var/run/httpd.pid 2&amp;amp;amp;gt;/dev/null                                        <xhtml:span class="inline_block"> 2&amp;amp;amp;amp;gt; /dev/null || true endscript }</xhtml:span>


 The default log retention is configured in /etc/logrotate.conf                                         <xhtml:span class="inline_block"> # rotate log files weekly weekly # keep 4 weeks worth of backlogs rotate 4</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Keep in mind that the generation of logs is under a potential attacker's control. So do not hold any Apache log files on the root partition of the OS. This could result in a denial of service against your web server host by filling up the root partition and causing the system to crash. For this reason, it is recommended that the log files should be stored on a dedicated partition. Likewise consider that attackers sometimes put information into your logs which is intended to attack your log collection or log analysis processing software. So it is important that they are not vulnerable. Investigation of incidents often require access to several months or more of logs, which is why it is important to keep at least 3 months available. Two common log rotation utilities include                                   <xhtml:span class="inline_block">rotatelogs(8)</xhtml:span>


 which is bundled with Apache, and                                   <xhtml:span class="inline_block">logrotate(8)</xhtml:span>


 commonly bundled on Linux distributions are described in the remediation section.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


To implement the recommended state, do either option a) if using the Linux                                               <xhtml:span class="inline_block">logrotate</xhtml:span>


 utility or option b) if using a piped logging utility such as the Apache                                               <xhtml:span class="inline_block">rotatelogs</xhtml:span>


:                                        </xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


File Logging with Logrotate:
                                                    <xhtml:ol>
                                 <xhtml:li>


Add or modify the web log rotation configuration to match your configured log files in                                                                 <xhtml:span class="inline_block">/etc/logrotate.d/httpd</xhtml:span>


 to be similar to the following.                                                          </xhtml:li>
                              </xhtml:ol>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">      /var/log/httpd/*log {
          missingok
          notifempty
          sharedscripts
          postrotate
          /bin/kill -HUP `cat /var/run/httpd.pid 2&gt;/dev/null` 2&gt; /dev/null || true
          endscript
      } 
      
      ```
    2. Modify the rotation period and number of logs to keep so that at least 13 weeks or 3 months of logs are retained. This may be done as the default value for all logs in `/etc/logrotate.conf` or in the web specific log rotation configuration in `/etc/logrotate.d/httpd` to be similar to the following. 
</xhtml:code>
                        <xhtml:code class="code_block">  # rotate log files weekly
  weekly
  
  # keep 1 years of backlogs
  rotate 52 
  
  ```
3. For each virtual host configured with its' own log files ensure that those log files are also included in a similar log rotation.
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Piped Logging:
                                                    <xhtml:ol>
                                 <xhtml:li>Configure the log rotation interval and log file names to a suitable interval such as daily.</xhtml:li>
                              </xhtml:ol>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">      CustomLog "|bin/rotatelogs -l /var/logs/logfile.%Y.%m.%d 86400" combined 
      
      ```
    2. Ensure the log file naming and any rotation scripts provide for retaining at least 3 months or 13 weeks of log files.
    3. For each virtual host configured with its own log files ensure that those log files are also included in a similar log rotation.
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5_Apply_Applicable_Patches" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Apply Applicable Patches</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apply available Apache patches within 1 month of availability.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: Not Applicable</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Obviously knowing about newly discovered vulnerabilities is only part of the solution; there needs to be a process in place where patches are tested and installed. These patches fix diverse problems, including security issues. It is recommended to use the Apache packages and updates provided by your Linux platform vendor rather than building from source when possible, in order to minimize the disruption and the work of keeping the software up-to-date.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/security/vulnerabilities_22.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Update to the latest Apache release available according to either of the following:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


When building from source:
                                                    <xhtml:ol>
                                 <xhtml:li>Read release notes and related security patch information</xhtml:li>
                                 <xhtml:li>


Download latest source and any dependent modules such as                                                                 <xhtml:span class="inline_block">mod\_security</xhtml:span>


.                                                          </xhtml:li>
                                 <xhtml:li>Build new Apache software according to your build process with the same configuration options.</xhtml:li>
                                 <xhtml:li>Install and Test the new software according to your organizations testing process.</xhtml:li>
                                 <xhtml:li>Move to production according to your organizations deployment process.</xhtml:li>
                              </xhtml:ol>
                           </xhtml:li>
                           <xhtml:li>


When using platform packages
                                                    <xhtml:ol>
                                 <xhtml:li>Read release notes and related security patch information.</xhtml:li>
                                 <xhtml:li>Download and install latest available Apache package and any dependent software.</xhtml:li>
                                 <xhtml:li>Test the new software according to your organizations testing process.</xhtml:li>
                                 <xhtml:li>Move to production according to your organizations deployment process.</xhtml:li>
                              </xhtml:ol>
                           </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.6_Install_and_Enable_ModSecurity" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Install and Enable ModSecurity</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


ModSecurity is a open source web application firewall (WAF) for real-time web application monitoring, logging, and access control. It enables but does not include a powerful customizable rule set, which may be used to detect and block common web application attacks. Installation of ModSecurity without a rule set does not provide additional security for the protected web applications. Refer to the benchmark recommendation "                                  <xhtml:em>Install and Enable OWASP ModSecurity Core Rule Set</xhtml:em>


" for details on a recommended rule set.                            </xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>NOTE: Like other application security/application firewall systems, Mod_Security requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing Mod_Security may NOT be effective and may provide a false sense of security.</xhtml:strong>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Installation of the ModSecurity Apache module enables a customizable web application firewall rule set which may be configured to detect and block common attack patterns as well as block outbound data leakage.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://www.modsecurity.org/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Install the ModSecurity module if it is not already installed in modules/mod_security2.so. It may be installed via OS package installation (such as apt-get or yum) or built from the source files. See                                                     <xhtml:a href="https://www.modsecurity.org/download.html">https://www.modsecurity.org/download.html</xhtml:a>


 for details.                                              </xhtml:li>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive if not already present in the Apache configuration as shown below. Typically, the                                                     <xhtml:span class="inline_block">LoadModule</xhtml:span>


 directive is placed in file named                                                     <xhtml:span class="inline_block">mod\_security.conf </xhtml:span>


which is included in the Apache configuration:                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">
LoadModule security2_module modules/mod_security2.so   
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.7_Install_and_Enable_OWASP_ModSecurity_Core_Rule_Set" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Install and Enable OWASP ModSecurity Core Rule Set</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The OWASP ModSecurity Core Rules Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>HTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.</xhtml:li>
                     <xhtml:li>Real-time Blacklist Lookups - utilizes 3rd Party IP Reputation</xhtml:li>
                     <xhtml:li>HTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.</xhtml:li>
                     <xhtml:li>Common Web Attacks Protection - detecting common web application security attack.</xhtml:li>
                     <xhtml:li>Automation Detection - Detecting bots, crawlers, scanners and other surface malicious activity.</xhtml:li>
                     <xhtml:li>Integration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.</xhtml:li>
                     <xhtml:li>Tracking Sensitive Data - Tracks Credit Card usage and blocks leakages.</xhtml:li>
                     <xhtml:li>Trojan Protection - Detecting access to Trojans horses.</xhtml:li>
                     <xhtml:li>Identification of Application Defects - alerts on application misconfigurations.</xhtml:li>
                     <xhtml:li>Error Detection and Hiding - Disguising error messages sent by the server.</xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>
                     <xhtml:strong>NOTE: Like other application security/application firewall systems, Mod_Security requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing Mod_Security may NOT be effective and may provide a false sense of security.</xhtml:strong>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Installing, configuring and enabling of the OWASP ModSecurity Core Rule Set (CRS), provides additional baseline security defense, and provides a good starting point to customize the monitoring and blocking of common web application attacks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project</xccdf:ident>
               <xccdf:ident system="URL">https://www.modsecurity.org/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Install, configure and test the OWASP ModSecurity Core Rule Set:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Download the OWASP ModSecurity CRS from the project page                                                     <xhtml:a href="https://www.owasp.org/index.php/Category:OWASP">https://www.owasp.org/index.php/Category:OWASP</xhtml:a>


_ModSecurity_Core_Rule_Set_Project                                              </xhtml:li>
                           <xhtml:li>Unbundled the archive and follow the instructions in the INSTALL file.</xhtml:li>
                           <xhtml:li>The modsecurity_crs_10_setup.conf file is required, and rules in the base_rules directory are intended as a baseline useful for most applications.</xhtml:li>
                           <xhtml:li>Test the application for correct functionality after installing the CRS. Check web server error logs and the modsec_audit.log file for blocked requests due to false positives.</xhtml:li>
                           <xhtml:li>It is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The the web server error log and modsec_audit.log files should show logs of the attacks and the servers response codes.</xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Use_SSLTLS">
            <xccdf:title xml:lang="en">Use SSL/TLS</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section pertain to the configuration of SSL/TLS-related aspects of Apache HTTP server.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_Install_mod_ssl_andor_mod_nss" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Install mod_ssl and/or mod_nss</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Secure Sockets Layer (SSL) was developed by Netscape and turned into an open standard, and was renamed Transport Layer Security (TLS) as part of the process. TLS is important for protecting communication and can provide authentication of the server and even the client. However contrary to vendor claims, implementing SSL does NOT directly make your web server more secure! SSL is used to encrypt traffic and therefore does provide confidentiality of private information and users credentials. Keep in mind, however that just because you have encrypted the data in transit does not mean that the data provided by the client is secure while it is on the server. Also SSL does not protect the web server, as attackers will easily target SSL-Enabled web servers, and the attack will be hidden in the encrypted channel. The                                   <xhtml:span class="inline_block">mod\_ssl</xhtml:span>


 module is the standard, most used module that implements SSL/TLS for Apache. A newer module found on Red Hat systems can be a compliment or replacement for                                   <xhtml:span class="inline_block">mod\_ssl</xhtml:span>


, and provides the same functionality plus additional security services. The                                   <xhtml:span class="inline_block">mod\_nss</xhtml:span>


 is an Apache module implementation of the Network Security Services (NSS) software from Mozilla, which implements a wide range of cryptographic functions in addition to TLS.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: SSL is not enabled by default.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is best to plan for SSL/TLS implementation from the beginning of any new web server. As most web servers have some need for SSL/TLS due to:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>non-public information submitted that should be protected as it's transmitted to the web server.</xhtml:li>
                     <xhtml:li>non-public information that is downloaded from the web server.</xhtml:li>
                     <xhtml:li>users are going to be authenticated to some portion of the web server</xhtml:li>
                     <xhtml:li>there is a need to authenticate the web server to ensure users that they have reached the real web server, and have not been phished or redirected to a bogus site.</xhtml:li>
                  </xhtml:ul>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html</xccdf:ident>
               <xccdf:ident system="URL">http://directory.fedoraproject.org/wiki/Mod_nss</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either of the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For Apache installations built from the source, use the option                                                     <xhtml:span class="inline_block">--with-ssl=</xhtml:span>


 to specify the openssl path, and the                                                     <xhtml:span class="inline_block">--enable-ssl</xhtml:span>


 configure option to add the SSL modules to the build. The                                                     <xhtml:span class="inline_block">--with-included-apr</xhtml:span>


 configure option may be necessary if there are conflicts with the platform version. See the Apache documentation on building from source                                                     <xhtml:a href="http://httpd.apache.org/docs/2.2/install.html">http://httpd.apache.org/docs/2.2/install.html</xhtml:a>


 for details.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # ./configure --with-included-apr --with-ssl=$OPENSSL_DIR --enable-ssl 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


For installations using OS packages, it is typically just a matter of ensuring the                                                     <xhtml:span class="inline_block">mod\_ssl</xhtml:span>


 package is installed. The                                                     <xhtml:span class="inline_block">mod\_nss</xhtml:span>


 package might also be installed. The following yum commands are suitable for Red Hat Linux.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # yum install mod_ssl 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_Install_a_Valid_Trusted_Certificate" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Install a Valid Trusted Certificate</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The default SSL certificate is self-signed and is not trusted. Install a valid certificate signed by a commonly trusted certificate authority. To be valid, the certificate must be:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>signed by a trusted certificate authority</xhtml:li>
                     <xhtml:li>not be expired, and</xhtml:li>
                     <xhtml:li>


have a common name that matches the host name of the web server, such as                                         <xhtml:a href="http://www.example.com">www.example.com</xhtml:a>


.                                  </xhtml:li>
                  </xhtml:ul>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>A digital certificate on your server automatically communicates your site's authenticity to visitors' web browsers. If a trusted authority signs your certificate, it confirms for the visitor they are actually communicating with you, and not with a fraudulent site stealing credit card numbers or personal information.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#realcert</xccdf:ident>
               <xccdf:ident system="URL">http://www.openssl.org/docs/HOWTO/certificates.txt</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Decide on the host name to be used for the certificate. It is important to remember that the browser will compare the host name in the URL to the common name in the certificate, so that it is important that all https: URL's match the correct host name. Specifically, the host name                                                     <xhtml:span class="inline_block">www.example.com</xhtml:span>


 is not the same as                                                     <xhtml:span class="inline_block">example.com</xhtml:span>


 nor the same as                                                     <xhtml:span class="inline_block">ssl.example.com</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Generate a private key using openssl. Although certificate key lengths of 1024 have been common in the past, a key length of 2048 is now recommended for strong authentication. The key must be kept confidential and will be encrypted with a passphrase by default. Follow the steps below and respond to the prompts for a passphrase. See the Apache or OpenSSL documentation for details:                                                     <xhtml:a href="http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#realcert">http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#realcert</xhtml:a>
                              <xhtml:a href="http://www.openssl.org/docs/HOWTO/certificates.txt">http://www.openssl.org/docs/HOWTO/certificates.txt</xhtml:a>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # cd /etc/pki/tls/certs
  # umask 077
  # openssl genrsa -aes128 2048 &gt; example.com.key
  
  Generating RSA private key, 2048 bit long modulus
  ...+++
  ............+++
  e is 65537 (0x10001)
  Enter pass phrase:
  Verifying - Enter pass phrase: 
  
</xhtml:code>
                        <xhtml:ol start="3">
                           <xhtml:li>Generate the certificate signing request (CSR) to be signed by a certificate authority. It is important that the common name exactly matches the web host name.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  &lt;strong&gt;# openssl req -utf8 -new -key example.com.key -out www.example.com.csr&amp;amp;lt;/strong&gt;
  
  Enter pass phrase for example.com.key:
  You are about to be asked to enter information that will be incorporated
  into your certificate request.
  What you are about to enter is what is called a Distinguished Name or a DN.
  There are quite a few fields but you can leave some blank
  For some fields there will be a default value,
  If you enter '.', the field will be left blank.
  -----
  Country Name (2 letter code) [GB]:US
  State or Province Name (full name) [Berkshire]:New York
  Locality Name (eg, city) [Newbury]:Lima
  Organization Name (eg, company) [My Company Ltd]:Durkee Consulting
  Organizational Unit Name (eg, section) []:
  Common Name (eg, your name or your server's hostname) []:www.example.com
  Email Address []:ralph@example.com
  
  &lt;strong&gt;Please enter the following 'extra' attributes&amp;amp;lt;/strong&gt;
  &lt;strong&gt;to be sent with your certificate request&amp;amp;lt;/strong&gt;
  &lt;strong&gt;A challenge password []:&lt;/strong&gt;
  &lt;strong&gt;An optional company name []:&lt;/strong&gt;
  
  &lt;strong&gt;# mv www.example.com.key /etc/pki/tls/private/ &lt;/strong&gt;
  
</xhtml:code>
                        <xhtml:ol start="4">
                           <xhtml:li>Send the certificate signing request (CSR) to a certificate signing authority to be signed, and follow their instructions for submission and validation. The CSR and the final signed certificate are just encoded text, and need to be protected for integrity, but not confidentiality. This certificate will be given out for every SSL connection made.</xhtml:li>
                           <xhtml:li>


The resulting signed certificate may be named                                                     <xhtml:span class="inline_block">www.example.com.crt</xhtml:span>


 and placed in                                                     <xhtml:span class="inline_block">/etc/pki/tls/certs/</xhtml:span>


 as readable by all (mode 0444). Please note that the certificate authority does not need the private key (                                                    <xhtml:span class="inline_block">example.com.key</xhtml:span>


) and this file must be carefully protected. With a decrypted copy of the private key, it would be possible to decrypt all conversations with the server.                                              </xhtml:li>
                           <xhtml:li>


Do not forget the passphrase used to encrypt the private key. It will be required every time the server is started in https mode. If it is necessary to avoid requiring an administrator having to type the passphrase every time the                                                     <xhtml:span class="inline_block">httpd</xhtml:span>


 service is started, the private key may be stored in clear text. Storing the private key in clear text increases the convenience while increasing the risk of disclosure of the key, but may be appropriate for the sake of being able to restart, if the risks are well managed. Be sure that the key file is only readable by root. To decrypt the private key and store it in clear text file the following openssl command may be used. You can tell by the private key headers whether it is encrypted or clear text.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # cd /etc/pki/tls/private/
  # umask 077
  # openssl rsa -in example.com.key -out example.com.key.clear 
  
</xhtml:code>
                        <xhtml:ol start="7">
                           <xhtml:li>


Locate the Apache configuration file for                                                     <xhtml:span class="inline_block">mod\_ssl</xhtml:span>


 and add or modify the                                                     <xhtml:span class="inline_block">SSLCertificateFile</xhtml:span>


 and                                                     <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>


 directives to have the correct path for the private key and signed certificate files. If a clear text key is referenced then a passphrase will not be required. You can use the CA's certificate that signed your certificate instead of the CA bundle, to speed up the initial SSL connection as fewer certificates will need to be transmitted.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  SSLCertificateFile /etc/pki/tls/certs/example.com.crt
  SSLCertificateKeyFile /etc/pki/tls/private/example.com.key
  
  # Default CA file, can be replaced with your CA's certificate. 
  SSLCACertificateFile /etc/pki/tls/certs/ca-bundle.crt 
  
</xhtml:code>
                        <xhtml:ol start="8">
                           <xhtml:li>


Lastly, start or restart the                                                     <xhtml:span class="inline_block">httpd</xhtml:span>


 service and verify correct functioning with your favorite browser.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_Protect_the_Servers_Private_Key" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Protect the Servers Private Key</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


It is critical to protect the server's private key. The server private key is be encrypted by default as a means of protecting it, however having it encrypted means that the passphrase is required each time the server is started up, and now it is necessary to protect the passphrase as well. The passphrase may be typed in when it is manually started up, or provided by an automated program. See                                   <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslpassphrasedialog">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslpassphrasedialog</xhtml:a>


 for details.                            </xhtml:p>
                  <xhtml:p>To summarize the options are:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Use SSLPassPhraseDialog builtin, - Requires a passphrase to be manually entered.</xhtml:li>
                     <xhtml:li>Use SSLPassPhraseDialog |/path/to/program to provide the passphrase.</xhtml:li>
                     <xhtml:li>Use SSLPassPhraseDialog exec:/path/to/program to provide the passphrase,</xhtml:li>
                     <xhtml:li>Store the private key in clear text so that a passphrase is not required.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Any of the above options 1-4 are acceptable as long as the key and passphrase are protected as described below. Option 1 has the additional security benefit of not storing the passphrase, but is not generally acceptable for most production web servers, since it requires the web server to be manually started. Options 2 and 3 can provide additional security if the programs providing them are secure. Option 4 is the simplest, is widely used and is acceptable as long as the private key is appropriately protected.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: Not Applicable</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>If the private key were to be disclosed, it could be used to decrypt all of the SSL communications with the web server, and could also be used to impersonate the web server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


All private keys must be stored separately from the public certificates. Find all                                                     <xhtml:span class="inline_block">SSLCertificateFile</xhtml:span>


 directives in the Apache configuration files. For any                                                     <xhtml:span class="inline_block">SSLCertificateFile</xhtml:span>


 directives that do not have a corresponding separate                                                     <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>


 directive, move the key to a separate file from the certificate, and add the                                                     <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>


 directive for the key file.                                              </xhtml:li>
                           <xhtml:li>


For each the                                                     <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>


 directive, change the ownership and permissions on the server private key to owned by                                                     <xhtml:span class="inline_block">root:root</xhtml:span>


 with permission 0400.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_Disable_Weak_SSL_Protocols" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable Weak SSL Protocols</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The Apache SSLProtocol directive specifies the SSL and TLS protocols allowed. Both the SSLv2 and the SSLv3 protocols should be disabled in this directive as they are outdated and vulnerable to information disclosure. Only TLS protocols should be enabled.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The SSLv2 and SSLv3 protocols are flawed and shouldn't be used, as they are subject to man-in-the-middle attacks and other cryptographic attacks. The TLSv1 protocols should be used instead, and the newer TLS protocols should be preferred.</xhtml:p>
                  <xhtml:p>
                     <xhtml:em>The SSLv3 protocol was discovered to be vulnerable to the POODLE attack (Padding Oracle On Downgraded Legacy Encryption) in October 2014. The attack allows decryption and extraction of information from the server's memory. Due to this vulnerability disabling the SSLv3 protocol is highly recommended.</xhtml:em>
                  </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslprotocol</xccdf:ident>
               <xccdf:ident system="URL">http://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
               <xccdf:ident system="URL">https://www.us-cert.gov/ncas/alerts/TA14-290A</xccdf:ident>
               <xccdf:ident system="URL">https://www.openssl.org/~bodo/ssl-poodle.pdf</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>Search the Apache configuration files for the SSLProtocol directive; add the directive if not present, or change the value to match one of the following values. The first setting TLSv1.1 TLS1.2 is preferred when it it acceptable to also disable the TLSv1.0 protocol. See the level 2 recommendation "Disable the TLS v1.0 Protocol" for details.</xhtml:p>
                        <xhtml:code class="code_block">
SSLProtocol TLSv1.1 TLSv1.2 
</xhtml:code>
                        <xhtml:code class="code_block">SSLProtocol TLSv1
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_Restrict_Weak_SSL_Ciphers" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Weak SSL Ciphers</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Disable weak SSL ciphers using the SSLCipherSuite, and SSLHonorCipherOrder directives. The SSLCipherSuite directive specifies which ciphers are allowed in the negotiation with the client. While the SSLHonorCipherOrder causes the servers preferred ciphers to be used instead of the clients specified preferences.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The SSL/TLS protocols support a large number of encryption ciphers including many weak ciphers that are subject to man-in-the middle attacks and information disclosure. Some implementations even support the NULL cipher which allows a TLS connection without any encryption! Therefore, it is critical to ensure the configuration only allows strong ciphers greater than or equal to 128 bit to be negotiated with the client. Stronger 256-bit ciphers should be allowed and preferred. In addition, enabling the                                   <xhtml:span class="inline_block">SSLHonorCipherOrder</xhtml:span>


 further protects the client from man-in-the-middle downgrade attacks by ensuring the servers preferred ciphers will be used rather than the clients' preferences.                            </xhtml:p>
                  <xhtml:p>In addition, the RC4 ciphers are stream ciphers that are widely used and have even been recommended in previous Apache benchmarks as a means of mitigating attacks based on CBC cipher vulnerabilities. However, the RC4 ciphers also have known cryptographic weaknesses and are no longer recommended, and should be disabled. The IETF is working on a new draft proposed standard [4] that would disallow RC4 negotiation for all TLS versions. While the document is not yet an RFC (i.e. its not a standard yet), It is expect it will become one soon, and the RC4 cipher suites will begin to disappear from options in TLS deployments. In the meantime, it is important to ensure that RC4-based cipher suites as disabled in the configuration.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslciphersuite</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslhonorcipherorder</xccdf:ident>
               <xccdf:ident system="URL">http://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
               <xccdf:ident system="URL">https://datatracker.ietf.org/doc/draft-ietf-tls-prohibiting-rc4/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>Add or modify the following line in the Apache server level configuration and every virtual host that is SSL enabled:</xhtml:p>
                        <xhtml:code class="code_block">
SSLHonorCipherOrder On
SSLCipherSuite ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!MD5:!RC4 
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>FIPS Compliance</xhtml:strong>


: The above cipher suite specification may be used for servers that fall under FIPS 140-2 compliance requirements, SP800-52 provides guidelines for the TLS ciphers, because it eliminates the usage of the RC4 cipher and MD5 hash which are not deemed FIPS compliant.                                               <xhtml:strong>Disable SSLv3 Ciphers:</xhtml:strong>


 If the SSLv3 protocol has also been disabled as recommended, then the SSLv3 related ciphers will not be used, and could be removed from the cipher suite specification.                                        </xhtml:p>
                        <xhtml:code class="code_block">
SSLCipherSuite ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_Restrict_Insecure_SSL_Renegotiation" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Restrict Insecure SSL Renegotiation</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


There was a man-in-the-middle renegotiation attack discovered in SSLv3 and TLSv1 in Nov 2009 (CVE-2009-3555).                                   <xhtml:a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555</xhtml:a>
                     <xhtml:a href="http://www.phonefactor.com/sslgap/ssl-tls-authentication-patches">http://www.phonefactor.com/sslgap/ssl-tls-authentication-patches</xhtml:a>


 First a work around and then a fix was approved as an Internet Standard as RFC 574, Feb 2010. The work around which removes the renegotiation is available from OpenSSL as of version 0.9.8l and newer versions. For details:                                   <xhtml:a href="http://www.openssl.org/news/secadv_20091111.txt">http://www.openssl.org/news/secadv_20091111.txt</xhtml:a>


The                                   <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>


 directive was added in Apache 2.2.15 for web servers linked with OpenSSL version 0.9.8m or later, to allow the insecure renegotiation to provide backward compatibility to clients with the older unpatched SSL implementations. While providing backward compatibility, enabling the                                   <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>


 directive also leaves the server vulnerable to man-in-the-middle renegotiation attack CVE-2009-3555. Therefore, the                                   <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>


 directive should not be enabled.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The seriousness and ramification of this attack warrants that servers and clients be upgraded to support the improved SSL/TLS protocols. Therefore, the recommendation is to not enable the insecure renegotiation.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslinsecurerenegotiation </xccdf:ident>
               <xccdf:ident system="URL">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555  </xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Search the Apache configuration files for the                                                     <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>


 directive. If the directive is present, modify the value to be off. If the directive is not present, then no action is required.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  SSLInsecureRenegotiation off 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_SSL_Compression_is_Not_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure SSL Compression is Not Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The SSLCompression directive controls whether SSL compression is used by Apache when serving content over HTTPS. It is recommended that the SSLCompression directive be set to off.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>if SSL compression is enabled, HTTPS communication between the client and the server may be at increased risk to the CRIME attack. The CRIME attack increases a malicious actor's ability to derive the value of a session cookie, which commonly contains an authenticator. If the authenticator in a session cookie is derived, it can be used to impersonate the account associated with the authenticator.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslcompression</xccdf:ident>
               <xccdf:ident system="URL">http://en.wikipedia.org/wiki/CRIME_(security_exploit)</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Verify the Apache version is 2.2.24 or later, with the command "                                                     <xhtml:span class="inline_block">httpd -v</xhtml:span>


".                                              </xhtml:li>
                           <xhtml:li>Search the Apache configuration files for the SSLCompression directive.</xhtml:li>
                           <xhtml:li>


Add or update the directive to have a value of                                                     <xhtml:span class="inline_block">off</xhtml:span>


.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_Disable_the_TLS_v1.0_Protocol" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Disable the TLS v1.0 Protocol</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The TLSv1.0 protocol should be disabled via the SSLProtocol directive, if possible, as it has been shown to be vulnerable to information disclosure.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The TLSv1.0 protocol is vulnerable to the BEAST attack when used in CBC mode (October 2011). Unfortunately, the TLSv1.0 uses CBC modes for all of the block mode ciphers, which only leaves the RC4 streaming cipher. The RC4 cipher is not vulnerable to the BEAST attack; however, there is research that indicates it is also weak and is not recommended. Therefore, it is recommended that the TLSv1.0 protocol be disabled if all TLS clients support the newer TLS protocols. All major up-to-date browsers support TLSv1.1 and TLSv1.2; however, some older IE browsers (8,9,10) may still have TLSv1.1 and TLSv1.2 disabled for some strange reason. While Safari 6 does not support the newer TLS protocols. Review the Wikipedia reference for browser support details. Ensuring that all user's browsers are configured to allow TLSv1.1 and TLSv1.2 is necessary before disabling TLSv1.0 on the Apache web server; therefore, this recommendation is a level 2 rather than a level 1. Disabling TLSv1.0 on internal only websites is more easily accomplished when access is limited to clients with browsers controlled by the organization policies and procedures to allow and prefer TLSv1.1 and higher.</xhtml:p>
                  <xhtml:p>The NIST SP 800-52r1 guidelines for TLS configuration state that servers that support government-only applications shall not support TLSv1.0 or any of the SSL protocols. While Servers that support citizen or business-facing applications may be configured to support TLS version 1.0 in order to enable interaction with citizens and businesses. Also it is important to note that Microsoft support for all older versions of IE ends January 12, 2016, and Apple ends support for Safari 6 with the fall release if OS X 10.11. So it is wise to plan for usage of TLSv1.0 to be eliminated in 2016.</xhtml:p>
                  <xhtml:p>Some organizations may find it helpful to implement a phased transitional plan where TLSv1.0 is not disabled, but the web server will detect browsers which do not have TLSv1.1 or newer enabled and redirect them to a web site that explains how to enabled the newer TLS protocols. The redirect can be implemented using the mod_rewrite which can detect the protocol used, and rewrite the URL to the helpful website.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://en.wikipedia.org/wiki/Transport_Layer_Security#Web_browsers - Browser support and defaults for SSL/TLS protocols </xccdf:ident>
               <xccdf:ident system="URL">https://community.qualys.com/blogs/securitylabs/2013/09/10/is-beast-still-a-threat</xccdf:ident>
               <xccdf:ident system="URL">http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r1.pdf </xccdf:ident>
               <xccdf:ident system="URL">https://support.microsoft.com/en-us/gp/microsoft-internet-explorer</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>


Search the Apache configuration files for the SSLProtocol directive; add the directive if not present, or change the value to                                               <xhtml:span class="inline_block">TLSv1.1 TLSv1.2</xhtml:span>


.                                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.9_Enable_OCSP_Stapling" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Enable OCSP Stapling</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The OCSP (Online Certificate Status Protocol) provides the current revocation status of an X.509 certificate and allows for a certificate authority to revoke the validity of a signed certificate before its' expiration date. The URI for the OCSP server is included in the certificate and verified by the browser. The Apache                                   <xhtml:span class="inline_block">SSLUseStapling</xhtml:span>


 directive along with the                                   <xhtml:span class="inline_block">SSLStaplingCache</xhtml:span>


 directive are recommended to enable OCSP Stapling by the web server. If the client requests OCSP stapling, then the web server can include the OCSP server response along with the web server's X.509 certificate.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The OCSP protocol is a big improvement over CRLs (certificate revocation lists) for checking if a certificate has been revoked. There are however some minor privacy and efficiency concerns with OCSP. The fact that the browser has to check a third party CA discloses that the browser is configured for OCSP checking. Also the already high overhead of making an SSL connection is increased by the need for the OCSP requests and responses. The OCSP stapling improves the situation by having the SSL server "staple" an OCSP response, signed by the OCSP server, to the certificate it presents to the client. This obviates the need for the client to ask the OCSP server for status information on the server certificate. However, the client will still need to make OCSP requests on any intermediate CA certificates that are typically used to sign the server's certificate.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://en.wikipedia.org/wiki/OCSP_stapling - OCSP Stapling</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html - Apache SSL Directives</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state: Add or modify the SSLUseStapling directive to have a value of "on" in the Apache server level configuration and every virtual host that is SSL enabled. Also ensure that SSLStaplingCache is set to one of the three cache types similar to the examples below.</xhtml:p>
                        <xhtml:code class="code_block">
SSLUseStapling On
SSLStaplingCache "shmcb:logs/ssl_staple_cache(512000)"
- or- 
SSLStaplingCache "dbm:logs/ssl_staple_cache.db"
- or -
SSLStaplingCache dc:UNIX:logs/ssl_staple_socket   
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.10_Enable_HTTP_Strict_Transport_Security" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Enable HTTP Strict Transport Security</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>HTTP Strict Transport Security (HSTS) is an optional web server security policy mechanism specified by an HTTP Server header. The HSTS header allows a server declaration that only HTTPS communication should be used rather than clear text HTTP communication.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Usage of HTTP Strict Transport Security (HSTS) helps protect HSTS compliant browsers and other agents from HTTP downgrade attacks. Downgrade attacks include a variety of man-in-the-middle attacks which leave the web communication vulnerable to disclosure and modification by forcing the usage of HTTP rather than HTTPS communication. The                                   <xhtml:span class="inline_block">sslstrip</xhtml:span>


 attack tool by Moxie Marlinspike released in 2009 is one such attack, which works when the server allows both HTTP and HTTPS communication. However, a man-in-the-middle HTTP-to-HTTPS proxy would be effective in cases where the server required HTTPS, but did not publish an HSTS policy to the browser. This attack would also be effective on browsers which were not compliant with HSTS. All current up-to-date browsers support HSTS.                            </xhtml:p>
                  <xhtml:p>The HSTS header specifies a length of time in seconds that the browser / user agent should access the server only using HTTPS. The header may also specify if all sub-domains should also be included in the same policy. Once a compliant browser receives the HSTS Header it will not allow access to the server via HTTP. Therefore, it is important that you ensure that there is no portion of the web site or web application that requires HTTP prior to enabling the HSTS protocol.</xhtml:p>
                  <xhtml:p>


If all sub-domains are to be included via the                                   <xhtml:em>includeSubDomains</xhtml:em>


 option, then carefully consider all various host names, web applications and third party services used to include any DNS CNAME values that may be impacted. An overly broad                                   <xhtml:em>includeSubDomains</xhtml:em>


 policy will disable access to HTTP web sites for all websites with the same domain name. Also consider that the access will be disabled for the number of seconds given in the max-age value, so in the event a mistake is made, a large value, such as a year, could create significant support issues. An optional flag of preload may be added if the web site name is to be submitted to be preloaded in Chrome, Firefox and Safari browsers. See                                   <xhtml:a href="https://hstspreload.appspot.com/">https://hstspreload.appspot.com/</xhtml:a>


 for details.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security</xccdf:ident>
               <xccdf:ident system="URL">https://www.owasp.org/index.php/HTTP_Strict_Transport_Security</xccdf:ident>
               <xccdf:ident system="URL">http://www.thoughtcrime.org/software/sslstrip/</xccdf:ident>
               <xccdf:ident system="URL">https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security</xccdf:ident>
               <xccdf:ident system="URL">https://hstspreload.appspot.com/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>


Add a Header directive as shown below in the Apache server level configuration and every virtual host that is SSL enabled. The                                               <xhtml:span class="inline_block">includeSubDomains</xhtml:span>


 and                                               <xhtml:span class="inline_block">preload</xhtml:span>


 flags may be included in the header, but are not required.                                        </xhtml:p>
                        <xhtml:code class="code_block">
Header always set Strict-Transport-Security "max-age=600; includeSubDomains; preload
</xhtml:code>
                        <xhtml:p>- or -</xhtml:p>
                        <xhtml:code class="code_block">
Header always set Strict-Transport-Security "max-age=600
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8_Information_Leakage">
            <xccdf:title xml:lang="en">Information Leakage</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section are intended to limit the disclosure of potentially sensitive information.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.1_Set_ServerToken_to_Prod" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set ServerToken to 'Prod'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Configure the Apache                                   <xhtml:span class="inline_block">ServerTokens</xhtml:span>


 directive to provide minimal information. By setting the value to                                   <xhtml:span class="inline_block">Prod</xhtml:span>


 or                                   <xhtml:span class="inline_block">ProductOnly</xhtml:span>


. The only version information given in the server HTTP response header will be "                                  <xhtml:span class="inline_block">Apache</xhtml:span>


" rather than providing details on modules and versions installed.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


The default value is                                         <xhtml:span class="inline_block">Full</xhtml:span>


 which provides the most detailed information.                                  </xhtml:p>
                     <xhtml:p>
                        <xhtml:span class="inline_block"> ServerTokens Full</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Information is power, and identifying web server details greatly increases the efficiency of any attack, as security vulnerabilities are extremely dependent upon specific software versions and configurations. Excessive probing and requests may cause too much "noise" being generated and may tip off an administrator. If an attacker can accurately target their exploits, the chances of successful compromise prior to detection increase dramatically. Script Kiddies are constantly scanning the Internet and documenting the version information openly provided by web servers. The purpose of this scanning is to accumulate a database of software installed on those hosts, which can then be used when new vulnerabilities are released.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#servertokens</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">ServerTokens</xhtml:span>


 directive as shown below to have the value of                                                     <xhtml:span class="inline_block">Prod</xhtml:span>


 or                                                     <xhtml:span class="inline_block">ProductOnly</xhtml:span>


:                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ServerTokens Prod
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2_Set_ServerSignature_to_Off" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set ServerSignature to 'Off'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Disable the server signatures which generates a signature line as a trailing footer at the bottom of server generated documents such as error pages.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


The default value is                                         <xhtml:span class="inline_block">Off</xhtml:span>


 for                                         <xhtml:span class="inline_block">ServerSignature</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Server signatures are helpful when the server is acting as a proxy, since it helps the user distinguish errors from the proxy rather than the destination server, however in this context there is no need for the additional information and we want to limit leakage of unnecessary information.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#serversignature</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">ServerSignature</xhtml:span>


 directive as shown below to have the value of                                                     <xhtml:span class="inline_block">Off</xhtml:span>


:                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  ServerSignature Off
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3_Information_Leakage_via_Default_Apache_Content" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Information Leakage via Default Apache Content</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>In previous recommendations we have removed default content such as the Apache manuals and default CGI programs. However, if you want to further restrict information leakage about the web server, it is important that default content such as icons are not left on the web server.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value: The default source build does not enable access to the Apache icons</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


To identify the type of web servers and versions software installed it is common for attackers to scan for icons or special content specific to the server type and version. A simple request like                                   <xhtml:a href="http://example.com/icons/apache_pb2.png">http://example.com/icons/apache_pb2.png</xhtml:a>


 may tell the attacker that the server is Apache 2.2 as shown below. The many icons are used primarily for auto indexing, which is recommended to be disabled.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either of the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The default source build places the auto-index and icon configurations in the                                                     <xhtml:span class="inline_block">extra/httpd-autoindex.conf</xhtml:span>


 file, so it can be disabled by leaving the include line commented out in the main                                                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>


 file as shown below.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # Fancy directory listings
  #Include conf/extra/httpd-autoindex.conf 
  
</xhtml:code>
                        <xhtml:ol start="2">
                           <xhtml:li>


Alternatively, the icon                                                     <xhtml:span class="inline_block">alias</xhtml:span>


 directive and the directory access control configuration can be commented out as shown:                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">  # We include the /icons/ alias for FancyIndexed directory listings. If
  # you do not use FancyIndexing, you may comment this out.
  #
  #Alias /icons/ "/var/www/icons/"
  
  #&lt;Directory "/var/www/icons"&gt;
  #     Options Indexes MultiViews FollowSymLinks
  #     AllowOverride None
  #     Order allow,deny
  #     Allow from all
  #&lt;/Directory&gt; 
  
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_9_Denial_of_Service_Mitigations">
            <xccdf:title xml:lang="en">Denial of Service Mitigations</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Denial of Service (DoS) attacks intend to degrade a service's ability to process and respond to service requests. Typically, DoS attacks attempt to exhaust the service's network-, CPU-, disk-, and/or memory- related resources. Configuration states in this section may increase a server's resiliency to DoS attacks.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.1_Set_the_TimeOut_to_10_or_less" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the TimeOut to 10 or less</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">TimeOut </xhtml:span>


directive controls the maximum time in seconds that Apache HTTP server will wait for an Input/Output call to complete. It is recommended that the                                   <xhtml:span class="inline_block">TimeOut </xhtml:span>


directive be set to 10 or less.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value:                                         <xhtml:span class="inline_block">Timeout 300</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


One common technique for DoS is to initiate many connections to the server. By decreasing the timeout for old connections, the server can free resources more quickly and be more responsive. By making the server more efficient, it will be more resilient to DoS conditions.                                   <xhtml:strong>Important Notice</xhtml:strong>


: There is a slow form of DoS attack not adequately mitigated by these control, such as the Slow Loris DoS attack of June 2009                                   <xhtml:a href="http://ha.ckers.org/slowloris/">http://ha.ckers.org/slowloris/</xhtml:a>


. Upgrading to Apache 2.4 is recommended.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#timeout</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>Add or modify the Timeout directive in the Apache configuration to have a value of 10 seconds or shorter.</xhtml:p>
                        <xhtml:code class="code_block">
Timeout 10
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.2_Set_the_KeepAlive_to_On" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the KeepAlive to On</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The ``KeepAlive                                  <xhtml:span class="inline_block"></xhtml:span>


directive controls whether Apache will reuse the same TCP connection per client to process subsequent HTTP requests from that client. It is recommended that the                                   <xhtml:span class="inline_block">KeepAlive </xhtml:span>


directive be set to                                   <xhtml:span class="inline_block">On</xhtml:span>


.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value:                                         <xhtml:span class="inline_block">KeepAlive On</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Allowing per-client reuse of TCP sockets reduces the amount of system and network resources required to serve requests. This efficiency gain may improve a server's resiliency to DoS attacks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#keepalive</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>Add or modify the KeepAlive directive in the Apache configuration to have a value of On, so that KeepAlive connections are enabled.</xhtml:p>
                        <xhtml:code class="code_block">
KeepAlive On
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.3_Set_the_MaxKeepAliveRequests_to_100_or_greater" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the MaxKeepAliveRequests to 100 or greater</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">MaxKeepAliveRequests</xhtml:span>


 directive limits the number of requests allowed per connection when                                   <xhtml:span class="inline_block">KeepAlive</xhtml:span>


 is on. If it is set to 0, unlimited requests will be allowed. It is recommended that the                                   <xhtml:span class="inline_block">MaxKeepAliveRequests</xhtml:span>


 directive be set to 100 or greater.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value:                                         <xhtml:span class="inline_block">MaxKeepAliveRequests 100</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Allowing per-client reuse of TCP sockets reduces the amount of system and network resources required to serve requests. This efficiency gain may improve a server's resiliency to DoS attacks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#maxkeepaliverequests</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>


Add or modify the                                               <xhtml:span class="inline_block">MaxKeepAliveRequests </xhtml:span>


directive in the Apache configuration to have a value of 100 or more.                                        </xhtml:p>
                        <xhtml:code class="code_block">
MaxKeepAliveRequests 100
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.4_Set_the_KeepAliveTimeout_to_15_or_less" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the KeepAliveTimeout to 15 or less</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">KeepAliveTimeout</xhtml:span>


 directive specifies the number of seconds Apache will wait for a subsequent request before closing a connection that is being kept alive.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value:                                         <xhtml:span class="inline_block"> KeepAliveTimeout 15</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Reducing the number of seconds that Apache HTTP server will keep unused resources allocated for will increase the availability of resources to serve other requests. This efficiency gain may improve a server's resiliency to DoS attacks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#keepalivetimeout</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>Add or modify the KeepAliveTimeout directive in the Apache configuration to have a value of 15 or less.</xhtml:p>
                        <xhtml:code class="code_block">
KeepAliveTimeout 15
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.5_Set_Timeout_Limits_for_Request_Headers" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set Timeout Limits for Request Headers</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>


 directive allows configuration of timeout limits for client requests. The header portion of the directive provides for an initial timeout value, a maximum timeout and a minimum rate. The minimum rate specifies that after the initial timeout, the server will wait an additional 1 second for each N bytes received. The recommended setting is to have a maximum timeout of 40 seconds or less. Keep in mind that for SSL/TLS virtual hosts the time for the TLS handshake must fit within the timeout.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Setting a request header timeout is vital for mitigating Denial of Service attacks based on slow requests. The slow request attacks are particularly lethal and relative easy to perform, because they require very little bandwidth and can easily be done through anonymous proxies. Starting in June 2009 with the Slow Loris DoS attack, which used a slow GET request, was published by Robert Hansen (RSnake) on his blog                                   <xhtml:a href="http://ha.ckers.org/slowloris/">http://ha.ckers.org/slowloris/</xhtml:a>


. Later in November 2010 at the OWASP App Sec DC conference Wong Onn Chee demonstrated a slow POST request attack which was even more effective. See                                   <xhtml:a href="https://www.owasp.org/index.php/H.....t.....t....p.......p....o....s....t">https://www.owasp.org/index.php/H.....t.....t....p.......p....o....s....t</xhtml:a>


 for details.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://ha.ckers.org/slowloris/</xccdf:ident>
               <xccdf:ident system="URL">https://www.owasp.org/index.php/H.....t.....t....p.......p....o....s....t</xccdf:ident>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_reqtimeout.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>


Load the                                                     <xhtml:span class="inline_block">mod\_requesttimeout</xhtml:span>


 module in the Apache configuration with the following configuration.                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
LoadModule reqtimeout_module modules/mod_reqtimeout.so
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>


Add a                                                     <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>


 directive similar to the one below with the maximum request header timeout value of 40 seconds or less.                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.6_Set_Timeout_Limits_for_the_Request_Body" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set Timeout Limits for the Request Body</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>


 directive also allows setting timeout values for the body portion of a request. The directive provides for an initial timeout value, and a maximum timeout and minimum rate. The minimum rate specifies that after the initial timeout, the server will wait an additional 1 second for each N bytes received. The recommended setting is to have a maximum timeout of 20 seconds or less. The default value is body=20,MinRate=500.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is not sufficient to timeout only on the header portion of the request, as the server will still be vulnerable to attacks like the OWASP Slow POST attack, which provide the body of the request very slowly. Therefore, the body portion of the request must have a timeout as well. A timeout of 20 seconds or less is recommended.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_reqtimeout.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Load the mod_requesttimeout module in the Apache configuration with the following configuration.</xhtml:p>
                        <xhtml:code class="code_block">
LoadModule reqtimeout_module modules/mod_reqtimeout.so
</xhtml:code>
                        <xhtml:p>


Add a                                               <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>


 directive similar to the one below with the maximum request body timeout value of 20 seconds or less.                                        </xhtml:p>
                        <xhtml:code class="code_block">
RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_10_Request_Limits">
            <xccdf:title xml:lang="en">Request Limits</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section reduce the maximum allowed size of request parameters. Doing so increases the likelihood of negatively impacting application and/or site functionality. It is highly recommended that the configuration states described in this section be tested on test servers prior deploying them to production servers.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.1_Set_the_LimitRequestLine_directive_to_512_or_less" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the LimitRequestLine directive to 512 or less</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LimitRequestLine </xhtml:span>


directive sets the maximum number of bytes that Apache will read for each line of an HTTP request. It is recommended that the                                   <xhtml:span class="inline_block">LimitRequestLine </xhtml:span>


be set to 512 or less.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>
                        <xhtml:span class="inline_block">LimitRequestline 8190 </xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Limiting request line size may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestline</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>


Add or modify the                                               <xhtml:span class="inline_block">LimitRequestLine</xhtml:span>


 directive in the Apache configuration to have a value of 512 or shorter.                                        </xhtml:p>
                        <xhtml:code class="code_block">
LimitRequestLine 512
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.2_Ensure_the_LimitRequestFields_directive_is_set_to_100_or_less" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the LimitRequestFields directive is set to 100 or less</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LimitRequestFields</xhtml:span>


 directive sets the maximum limit on the number of HTTP request headers allowed per request. It is recommended that the                                   <xhtml:span class="inline_block">LimitRequestFields </xhtml:span>


directive be set to 100 or less.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>
                        <xhtml:span class="inline_block">LimitRequestFields 100 </xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Limiting the number of headers per request may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestfields</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">LimitRequestFields</xhtml:span>


 directive in the Apache configuration to have a value of 100 or less. If the directive is not present the default depends on a compile time configuration, but defaults to a value of 100.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">
LimitRequestFields 100
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.3_Set_the_LimitRequestFieldsize_directive_to_1024_or_less" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the LimitRequestFieldsize directive to 1024 or less</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LimitRequestFieldSize </xhtml:span>


directive sets the maximum size of an HTTP request header field. It is recommended that the                                   <xhtml:span class="inline_block">LimitRequestFieldSize </xhtml:span>


directive be set to 1024 or less.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Default Value:</xhtml:p>
                     <xhtml:p>LimitRequestFieldsize 8190</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Limiting header field size may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestfieldsize</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Add or modify the                                                     <xhtml:span class="inline_block">LimitRequestFieldsize</xhtml:span>


 directive in the Apache configuration to have a value of 1024 or less.                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.4_Set_the_LimitRequestBody_directive_to_102400_or_less" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Set the LimitRequestBody directive to 102400 or less</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">LimitRequestBody</xhtml:span>


 directive sets the maximum size of an HTTP request body. It is recommended that the                                   <xhtml:span class="inline_block">LimitRequestBody</xhtml:span>


 directive be set to 102400 or less.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Default Value: The following are the default values:                                         <xhtml:span class="inline_block">LimitRequestline 8190 LimitRequestFields 100 LimitRequestFieldsize 8190 LimitRequestBody 0 (unlimited)</xhtml:span>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Limiting request body size may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestbody</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:p>


Add or modify the                                               <xhtml:span class="inline_block">LimitRequestBody</xhtml:span>


 directive in the Apache configuration to have a value of 102400 (100K) or less. Please read the Apache documentation so that it is understood that this directive will limit the size of file up-loads to the web server.                                        </xhtml:p>
                        <xhtml:code class="code_block">
LimitRequestBody 102400
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_11_Enable_SELinux_to_Restrict_Apache_Processes">
            <xccdf:title xml:lang="en">Enable SELinux to Restrict Apache Processes</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section provide mandatory access controls (MAC) using the SELinux kernel module in targeted mode. SELinux provides additional enforced security which will prevent access to resources, files and directories by the httpd processes even in cases where an application or server vulnerability might allow inappropriate access. The SELinux controls are advanced security controls that require significant effort to ensure they do not negatively impact the application and/or site functionality. It is highly recommended that the configuration states described in this section be tested thoroughly on test servers prior to deploying them to production servers.</xhtml:p>
               <xhtml:p>SELinux and AppArmor provide similar controls, and it is not recommended to use both SELinux and AppArmor on the same system. Depending on which Linux distribution is in use either AppArmor or SELinux are likely to be already installed or readily available as packages. AppArmor differs from SELinux in that it binds the controls to programs rather than users and uses path names rather than labeled type enforcement.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.1_Enable_SELinux_in_Enforcing_Mode" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Enable SELinux in Enforcing Mode</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SELinux (Security-Enhanced Linux) is a Linux kernel security module that provides mandatory access control security policies with type enforcement that are checked after the traditional discretionary access controls. It was created by the US National Security Agency and can enforce rules on files and processes in a Linux system, and restrict actions, based on defined policies.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Web applications and services continue to be one of the leading attack vectors for black-hat criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The SELinux mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model which only allows what is explicitly permitted.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://en.wikipedia.org/wiki/Security-Enhanced_Linux</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Perform the following to implement the recommended state: If SELinux is not enabled in the configuration file, edit the file                                              <xhtml:span class="inline_block"> /etc/selinux/config</xhtml:span>


 and set the value of SELINUX as                                               <xhtml:span class="inline_block">enforcing</xhtml:span>


 and reboot the system for the new configuration to be effective.                                        </xhtml:p>
                        <xhtml:code class="code_block">
SELINUX=enforcing
</xhtml:code>
                        <xhtml:p>


If the current mode is not enforcing, and an immediate reboot is not possible, the current mode can be set to enforcing with the                                               <xhtml:span class="inline_block">setenable</xhtml:span>


 command shown below.                                        </xhtml:p>
                        <xhtml:code class="code_block">
# setenforce 1
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.2_Run_Apache_Processes_in_the_httpd_t_Confined_Context" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Run Apache Processes in the httpd_t Confined Context</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SELinux includes customizable targeted policies that may be used to confine the Apache httpd server to enforce least privileges so that the httpd server has only the minimal access to specified directories, files and network ports. Access is controlled by process types (domains) defined for the httpd process. There are over a hundred individual httpd related types defined in a default Apache SELinux policy which includes many of the common Apache add-ons and applications such as php, nagios, smokeping and many others. The default SELinux policies work well for a default Apache installation, but implementation of SELinux targeted polices on a complex or highly customized web server requires a rather significant development and testing effort which comprehends both the workings of SELinux and the detailed operations and requirements of the web application. All directories and files to be accessed by the web server process must have security labels with appropriate types. The following types are a sample of the most commonly used:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>http_port_t - Network ports allowed for listening</xhtml:li>
                     <xhtml:li>httpd_sys_content_t - Read access to directories and files with web content</xhtml:li>
                     <xhtml:li>httpd_log_t - Directories and files to be used for writable log data</xhtml:li>
                     <xhtml:li>httpd_sys_script_exec_t - Directories and files for executable content.</xhtml:li>
                  </xhtml:ul>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>With the proper implementation of SELinux, vulnerabilities in the web application may be prevented from being exploited due to the additional restrictions. For example, a vulnerability that allows an attacker to read to inappropriate system files may be prevented from execution by SELinux because the inappropriate files are not labeled as httpd_sys_content_t. Likewise writing to an unexpected directory or execution of unexpected content can be prevented by similar mandatory security labels enforced by SELinux.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>If the running httpd processes are not confined to the httpd_t SELinux context. Then check the context for the httpd binary and the apachectl binary, and set the httpd binary to have a context of httpd_exec_t and the apachectl executable should have a context of initrc_exec_t as shown below. Also note that on some platforms such as Ubuntu, the Apache executable is named apache2 instead of httpd. Also note that on some platforms such as Ubuntu, the Apache executable is named apache2 instead of httpd.</xhtml:p>
                        <xhtml:code class="code_block">
# ls -alZ /usr/sbin/httpd /usr/sbin/httpd.* /usr/sbin/apachectl
-rwxr-xr-x. root root system_u:object_r:initrc_exec_t:s0 /usr/sbin/apachectl
-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd
-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd.worker
-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd.event
</xhtml:code>
                        <xhtml:p>If the executable files are not labeled correctly, they may be relabeled with the chcon command, as shown, however the file system labeling is based on the SELinux file context polices and the file systems will on some occasions be relabeled according to the policy.</xhtml:p>
                        <xhtml:code class="code_block">
# chcon -t initrc_exec_t /usr/sbin/apachectl
# chcon -t httpd_exec_t /usr/sbin/httpd /usr/sbin/httpd.*   
</xhtml:code>
                        <xhtml:p>Since the file system may be relabeled based on SELinux policy, it's best to check the SELinux policy with semanage fcontext "-l" option. If the policy is not present, then add the pattern to the policy using the "-a" option. The restorecon command shown below will restore the file context label according to the current policy, and is required if a pattern was added.</xhtml:p>
                        <xhtml:code class="code_block">
# ### Check the Policy 
# semanage fcontext -l | fgrep 'apachectl'
/usr/sbin/apachectl regular file system_u:object_r:&lt;strong&gt;initrc_exec_t&amp;amp;lt;/strong&gt;:s0 
# semanage fcontext -l | fgrep '/usr/sbin/httpd'
/usr/sbin/httpd regular file system_u:object_r:&lt;strong&gt;httpd_exec_t&amp;amp;lt;/strong&gt;:s0 
/usr/sbin/httpd.worker regular file system_u:object_r:&lt;strong&gt;httpd_exec_t&amp;amp;lt;/strong&gt;:s0
/usr/sbin/httpd.event regular file system_u:object_r:&lt;strong&gt;httpd_exec_t&amp;amp;lt;/strong&gt;:s0 
# ### Add to the policy, if not present
# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd'
# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd.worker'
# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd.event'
# semanage fcontext -f -- -a -t initrc_exec_t /usr/sbin/apachectl

# ### Restore the file labeling accord to the SELinux policy
# restorecon -v /usr/sbin/httpd /usr/sbin/httpd.* /usr/sbin/apachectl   
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.3_Ensure_the_httpd_t_Type_is_Not_in_Permissive_Mode" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the httpd_t Type is Not in Permissive Mode</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>In addition to setting the entire SELinux configuration in permissive mode, it is possible to set individual process types (domains) such as httpd_t into a permissive mode as well. The permissive mode will not prevent any access or actions, instead, any actions that would have been denied are simply logged.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Usage of the permissive mode is helpful for testing and ensuring that SELinux will not prevent access that is necessary for the proper function of a web application. However all access is allowed in permissive mode by SELinux.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/sect-Security-Enhanced_Linux-Fixing_Problems-Permissive_Domains.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Perform the following to implement the recommended state: If the http_t type is in permissive mode, the customized permissive mode should be deleted with the following                                               <xhtml:span class="inline_block">semanage</xhtml:span>


 command.                                        </xhtml:p>
                        <xhtml:code class="code_block">
# semanage permissive -d httpd_t 
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.4_Ensure_Only_the_Necessary_SELinux_Booleans_are_Enabled" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure Only the Necessary SELinux Booleans are Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SELinux booleans allow or disallow behavior specific to the Apache web server. Common examples include whether CGI execution is allowed, or if the httpd server is allowed to communicate with the current terminal (tty). Communication with the terminal, may be necessary for entering a passphrase during start up to decrypt a private key.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enabling only the necessary httpd related booleans provides a defense in depth approach, that will deny actions that are not in use or expected.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/sect-Security-Enhanced_Linux-Working_with_SELinux-Booleans.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>To disable the SELinux httpd booleans that are determined to be unnecessary, use the setsebool command as shown below with the "-P" option to make the change persistent.</xhtml:p>
                        <xhtml:code class="code_block">
# &lt;strong&gt;setsebool -P httpd_enable_cgi off&amp;amp;lt;/strong&gt;
# &lt;strong&gt;getsebool httpd_enable_cgi&amp;amp;lt;/strong&gt; 
httpd_enable_cgi --&gt; off
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_12_Enable_AppArmor_to_Restrict_Apache_Processes">
            <xccdf:title xml:lang="en">Enable AppArmor to Restrict Apache Processes</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Recommendations in this section provide mandatory access controls (MAC) using the AppArmor kernel module. AppArmor provides additional enforced security which will prevent access to resources, files and directories by the apache2 processes even in cases where an application or server vulnerability might allow inappropriate access. The AppArmor controls are advanced security controls that require significant effort to ensure they do not negatively impact the application and/or site functionality. It is highly recommended that the configuration states described in this section be tested thoroughly on test servers prior to deploying them to production servers. AppArmor and SELinux provide similar controls, and it is not recommended to use both SELinux and AppArmor on the same system. Depending on which Linux distribution is in use either AppArmor or SELinux are likely to be already installed or readily available as packages. AppArmor differs from SELinux in that it binds the controls to programs rather than users and uses path names rather than labeled type enforcement.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_12.1_Enable_the_AppArmor_Framework" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Enable the AppArmor Framework</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>AppArmor is a Linux kernel security module that provides a named based mandatory access control with security policies. AppArmor can enforce rules on programs for file access and network connections and restrict actions based on defined policies.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Web applications and web services continue to be one of the leading attack vectors for black-hat criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The AppArmor mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model which only allows what is explicitly permitted.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://help.ubuntu.com/community/AppArmor</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>If the aa-status command is not found, then the AppArmor package is not installed and needs to be installed using the appropriate the Linux distribution package management. For example:</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# apt-get install apparmor
# apt-get install libapache2-mod-apparmor
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>To enable the AppArmor framework run the init.d script as shown below.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# /etc/init.d/apparmor start
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_12.2_Customize_the_Apache_AppArmor_Profile" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Customize the Apache AppArmor Profile</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


AppArmor includes customizable profiles that may be used to confine the Apache web server to enforce least privileges so that the server has only the minimal access to specified directories, files and network ports. Access is controlled by a profile defined for the apache2 process. The default AppArmor profile is typically a very permissive profile that allows read-write access to all system files. Therefore it's important that the default profile be customized to enforce least privileges. The AppArmor utilities such as                                   <xhtml:span class="inline_block">aa-autodep</xhtml:span>


,                                   <xhtml:span class="inline_block">aa-complain</xhtml:span>


, and                                  <xhtml:span class="inline_block"> aa-logprof</xhtml:span>


 can be used to generate an initial profile based on actual usage. However thorough testing, review and customization will be necessary to ensure that the Apache profile restrictions allow necessary functionality while implementing least privilege.                            </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>With the proper implementation of AppArmor profile, vulnerabilities in the web application may be prevented from being exploited due to the additional restrictions. For example a vulnerability that allows an attacker to read an inappropriate system files may be prevented from execution by AppArmor because the inappropriate files are not allowed by the profile. Likewise writing to an unexpected directory or execution of unexpected content can be prevented by similar mandatory security controls enforced by AppArmor.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident system="URL">https://wiki.ubuntu.com/AppArmor</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>Stop the Apache server</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# service apache2 stop
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Create a mostly empty apache2 profile based on program dependencies.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# aa-autodep apache2
Writing updated profile for /usr/sbin/apache2.
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Set the apache2 profile in complain mode so that access violations will be allowed, and will be logged.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# aa-complain apache2
Setting /usr/sbin/apache2 to complain mode.
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Start the apache2 service</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# service apache2 start
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Throughly test the web application attempting to exercise all intended functionality so that AppArmor will generate the necessary logs of all resources accessed. The logs are sent via the system syslog utility, and are typically found in either the /var/log/syslog or /var/log/messages files. Also stop and restart the web server as part of the testing process.</xhtml:li>
                           <xhtml:li>


Use                                                     <xhtml:span class="inline_block">aa-logprof</xhtml:span>


 to update the profile based on logs generated during the testing. The tool will prompt for suggested modifications to the profile, based on the logs. The logs may also be reviewed manually in order to update the profile.                                              </xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# aa-logprof
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Review and edit the profile, removing any inappropriate content, and adding appropriate access rules. Directories with multiple files accessed with the same permission can be simplified with the usage of wild-cards when appropriate. Reload the updated profile using the apparmor_parser command.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# apparmor_parser -r /etc/apparmor.d/usr.sbin.apache2
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Test the new updated profile again checking for any new apparmor denied logs generated. Update and reload the profile as necessary. Repeat the application tests, until no new apparmor deny logs are created, except for access which should be prohibited.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# tail -f /var/log/syslog
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Set the apache2 profile to enforce mode, reload apparmor, and then test the web site functionality again.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# aa-enforce /usr/sbin/apache2
# /etc/init.d/apparmor reload
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_12.3_Ensure_Apache_AppArmor_Profile_is_in_Enforce_Mode" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Apache AppArmor Profile is in Enforce Mode</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>AppArmor profiles may be in one of three modes: disabled, complain or enforce. In the complain mode, any violations of the access controls are logged but the restrictions are not enforced. Also once a profile mode has been changed, it is recommended to restart the Apache server, otherwise the currently running process may not be confined by the policy.</xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The complain mode is useful for testing and debugging a profile, but is not appropriate for production. Only the confined process running in enforce mode will prevent attacks that violate the configured access controls.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>Set the profile state to enforce mode.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# aa-enforce apache2
Setting /usr/sbin/apache2 to enforce mode.
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Stop the Apache server, and confirm that is it not running. In some cases the AppArmor controls may prevent the web server from stopping properly, and it may be necessary to stop the process manually or even reboot the server.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# service apache2 stop
 * Stopping web server apache2 
# service apache2 status
 * apache2 is not running
</xhtml:code>
                        <xhtml:ul>
                           <xhtml:li>Restart the Apache service.</xhtml:li>
                        </xhtml:ul>
                        <xhtml:code class="code_block">
# service apache2 start
 * Starting web server apache2
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
      </xccdf:Benchmark>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_3.4.0_CIS_Apache_HTTP_Server_2.2_Benchmark_imported-oval" timestamp="2024-09-24T14:19:51">
      <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://oval.cisecurity.org/schemas/validator-oval-definitions-5.11.2.xsd">
         <generator>
            <oval:product_name>Center for Internet Security - Optimus</oval:product_name>
            <oval:schema_version>5.11.2</oval:schema_version>
            <oval:timestamp>2024-09-24T14:19:47.606Z</oval:timestamp>
         </generator>
         <definitions>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:def:27577" version="1">
               <metadata>
                  <title>Enable the Log Config Module</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.2_Enable_the_Log_Config_Module" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.2_Enable_the_Log_Config_Module"></reference>
                  <description>Enable the Log Config Module</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:tst:27577"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:def:27578" version="1">
               <metadata>
                  <title>Disable WebDAV Modules</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.3_Disable_WebDAV_Modules" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.3_Disable_WebDAV_Modules"></reference>
                  <description>Disable WebDAV Modules</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:tst:27578"></criterion>
               </criteria>
            </definition>
         </definitions>
         <tests>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure the log_config module is loaded" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:tst:27577" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:obj:27577"></object>
               <state state_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:ste:27577"></state>
            </shellcommand_test>
            <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" check="all" check_existence="at_least_one_exists" comment="Ensure the WebDav modules are correctly disabled." id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:tst:27578" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:obj:27578"></object>
               <state state_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:ste:27578"></state>
            </shellcommand_test>
         </tests>
         <objects>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure the log_config module is loaded" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:obj:27577" version="1">
               <command>httpd -M | grep log_config</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
            <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure the WebDav modules are correctly disabled." id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:obj:27578" version="1">
               <command>httpd -M | grep ' dav_[[:print:]]+module'</command>
               <line_selection operation="pattern match">.+</line_selection>
            </shellcommand_object>
         </objects>
         <states>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure the log_config module is loaded" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:ste:27577" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:27577"></stdout_line>
            </shellcommand_state>
            <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#cmd" comment="Ensure the WebDav modules are correctly disabled." id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:ste:27578" version="1">
               <stdout_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:27578"></stdout_line>
            </shellcommand_state>
         </states>
         <variables>
            <external_variable comment="This value is used in Rule: Enable the Log Config Module" datatype="string" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:27577" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable WebDAV Modules" datatype="string" id="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:27578" version="1"></external_variable>
         </variables>
      </oval_definitions>
   </ds:component>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>dfz6dju7WOpcSBvBfmGpUeKDTkC8qMkM8M80OkPns4o=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
s6+s+MuhH8SqRjEBNAP7Fza5/yMz1nRZzWBm0xiaflTymxfTNWScdcetRSsgPZQtNegbKWoUmIiR
k2mKXei6fFf0N2QhvzMCMARE2wsCB1VSbiyKouoYoN/6n0QBF6Aqv3H5kIrJywSmW2BDpYehy5D4
SgXxWyw1lgSRk46SBP+aLepasBch99WEvSQqJC+79z/NDDV8fbx/AWmEzI/wxR9+tBxyu+Q1ozJd
i3BY0Aevf2knkfMtKP/dZqU4QSS87vjTQz4fWH8Rew/VHgvm0q8BfOLOa9WUYoC8kqHcIHgZqXsA
EfyznFEa2QhXiY/Brbz3w3Q23BlBB+71b4osd+imbL79XBdC/wUtHFBEok/4CFpb7bytgy7hxdZP
bXeoXO7lBc1SKysJEDyGsXMhaY1Cib6cnlRXWyF0kka5teROHIeBIitbjsxzrr1f8tik5hK4SrH9
e6BkCrrQ8tkKVOJwvAyjNxCGg6Jos5DOmTYYPS3qfbiYiXbCxOzpzJpG
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></ds:data-stream-collection>