<xccdf:Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_3.5.0_CIS_Apache_HTTP_Server_2.2_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
   <xccdf:status date="2024-10-31">accepted</xccdf:status>
   <xccdf:title xml:lang="en">CIS Apache HTTP Server 2.2 Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:h3>
         <xhtml:strong>This is the archive of the CIS Apache HTTP Server 2.2 Benchmark v3.5.0. CIS encourages you to migrate to a more recent, supported version of this technology.</xhtml:strong>
      </xhtml:h3>
      <xhtml:p>
This document, CIS Apache 2.2 Benchmark, provides prescriptive guidance for establishing a secure configuration posture for Apache Web Server versions 2.2 running on Linux. This guide was tested against Apache Web Server 2.2.29 as built from source       <xhtml:span class="inline_block">httpd-2.2.29.tar.gz</xhtml:span>
 from       <xhtml:a href="http://httpd.apache.org/">http://httpd.apache.org/</xhtml:a>
 on Linux. To obtain the latest version of this guide, please visit       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>
.    </xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <xccdf:platform idref="cpe:2.3:a:apache_foundation:apache_http_server:2.2.*:*:*:*:*:*:*:*"></xccdf:platform>
   <xccdf:version>3.5.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
      <xccdf:title xml:lang="en">Level 1</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Apache_Is_Installed_From_the_Appropriate_Binaries" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Only_Necessary_Authentication_and_Authorization_Modules_Are_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_the_Log_Config_Module_Is_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_the_WebDAV_Modules_Are_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_the_Status_Module_Is_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_the_Autoindex_Module_Is_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_the_Proxy_Modules_Are_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_the_User_Directories_Module_Is_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_the_Info_Module_Is_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_the_Apache_Web_Server_Runs_As_a_Non-Root_User" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_the_Apache_User_Account_Has_an_Invalid_Shell" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_the_Apache_User_Account_Is_Locked" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Apache_Directories_and_Files_Are_Owned_By_Root" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_the_Group_Is_Set_Correctly_on_Apache_Directories_and_Files" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Other_Write_Access_on_Apache_Directories_and_Files_Is_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_the_Core_Dump_Directory_Is_Secured" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_the_Lock_File_Is_Secured" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_the_Pid_File_Is_Secured" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_the_ScoreBoard_File_Is_Secured" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_Group_Write_Access_for_the_Apache_Directories_and_Files_Is_Properly_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.12_Ensure_Group_Write_Access_for_the_Document_Root_Directories_and_Files_Is_Properly_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_Access_to_OS_Root_Directory_Is_Denied_By_Default" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_Appropriate_Access_to_Web_Content_Is_Allowed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_OverRide_Is_Disabled_for_the_OS_Root_Directory" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_OverRide_Is_Disabled_for_All_Directories" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Options_for_the_OS_Root_Directory_Are_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Options_for_the_Web_Root_Directory_Are_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Options_for_Other_Directories_Are_Minimized" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_Default_HTML_Content_Is_Removed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_Default_CGI_Content_printenv_Script_Is_Removed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_the_Default_CGI_Content_test-cgi_Script_Is_Removed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_HTTP_Request_Methods_Are_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_the_HTTP_TRACE_Method_Is_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_Old_HTTP_Versions_Are_Disallowed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Access_to_.ht_Files_Is_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_the_Error_Log_Filename_and_Severity_Level_Are_Configured_Correctly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_the_Server_Access_Log_Is_Configured_Correctly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_Log_Storage_and_Rotation_Is_Configured_Correctly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.5_Ensure_Applicable_Patches_Are_Applied" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_mod_ssl_andor_mod_nss_Is_Installed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_a_Valid_Trusted_Certificate_Is_Installed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_the_Servers_Private_Key_Is_Protected" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_Ensure_Weak_SSL_Protocols_Are_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_Ensure_Weak_SSLTLS_Ciphers_Are_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_Ensure_Insecure_SSL_Renegotiation_Is_Not_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_SSL_Compression_is_Not_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_Ensure_Medium_Strength_SSLTLS_Ciphers_Are_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_ServerTokens_Provides_Minimal_Information" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2_Ensure_ServerSignature_Is_Not_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.1_Ensure_the_TimeOut_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.2_Ensure_KeepAlive_Is_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.3_Ensure_MaxKeepAliveRequests_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.4_Ensure_the_KeepAliveTimeout_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.5_Ensure_Timeout_Limits_for_Request_Headers_Are_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_9.6_Ensure_Timeout_Limits_for_the_Request_Body_Are_Set_Properly" selected="true"></xccdf:select>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
      <xccdf:title xml:lang="en">Level 2</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_the_Server_Is_Not_a_Multi-Use_System" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Ensure_Access_to_Inappropriate_File_Extensions_Is_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.12_Ensure_IP_Address_Based_Requests_Are_Disallowed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.13_Ensure_the_IP_Addresses_for_Listening_for_Requests_Are_Specified" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.14_Ensure_Browser_Framing_Is_Restricted" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_a_Syslog_Facility_Is_Configured_for_Error_Logging" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_ModSecurity_Is_Installed_and_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_the_OWASP_ModSecurity_Core_Rule_Set_Is_Installed_and_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_Ensure_the_TLS_v1.0_Protocol_Is_Disabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_Ensure_HTTP_Strict_Transport_Security_Is_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3_Ensure_ETag_Response_Header_Fields_Do_Not_Include_Inodes" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4_Ensure_All_Default_Apache_Content_Is_Removed" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.1_Ensure_the_Maximum_Request_Line_Length_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.2_Ensure_the_Maximum_Request_Headers_Per_Request_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.3_Enusre_the_Maximum_Request_Header_Field_Size_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_10.4_Ensure_the_Maximum_Request_Body_Size_Is_Set_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.1_Ensure_SELinux_Is_Enabled_in_Enforcing_Mode" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.2_Ensure_Apache_Processes_Run_in_the_httpd_t_Confined_Context" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.3_Ensure_the_httpd_t_Type_Is_Not_in_Permissive_Mode" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_11.4_Ensure_Only_the_Necessary_SELinux_Booleans_Are_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_12.1_Ensure_the_AppArmor_Framework_Is_Enabled" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_12.2_Ensure_the_Apache_AppArmor_Profile_Is_Configured_Properly" selected="true"></xccdf:select>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_12.3_Ensure_the_Apache_AppArmor_Profile_Is_in_Enforce_Mode" selected="true"></xccdf:select>
   </xccdf:Profile>
   <Value id="xccdf_org.cisecurity.benchmarks_value_50542_var" operator="pattern match" type="string">
      <title>Ensure the Log Config Module Is Enabled</title>
      <description>This value is used in Rule: Ensure the Log Config Module Is Enabled</description>
      <value>/log_config/</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_50543_var" operator="pattern match" type="string">
      <title>Ensure the WebDAV Modules Are Disabled</title>
      <description>This value is used in Rule: Ensure the WebDAV Modules Are Disabled</description>
      <value>/syntax ok/i</value>
   </Value>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Planning_and_Installation">
      <xccdf:title xml:lang="en">Planning and Installation</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for the planning and installation of an Apache HTTP Server.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1_Ensure_the_Pre-Installation_Planning_Checklist_Has_Been_Implemented">
         <xccdf:title xml:lang="en">Ensure the Pre-Installation Planning Checklist Has Been Implemented</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Review and implement the following items as appropriate:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Review and implement your organization's security policies as they relate to web security.</xhtml:li>
               <xhtml:li>Implement a secure network infrastructure by controlling access to/from your web server using firewalls, routers and switches.</xhtml:li>
               <xhtml:li>Harden the underlying operating system of the web server by minimizing listening network services, applying proper patches, and hardening the configurations as recommended in the appropriate Center for Internet Security benchmark for the platform.</xhtml:li>
               <xhtml:li>Implement central log monitoring processes.</xhtml:li>
               <xhtml:li>Implement a disk space monitoring process and log rotation mechanism.</xhtml:li>
               <xhtml:li>
Educate developers about developing secure applications.             <xhtml:a href="http://www.owasp.org/">http://www.owasp.org/</xhtml:a>
                  <xhtml:a href="http://www.webappsec.org/">http://www.webappsec.org/</xhtml:a>
               </xhtml:li>
               <xhtml:li>Ensure the WHOIS Domain information registered for the web presence does not reveal sensitive personnel information, which may be leveraged for social engineering and other types of attacks.</xhtml:li>
               <xhtml:li>Ensure your Domain Name System (DNS) servers have been properly secured to prevent attacks, as recommended in the CIS BIND DNS benchmark.</xhtml:li>
               <xhtml:li>Implement intrusion detection technology, a web application firewall, or other similar technology to monitor attacks against the web server.</xhtml:li>
            </xhtml:ul>
         </xccdf:description>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_the_Server_Is_Not_a_Multi-Use_System" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure the Server Is Not a Multi-Use System</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>A web server should function as only a web server, and if possible should not be mixed with other primary functions such as email, DNS, databases, or middleware. The number of services and daemons executing on the server should be limited to those necessary.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Operate Critical Services On Dedicated Hosts (i.e. DNS, Mail, Web, Database)" urn="urn:cisecurity.org:controls:6.0:9:5">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Default server configurations often expose a wide variety of services. The more services exposed to an attacker, the more potential vectors an attacker has to exploit the server and therefore the higher the risk for the server. Just because a server can perform many services doesn't mean it is wise to do so. Maintaining a server for a single purpose increases the security of your application and system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Leverage the package or services manager for your OS to uninstall or disable all unneeded services. On Red Hat systems, the following will disable a given service:</xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Apache_Is_Installed_From_the_Appropriate_Binaries" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure Apache Is Installed From the Appropriate Binaries</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The CIS Apache Benchmark recommends using the Apache binary provided by your vendor for most situations in order to reduce the effort and increase the effectiveness of maintenance and security patches. However, to keep the benchmark as generic and applicable to all Unix/Linux platforms as possible, a default source build has been used for this benchmark.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Important Note</xhtml:strong>
: There is a major difference between source builds and most vendor packages that is very important to highlight. The default source build of Apache is fairly conservative and minimalist in the modules included, and therefore starts off in a fairly strong security state, while most vendor binaries are typically very well loaded with most of the functionality that one may be looking for.           <xhtml:em>
                  <xhtml:strong>Therefore, it is important that you don't assume the default value shown in the benchmark will match default values in your installation.</xhtml:strong>
               </xhtml:em>
 You should always test any new installation in your environment before putting it into production. Also, keep in mind you can install and run a new version alongside the old one by using a different Apache prefix and a different IP address or port number in the           <xhtml:span class="inline_block">Listen</xhtml:span>
 directive.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Inventory of Authorized and Unauthorized Software" urn="urn:cisecurity.org:controls:6.0:2"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The benefits of using vendor supplied binaries include:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Easy installation; it should work straight out of the box.</xhtml:li>
               <xhtml:li>It is customized for your OS environment.</xhtml:li>
               <xhtml:li>It has been tested and gone through QA procedures.</xhtml:li>
               <xhtml:li>
Everything you need is likely to be included, probably including some third-party modules. Many OS vendors ship Apache with             <xhtml:span class="inline_block">mod_ssl</xhtml:span>
, OpenSSL, PHP,             <xhtml:span class="inline_block">mod_perl</xhtml:span>
 and             <xhtml:span class="inline_block">mod_security</xhtml:span>
, for example.          </xhtml:li>
               <xhtml:li>Your vendor will tell you about security issues, so you have to look for information in fewer places.</xhtml:li>
               <xhtml:li>Updates to fix security issues will be easy to apply. The vendor will have already verified the problem, checked the signature on the Apache download, worked out the impact, and so on.</xhtml:li>
               <xhtml:li>You may be able to get the updates automatically, reducing the window of risk.</xhtml:li>
            </xhtml:ul>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">Apache Compiling and Installation  http://httpd.apache.org/docs/2.2/install.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Installation depends on the operating system platform. For a source build, consult the Apache 2.2 documentation on compiling and installing               <xhtml:a href="http://httpd.apache.org/docs/2.2/install.html">http://httpd.apache.org/docs/2.2/install.html</xhtml:a>
. For Red Hat Enterprise Linux 5, the following               <xhtml:span class="inline_block">yum</xhtml:span>
 command could be used:            </xhtml:p>
                  <xhtml:code class="code_block"># yum install httpd 
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Apache_Modules">
      <xccdf:title xml:lang="en">Apache Modules</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>It's crucially important to have a minimal and compact Apache installation based on documented business requirements. This section covers specific modules that should be reviewed and disabled if not required for business purposes. However, it's very important that the review and analysis of which modules are required for business purposes not be limited to the modules explicitly listed.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Only_Necessary_Authentication_and_Authorization_Modules_Are_Enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure Only Necessary Authentication and Authorization Modules Are Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache 2.2 modules for authentication and authorization have been refactored to provide finer granularity and more consistent and logical names, and to simplify configuration. The           <xhtml:span class="inline_block">authn_*</xhtml:span>
 modules provide authentication, while the           <xhtml:span class="inline_block">authz_*</xhtml:span>
 modules provide authorization. Apache provides two types of authentication: basic and digest. Enable only the modules that are required.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Account Monitoring and Control" urn="urn:cisecurity.org:controls:6.0:16"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Authentication and authorization are the front doors to the protected information in your web site. Most installations only need a small subset of the modules available. By minimizing the enabled modules to those that are actually used, we reduce the number of "doors" and therefore reduce the attack surface of the web site. Likewise, having fewer modules means less software that could have vulnerabilities.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/16" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/howto/auth.html</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/programs/configure.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Consult Apache module documentation for descriptions of each module in order to determine the necessary modules for the specific installation. The unnecessary static compiled modules are disabled through compile time configuration options. The dynamically loaded modules are disabled by commenting out or removing the               <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive from the Apache configuration files (typically               <xhtml:span class="inline_block">httpd.conf</xhtml:span>
). Some modules may be separate packages and may be removed.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_the_Log_Config_Module_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Log Config Module Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">log_config</xhtml:span>
 module provides for flexible logging of client requests and for the configuration of the information in each log.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Ensure Audit Log Settings Support Appropriate Log Entry Formatting" urn="urn:cisecurity.org:controls:6.0:6:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Logging is critical for monitoring usage and potential abuse of your web server. To configure web server logging using the           <xhtml:span class="inline_block">log_format</xhtml:span>
 directive, this module is required.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_log_config.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform either one of the following:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>
For source builds with static modules, run the Apache                 <xhtml:span class="inline_block">./configure</xhtml:span>
 script without including the                 <xhtml:span class="inline_block">--disable-log-config</xhtml:span>
 script options.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, add or modify the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive so that it is present in the Apache configuration as below and not commented out:
                <xhtml:code class="code_block">LoadModule log_config_module modules/mod_log_config.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ul>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:50542" value-id="xccdf_org.cisecurity.benchmarks_value_50542_var"></check-export>
               <check-content-ref href="CIS_Apache_HTTP_Server_2.2_Benchmark_v3.5.0-oval.xml" name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:def:50542"></check-content-ref>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_the_WebDAV_Modules_Are_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the WebDAV Modules Are Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">mod_dav</xhtml:span>
 and           <xhtml:span class="inline_block">mod_dav_fs</xhtml:span>
 modules support WebDAV ('Web-based Distributed Authoring and Versioning') functionality for Apache. WebDAV is an extension to the HTTP protocol which allows clients to create, move, and delete files and resources on the web server.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
WebDAV is not widely used, and it has serious security concerns because it may allow clients to modify unauthorized files on the web server. Therefore, the WebDav modules           <xhtml:span class="inline_block">mod_dav</xhtml:span>
 and           <xhtml:span class="inline_block">mod_dav_fs</xhtml:span>
 should be disabled.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_dav.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform either one of the following to disable the WebDAV modules:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For source builds with static modules, run the Apache                 <xhtml:span class="inline_block">./configure</xhtml:span>
 script without including                 <xhtml:span class="inline_block">mod_dav</xhtml:span>
 and                 <xhtml:span class="inline_block">mod_dav_fs</xhtml:span>
 in the                 <xhtml:span class="inline_block">--enable-modules=configure</xhtml:span>
 script options.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, comment out or remove the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive for the                 <xhtml:span class="inline_block">mod_dav</xhtml:span>
 and                 <xhtml:span class="inline_block">mod_dav_fs</xhtml:span>
 modules from the                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file.
                <xhtml:code class="code_block">##LoadModule dav_module modules/mod_dav.so
##LoadModule dav_fs_module modules/mod_dav_fs.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:var:50543" value-id="xccdf_org.cisecurity.benchmarks_value_50543_var"></check-export>
               <check-content-ref href="CIS_Apache_HTTP_Server_2.2_Benchmark_v3.5.0-oval.xml" name="oval:org.cisecurity.benchmarks.apache_foundation_apache_http_server_2:def:50543"></check-content-ref>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_the_Status_Module_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Status Module Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">mod_status</xhtml:span>
 module provides current server performance statistics.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
While having server performance status information available as a web page may be convenient, it's recommended that this module be disabled. When it is enabled, its handler capability is available in all configuration files, including per-directory files (e.g.,           <xhtml:span class="inline_block">.htaccess</xhtml:span>
). This may have security-related ramifications.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_status.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform either one of the following to disable the               <xhtml:span class="inline_block">mod_status</xhtml:span>
 module:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For source builds with static modules, run the Apache ./configure script with the                 <xhtml:span class="inline_block">--disable-status configure</xhtml:span>
 script options.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure --disable-status
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, comment out or remove the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive for the                 <xhtml:span class="inline_block">mod_status</xhtml:span>
 module from the                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file.
                <xhtml:code class="code_block">##LoadModule status_module modules/mod_status.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_the_Autoindex_Module_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Autoindex Module Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">mod_autoindex</xhtml:span>
 module automatically generates a web page listing the contents of directories on the server, typically used so an           <xhtml:span class="inline_block">index.html</xhtml:span>
 does not have to be generated.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Automated directory listings should not be enabled because they will reveal information helpful to an attacker such as naming conventions and directory paths. They may also reveal files that were not intended to be revealed.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_autoindex.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform either one of the following to disable the               <xhtml:span class="inline_block">mod_autoindex</xhtml:span>
 module:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For source builds with static modules, run the Apache                 <xhtml:span class="inline_block">./configure</xhtml:span>
 script with the                 <xhtml:span class="inline_block">--disable-autoindex configure</xhtml:span>
 script options.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure -disable-autoindex
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, comment out or remove the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive for the                 <xhtml:span class="inline_block">mod_autoindex</xhtml:span>
 module from the                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file.
                <xhtml:code class="code_block">## LoadModule autoindex_module modules/mod_autoindex.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_the_Proxy_Modules_Are_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Proxy Modules Are Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Apache proxy modules allow the server to act as a proxy (either forward or reverse proxy) for HTTP and other protocols with additional proxy modules loaded. If the Apache installation is not intended to proxy requests to or from another network, the proxy module should not be loaded.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Proxy servers can act as an important security control when properly configured. However, a secure proxy server is not within the scope of this benchmark. A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended. Scanning for web servers that will also proxy requests is a very common attack because proxy servers are useful for anonymizing attacks on other servers, or possibly proxying requests into an otherwise protected network.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_proxy.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform either one of the following to disable the proxy modules:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For source builds with static modules, run the Apache                 <xhtml:span class="inline_block">./configure</xhtml:span>
 script without including the                 <xhtml:span class="inline_block">mod_proxy</xhtml:span>
 and all other proxy modules in the                 <xhtml:span class="inline_block">--enable-modules=configure</xhtml:span>
 script options.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, comment out or remove the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive for the                 <xhtml:span class="inline_block">mod_proxy</xhtml:span>
 module and all other proxy modules from the                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file.
                <xhtml:code class="code_block">##LoadModule proxy_module modules/mod_proxy.so
##LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
##LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
##LoadModule proxy_http_module modules/mod_proxy_http.so
##LoadModule proxy_connect_module modules/mod_proxy_connect.so
##LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_the_User_Directories_Module_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the User Directories Module Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">UserDir</xhtml:span>
 directive must be disabled so that user home directories are not accessed via the web site with a tilde (~) preceding the username. The directive also sets the path name of the directory that will be accessed. For example:        </xhtml:p>
            <xhtml:ul>
               <xhtml:li>
                  <xhtml:a href="http://example.com/~ralph/">http://example.com/~ralph/</xhtml:a>
 might access a             <xhtml:span class="inline_block">public_html</xhtml:span>
 sub-directory of             <xhtml:span class="inline_block">ralph</xhtml:span>
 user's home directory.          </xhtml:li>
               <xhtml:li>
The directive             <xhtml:span class="inline_block">UserDir ./</xhtml:span>
 might map             <xhtml:span class="inline_block">/~root</xhtml:span>
 to the root directory (            <xhtml:span class="inline_block">/</xhtml:span>
).          </xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The user directories should not be globally enabled since that allows anonymous access to anything users may want to share with other users on the network. Also consider that every time a new account is created on the system, there is potentially new content available via the web site.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_userdir.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform either one of the following to disable the user directories module:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For source builds with static modules, run the Apache                 <xhtml:span class="inline_block">./configure</xhtml:span>
 script with the                 <xhtml:span class="inline_block">--disable-userdir configure</xhtml:span>
 script option.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure --disable-userdir
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, comment out or remove the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive for the                 <xhtml:span class="inline_block">mod_userdir</xhtml:span>
 module from the                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file.
                <xhtml:code class="code_block">##LoadModule userdir_module modules/mod_userdir.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_the_Info_Module_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Info Module Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">mod_info</xhtml:span>
 module provides information on the server configuration via access to a           <xhtml:span class="inline_block">/server-info</xhtml:span>
 URL location.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Although having server configuration information available as a web page may be convenient, it's recommended that this module be disabled. Once the module is loaded into the server, its handler capability is available in per-directory           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files. This can leak sensitive information, such as system paths, usernames/passwords, and database names, from the configuration directives of other Apache modules.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_info.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform either one of the following to disable the               <xhtml:span class="inline_block">mod_info</xhtml:span>
 module:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For source builds with static modules, run the Apache                 <xhtml:span class="inline_block">./configure</xhtml:span>
 script without including                 <xhtml:span class="inline_block">mod_info</xhtml:span>
 in the                 <xhtml:span class="inline_block">--enable-modules= configure</xhtml:span>
 script options.
                <xhtml:code class="code_block">$ cd $DOWNLOAD/httpd-2.2.22
$ ./configure
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For dynamically loaded modules, comment out or remove the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive for the                 <xhtml:span class="inline_block">mod_info</xhtml:span>
 module from the                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file.
                <xhtml:code class="code_block">##LoadModule info_module modules/mod_info.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Privileges_Permissions_and_Ownership">
      <xccdf:title xml:lang="en">Privileges, Permissions, and Ownership</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Security at the operating system (OS) level is the vital foundation required for a secure web server. This section will focus on OS platform privileges, permissions, and ownership.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_the_Apache_Web_Server_Runs_As_a_Non-Root_User" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Apache Web Server Runs As a Non-Root User</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Although Apache is typically started with root privileges in order to listen on port           <xhtml:span class="inline_block">80</xhtml:span>
 and           <xhtml:span class="inline_block">443</xhtml:span>
, it can and should run as another non-root user in order to perform the web services. The Apache User and Group directives are used to designate the user and group to be used.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
One of the best ways to reduce your exposure to attack when running a web server is to create a unique, unprivileged user and group for the server application. The           <xhtml:span class="inline_block">nobody</xhtml:span>
 or           <xhtml:span class="inline_block">daemon</xhtml:span>
 user and group that come default on Unix variants should NOT be used to run the web server because the account is commonly used for other separate daemon services. Instead, an account should be used only by the Apache software so as to not give unnecessary access to other services. Also, the user used for the Apache user should be a unique value between           <xhtml:span class="inline_block">1</xhtml:span>
 and           <xhtml:span class="inline_block">499</xhtml:span>
, as these lower values are reserved for the special system accounts not used by regular users, as discussed in the User Accounts section of the CIS Red Hat benchmark. As an even more secure alternative, if the Apache web server can be run on high unprivileged ports, it is not necessary to start Apache as root, and all the Apache processes may be run as the Apache specific user, as described below.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
If the Apache user and group do not already exist, create the account and group as a unique system account:
                <xhtml:code class="code_block"># groupadd -r apache
# useradd apache -r -g apache -d /var/www -s /sbin/nologin
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Configure the Apache user and group in the Apache configuration file                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
:
                <xhtml:code class="code_block">User apache
Group apache
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_the_Apache_User_Account_Has_an_Invalid_Shell" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Apache User Account Has an Invalid Shell</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The apache account must not be used as a regular login account, so it should be assigned an invalid or           <xhtml:span class="inline_block">nologin</xhtml:span>
 shell to ensure it cannot be used to log in.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Account Monitoring and Control" urn="urn:cisecurity.org:controls:6.0:16"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Service accounts such as the apache account are a risk if they can be used to get a login shell to the system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/16" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Change the apache account to use the               <xhtml:span class="inline_block">nologin</xhtml:span>
 shell or an invalid shell such as               <xhtml:span class="inline_block">/dev/null</xhtml:span>
:            </xhtml:p>
                  <xhtml:code class="code_block"># chsh -s /sbin/nologin apache
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_the_Apache_User_Account_Is_Locked" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Apache User Account Is Locked</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The user account under which Apache runs should not have a valid password, but should be locked.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Account Monitoring and Control" urn="urn:cisecurity.org:controls:6.0:16"></controls:control>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>The default user account, daemon, is locked by default.</xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
As a defense-in-depth measure, the Apache user account should be locked to prevent logins and to prevent a user from           <xhtml:span class="inline_block">su</xhtml:span>
-ing to apache using the password. In general, there shouldn't be a need for anyone to have to           <xhtml:span class="inline_block">su</xhtml:span>
 as apache, and when there is a need,           <xhtml:span class="inline_block">sudo</xhtml:span>
 should be used instead, which would not require the apache account password.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/16" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Use the               <xhtml:span class="inline_block">passwd</xhtml:span>
 command to lock the apache account:            </xhtml:p>
                  <xhtml:code class="code_block"># passwd -l apache
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Apache_Directories_and_Files_Are_Owned_By_Root" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Apache Directories and Files Are Owned By Root</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Apache directories and files should be owned by root. This applies to all of the Apache software directories and files installed.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting ownership of the Apache files and directories will reduce the probability of unauthorized modifications.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following:</xhtml:p>
                  <xhtml:p>
Set ownership on the               <xhtml:span class="inline_block">$APACHE_PREFIX</xhtml:span>
 directories such as               <xhtml:span class="inline_block">/usr/local/apache2</xhtml:span>
:            </xhtml:p>
                  <xhtml:code class="code_block">$ chown -R root $APACHE_PREFIX
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_the_Group_Is_Set_Correctly_on_Apache_Directories_and_Files" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Group Is Set Correctly on Apache Directories and Files</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache directories and files should be set to have a group of root (or a root equivalent group). This applies to all the Apache software directories and files installed. The only expected exception is that the Apache web document root (          <xhtml:span class="inline_block">$APACHE_PREFIX/htdocs</xhtml:span>
) is likely to need a designated group to allow web content to be updated (such as           <xhtml:span class="inline_block">webupdate</xhtml:span>
) through a change management process.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Controlled Use of Administration Privileges" urn="urn:cisecurity.org:controls:6.0:5"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Securing Apache files and directories will reduce the probability of unauthorized modifications.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/5" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following:</xhtml:p>
                  <xhtml:p>
Set the group on the $              <xhtml:span class="inline_block">APACHE_PREFIX</xhtml:span>
 directories, such as               <xhtml:span class="inline_block">/usr/local/apache2</xhtml:span>
:            </xhtml:p>
                  <xhtml:code class="code_block">$ chgrp -R root $APACHE_PREFIX
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Other_Write_Access_on_Apache_Directories_and_Files_Is_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Other Write Access on Apache Directories and Files Is Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The permission on the Apache directories should be           <xhtml:span class="inline_block">rwxr-xr-x</xhtml:span>
 (755) and the file permissions should be similar, except not executable if executable is not appropriate. This applies to all the Apache software directories and files installed, with the possible exception in some cases that a group with write access for the Apache web document root (          <xhtml:span class="inline_block">$APACHE_PREFIX/htdocs</xhtml:span>
) may be needed to allow web content to be updated. In addition, the           <xhtml:span class="inline_block">/bin</xhtml:span>
 directory and executables should be set to not be readable by other.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>None of the Apache files and directories, including the Web document root, should allow other write access. Other write access is likely to be very useful for unauthorized modification of web content, configuration files, and software.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to remove other write access on the               <xhtml:span class="inline_block">$APACHE_PREFIX</xhtml:span>
 directories:            </xhtml:p>
                  <xhtml:code class="code_block"># chmod -R o-w $APACHE_PREFIX
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_the_Core_Dump_Directory_Is_Secured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Core Dump Directory Is Secured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">CoreDumpDirectory</xhtml:span>
 directive can be used to specify a directory which Apache attempts to switch before dumping core for debugging. The default directory is the Apache           <xhtml:span class="inline_block">ServerRoot</xhtml:span>
 directory. However, on Linux systems, core dumps are disabled by default. Most production environments should leave core dumps disabled. In the event that core dumps are needed, the directory needs to be writable by Apache, and it should meet the security requirements defined below in the audit and remediation sections.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Deployed Software Of Development Artifacts" urn="urn:cisecurity.org:controls:6.0:18:9">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Core dumps are snapshots of memory and may contain sensitive information that should not be accessible by other accounts on the system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mpm_common.html#coredumpdirectory</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Either remove the               <xhtml:span class="inline_block">CoreDumpDirectory</xhtml:span>
 directive from the Apache configuration files, or make the configured directory meet the following requirements:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Not within the Apache web document root (                <xhtml:span class="inline_block">$APACHE_PREFIX/htdocs</xhtml:span>
)              </xhtml:li>
                     <xhtml:li>
Owned by root and has a group ownership of the Apache group (as defined via the Group directive)
                <xhtml:code class="code_block"># chown root:apache /var/log/httpd
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Has no read-write-search access permission for other users
                <xhtml:code class="code_block"># chmod o-rwx /var/log/httpd
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_the_Lock_File_Is_Secured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Lock File Is Secured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LockFile</xhtml:span>
 directive sets the path to the lock file used when Apache uses           <xhtml:span class="inline_block">fcntl(2)</xhtml:span>
 or           <xhtml:span class="inline_block">flock(2)</xhtml:span>
 system calls to implement a mutex. Most Linux systems will default to using semaphores instead, so the directive may not apply. However, in the event a lock file is used, it is important for the lock file to be in a locally mounted directory that is not writable by other users.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
If the           <xhtml:span class="inline_block">LockFile</xhtml:span>
 is placed in a writable directory, other accounts could create a denial of service attack and prevent the server from starting by creating a lock file with the same name.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mpm_common.html#lockfile</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform these steps to properly secure the lock file:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Find the directory in which the                 <xhtml:span class="inline_block">LockFile</xhtml:span>
 would be created. The default value is the                 <xhtml:span class="inline_block">ServerRoot/logs</xhtml:span>
 directory.              </xhtml:li>
                     <xhtml:li>
Modify the directory for the                 <xhtml:span class="inline_block">LockFile</xhtml:span>
 so it is not within the Apache                 <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
 and so it is on a locally mounted hard drive rather than an NFS mounted file system.              </xhtml:li>
                     <xhtml:li>
Change the ownership and group of the directory to be                 <xhtml:span class="inline_block">root:root</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Change the permissions on the directory so it is only writable by root, or the user under which apache initially starts up (default is root).</xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_the_Pid_File_Is_Secured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Pid File Is Secured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">PidFile</xhtml:span>
 directive sets the file path to the process ID (pid) file to which the server records the pid of the server. The pid is useful for sending a signal to the server process or checking on the health of the process.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
If the           <xhtml:span class="inline_block">PidFile</xhtml:span>
 is placed in a writable directory, other accounts could create a denial of service attack and prevent the server from starting by creating a pid file with the same name.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mpm_common.html#pidfile</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform these steps to secure the pid file:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Find the directory in which the                 <xhtml:span class="inline_block">PidFile</xhtml:span>
 would be created. The default value is the                 <xhtml:span class="inline_block">ServerRoot/logs</xhtml:span>
 directory.              </xhtml:li>
                     <xhtml:li>
Modify the directory if it is within the Apache                 <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Change the ownership and group of the directory to be                 <xhtml:span class="inline_block">root:root</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Change the permissions for the directory so it is only writable by root, or the user under which apache initially starts up (default is root).</xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_the_ScoreBoard_File_Is_Secured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the ScoreBoard File Is Secured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>
 directive sets a file path which the server will use for interprocess communication (IPC) among the Apache processes. On most Linux platforms, shared memory will be used instead of a file in the file system, so this directive is not generally needed and does not need to be specified. However, if the directive is specified, Apache will use the configured file for IPC, so it needs to be located in a secure directory.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
If the           <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>
 is placed in a writable directory, other accounts could create a denial of service attack and prevent the server from starting by creating a file with the same name, and users could monitor and disrupt communication between the processes by reading and writing to the file.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mpm_common.html#scoreboardfile</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following steps to secure the ScoreBoard file:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Check to see if the                 <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>
 is specified in any of the Apache configuration files. If it is not present, no changes are required.              </xhtml:li>
                     <xhtml:li>
If the directive is present, find the directory in which the                 <xhtml:span class="inline_block">ScoreBoardFile</xhtml:span>
 would be created. The default value is the                 <xhtml:span class="inline_block">ServerRoot/logs</xhtml:span>
 directory.              </xhtml:li>
                     <xhtml:li>
Modify the directory if it is within the Apache                 <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
 or if it is on an NFS mounted file system and not a locally mounted hard drive.              </xhtml:li>
                     <xhtml:li>
Change the directory ownership and group to be                 <xhtml:span class="inline_block">root:root</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Change the directory permissions so it is only writable by root or the user under which apache initially starts up (default is root).</xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_Group_Write_Access_for_the_Apache_Directories_and_Files_Is_Properly_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Group Write Access for the Apache Directories and Files Is Properly Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Group permissions on Apache directories should generally be           <xhtml:span class="inline_block">r-x</xhtml:span>
, and file permissions should be similar, except not executable if executable is not appropriate. This applies to all the Apache software directories and files installed, with the possible exception of the web document root           <xhtml:span class="inline_block">$DOCROOT</xhtml:span>
 defined by Apache           <xhtml:span class="inline_block">DocumentRoot</xhtml:span>
 and defaulting to           <xhtml:span class="inline_block">$APACHE_PREFIX/htdocs</xhtml:span>
. The directories and files in the web document root may have a designated web development group with write access to allow web content to be updated.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Restricting write permissions on the Apache files and directories can help mitigate attacks that modify web content to provide unauthorized access or to attack web clients.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to remove group write access on the               <xhtml:span class="inline_block">$APACHE_PREFIX</xhtml:span>
 directories:            </xhtml:p>
                  <xhtml:code class="code_block"># chmod -R g-w $APACHE_PREFIX
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.12_Ensure_Group_Write_Access_for_the_Document_Root_Directories_and_Files_Is_Properly_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Group Write Access for the Document Root Directories and Files Is Properly Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache Document Root directory           <xhtml:span class="inline_block">$DOCROOT</xhtml:span>
 may need to be writeable by an authorized group such as development, support, or a production content management tool. However, it is important that the Apache group used to run the server does not have write access to any directories or files in the document root.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Preventing Apache from writing to the web document root helps mitigate risk associated with web application vulnerabilities associated with file uploads or command execution. Typically, if an application hosted by Apache needs to write to a directory, it is best practice to have that directory live outside the web root.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to remove group write access on the               <xhtml:span class="inline_block">$DOCROOT</xhtml:span>
 directories and files for the Apache group.            </xhtml:p>
                  <xhtml:code class="code_block"># find -L $DOCROOT -group $GRP -perm /g=w -print | xargs chmod g-w
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Apache_Access_Control">
      <xccdf:title xml:lang="en">Apache Access Control</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section pertain to configurable access control mechanisms that are available in Apache HTTP server.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_Access_to_OS_Root_Directory_Is_Denied_By_Default" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Access to OS Root Directory Is Denied By Default</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">Directory</xhtml:span>
 directive allows for directory-specific configuration of access controls and many other features and options. One important usage is to create a default deny policy that does not allow access to OS directories and files, except for those specifically allowed. This is done by denying access to the OS root directory.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>One aspect of Apache that is occasionally misunderstood is the feature of default access. That is, unless you take steps to change it, if the server can find its way to a file through normal URL mapping rules, it can and will serve it to clients. Having a default deny helps prevent unintended access. The Order directive is important as it provides for other Allow directives to override the default deny.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#directory</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_authz_host.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
                        <xhtml:p>
Search the Apache configuration files (                  <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find a root                   <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 element.                </xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>
Have a single                   <xhtml:span class="inline_block">Order</xhtml:span>
 directive and set its value to                   <xhtml:span class="inline_block">deny, allow</xhtml:span>
.                </xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>
Have a                   <xhtml:span class="inline_block">Deny</xhtml:span>
 directive and set its value to                   <xhtml:span class="inline_block">from all</xhtml:span>
.                </xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>
Remove all                   <xhtml:span class="inline_block">Allow</xhtml:span>
 directives from the root                   <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 element.                </xhtml:p>
                        <xhtml:code class="code_block">&lt;Directory /&gt;
   . . .
   Order deny,allow
   Deny from all
   . . .
&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_Appropriate_Access_to_Web_Content_Is_Allowed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure Appropriate Access to Web Content Is Allowed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
In order to serve web content, the Apache           <xhtml:span class="inline_block">Allow</xhtml:span>
 directive will need to be used to allow for appropriate access to directories, locations, and virtual hosts that contain web content.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">Allow</xhtml:span>
 directive may be used within a directory, a location, or other context to allow appropriate access. Access may be allowed to all, or to specific networks, hosts, or users as appropriate.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#require</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_authz_host.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Search the Apache configuration files (                <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find all                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 and                 <xhtml:span class="inline_block">&lt;Location&gt;</xhtml:span>
 elements. There should be one for the document root and any special purpose directories or locations. There are likely to be other access control directives in other contexts, such as virtual hosts or special elements like                 <xhtml:span class="inline_block">&lt;Proxy&gt;</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Add a single                 <xhtml:span class="inline_block">Order</xhtml:span>
 directive and set the value to                 <xhtml:span class="inline_block">deny, allow</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Include the appropriate                 <xhtml:span class="inline_block">Allow</xhtml:span>
 and                 <xhtml:span class="inline_block">Deny</xhtml:span>
 directives, with values that are appropriate for the purposes of the directory.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>The configurations below are just a few possible examples.</xhtml:p>
                  <xhtml:code class="code_block">
&lt;Directory "/var/www/html/"&gt;              <br></br>
    Order deny,allow              <br></br>
    Deny from all              <br></br>
    Allow from 192.169.              <br></br>
&lt;/Directory&gt;
            </xhtml:code>
                  <xhtml:code class="code_block">
&lt;Directory "/var/www/html/"&gt;              <br></br>
    Order allow,deny              <br></br>
    Allow from all              <br></br>
&lt;/Directory&gt;
            </xhtml:code>
                  <xhtml:code class="code_block">
&lt;Location /usage&gt;              <br></br>
    Order deny,allow              <br></br>
    Deny from all              <br></br>
    Allow from 127.0.0.1              <br></br>
    Allow from ::1              <br></br>
&lt;/Location&gt;
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_OverRide_Is_Disabled_for_the_OS_Root_Directory" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure OverRide Is Disabled for the OS Root Directory</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">OverRide</xhtml:span>
 directive allows for           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files to be used to override much of the configuration, including authentication, handling of document types, auto generated indexes, access control, and options. When the server finds an           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 file (as specified by           <xhtml:span class="inline_block">AccessFileName</xhtml:span>
), it needs to know which directives declared in that file can override earlier access information. When this directive is set to           <xhtml:span class="inline_block">None</xhtml:span>
,           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files are completely ignored. When this directive is set to           <xhtml:span class="inline_block">All</xhtml:span>
, any directive which has the           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 Context is allowed in           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files. Refer to the Apache 2.2 documentation for details           <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride">http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride</xhtml:a>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
While the functionality of           <xhtml:span class="inline_block">htaccess</xhtml:span>
 files is sometimes convenient, usage decentralizes the access controls and increases the risk of configurations being changed or viewed inappropriately by an unintended or rogue           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 file. Consider also that some of the more common vulnerabilities in web servers and web applications allow the web files to be viewed or to be modified; this is why it is wise to keep the configuration of the web server from being placed in           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#allowoverride</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Search the Apache configuration files (                <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find a root                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 element.              </xhtml:li>
                     <xhtml:li>
Add a single                 <xhtml:span class="inline_block">AllowOverride</xhtml:span>
 directive if there is none.              </xhtml:li>
                     <xhtml:li>
Set the value for                 <xhtml:span class="inline_block">AllowOverride</xhtml:span>
 to                 <xhtml:span class="inline_block">None</xhtml:span>
.
                <xhtml:code class="code_block">&lt;Directory /&gt;
    . . .
    AllowOverride None
    . . .
&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_OverRide_Is_Disabled_for_All_Directories" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure OverRide Is Disabled for All Directories</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">AllowOverride</xhtml:span>
 directive allows for           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files to be used to override much of the configuration, including authentication, handling of document types, auto generated indexes, access control, and options. When the server finds an           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 file (as specified by           <xhtml:span class="inline_block">AccessFileName</xhtml:span>
), it needs to know which directives declared in that file can override earlier access information. When this directive is set to           <xhtml:span class="inline_block">None</xhtml:span>
,           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files are completely ignored. When this directive is set to           <xhtml:span class="inline_block">All</xhtml:span>
, any directive which has the           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 Context is allowed in           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files. Refer to the Apache 2.2 documentation for details           <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride">http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride</xhtml:a>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
While the functionality of           <xhtml:span class="inline_block">htaccess</xhtml:span>
 files is sometimes convenient, usage decentralizes the access controls and increases the risk of configurations being changed or viewed inappropriately by an unintended or rogue           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 file. Consider also that some of the more common vulnerabilities in web servers and web applications allow the web files to be viewed or to be modified; this is why it is wise to keep the configuration of the web server from being placed in           <xhtml:span class="inline_block">.htaccess</xhtml:span>
 files.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#allowoverride</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Search the Apache configuration files (                <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find                 <xhtml:span class="inline_block">AllowOverride</xhtml:span>
 directives.              </xhtml:li>
                     <xhtml:li>
Set the value for all                 <xhtml:span class="inline_block">AllowOverride</xhtml:span>
 directives to                 <xhtml:span class="inline_block">None</xhtml:span>
.
                <xhtml:code class="code_block">. . .
AllowOverride None
. . .
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Features_Content_and_Options">
      <xccdf:title xml:lang="en">Features, Content, and Options</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section intend to reduce the effective attack surface of Apache HTTP server.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Options_for_the_OS_Root_Directory_Are_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Options for the OS Root Directory Are Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">Options</xhtml:span>
 directive allows for specific configuration of options, including execution of CGI, following symbolic links, server side includes, and content negotiation.        </xhtml:p>
            <xhtml:p>
Refer to the Apache 2.2 documentation for details:
          <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#options">http://httpd.apache.org/docs/2.2/mod/core.html#options</xhtml:a>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">Options</xhtml:span>
 directive for the root OS level is used to create a default minimal options policy that allows only the minimal options at the root directory level. Then for specific web sites or portions of the web site, options may be enabled as needed and appropriate. No options should be enabled and the value for the           <xhtml:span class="inline_block">Options</xhtml:span>
 directive should be           <xhtml:span class="inline_block">None</xhtml:span>
.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#options</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Search the Apache configuration files (                <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find a root                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 element.              </xhtml:li>
                     <xhtml:li>
Add a single                 <xhtml:span class="inline_block">Options</xhtml:span>
 directive if there is none.              </xhtml:li>
                     <xhtml:li>
Set the value for                 <xhtml:span class="inline_block">Options</xhtml:span>
 to                 <xhtml:span class="inline_block">None</xhtml:span>
.
                <xhtml:code class="code_block">&lt;Directory /&gt;
    . . .
    Options None
    . . .
&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Options_for_the_Web_Root_Directory_Are_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Options for the Web Root Directory Are Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">Options</xhtml:span>
 directive allows for specific configuration of options, including execution of CGI, following symbolic links, server side includes, and content negotiation.        </xhtml:p>
            <xhtml:p>
Refer to the Apache 2.2 documentation for details
          <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#options">http://httpd.apache.org/docs/2.2/mod/core.html#options</xhtml:a>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">Options</xhtml:span>
 directive at the web root or document root level should be restricted to the minimal options required. A setting of           <xhtml:span class="inline_block">None</xhtml:span>
 is highly recommended; however, at this level, content negotiation may be needed if multiple languages are supported. No other options should be enabled.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#options</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Search the Apache configuration files (                <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find the document root                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 element.              </xhtml:li>
                     <xhtml:li>
Add or modify any existing                 <xhtml:span class="inline_block">Options</xhtml:span>
 directive to have a value of                 <xhtml:span class="inline_block">None</xhtml:span>
 or                 <xhtml:span class="inline_block">Multiviews</xhtml:span>
, if multiviews are needed.
                <xhtml:code class="code_block">&lt;Directory "/usr/local/apache2/htdocs"&gt;
    . . .
    Options None
    . . .
&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Options_for_Other_Directories_Are_Minimized" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Options for Other Directories Are Minimized</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">Options</xhtml:span>
 directive allows for specific configuration of options, including execution of CGI, following symbolic links, server side includes, and content negotiation.        </xhtml:p>
            <xhtml:p>
Refer to the Apache 2.2 documentation for details
          <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#options">http://httpd.apache.org/docs/2.2/mod/core.html#options</xhtml:a>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The options for other directories and hosts should be restricted to the minimal options required. A setting of           <xhtml:span class="inline_block">None</xhtml:span>
 is recommended; however, it is recognized that other options may be needed in some cases:        </xhtml:p>
            <xhtml:ul>
               <xhtml:li>
                  <xhtml:span class="inline_block">Multiviews</xhtml:span>
 is appropriate if content negotiation is required, such as when multiple languages are supported.          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">ExecCGI</xhtml:span>
 is only appropriate for special directories dedicated to executable content, such as a             <xhtml:span class="inline_block">cgi-bin/</xhtml:span>
 directory. That way you will know what is executed on the server. It is possible to enable CGI script execution based on file extension or permission settings, but this makes script control and management almost impossible as developers may install scripts without your knowledge.          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">FollowSymLinks</xhtml:span>
 &amp;             <xhtml:span class="inline_block">SymLinksIfOwnerMatch</xhtml:span>
: The following of symbolic links is not recommended and should be disabled if possible. The usage of symbolic links opens up additional risk for possible attacks that may use inappropriate symbolic links to access content outside of the document root of the web server. Also consider that it could be combined with a vulnerability that allows an attacker or insider to create an inappropriate link. The option             <xhtml:span class="inline_block">SymLinksIfOwnerMatch</xhtml:span>
 is much safer in that the ownership must match in order for the link to be used, but keep in mind there is additional overhead created by requiring Apache to check the ownership.          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">Includes</xhtml:span>
 &amp;             <xhtml:span class="inline_block">IncludesNOEXEC</xhtml:span>
: The             <xhtml:span class="inline_block">IncludesNOEXEC</xhtml:span>
 option should only be needed when server side includes are required. The full             <xhtml:span class="inline_block">Includes</xhtml:span>
 option should not be used because it allows execution of arbitrary shell commands. See Apache Mod Include for details             <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_include.html">http://httpd.apache.org/docs/2.2/mod/mod_include.html</xhtml:a>
.          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">Indexes</xhtml:span>
 causes automatic generation of indexes if the default index page is missing, so it should be disabled unless required.          </xhtml:li>
            </xhtml:ul>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#options</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Search the Apache configuration files (                <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and any included configuration files) to find all                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 elements.              </xhtml:li>
                     <xhtml:li>
Add or modify any existing                 <xhtml:span class="inline_block">Options</xhtml:span>
 directive to NOT have a value of                 <xhtml:span class="inline_block">Includes</xhtml:span>
. Other options may be set if necessary and appropriate as described above.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_Default_HTML_Content_Is_Removed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Default HTML Content Is Removed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Apache installations have default content that is not needed or appropriate for production use. The primary function for the sample content is to provide a default web site, provide user manuals, or demonstrate special features of the web server. All content that is not needed should be removed.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Deployed Software Of Development Artifacts" urn="urn:cisecurity.org:controls:6.0:18:9">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Historically, sample content and features have been remotely exploited and can provide different levels of access to the server. Usually these routines are not written for production use and consequently little thought was given to security in their development.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Review all pre-installed content and remove content which is not required. In particular, look for unnecessary content in the document root directory, in a configuration directory such as               <xhtml:span class="inline_block">conf/extra</xhtml:span>
 directory, or as a Unix/Linux package.            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Remove the default                 <xhtml:span class="inline_block">index.html</xhtml:span>
 or welcome page, if it is a separate package, or comment out the configuration if it is part of the main Apache                 <xhtml:span class="inline_block">httpd</xhtml:span>
 package, such as it is on Red Hat Linux. Removing a file such as the                 <xhtml:span class="inline_block">welcome.conf</xhtml:span>
 shown below is not recommended as it may get replaced if the package is updated.
                <xhtml:code class="code_block">#
# This configuration file enables the default "Welcome"
# page if there is no default index page present for
# the root URL. To disable the Welcome page, comment
# out all the lines below.
#
##&lt;LocationMatch "^/+$"&gt;
##     Options -Indexes
##     ErrorDocument 403 /error/noindex.html
##&lt;/LocationMatch&gt;
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Remove the Apache user manual content or comment out configurations referencing the manual.
                <xhtml:code class="code_block"># yum erase httpd-manual
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Remove or comment out any Server Status handler configuration.
                <xhtml:code class="code_block">#
# Allow server status reports generated by mod_status,
# with the URL of http://servername/server-status
# Change the ".example.com" to match your domain to enable.
#
#&lt;Location /server-status&gt;
#     SetHandler server-status
#     Order deny,allow
#     Deny from all
#     Allow from .example.com
#&lt;/Location&gt;
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Remove or comment out any Server Information handler configuration.
                <xhtml:code class="code_block">#
# Allow remote server configuration reports, with the URL of
# http://servername/server-info (requires that mod_info.c be loaded).
# Change the ".example.com" to match your domain to enable.
#
#&lt;Location /server-info&gt;
#     SetHandler server-info
#     Order deny,allow
#     Deny from all
#     Allow from .example.com
#&lt;/Location&gt;
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Remove or comment out any other handler configurations such as                 <xhtml:span class="inline_block">perl-status</xhtml:span>
.
                <xhtml:code class="code_block"># This will allow remote server configuration reports, with the URL of
# http://servername/perl-status
# Change the ".example.com" to match your domain to enable.
#
#&lt;Location /perl-status&gt;
#     SetHandler perl-script
#     PerlResponseHandler Apache2::Status
#     Order deny,allow
#     Deny from all
#     Allow from .example.com
#&lt;/Location&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_Default_CGI_Content_printenv_Script_Is_Removed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Default CGI Content printenv Script Is Removed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Most web servers, including Apache installations, have default CGI content which is not needed or appropriate for production use. The primary function for these sample programs is to demonstrate the capabilities of the web server. One common default CGI content for apache installations is the script           <xhtml:span class="inline_block">printenv</xhtml:span>
. This script will print back to the requester all of the CGI environment variables, which include many server configuration details and system paths.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
            <notes:notes xml:lang="en">
               <xhtml:p>
The default source build does not include the             <xhtml:span class="inline_block">printenv</xhtml:span>
 script.          </xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
CGI programs have a long history of security bugs and problems associated with improperly accepting user input. Since these programs are often targets of attackers, we need to make sure there are no unnecessary CGI programs that could potentially be used for malicious purposes. Usually these programs were not written for production use, and consequently little thought was given to security in their development. The           <xhtml:span class="inline_block">printenv</xhtml:span>
 script in particular will disclose inappropriate information about the web server, including directory paths and detailed version and configuration information.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Locate cgi-bin files and directories enabled in the Apache configuration via the                 <xhtml:span class="inline_block">Script</xhtml:span>
,                 <xhtml:span class="inline_block">ScriptAlias</xhtml:span>
,                 <xhtml:span class="inline_block">ScriptAliasMatch</xhtml:span>
, or                 <xhtml:span class="inline_block">ScriptInterpreterSource</xhtml:span>
 directives.              </xhtml:li>
                     <xhtml:li>
Remove the                 <xhtml:span class="inline_block">printenv</xhtml:span>
 default CGI in the cgi-bin directory if it is installed.
                <xhtml:code class="code_block"># rm $APACHE_PREFIX/cgi-bin/printenv
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_the_Default_CGI_Content_test-cgi_Script_Is_Removed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Default CGI Content test-cgi Script Is Removed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Most web servers, including Apache installations, have default CGI content which is not needed or appropriate for production use. The primary function for these sample programs is to demonstrate the capabilities of the web server. A common default CGI content for Apache installations is the script           <xhtml:span class="inline_block">test-cgi</xhtml:span>
. This script will print back to the requester CGI environment variables, which includes many server configuration details.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Deployed Software Of Development Artifacts" urn="urn:cisecurity.org:controls:6.0:18:9">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
CGI programs have a long history of security bugs and problems associated with improperly accepting user input. Since these programs are often targets of attackers, we need to make sure there are no unnecessary CGI programs that could potentially be used for malicious purposes. Usually these programs were not written for production use, and consequently little thought was given to security in their development. The           <xhtml:span class="inline_block">test-cgi</xhtml:span>
 script in particular will disclose inappropriate information about the web server, including directory paths and detailed version and configuration information.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Locate cgi-bin files and directories enabled in the Apache configuration via                 <xhtml:span class="inline_block">Script</xhtml:span>
,                 <xhtml:span class="inline_block">ScriptAlias</xhtml:span>
,                 <xhtml:span class="inline_block">ScriptAliasMatch</xhtml:span>
, or                 <xhtml:span class="inline_block">ScriptInterpreterSource</xhtml:span>
 directives.              </xhtml:li>
                     <xhtml:li>
Remove the                 <xhtml:span class="inline_block">test-cgi</xhtml:span>
 default CGI in the cgi-bin directory if it is installed.
                <xhtml:code class="code_block"># rm $APACHE_PREFIX/cgi-bin/test-cgi
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_HTTP_Request_Methods_Are_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure HTTP Request Methods Are Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Use the Apache           <xhtml:span class="inline_block">&lt;LimitExcept&gt;</xhtml:span>
 directive to restrict unnecessary HTTP request methods of the web server so it only accepts and processes the           <xhtml:span class="inline_block">GET</xhtml:span>
,           <xhtml:span class="inline_block">HEAD</xhtml:span>
,           <xhtml:span class="inline_block">POST</xhtml:span>
 and           <xhtml:span class="inline_block">OPTIONS</xhtml:span>
 HTTP request methods.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The HTTP 1.1 protocol supports several request methods which are rarely used and potentially high risk. For example, methods such as           <xhtml:span class="inline_block">PUT</xhtml:span>
 and           <xhtml:span class="inline_block">DELETE</xhtml:span>
 are rarely used and should be disabled in keeping with the security principle of minimizing features and options. Also, since these methods are typically used to modify resources on the web server, they should be explicitly disallowed. For normal web server operation, you will typically need to allow only the           <xhtml:span class="inline_block">GET</xhtml:span>
,           <xhtml:span class="inline_block">HEAD</xhtml:span>
 and           <xhtml:span class="inline_block">POST</xhtml:span>
 request methods. This will allow for downloading web pages and submitting information to web forms. The           <xhtml:span class="inline_block">OPTIONS</xhtml:span>
 request method will also be allowed as it is used to request which HTTP request methods are allowed. Unfortunately, the Apache           <xhtml:span class="inline_block">&lt;LimitExcept&gt;</xhtml:span>
 directive does not deny the           <xhtml:span class="inline_block">TRACE</xhtml:span>
 request method. The           <xhtml:span class="inline_block">TRACE</xhtml:span>
 request method is disallowed in another benchmark recommendation with the           <xhtml:span class="inline_block">TraceEnable</xhtml:span>
 directive.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#limitexcept</xccdf:ident>
         <xccdf:ident system="URL">https://www.ietf.org/rfc/rfc2616.txt</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Locate the Apache configuration files and included configuration files.</xhtml:li>
                     <xhtml:li>
Search for the directive on the document root directory, such as:
                <xhtml:code class="code_block">&lt;Directory "/usr/local/apache2/htdocs"&gt;
    . . .
&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Ensure that the access control order within the                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 directive is                 <xhtml:span class="inline_block">deny,allow</xhtml:span>
.
                <xhtml:code class="code_block">Order allow,deny
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add a directive as shown below within the group of document root directives.
                <xhtml:code class="code_block"># Limit HTTP methods to standard methods. Note: Does not limit TRACE
&lt;LimitExcept GET POST OPTIONS&gt;
    Deny from all
&lt;/LimitExcept&gt;   
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Search for other directives in the Apache configuration files in places other than the root directory, and add the same directives to each. It is very important to understand that the directives are based on the OS file system hierarchy as accessed by Apache and not the hierarchy of the locations within web site URLs.
                <xhtml:code class="code_block">&lt;Directory "/usr/local/apache2/cgi-bin"&gt;
    . . .
    Order allow,deny
    # Limit HTTP methods
    &lt;LimitExcept GET POST OPTIONS&gt;
        Deny from all
    &lt;/LimitExcept&gt;
&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_the_HTTP_TRACE_Method_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the HTTP TRACE Method Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Use the Apache           <xhtml:span class="inline_block">TraceEnable</xhtml:span>
 directive to disable the HTTP           <xhtml:span class="inline_block">TRACE</xhtml:span>
 request method.
Refer to the Apache documentation for more details:
          <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/core.html#traceenable">http://httpd.apache.org/docs/2.2/mod/core.html#traceenable</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The HTTP 1.1 protocol requires support for the           <xhtml:span class="inline_block">TRACE</xhtml:span>
 request method, which reflects the request back as a response and was intended for diagnostics purposes. The           <xhtml:span class="inline_block">TRACE</xhtml:span>
 method is not needed and is easily subjected to abuse, so it should be disabled.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#traceenable</xccdf:ident>
         <xccdf:ident system="URL">https://www.ietf.org/rfc/rfc2616.txt</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Locate the main Apache configuration file such as                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Add a                 <xhtml:span class="inline_block">TraceEnable</xhtml:span>
 directive to the server level configuration with a value of                 <xhtml:span class="inline_block">off</xhtml:span>
. Server level configuration is the top level configuration, not nested within any other directives like                 <xhtml:span class="inline_block">&lt;Directory&gt;</xhtml:span>
 or                 <xhtml:span class="inline_block">&lt;Location&gt;</xhtml:span>
.
                <xhtml:code class="code_block">TraceEnable off
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_Old_HTTP_Versions_Are_Disallowed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Old HTTP Versions Are Disallowed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache modules           <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 and           <xhtml:span class="inline_block">mod_security</xhtml:span>
 can be used to disallow old and invalid HTTP versions. The HTTP version 1.1 RFC is dated June 1999 and has been supported by Apache since version 1.2, so it should no longer be necessary to allow ancient versions of HTTP prior to 1.1. Refer to the Apache documentation on           <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 for more details:           <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Many malicious automated programs, vulnerability scanners, and fingerprinting tools send requests using old HTTP versions to see how the web server responds. These requests are usually part of the attacker's enumeration process.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Load the                 <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 module for Apache by doing either one of the following:
                <xhtml:ul>
                           <xhtml:li>
Build Apache with                     <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 statically loaded during the build by adding the                     <xhtml:span class="inline_block">--enable-rewrite</xhtml:span>
 option to the                     <xhtml:span class="inline_block">./configure</xhtml:span>
 script.
                    <xhtml:code class="code_block">./configure --enable-rewrite
</xhtml:code>
                           </xhtml:li>
                           <xhtml:li>
Or, dynamically load the module with the                     <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive in the httpd.conf configuration file.
                    <xhtml:code class="code_block">LoadModule rewrite_module modules/mod_rewrite.so
</xhtml:code>
                           </xhtml:li>
                        </xhtml:ul>
                     </xhtml:li>
                     <xhtml:li>
Add the                 <xhtml:span class="inline_block">RewriteEngine</xhtml:span>
 directive to the configuration within the global server context with the value of                 <xhtml:span class="inline_block">on</xhtml:span>
 so the rewrite engine is enabled.
                <xhtml:code class="code_block">RewriteEngine On
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Locate the main Apache configuration file such as                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
, and add the following rewrite condition to match HTTP/1.1 and the rewrite rule to the top server level configuration to disallow other protocol versions.
                <xhtml:code class="code_block">RewriteEngine On
RewriteCond %{THE_REQUEST} !HTTP/1\.1$
RewriteRule .* - [F]
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
By default,                 <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 configuration settings from the main server context are not inherited by virtual hosts. Therefore, it is also necessary to add the following directives in each section to inherit the main server settings:
                <xhtml:code class="code_block">RewriteEngine On
RewriteOptions Inherit
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Access_to_.ht_Files_Is_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Access to .ht* Files Is Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Restrict access to any files beginning with           <xhtml:span class="inline_block">.ht</xhtml:span>
 using the           <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Input For In-house Software" urn="urn:cisecurity.org:controls:6.0:18:3">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The default name for the access file which allows files in web directories to override the Apache configuration is           <xhtml:span class="inline_block">.htaccess</xhtml:span>
. The usage of access files should not be allowed, but as a defense in depth a           <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive is recommended to prevent web clients from viewing those files in case they are created.        </xhtml:p>
            <xhtml:p>
Also, common names for web password and group files are           <xhtml:span class="inline_block">.htpasswd</xhtml:span>
 and           <xhtml:span class="inline_block">.htgroup</xhtml:span>
. Neither of these files should be placed in the document root, but in the event they are, the           <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive can be used to prevent them from being viewed by web clients.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/3" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#filesmatch</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>Add or modify the following lines in the Apache configuration at the server configuration level:</xhtml:p>
                  <xhtml:code class="code_block">
&lt;FilesMatch "^\.ht"&gt;              <br></br>
   Order allow,deny              <br></br>
   Deny from all              <br></br>
&lt;/FilesMatch&gt;
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_Ensure_Access_to_Inappropriate_File_Extensions_Is_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Access to Inappropriate File Extensions Is Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Restrict access to inappropriate file extensions that are not expected to be a legitimate part of web sites using the           <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Input For In-house Software" urn="urn:cisecurity.org:controls:6.0:18:3">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
There are many files that are often left within the web server document root that could provide an attacker with sensitive information. Most often these files are mistakenly left behind after installation, troubleshooting, or backing up files before editing. Regardless of the reason for their creation, these files can still be served by Apache even when there is no hyperlink pointing to them. The web administrators should use the           <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive to restrict access to only those file extensions that are appropriate for the web server. Rather than create a blacklist of potentially inappropriate file extensions such as           <xhtml:span class="inline_block">.bak</xhtml:span>
,           <xhtml:span class="inline_block">.config</xhtml:span>
,           <xhtml:span class="inline_block">.old</xhtml:span>
, etc., it is recommended instead that a whitelist of the appropriate and expected file extensions for the web server be created, reviewed, and enforced with a           <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/3" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#filesmatch</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Compile a list of existing file extensions on the web server. The following                 <xhtml:span class="inline_block">find/awk</xhtml:span>
 command may be useful but is likely to need some customization according to the appropriate webroot directories for your web server. Please note that the find command skips over any files without a dot (.) in the filename, as these are not expected to be appropriate web content.
                <xhtml:code class="code_block">find */htdocs -type f -name '*.*' | awk -F. '{print $NF }' | sort -u
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>Review the list of existing file extensions. Remove those that are inappropriate and add any appropriate file extensions expected to be added to the web server in the near future.</xhtml:li>
                     <xhtml:li>
Add the                 <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive below, which denies access to all files by default.
                <xhtml:code class="code_block"># Block all files by default, unless specifically allowed.
&lt;FilesMatch "^.*$"&gt;
    Order Deny,Allow
    Deny from all 
&lt;/FilesMatch&gt;
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add another                 <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive that allows access to those file extensions specifically allowed from the review process in step 2. An example                 <xhtml:span class="inline_block">FilesMatch</xhtml:span>
 directive is below. The file extensions in the regular expression should match your approved list, and not necessarily the expression below.
                <xhtml:code class="code_block"># Allow files with specifically approved file extensions
# Such as (css, htm; html; js; pdf; txt; xml; xsl; ...),
# images (gif; ico; jpeg; jpg; png; ...), multimedia
&lt;FilesMatch "^.*\.(css|html?|js|pdf|txt|xml|xsl|gif|ico|jpe?g|png)$"&gt;
    Order Deny,Allow
    Allow from all
&lt;/FilesMatch&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.12_Ensure_IP_Address_Based_Requests_Are_Disallowed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure IP Address Based Requests Are Disallowed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache module           <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 should disallow access for requests that use an IP address instead of a host name for the URL. Most normal access to the website from browsers and automated software will use a hostname, and will therefore include the hostname in the HTTP HOST header.        </xhtml:p>
            <xhtml:p>
Refer to the Apache 2.2 documentation for details:
          <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A common malware propagation and automated network scanning technique is to use IP addresses rather than hostnames for web requests, since it's simpler to automate. By denying IP-based web requests, these automated techniques will be denied access to the website. Malicious web scanning techniques continue to evolve, and many are now using hostnames, but denying access to IP-based requests is still a worthwhile defensive measure.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Load the                 <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 module for Apache by doing either one of the following:
                <xhtml:ul>
                           <xhtml:li>
Build Apache with                     <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
 statically loaded during the build by adding the                     <xhtml:span class="inline_block">--enable-rewrite</xhtml:span>
option to the                     <xhtml:span class="inline_block">./configure</xhtml:span>
 script.
                    <xhtml:code class="code_block">/configure --enable-rewrite
</xhtml:code>
                           </xhtml:li>
                           <xhtml:li>
Or, dynamically load the module with the                     <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive in the                     <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 configuration file.
                    <xhtml:code class="code_block">LoadModule rewrite_module modules/mod_rewrite.so
</xhtml:code>
                           </xhtml:li>
                        </xhtml:ul>
                     </xhtml:li>
                     <xhtml:li>
Add the                 <xhtml:span class="inline_block">RewriteEngine</xhtml:span>
 directive to the configuration within the global server context with the value of                 <xhtml:span class="inline_block">on</xhtml:span>
 so the rewrite engine is enabled.
                <xhtml:code class="code_block">RewriteEngine On
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Locate the Apache configuration file such as                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 and add the following rewrite condition to match the expected host name of the top server level configuration.
                <xhtml:code class="code_block">RewriteCond %{HTTP_HOST} !^www\.example\.com [NC]
RewriteCond %{REQUEST_URI} !^/error [NC]
RewriteRule ^.(.*) - [L,F]
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.13_Ensure_the_IP_Addresses_for_Listening_for_Requests_Are_Specified" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the IP Addresses for Listening for Requests Are Specified</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">Listen</xhtml:span>
 directive specifies the IP addresses and port numbers the Apache web server will listen on for requests. Rather than be unrestricted to listen on all IP addresses available to the system, the specific IP address or addresses intended should be explicitly specified. Specifically, a           <xhtml:span class="inline_block">Listen</xhtml:span>
 directive with no IP address specified or with an IP address of all zeroes should not be used.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Limit Open Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9:1">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Having multiple interfaces on web servers is fairly common, and without explicit           <xhtml:span class="inline_block">Listen</xhtml:span>
 directives, the web server is likely to be listening on an IP address or interface that was not intended for the web server. Single-homed systems with a single IP address are also required to have an explicit IP address in the           <xhtml:span class="inline_block">Listen</xhtml:span>
 directive, in case additional interfaces are added to the system at a later date.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mpm_common.html#listen</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Find any                 <xhtml:span class="inline_block">Listen</xhtml:span>
 directives in the Apache configuration file with no IP address specified or with an IP address of all zeroes similar to the examples below. Keep in mind there may be both IPv4 and IPv6 addresses on the system.
                <xhtml:code class="code_block">Listen 80
Listen 0.0.0.0:80
Listen [::ffff:0.0.0.0]:80
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Modify the                 <xhtml:span class="inline_block">Listen</xhtml:span>
 directives in the Apache configuration file to have explicit IP addresses according to the intended usage. Multiple                 <xhtml:span class="inline_block">Listen</xhtml:span>
 directives may be specified for each IP address and port.
                <xhtml:code class="code_block">Listen 10.1.2.3:80
Listen 192.168.4.5:80
Listen [2001:db8::a00:20ff:fea7:ccea]:80
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.14_Ensure_Browser_Framing_Is_Restricted" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Browser Framing Is Restricted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Header directive allows server HTTP response headers to be added, replaced, or merged. Use the directive to add a server HTTP response header to tell browsers to restrict all the web pages from being framed by other web sites.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Using iframes and regular web frames to embed malicious content along with expected web content has been a favored attack vector for attacking web clients for a long time. This can happen when the attacker lures the victim to a malicious web site, which uses frames to include the expected content from the legitimate site. The attack can also be performed via XSS (either reflected, DOM or stored XSS) to add the malicious content to the legitimate web site. To combat this vector, an HTTP Response header, X-Frame-Options, has been introduced that allows a server to specify whether a web page may be loaded in any frame (          <xhtml:span class="inline_block">DENY</xhtml:span>
) or only those frames that share the page's origin (          <xhtml:span class="inline_block">SAMEORIGIN</xhtml:span>
).        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header</xccdf:ident>
         <xccdf:ident system="URL">https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header</xccdf:ident>
         <xccdf:ident system="URL">http://blogs.msdn.com/b/ie/archive/2009/01/27/ie8-security-part-vii-clickjacking-defenses.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">Header</xhtml:span>
 directive for the               <xhtml:span class="inline_block">X-Frame-Options</xhtml:span>
 header in the Apache configuration to have the condition               <xhtml:span class="inline_block">always</xhtml:span>
, an action of               <xhtml:span class="inline_block">append</xhtml:span>
, and a value of               <xhtml:span class="inline_block">SAMEORIGIN</xhtml:span>
, as shown below.            </xhtml:p>
                  <xhtml:code class="code_block">Header always append X-Frame-Options SAMEORIGIN
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_Operations_-_Logging_Monitoring_and_Maintenance">
      <xccdf:title xml:lang="en">Operations - Logging, Monitoring and Maintenance</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Operational procedures of logging, monitoring and maintenance are vital to protecting your web servers as well as the rest of the infrastructure.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_the_Error_Log_Filename_and_Severity_Level_Are_Configured_Correctly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Error Log Filename and Severity Level Are Configured Correctly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LogLevel</xhtml:span>
 directive is used to configure the severity level for the error logs, while the           <xhtml:span class="inline_block">ErrorLog</xhtml:span>
 directive configures the error log filename. The log level values are the standard syslog levels of           <xhtml:span class="inline_block">emerg</xhtml:span>
,           <xhtml:span class="inline_block">alert</xhtml:span>
,           <xhtml:span class="inline_block">crit</xhtml:span>
,           <xhtml:span class="inline_block">error</xhtml:span>
,           <xhtml:span class="inline_block">warn</xhtml:span>
,           <xhtml:span class="inline_block">notice</xhtml:span>
,           <xhtml:span class="inline_block">info</xhtml:span>
 and           <xhtml:span class="inline_block">debug</xhtml:span>
. The recommended level is           <xhtml:span class="inline_block">notice</xhtml:span>
, so that all errors from the           <xhtml:span class="inline_block">emerg</xhtml:span>
 level through the           <xhtml:span class="inline_block">notice</xhtml:span>
 level will be logged.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Ensure Audit Log Settings Support Appropriate Log Entry Formatting" urn="urn:cisecurity.org:controls:6.0:6:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The server error logs are invaluable because they can be used to spot potential problems before they become serious. Most importantly, they can be used to watch for anomalous behavior such as numerous "not found" or "unauthorized" errors that may be an indication an attack is pending or has occurred.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/logs.html</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#loglevel</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#errorlog</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Add or modify the                 <xhtml:span class="inline_block">LogLevel</xhtml:span>
 in the Apache configuration to have a value of                 <xhtml:span class="inline_block">notice</xhtml:span>
 or lower. Note that is it is compliant to have a value of                 <xhtml:span class="inline_block">info</xhtml:span>
 or                 <xhtml:span class="inline_block">debug</xhtml:span>
 if there is a need for a more verbose log and the storage and monitoring processes are capable of handling the extra load. The recommended value is                 <xhtml:span class="inline_block">notice</xhtml:span>
.
                <xhtml:code class="code_block">LogLevel notice
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add an                 <xhtml:span class="inline_block">ErrorLog</xhtml:span>
 directive if not already configured. The file path may be relative or absolute, or the logs may be configured to be sent to a syslog server.
                <xhtml:code class="code_block">ErrorLog "logs/error_log"
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add a similar                 <xhtml:span class="inline_block">ErrorLog</xhtml:span>
 directive for each virtual host configured if the virtual host will have different people responsible for the web site. Each responsible individual or organization needs access to their own web logs.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_a_Syslog_Facility_Is_Configured_for_Error_Logging" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure a Syslog Facility Is Configured for Error Logging</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">ErrorLog</xhtml:span>
 directive should be configured to send web server error logs to a           <xhtml:span class="inline_block">syslog</xhtml:span>
 facility so the logs can be processed and monitored along with the system logs.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Deploy A SIEM OR Log Analysis Tools  For Aggregation And Correlation/Analysis" urn="urn:cisecurity.org:controls:6.0:6:6">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>It is easy for web server error logs to be overlooked in the log monitoring process, yet application-level attacks have become the most common and are extremely important for detecting attacks early, as well as detecting non-malicious problems such as a broken link or internal errors. By including the Apache error logs with the system logging facility, the application logs are more likely to be included in the established log monitoring process.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/6" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/logs.html</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#loglevel</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#errorlog</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Add an                 <xhtml:span class="inline_block">ErrorLog</xhtml:span>
 directive if not already configured. Any appropriate                 <xhtml:span class="inline_block">syslog</xhtml:span>
 facility may be used in place of                 <xhtml:span class="inline_block">local1</xhtml:span>
.
                <xhtml:code class="code_block">ErrorLog "syslog:local1"
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add a similar                 <xhtml:span class="inline_block">ErrorLog</xhtml:span>
 directive for each virtual host if necessary.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_the_Server_Access_Log_Is_Configured_Correctly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Server Access Log Is Configured Correctly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LogFormat</xhtml:span>
 directive defines the format and information to be included in the server access log entries. The           <xhtml:span class="inline_block">CustomLog</xhtml:span>
 directive specifies the log file, syslog facility, or piped logging utility.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Ensure Audit Log Settings Support Appropriate Log Entry Formatting" urn="urn:cisecurity.org:controls:6.0:6:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The server access logs are invaluable for a variety of reasons. They can be used to determine what resources are being used most. Most importantly, they can be used to investigate anomalous behavior that may be an indication an attack is pending or has occurred. If the server only logs errors and does not log successful access, it is very difficult to investigate incidents. You may see that the errors stop and wonder if the attacker gave up or if the attack was successful.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
                        <xhtml:p>
Add or modify the                   <xhtml:span class="inline_block">LogFormat</xhtml:span>
 directives in the Apache configuration to use the standard and recommended                   <xhtml:span class="inline_block">combined</xhtml:span>
 format as shown below.                </xhtml:p>
                        <xhtml:code class="code_block">LogFormat "%h %l %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>
Add or modify the                   <xhtml:span class="inline_block">CustomLog</xhtml:span>
 directives in the Apache configuration to use the combined format with an appropriate log file, syslog facility, or piped logging utility.                </xhtml:p>
                        <xhtml:code class="code_block">CustomLog log/access_log combined
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>
Add a similar                   <xhtml:span class="inline_block">CustomLog</xhtml:span>
 directive for each virtual host configured if the virtual host will have different people responsible for the web site. Each responsible individual or organization needs access to their own web logs.                </xhtml:p>
                        <xhtml:p>The format string tokens provide the following information:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%h</xhtml:span>
 = Remote hostname or IP address if HostnameLookups is set to Off, which is the default.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%l</xhtml:span>
 = Remote logname / identity.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%u</xhtml:span>
 = Remote user, if the request was authenticated.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%t</xhtml:span>
 = Time the request was received,                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%r</xhtml:span>
 = First line of request.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%&gt;s</xhtml:span>
 = Final status.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%b</xhtml:span>
 = Size of response in bytes.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%{Referer}i</xhtml:span>
 = Variable value for Referer header.                  </xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">%{User-agent}i</xhtml:span>
 = Variable value for User Agent header.                  </xhtml:li>
                        </xhtml:ul>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_Log_Storage_and_Rotation_Is_Configured_Correctly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Log Storage and Rotation Is Configured Correctly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>It is important that there is adequate disk space on the partition to hold all the log files, and that log rotation is configured to retain at least three months or 13 weeks of logs if central logging is not used for storage.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive)" urn="urn:cisecurity.org:controls:6.0:6:3">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The generation of logs is under a potential attacker's control, so do not hold any Apache log files on the root partition of the OS. This could result in a denial of service against your web server host by filling up the root partition and causing the system to crash. For this reason, it is recommended that the log files should be stored on a dedicated partition. Likewise, consider that attackers sometimes put information into your logs which is intended to attack your log collection or log analysis processing software. So it is important that they are not vulnerable. Investigation of incidents often requires access to several months or more of logs, which is why it is important to keep at least three months' worth available. Two common log rotation utilities are           <xhtml:span class="inline_block">rotatelogs(8)</xhtml:span>
, which is bundled with Apache, and           <xhtml:span class="inline_block">logrotate(8)</xhtml:span>
, commonly bundled on Linux distributions.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
To implement the recommended state, do either option a) if using the Linux               <xhtml:span class="inline_block">logrotate</xhtml:span>
 utility or option b) if using a piped logging utility such as the Apache               <xhtml:span class="inline_block">rotatelogs</xhtml:span>
:            </xhtml:p>
                  <xhtml:p>a) File Logging with Logrotate:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Add or modify the web log rotation configuration to match your configured log files in                 <xhtml:span class="inline_block">/etc/logrotate.d/httpd</xhtml:span>
 to be similar to the following.
                <xhtml:code class="code_block">/var/log/httpd/*log {
    missingok
    notifempty
    sharedscripts
       postrotate
    /bin/kill -HUP 'cat /var/run/httpd.pid 2&gt;/dev/null' 2&gt; /dev/null || true
    endscript
}
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Modify the rotation period and number of logs to keep so that at least 13 weeks or three months of logs are retained. This may be done as the default value for all logs in                 <xhtml:span class="inline_block">/etc/logrotate.conf</xhtml:span>
 or in the web specific log rotation configuration in                 <xhtml:span class="inline_block">/etc/logrotate.d/httpd</xhtml:span>
 to be similar to the following.
                <xhtml:code class="code_block"># rotate log files weekly
weekly

# keep 1 year of logs
rotate 52
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">3. For each virtual host configured with its own log files, ensure those log files are also included in a similar log rotation.
</xhtml:code>
                  <xhtml:p>b) Piped Logging:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Configure the log rotation interval and log filenames to a suitable interval such as daily.
                <xhtml:code class="code_block">CustomLog "|bin/rotatelogs -l /var/logs/logfile.%Y.%m.%d 86400" combined
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>Ensure the log file naming and any rotation scripts provide for retaining at least three months or 13 weeks of log files.</xhtml:li>
                     <xhtml:li>For each virtual host configured with its own log files, ensure those log files are included in a similar log rotation.</xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.5_Ensure_Applicable_Patches_Are_Applied" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Applicable Patches Are Applied</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Apply Apache patches within one month of availability.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Continuous Vulnerability Assessment and Remediation" urn="urn:cisecurity.org:controls:6.0:4"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Obviously knowing about newly discovered vulnerabilities is only part of the solution; there needs to be a process in place where patches are tested and installed. These patches fix diverse problems, including security issues. It is recommended to use the Apache packages and updates provided by your Linux platform vendor rather than building from source whenever possible in order to minimize the disruption and the work of keeping the software up-to-date.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/security/vulnerabilities_22.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Update to the latest Apache release available according to either of the following:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>When building from source:
</xhtml:li>
                     <xhtml:li>When using platform packages:
</xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_ModSecurity_Is_Installed_and_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure ModSecurity Is Installed and Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span class="inline_block">ModSecurity</xhtml:span>
 is an open source web application firewall (WAF) for real-time web application monitoring, logging, and access control. It does not include a powerful customizable rule set, which may be used to detect and block common web application attacks. Installation of           <xhtml:span class="inline_block">ModSecurity</xhtml:span>
 without a rule set does not provide additional security for the protected web applications. Refer to the benchmark recommendation "          <xhtml:em>Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled</xhtml:em>
" for details on a recommended rule set.        </xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 Like other application security/application firewall systems,           <xhtml:span class="inline_block">ModSecurity</xhtml:span>
 requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing           <xhtml:span class="inline_block">ModSecurity</xhtml:span>
 may NOT be effective and may provide a false sense of security.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Deploy And Configure Web Application Firewalls" urn="urn:cisecurity.org:controls:6.0:18:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Installation of the           <xhtml:span class="inline_block">ModSecurity</xhtml:span>
 Apache module enables a customizable web application firewall rule set which may be configured to detect and block common attack patterns as well as block outbound data leakage.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://www.modsecurity.org/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to enable the module:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Install the                 <xhtml:span class="inline_block">ModSecurity</xhtml:span>
 module if it is not already installed in modules/mod_security2.so. It may be installed via OS package installation (such as apt-get or yum) or built from the source files. See                 <xhtml:a href="https://www.modsecurity.org/download.html">https://www.modsecurity.org/download.html</xhtml:a>
 for details.              </xhtml:li>
                     <xhtml:li>
Add or modify the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive if not already present in the Apache configuration as shown below. Typically, the                 <xhtml:span class="inline_block">LoadModule</xhtml:span>
 directive is placed in the file named                 <xhtml:span class="inline_block">mod_security.conf</xhtml:span>
, which is included in the Apache configuration:
                <xhtml:code class="code_block">LoadModule security2_module modules/mod_security2.so
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_the_OWASP_ModSecurity_Core_Rule_Set_Is_Installed_and_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The OWASP ModSecurity Core Rule Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>HTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.</xhtml:li>
               <xhtml:li>Real-time Blacklist Lookups - utilizes 3rd Party IP Reputation</xhtml:li>
               <xhtml:li>HTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.</xhtml:li>
               <xhtml:li>Common Web Attacks Protection - detecting common web application security attack.</xhtml:li>
               <xhtml:li>Automation Detection - Detecting bots, crawlers, scanners and other surface malicious activity.</xhtml:li>
               <xhtml:li>Integration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.</xhtml:li>
               <xhtml:li>Tracking Sensitive Data - Tracks Credit Card usage and blocks leakages.</xhtml:li>
               <xhtml:li>Trojan Protection - Detecting access to Trojans horses.</xhtml:li>
               <xhtml:li>Identification of Application Defects - alerts on application misconfigurations.</xhtml:li>
               <xhtml:li>Error Detection and Hiding - Disguising error messages sent by the server.</xhtml:li>
            </xhtml:ul>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 Like other application security/application firewall systems, Mod_Security requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing Mod_Security may NOT be effective and may provide a false sense of security.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Deploy And Configure Web Application Firewalls" urn="urn:cisecurity.org:controls:6.0:18:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Installing, configuring, and enabling the OWASP ModSecurity Core Rule Set (CRS) provides additional baseline security defense and a good starting point to customize the monitoring and blocking of common web application attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project</xccdf:ident>
         <xccdf:ident system="URL">https://www.modsecurity.org/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Install, configure and test the OWASP ModSecurity Core Rule Set:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Download the OWASP ModSecurity CRS from the project page                 <xhtml:a href="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project</xhtml:a>
.              </xhtml:li>
                     <xhtml:li>
Unbundle the archive and follow the instructions in the                 <xhtml:span class="inline_block">INSTALL</xhtml:span>
 file.              </xhtml:li>
                     <xhtml:li>
The                 <xhtml:span class="inline_block">modsecurity_crs_10_setup.conf</xhtml:span>
 file is required, and rules in the                 <xhtml:span class="inline_block">base_rules</xhtml:span>
 directory are intended as a baseline useful for most applications.              </xhtml:li>
                     <xhtml:li>
Test the application for correct functionality after installing the CRS. Check web server error logs and the                 <xhtml:span class="inline_block">modsec_audit.log</xhtml:span>
 file for blocked requests due to false positives.              </xhtml:li>
                     <xhtml:li>
It is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The web server error log and                 <xhtml:span class="inline_block">modsec_audit.log</xhtml:span>
 files should show logs of the attacks and the server's response codes.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_SSLTLS">
      <xccdf:title xml:lang="en">SSL/TLS</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section pertain to the configuration of SSL/TLS-related aspects of Apache HTTP server.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_mod_ssl_andor_mod_nss_Is_Installed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure mod_ssl and/or mod_nss Is Installed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Secure Sockets Layer (SSL) was developed by Netscape and turned into an open standard renamed Transport Layer Security (TLS). TLS is important for protecting communication and can provide authentication of the server and even the client. However, contrary to vendor claims, implementing TLS does NOT make your web server more secure. TLS is used to encrypt traffic and does provide confidentiality for private information and user credentials, but just because you have encrypted the data in transit does not mean that the data provided by the client is secure while it is on the server. Also, TLS inadvertently conceals attacks contained within the traffic it protects.</xhtml:p>
            <xhtml:p>
The           <xhtml:span class="inline_block">mod_ssl</xhtml:span>
 module is the standard, most used module that implements TLS for Apache. A newer module found on Red Hat systems can be a complement or replacement for           <xhtml:span class="inline_block">mod_ssl</xhtml:span>
, and provides the same functionality plus additional security services. The           <xhtml:span class="inline_block">mod_nss</xhtml:span>
 is an Apache module implementation of the Network Security Services (NSS) software from Mozilla, which implements a wide range of cryptographic functions in addition to TLS.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>It is best to plan for TLS implementation from the beginning of any new web server because most web servers have some need for TLS due to:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Non-public information submitted that should be protected as it's transmitted to the web server</xhtml:li>
               <xhtml:li>Non-public information that is downloaded from the web server</xhtml:li>
               <xhtml:li>Users authenticating to some portion of the web server</xhtml:li>
               <xhtml:li>Authenticating the web server to ensure users they have reached the real web server and have not been phished or redirected to a bogus site</xhtml:li>
            </xhtml:ul>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html</xccdf:ident>
         <xccdf:ident system="URL">https://directory.fedoraproject.org/wiki/Mod_nss</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform either of the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
For Apache installations built from source, use the option                 <xhtml:span class="inline_block">--with-ssl=</xhtml:span>
 to specify the openssl path, and the                 <xhtml:span class="inline_block">--enable-ssl</xhtml:span>
 configure option to add the SSL modules to the build. The                 <xhtml:span class="inline_block">--with-included-apr</xhtml:span>
 configure option may be necessary if there are conflicts with the platform version. See the Apache documentation on building from source                 <xhtml:a href="http://httpd.apache.org/docs/2.2/install.html">http://httpd.apache.org/docs/2.2/install.html</xhtml:a>
 for details.
                <xhtml:code class="code_block"># ./configure --with-included-apr --with-ssl=$OPENSSL_DIR --enable-ssl
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
For installations using OS packages, it is typically just a matter of ensuring the                 <xhtml:span class="inline_block">mod_ssl</xhtml:span>
 package is installed. The                 <xhtml:span class="inline_block">mod_nss</xhtml:span>
 package might also be installed. The following yum command is suitable for Red Hat Linux.
                <xhtml:code class="code_block"># yum install mod_ssl
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_a_Valid_Trusted_Certificate_Is_Installed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure a Valid Trusted Certificate Is Installed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The default SSL certificate is self-signed and is not trusted. Install a valid certificate signed by a commonly trusted certificate authority. To be valid, the certificate must not be expired, and must have a common name that matches the hostname of the web server, such as           <xhtml:a href="http://www.example.com">www.example.com</xhtml:a>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A digital certificate on your server automatically communicates your site's authenticity to visitors' web browsers. If a trusted authority signs your certificate, it confirms for visitors they are actually communicating with you, and not with a fraudulent site stealing credit card numbers or personal information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#realcert</xccdf:ident>
         <xccdf:ident system="URL">https://www.openssl.org/docs/HOWTO/certificates.txt</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Decide on the hostname to be used for the certificate. It is important to remember that the browser will compare the hostname in the URL to the common name in the certificate, so it is important that all https: URLs match the correct hostname. Specifically, the hostname                 <xhtml:span class="inline_block">www.example.com</xhtml:span>
 is not the same as                 <xhtml:span class="inline_block">example.com</xhtml:span>
 nor the same as                 <xhtml:span class="inline_block">ssl.example.com</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Generate a private key using openssl. Although certificate key lengths of 1024 have been common in the past, a key length of 2048 is now recommended for strong authentication. The key must be kept confidential and will be encrypted with a passphrase by default. Follow the steps below and respond to the prompts for a passphrase. See the Apache or OpenSSL documentation for details:
                <xhtml:ul>
                           <xhtml:li>
                              <xhtml:a href="http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#realcert">http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#realcert</xhtml:a>
                           </xhtml:li>
                           <xhtml:li>
                              <xhtml:a href="http://www.openssl.org/docs/HOWTO/certificates.txt">http://www.openssl.org/docs/HOWTO/certificates.txt</xhtml:a>
                           </xhtml:li>
                        </xhtml:ul>
                     </xhtml:li>
                     <xhtml:li>Generate the certificate signing request (CSR) to be signed by a certificate authority. It is important that the common name exactly matches the web hostname.
</xhtml:li>
                     <xhtml:li>Send the CSR to a certificate signing authority to be signed, and follow their instructions for submission and validation. The CSR and the final signed certificate are just encoded text and need to have their integrity protected, but not their confidentiality. This certificate will be given out for every SSL connection made.</xhtml:li>
                     <xhtml:li>
The resulting signed certificate may be named                 <xhtml:span class="inline_block">www.example.com.crt</xhtml:span>
 and placed in                 <xhtml:span class="inline_block">/etc/pki/tls/certs/</xhtml:span>
 as readable by all (mode 0444). Please note that the certificate authority does not need the private key (                <xhtml:span class="inline_block">example.com.key</xhtml:span>
) and this file must be carefully protected. With a decrypted copy of the private key, it would be possible to decrypt all conversations with the server.              </xhtml:li>
                     <xhtml:li>
Do not forget the passphrase used to encrypt the private key. It will be required every time the server is started in https mode. If it is necessary to avoid requiring an administrator having to type the passphrase every time the                 <xhtml:span class="inline_block">httpd</xhtml:span>
 service is started, the private key may be stored in clear text. Storing the private key in clear text increases the convenience while increasing the risk of disclosure of the key, but may be appropriate for the sake of being able to restart if the risks are well managed. Be sure that the key file is only readable by root. To decrypt the private key and store it in a clear text file, the following openssl command may be used. You can tell by the private key headers whether it is encrypted or clear text.
                <xhtml:code class="code_block"># cd /etc/pki/tls/private/
# umask 077
# openssl rsa -in example.com.key -out example.com.key.clear
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Locate the Apache configuration file for                 <xhtml:span class="inline_block">mod_ssl</xhtml:span>
 and add or modify the                 <xhtml:span class="inline_block">SSLCertificateFile</xhtml:span>
 and                 <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>
 directives to have the correct path for the private key and signed certificate files. If a clear text key is referenced, a passphrase will not be required. You can use the CA's certificate that signed your certificate instead of the CA bundle to speed up the initial SSL connection, as fewer certificates will need to be transmitted.
                <xhtml:code class="code_block">SSLCertificateFile /etc/pki/tls/certs/example.com.crt
SSLCertificateKeyFile /etc/pki/tls/private/example.com.key

# Default CA file, can be replaced with your CA's certificate. 
SSLCACertificateFile /etc/pki/tls/certs/ca-bundle.crt
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Lastly, start or restart the                 <xhtml:span class="inline_block">httpd</xhtml:span>
 service and verify correct functioning with your favorite browser.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_the_Servers_Private_Key_Is_Protected" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Server's Private Key Is Protected</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
It is critical to protect the server's private key. The private key is encrypted by default as a means of protecting it, but having it encrypted means that the passphrase is required each time the server is started up. Now it is necessary to protect the passphrase as well. The passphrase may be typed in when it is manually started up or provided by an automated program. See           <xhtml:a href="http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslpassphrasedialog">http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslpassphrasedialog</xhtml:a>
 for details.
To summarize, the options are:        </xhtml:p>
            <xhtml:ol>
               <xhtml:li>
Use             <xhtml:span class="inline_block">SSLPassPhraseDialog builtin</xhtml:span>
, which requires a passphrase to be manually entered.          </xhtml:li>
               <xhtml:li>
Use             <xhtml:span class="inline_block">SSLPassPhraseDialog |/path/to/program</xhtml:span>
 to provide the passphrase.          </xhtml:li>
               <xhtml:li>
Use             <xhtml:span class="inline_block">SSLPassPhraseDialog exec:/path/to/program</xhtml:span>
 to provide the passphrase.          </xhtml:li>
               <xhtml:li>Store the private key in clear text so a passphrase is not required.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Any of the above options 1-4 are acceptable as long as the key and passphrase are protected properly. Option 1 has the additional security benefit of not storing the passphrase but is not generally acceptable for most production web servers, since it requires the web server to be manually started. Options 2 and 3 can provide additional security if the programs providing them are secure. Option 4 is the simplest, is widely used, and is acceptable as long as the private key is appropriately protected.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Controlled Access Based on the Need to Know" urn="urn:cisecurity.org:controls:6.0:14"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>If the private key were to be disclosed, it could be used to decrypt all of the SSL communications with the web server as well as to impersonate the web server.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
All private keys must be stored separately from the public certificates. Find all                 <xhtml:span class="inline_block">SSLCertificateFile</xhtml:span>
 directives in the Apache configuration files. For any                 <xhtml:span class="inline_block">SSLCertificateFile</xhtml:span>
 directives that do not have a corresponding separate                 <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>
 directive, move the key to a separate file from the certificate, and add the                 <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>
 directive for the key file.              </xhtml:li>
                     <xhtml:li>
For each                 <xhtml:span class="inline_block">SSLCertificateKeyFile</xhtml:span>
 directive, change the ownership and permissions on the server private key to be owned by                 <xhtml:span class="inline_block">root:root</xhtml:span>
 with permission                 <xhtml:span class="inline_block">0400</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_Ensure_Weak_SSL_Protocols_Are_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Weak SSL Protocols Are Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The Apache           <xhtml:span class="inline_block">SSLProtocol</xhtml:span>
 directive specifies the SSL and TLS protocols allowed. Both the SSLv2 and the SSLv3 protocols should be disabled in this directive because they are outdated and vulnerable to information disclosure. Only TLS protocols should be enabled.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The SSLv2 and SSLv3 protocols are flawed and shouldn't be used, as they are subject to man-in-the-middle attacks and other cryptographic attacks. The TLSv1 protocols should be used instead, and the newer TLS protocols are preferred.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslprotocol</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">https://www.us-cert.gov/ncas/alerts/TA14-290A</xccdf:ident>
         <xccdf:ident system="URL">https://www.openssl.org/~bodo/ssl-poodle.pdf</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Search the Apache configuration files for the SSLProtocol directive. Add the directive if not present or change the value to match one of the following values. The first setting,               <xhtml:span class="inline_block">TLSv1.1 TLS1.2</xhtml:span>
, is preferred when it is acceptable to also disable the TLSv1.0 protocol. See the level 2 recommendation "Ensure the TLS v1.0 Protocol Is Disabled" for details.            </xhtml:p>
                  <xhtml:code class="code_block">SSLProtocol TLSv1.1 TLSv1.2
</xhtml:code>
                  <xhtml:code class="code_block">SSLProtocol TLSv1
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_Ensure_Weak_SSLTLS_Ciphers_Are_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Weak SSL/TLS Ciphers Are Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Disable weak SSL ciphers using the           <xhtml:span class="inline_block">SSLCipherSuite</xhtml:span>
 and           <xhtml:span class="inline_block">SSLHonorCipherOrder</xhtml:span>
 directives. The           <xhtml:span class="inline_block">SSLCipherSuite</xhtml:span>
 directive specifies which ciphers are allowed in the negotiation with the client. The           <xhtml:span class="inline_block">SSLHonorCipherOrder</xhtml:span>
 directive causes the server's preferred ciphers to be used instead of the clients' specified preferences.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
The SSL/TLS protocols support a large number of encryption ciphers, including many weak ciphers that are subject to man-in-the middle attacks and information disclosure. Some implementations even support the NULL cipher, which allows a TLS connection without any encryption! Therefore, it is critical to ensure the configuration only allows strong ciphers greater than or equal to 128 bit to be negotiated with the client. Stronger 256-bit ciphers should be allowed and preferred. In addition, enabling           <xhtml:span class="inline_block">SSLHonorCipherOrder</xhtml:span>
 further protects the client from man-in-the-middle downgrade attacks by ensuring the server's preferred ciphers will be used rather than the clients' preferences.        </xhtml:p>
            <xhtml:p>In addition, the RC4 stream ciphers should be disabled, even though they are widely used and have been recommended in previous Apache benchmarks as a means of mitigating attacks based on CBC cipher vulnerabilities. The RC4 ciphers have known cryptographic weaknesses and are no longer recommended. The IETF has published the RFC 7465 standard[4] that would disallow RC4 negotiation for all TLS versions. While the document is somewhat new (Feb 2015), it is expected the RC4 cipher suites will begin to disappear from options in TLS deployments. In the meantime, it is important to ensure that RC4-based cipher suites are disabled in the configuration.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslciphersuite</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslhonorcipherorder</xccdf:ident>
         <xccdf:ident system="URL">https://github.com/rbsec/sslscan</xccdf:ident>
         <xccdf:ident system="URL">https://tools.ietf.org/html/rfc7465</xccdf:ident>
         <xccdf:ident system="URL">https://community.qualys.com/blogs/securitylabs/2013/03/19/rc4-in-tls-is-broken-now-what</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>Add or modify the following line in the Apache server level configuration and every virtual host that is SSL enabled:</xhtml:p>
                  <xhtml:code class="code_block">
SSLHonorCipherOrder On              <br></br>
SSLCipherSuite ALL:!EXP:!NULL:!LOW:!SSLv2:!MD5:!RC4:!aNULL
            </xhtml:code>
                  <xhtml:p>
It is               <xhtml:strong>not</xhtml:strong>
 recommended to add               <xhtml:span class="inline_block">!SSLv3</xhtml:span>
 to the directive even if the SSLv3 protocol is not in use. Doing so disables ALL of the ciphers that may be used with SSLv3, which includes the same ciphers used with the TLS protocols. The               <xhtml:span class="inline_block">!aNULL</xhtml:span>
 will disable both the ADH and AECDH ciphers, so the               <xhtml:span class="inline_block">!ADH</xhtml:span>
 is not required.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_Ensure_Insecure_SSL_Renegotiation_Is_Not_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Insecure SSL Renegotiation Is Not Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
A man-in-the-middle renegotiation attack was discovered in SSLv3 and TLSv1 in Nov 2009           <xhtml:a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555">CVE-2009-3555</xhtml:a>
.           <xhtml:a href="http://www.phonefactor.com/sslgap/ssl-tls-authentication-patches">http://www.phonefactor.com/sslgap/ssl-tls-authentication-patches</xhtml:a>
 A fix was approved as an Internet Standard as RFC 574, Feb 2010. The workaround which removes the renegotiation is available from OpenSSL as of version 0.9.8l and newer versions. For details:           <xhtml:a href="http://www.openssl.org/news/secadv_20091111.txt">http://www.openssl.org/news/secadv_20091111.txt</xhtml:a>

The           <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>
 directive was added in Apache 2.2.15 for web servers linked with OpenSSL version 0.9.8m or later, to allow the insecure renegotiation to provide backward compatibility to clients with the older unpatched SSL implementations. While providing backward compatibility, enabling the           <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>
 directive also leaves the server vulnerable to man-in-the-middle renegotiation attack CVE-2009-3555. Therefore, the           <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>
 directive should not be enabled.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The seriousness and ramification of this attack warrants that servers and clients be upgraded to support the improved SSL/TLS protocols. Therefore, the recommendation is to not enable the insecure renegotiation.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslinsecurerenegotiation</xccdf:ident>
         <xccdf:ident system="URL">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Search the Apache configuration files for the               <xhtml:span class="inline_block">SSLInsecureRenegotiation</xhtml:span>
 directive. If the directive is present, modify the value to be off. If the directive is not present, no action is required.            </xhtml:p>
                  <xhtml:code class="code_block">SSLInsecureRenegotiation off
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_SSL_Compression_is_Not_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure SSL Compression is Not Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">SSLCompression</xhtml:span>
 directive controls whether SSL compression is used by Apache when serving content over HTTPS. It is recommended that the           <xhtml:span class="inline_block">SSLCompression</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">off</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>If SSL compression is enabled, HTTPS communication between the client and the server may be at increased risk to the CRIME attack. The CRIME attack increases a malicious actor's ability to derive the value of a session cookie, which commonly contains an authenticator. If the authenticator in a session cookie is derived, it can be used to impersonate the account associated with the authenticator.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslcompression</xccdf:ident>
         <xccdf:ident system="URL">https://en.wikipedia.org/wiki/CRIME_(security_exploit)</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Verify the Apache version is 2.2.24 or later, with the command                 <xhtml:span class="inline_block">httpd -v</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>
Search the Apache configuration files for the                 <xhtml:span class="inline_block">SSLCompression</xhtml:span>
 directive.              </xhtml:li>
                     <xhtml:li>
Add or update the directive to have a value of                 <xhtml:span class="inline_block">off</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_Ensure_Medium_Strength_SSLTLS_Ciphers_Are_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Medium Strength SSL/TLS Ciphers Are Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The SSLCipherSuite directive specifies which ciphers are allowed in the negotiation with the client. Disable the medium strength ciphers such as Triple DES (3DES) and IDEA by adding           <xhtml:span class="inline_block">!3DES</xhtml:span>
 and           <xhtml:span class="inline_block">!IDEA</xhtml:span>
 in the SSLCipherSuite directive.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Although Triple DES was a trusted standard in the past, several vulnerabilities for it have been published over the years and it is no longer considered secure. A somewhat recent attack against 3DES in CBC mode, nicknamed the SWEET32 attack, was published in 2016 as CVE-2016-2183. The IDEA cipher in CBC mode is also vulnerable to the SWEET32 attack.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslciphersuite</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslhonorcipherorder</xccdf:ident>
         <xccdf:ident system="URL">https://sweet32.info/</xccdf:ident>
         <xccdf:ident system="URL">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-2183</xccdf:ident>
         <xccdf:ident system="URL">https://github.com/rbsec/sslscan</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>Add or modify the following line in the Apache server level configuration and every virtual host that is SSL/TLS enabled:</xhtml:p>
                  <xhtml:code class="code_block">SSLCipherSuite ALL:!EXP:!NULL:!LOW:!SSLv2:!MD5:!RC4:!aNULL:!3DES:!IDEA
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.9_Ensure_the_TLS_v1.0_Protocol_Is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the TLS v1.0 Protocol Is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The TLSv1.0 protocol should be disabled via the           <xhtml:span class="inline_block">SSLProtocol</xhtml:span>
 directive, if possible, because it is vulnerable to information disclosure.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The TLSv1.0 protocol is vulnerable to the BEAST attack when used in CBC mode (October 2011). Unfortunately, TLSv1.0 uses CBC modes for all of the block mode ciphers, which only leaves the RC4 streaming cipher. The RC4 cipher is also weak and is not recommended. Therefore, it is recommended that the TLSv1.0 protocol be disabled if all TLS clients support the newer TLS protocols. All major up-to-date browsers support TLSv1.1 and TLSv1.2. Ensuring that all user's browsers are configured to allow TLSv1.1 and TLSv1.2 is necessary before disabling TLSv1.0 on the Apache web server; therefore, this recommendation is a level 2 rather than a level 1. Disabling TLSv1.0 on internal-only websites is more easily accomplished when access is limited to clients with browsers controlled by the organization's policies and procedures to allow and prefer TLSv1.1 and higher.</xhtml:p>
            <xhtml:p>The NIST SP 800-52r1 guidelines for TLS configuration state that servers that support government-only applications shall not support TLSv1.0 or any of the SSL protocols, while servers that support citizen or business-facing applications may be configured to support TLS version 1.0 in order to enable interaction with citizens and businesses.</xhtml:p>
            <xhtml:p>
Some organizations may find it helpful to implement a phased transitional plan where TLSv1.0 is not disabled, but the web server will detect browsers which do not have TLSv1.1 or newer enabled and redirect them to a web site that explains how to enable the newer TLS protocols. The redirect can be implemented using           <xhtml:span class="inline_block">mod_rewrite</xhtml:span>
, which can detect the protocol used and rewrite the URL to the helpful website.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Web_browsers - Browser support and defaults for SSL/TLS protocols</xccdf:ident>
         <xccdf:ident system="URL">https://community.qualys.com/blogs/securitylabs/2013/09/10/is-beast-still-a-threat</xccdf:ident>
         <xccdf:ident system="URL">http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-52r1.pdf</xccdf:ident>
         <xccdf:ident system="URL">https://support.microsoft.com/en-us/gp/microsoft-internet-explorer</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Search the Apache configuration files for the               <xhtml:span class="inline_block">SSLProtocol</xhtml:span>
 directive; add the directive if not present or change the value to               <xhtml:span class="inline_block">TLSv1.1 TLSv1.2</xhtml:span>
.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.10_Ensure_HTTP_Strict_Transport_Security_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure HTTP Strict Transport Security Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>HTTP Strict Transport Security (HSTS) is an optional web server security policy mechanism specified by an HTTP Server header. The HSTS header allows a server declaration that only HTTPS communication should be used rather than clear text HTTP communication.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Encrypt All Sensitive Information Over Less-trusted Networks" urn="urn:cisecurity.org:controls:6.0:14:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Usage of HTTP Strict Transport Security (HSTS) helps protect HSTS-compliant browsers and other agents from HTTP downgrade attacks. Downgrade attacks include a variety of man-in-the-middle attacks which leave the web communication vulnerable to disclosure and modification by forcing the usage of HTTP rather than HTTPS communication. The           <xhtml:span class="inline_block">sslstrip</xhtml:span>
 attack tool by Moxie Marlinspike released in 2009 is one such attack, which works when a server allows both HTTP and HTTPS communication. However, a man-in-the-middle HTTP-to-HTTPS proxy would be effective in cases where the server required HTTPS but did not publish an HSTS policy to the browser. This attack would also be effective on browsers which were not compliant with HSTS. All current up-to-date browsers support HSTS.        </xhtml:p>
            <xhtml:p>The HSTS header specifies a length of time in seconds that the browser/user agent should access the server only using HTTPS. The header may also specify if all subdomains should also be included in the same policy. Once a compliant browser receives the HSTS header, it will not allow access to the server via HTTP. Therefore, it is important you ensure there is no portion of the web site or web application that requires HTTP prior to enabling the HSTS protocol.</xhtml:p>
            <xhtml:p>
If all subdomains are to be included via the           <xhtml:em>includeSubDomains</xhtml:em>
 option, carefully consider all various hostnames, web applications, and third-party services used to include any DNS CNAME values that may be impacted. An overly broad           <xhtml:em>includeSubDomains</xhtml:em>
 policy will disable access to HTTP websites for all websites with the same domain name. Also consider that the access will be disabled for the number of seconds given in the max-age value, so in the event a mistake is made, a large value, such as a year, could create significant support issues. An optional flag of preload may be added if the website name is to be submitted to be preloaded in Chrome, Firefox and Safari browsers. See           <xhtml:a href="https://hstspreload.appspot.com/">https://hstspreload.appspot.com/</xhtml:a>
 for details.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/HTTP_Strict_Transport_Security</xccdf:ident>
         <xccdf:ident system="URL">https://moxie.org/software/sslstrip/</xccdf:ident>
         <xccdf:ident system="URL">https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security</xccdf:ident>
         <xccdf:ident system="URL">https://hstspreload.appspot.com/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add a               <xhtml:span class="inline_block">Header</xhtml:span>
 directive as shown below in the Apache server level configuration and every virtual host that is SSL enabled. The               <xhtml:span class="inline_block">includeSubDomains</xhtml:span>
 and               <xhtml:span class="inline_block">preload</xhtml:span>
 flags may be included in the header, but are not required.            </xhtml:p>
                  <xhtml:code class="code_block">
Header always set Strict-Transport-Security "max-age=600; includeSubDomains; preload              <br></br>
- or -              <br></br>
Header always set Strict-Transport-Security "max-age=600
            </xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8_Information_Leakage">
      <xccdf:title xml:lang="en">Information Leakage</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section are intended to limit the disclosure of potentially sensitive information.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_ServerTokens_Provides_Minimal_Information" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure ServerTokens Provides Minimal Information</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Configure the Apache           <xhtml:span class="inline_block">ServerTokens</xhtml:span>
 directive to provide minimal information by setting the value to           <xhtml:span class="inline_block">Prod</xhtml:span>
 or           <xhtml:span class="inline_block">ProductOnly</xhtml:span>
. The only version information given in the server HTTP response header will be           <xhtml:span class="inline_block">Apache</xhtml:span>
 rather than details on modules and versions installed.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Deployed Software Of Development Artifacts" urn="urn:cisecurity.org:controls:6.0:18:9">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Information is power, and identifying web server details greatly increases the efficiency of any attack, as security vulnerabilities are extremely dependent upon specific software versions and configurations. Excessive probing and requests may cause too much "noise" being generated and may tip off an administrator. If an attacker can accurately target exploits, the chances of successful compromise prior to detection increase dramatically. Script kiddies are constantly scanning the Internet and documenting the version information openly provided by web servers. The purpose of this scanning is to accumulate a database of software installed on those hosts, which can then be used when new vulnerabilities are released.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#servertokens</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">ServerTokens</xhtml:span>
 directive as shown below to have the value of               <xhtml:span class="inline_block">Prod</xhtml:span>
 or               <xhtml:span class="inline_block">ProductOnly</xhtml:span>
:            </xhtml:p>
                  <xhtml:code class="code_block">ServerTokens Prod
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2_Ensure_ServerSignature_Is_Not_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure ServerSignature Is Not Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Disable the server signatures, which is the generation of a signature line as a trailing footer at the bottom of server-generated documents such as error pages.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Server signatures are helpful when the server is acting as a proxy because they help the user distinguish errors from the proxy rather than the destination server. However, in this context there is no need for the additional information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#serversignature</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">ServerSignature</xhtml:span>
 directive as shown below to have the value of               <xhtml:span class="inline_block">Off</xhtml:span>
:            </xhtml:p>
                  <xhtml:code class="code_block">ServerSignature Off
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3_Ensure_ETag_Response_Header_Fields_Do_Not_Include_Inodes" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure ETag Response Header Fields Do Not Include Inodes</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The FileETag directive configures the file attributes that are used to create the ETag (entity tag) response header field when the document is based on a static file. The ETag value is used in cache management to save network bandwidth. The value returned may be based on combinations of the file inode, the modification time, and the file size.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Deployed Software Of Development Artifacts" urn="urn:cisecurity.org:controls:6.0:18:9">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>When the FileETag is configured to include the file inode number, a remote attacker may be able to discern the inode number from returned values. The inode is considered sensitive information, as it could be useful in assisting in other attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">http://httpd.apache.org/docs/2.2/mod/core.html#FileETag</xccdf:ident>
         <xccdf:ident system="URL">https://nvd.nist.gov/vuln/detail/CVE-2003-1418</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">FileETag</xhtml:span>
 directive in the server and each virtual host configuration to have the value               <xhtml:span class="inline_block">None</xhtml:span>
 or               <xhtml:span class="inline_block">MTime Size</xhtml:span>
.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4_Ensure_All_Default_Apache_Content_Is_Removed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure All Default Apache Content Is Removed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>In previous recommendations, we have removed default content such as the Apache manuals and default CGI programs. However, if you want to further restrict information leakage about the web server, it is important that default content such as icons are not left on the web server.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Sanitize Deployed Software Of Development Artifacts" urn="urn:cisecurity.org:controls:6.0:18:9">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
To identify the type of web servers and versions software installed, it is common for attackers to scan for icons or special content specific to the server type and version. A simple request like           <xhtml:a href="http://example.com/icons/apache_pb2.png">http://example.com/icons/apache_pb2.png</xhtml:a>
 may tell the attacker that the server is Apache 2.2. Many icons are used primarily for auto indexing, which is recommended to be disabled.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform either of the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
The default source build places the auto-index and icon configurations in the                 <xhtml:span class="inline_block">extra/httpd-autoindex.conf</xhtml:span>
 file, so it can be disabled by leaving the include line commented out in the main                 <xhtml:span class="inline_block">httpd.conf</xhtml:span>
 file, as shown below.
                <xhtml:code class="code_block"># Fancy directory listings
#Include conf/extra/httpd-autoindex.conf
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Alternatively, the icon                 <xhtml:span class="inline_block">alias</xhtml:span>
 directive and the directory access control configuration can be commented out as shown:
                <xhtml:code class="code_block"># We include the /icons/ alias for FancyIndexed directory listings. If
# you do not use FancyIndexing, you may comment this out.
#
#Alias /icons/ "/var/www/icons/"

#&lt;Directory "/var/www/icons"&gt;
#     Options Indexes MultiViews FollowSymLinks
#     AllowOverride None
#     Order allow,deny
#     Allow from all
#&lt;/Directory&gt;
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_9_Denial_of_Service_Mitigations">
      <xccdf:title xml:lang="en">Denial of Service Mitigations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Denial of Service (DoS) attacks intend to degrade a server's ability to process and respond to service requests. Typically, DoS attacks attempt to exhaust the server's network-, CPU-, disk-, and/or memory- related resources. Configuration states in this section may increase a server's resiliency to DoS attacks.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.1_Ensure_the_TimeOut_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the TimeOut Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">TimeOut</xhtml:span>
 directive controls the maximum time in seconds that Apache HTTP server will wait for an Input/Output call to complete. It is recommended that the           <xhtml:span class="inline_block">TimeOut</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">10</xhtml:span>
 or less.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>One common technique for DoS is to initiate many connections to the server. By decreasing the timeout for old connections, the server can free resources more quickly and be more responsive. By making the server more efficient, it will be more resilient to DoS conditions.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Important Notice</xhtml:strong>
: There is a slow form of DoS attack not adequately mitigated by these control, such as the Slow Loris DoS attack of June 2009           <xhtml:a href="http://ha.ckers.org/slowloris/">http://ha.ckers.org/slowloris/</xhtml:a>
. Upgrading to Apache 2.4 is recommended.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#timeout</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">Timeout</xhtml:span>
 directive in the Apache configuration files to have a value of               <xhtml:span class="inline_block">10</xhtml:span>
 seconds or less.            </xhtml:p>
                  <xhtml:code class="code_block">Timeout 10
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.2_Ensure_KeepAlive_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure KeepAlive Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">KeepAlive</xhtml:span>
 directive controls whether Apache will reuse the same TCP connection per client to process subsequent HTTP requests from that client. It is recommended that the           <xhtml:span class="inline_block">KeepAlive</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">On</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Allowing per-client reuse of TCP sockets reduces the amount of system and network resources required to serve requests. This efficiency gain may improve a server's resiliency to DoS attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#keepalive</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">KeepAlive</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">On</xhtml:span>
.            </xhtml:p>
                  <xhtml:code class="code_block">KeepAlive On
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.3_Ensure_MaxKeepAliveRequests_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure MaxKeepAliveRequests Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">MaxKeepAliveRequests</xhtml:span>
 directive limits the number of requests allowed per connection when           <xhtml:span class="inline_block">KeepAlive</xhtml:span>
 is on. If it is set to           <xhtml:span class="inline_block">0</xhtml:span>
, unlimited requests will be allowed. It is recommended that the           <xhtml:span class="inline_block">MaxKeepAliveRequests</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">100</xhtml:span>
 or greater.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting the number of requests per connection may improve a server's resiliency to DoS attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#maxkeepaliverequests</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">MaxKeepAliveRequests</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">100</xhtml:span>
 or more.            </xhtml:p>
                  <xhtml:code class="code_block">MaxKeepAliveRequests 100
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.4_Ensure_the_KeepAliveTimeout_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the KeepAliveTimeout Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">KeepAliveTimeout</xhtml:span>
 directive specifies the number of seconds Apache will wait for a subsequent request before closing a connection that is being kept alive.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Reducing the number of seconds that Apache HTTP server will keep unused resources allocated will increase the availability of resources to serve other requests. This efficiency gain may improve a server's resiliency to DoS attacks.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#keepalivetimeout</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">KeepAliveTimeout</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">15</xhtml:span>
 or less.            </xhtml:p>
                  <xhtml:code class="code_block">KeepAliveTimeout 15
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.5_Ensure_Timeout_Limits_for_Request_Headers_Are_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Timeout Limits for Request Headers Are Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>
 directive allows configuration of timeout limits for client requests. The header portion of the directive provides for an initial timeout value, a maximum timeout, and a minimum rate. The minimum rate specifies that after the initial timeout, the server will wait an additional second for each N bytes received. The recommended setting is to have a maximum timeout of           <xhtml:span class="inline_block">40</xhtml:span>
 seconds or less. Keep in mind that for SSL/TLS virtual hosts, the time for the TLS handshake must fit within the timeout.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Setting a request header timeout is vital for mitigating DoS attacks based on slow requests. The slow request attacks are particularly lethal and relative easy to perform, because they require very little bandwidth and can easily be done through anonymous proxies. These attacks started in June 2009 with the Slow Loris DoS attack, which used a slow           <xhtml:span class="inline_block">GET</xhtml:span>
 request, as published by Robert Hansen (RSnake) on his blog           <xhtml:a href="http://ha.ckers.org/slowloris/">http://ha.ckers.org/slowloris/</xhtml:a>
. Later in November 2010 at the OWASP App Sec DC conference, Wong Onn Chee demonstrated a slow POST request attack which was even more effective.  For details, see:           <xhtml:a href="https://www.owasp.org/index.php/H.....t.....t....p.......p....o....s....t">https://www.owasp.org/index.php/H.....t.....t....p.......p....o....s....t</xhtml:a>
            </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">http://ha.ckers.org/slowloris/</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/H.....t.....t....p.......p....o....s....t</xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_reqtimeout.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Load the                 <xhtml:span class="inline_block">mod_requesttimeout</xhtml:span>
 module in the Apache configuration with the following.
                <xhtml:code class="code_block">LoadModule reqtimeout_module modules/mod_reqtimeout.so
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add a                 <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>
 directive similar to the one below with the maximum request header timeout value of                 <xhtml:span class="inline_block">40</xhtml:span>
 seconds or less.
                <xhtml:code class="code_block">RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_9.6_Ensure_Timeout_Limits_for_the_Request_Body_Are_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Timeout Limits for the Request Body Are Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>
 directive allows setting timeout values for the body portion of a request. The directive provides for an initial timeout value, a maximum timeout, and a minimum rate. The minimum rate specifies that after the initial timeout, the server will wait an additional second for each N bytes received. The recommended setting is to have a maximum timeout of           <xhtml:span class="inline_block">20</xhtml:span>
 seconds or less.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
It is not sufficient to timeout only on the header portion of the request, as the server will still be vulnerable to attacks like the OWASP Slow           <xhtml:span class="inline_block">POST</xhtml:span>
 attack, which provide the body of the request very slowly. Therefore, the body portion of the request must have a timeout as well. A timeout of           <xhtml:span class="inline_block">20</xhtml:span>
 seconds or less is recommended.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/mod_reqtimeout.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Load the                 <xhtml:span class="inline_block">mod_requesttimeout</xhtml:span>
 module in the Apache configuration with the following.
                <xhtml:code class="code_block">LoadModule reqtimeout_module modules/mod_reqtimeout.so
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Add a                 <xhtml:span class="inline_block">RequestReadTimeout</xhtml:span>
 directive similar to the one below with the maximum request body timeout value of                 <xhtml:span class="inline_block">20</xhtml:span>
 seconds or less.
              </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_10_Request_Limits">
      <xccdf:title xml:lang="en">Request Limits</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section reduce the maximum allowed size of request parameters. Doing so increases the likelihood of negatively impacting application and/or site functionality. It is highly recommended that the configuration states described in this section be tested on test servers prior to deploying them to production servers.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.1_Ensure_the_Maximum_Request_Line_Length_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Maximum Request Line Length Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LimitRequestLine</xhtml:span>
 directive sets the maximum number of bytes that Apache will read for each line of an HTTP request. It is recommended that the           <xhtml:span class="inline_block">LimitRequestLine</xhtml:span>
 be set to           <xhtml:span class="inline_block">512</xhtml:span>
 or less.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting request line size may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#limitrequestline</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">LimitRequestLine</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">512</xhtml:span>
 or less.            </xhtml:p>
                  <xhtml:code class="code_block">LimitRequestLine 512
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.2_Ensure_the_Maximum_Request_Headers_Per_Request_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Maximum Request Headers Per Request Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LimitRequestFields</xhtml:span>
 directive sets the maximum limit on the number of HTTP request headers allowed per request. It is recommended that the           <xhtml:span class="inline_block">LimitRequestFields</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">100</xhtml:span>
 or less.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting the number of headers per request may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#limitrequestfields</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">LimitRequestFields</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">100</xhtml:span>
 or less. If the directive is not present, the default depends on a compile time configuration, but defaults to a value of               <xhtml:span class="inline_block">100</xhtml:span>
.            </xhtml:p>
                  <xhtml:code class="code_block">LimitRequestFields 100
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.3_Enusre_the_Maximum_Request_Header_Field_Size_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enusre the Maximum Request Header Field Size Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LimitRequestFieldSize</xhtml:span>
 directive sets the maximum size of an HTTP request header field. It is recommended that the           <xhtml:span class="inline_block">LimitRequestFieldSize</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">1024</xhtml:span>
 or less.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting header field size may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#limitrequestfieldsize</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">LimitRequestFieldSize</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">1024</xhtml:span>
 or less.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_10.4_Ensure_the_Maximum_Request_Body_Size_Is_Set_Properly" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Maximum Request Body Size Is Set Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">LimitRequestBody</xhtml:span>
 directive sets the maximum size of an HTTP request body. It is recommended that the           <xhtml:span class="inline_block">LimitRequestBody</xhtml:span>
 directive be set to           <xhtml:span class="inline_block">102400</xhtml:span>
 or less.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:6.0:9"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting request body size may reduce the exposure of a buffer-related vulnerability potentially present in a code base hosted by Apache HTTP server.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/9" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://httpd.apache.org/docs/2.2/mod/core.html#limitrequestbody</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
Add or modify the               <xhtml:span class="inline_block">LimitRequestBody</xhtml:span>
 directive in the Apache configuration to have a value of               <xhtml:span class="inline_block">102400</xhtml:span>
 (100K) or less. Please read the Apache documentation so it is understood this directive will limit the size of file uploads to the web server.            </xhtml:p>
                  <xhtml:code class="code_block">LimitRequestBody 102400
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_11_Enable_SELinux_to_Restrict_Apache_Processes">
      <xccdf:title xml:lang="en">Enable SELinux to Restrict Apache Processes</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section provide mandatory access controls (MAC) using the SELinux kernel module in targeted mode. SELinux provides additional enforced security which will prevent access to resources, files, and directories by the httpd processes, even in cases where an application or server vulnerability might allow inappropriate access. The SELinux controls are advanced security controls that require significant effort to ensure they do not negatively impact the application and/or site functionality. It is highly recommended that the configuration states described in this section be tested thoroughly on test servers prior to deploying them to production servers.</xhtml:p>
         <xhtml:p>SELinux and AppArmor provide similar controls, and it is not recommended to use both SELinux and AppArmor on the same system. Depending on which Linux distribution is in use, either AppArmor or SELinux is likely to be already installed or readily available as packages. AppArmor differs from SELinux in that it binds the controls to programs rather than users and uses pathnames rather than labeled type enforcement.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.1_Ensure_SELinux_Is_Enabled_in_Enforcing_Mode" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure SELinux Is Enabled in Enforcing Mode</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>SELinux (Security-Enhanced Linux) is a Linux kernel security module that provides mandatory access control security policies with type enforcement that are checked after the traditional discretionary access controls. It was created by the US National Security Agency and can enforce rules on files and processes in a Linux system, and restrict actions, based on defined policies.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Web applications and services continue to be one of the leading attack vectors for criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The SELinux mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model only allowing what is explicitly permitted.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://en.wikipedia.org/wiki/Security-Enhanced_Linux</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
If SELinux is not enabled in the configuration file, edit the file               <xhtml:span class="inline_block">/etc/selinux/config</xhtml:span>
 and set the value of SELINUX as               <xhtml:span class="inline_block">enforcing</xhtml:span>
. Reboot the system for the new configuration to be effective.            </xhtml:p>
                  <xhtml:code class="code_block">SELINUX=enforcing
</xhtml:code>
                  <xhtml:p>
If the current mode is not               <xhtml:span class="inline_block">enforcing</xhtml:span>
 and an immediate reboot is not possible, the current mode can be set to               <xhtml:span class="inline_block">enforcing</xhtml:span>
 with the command shown below.            </xhtml:p>
                  <xhtml:code class="code_block"># setenforce 1
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.2_Ensure_Apache_Processes_Run_in_the_httpd_t_Confined_Context" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure Apache Processes Run in the httpd_t Confined Context</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>SELinux includes customizable targeted policies that may be used to confine the Apache httpd server to enforce least privileges so the httpd server has only the minimal access to specified directories, files, and network ports. Access is controlled by process types (domains) defined for the httpd process. There are over a hundred individual httpd related types defined in a default Apache SELinux policy, which includes many of the common Apache add-ons and applications such as php, nagios, and smokeping. The default SELinux policies work well for a default Apache installation, but implementation of SELinux targeted policies on a complex or highly customized web server requires a rather significant development and testing effort which comprehends both the workings of SELinux and the detailed operations and requirements of the web application.</xhtml:p>
            <xhtml:p>All directories and files to be accessed by the web server process must have security labels with appropriate types. The following types are a sample of the most commonly used:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>
                  <xhtml:span class="inline_block">http_port_t</xhtml:span>
 - Network ports allowed for listening          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">httpd_sys_content_t</xhtml:span>
 - Read access to directories and files with web content          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">httpd_log_t</xhtml:span>
 - Directories and files to be used for writable log data          </xhtml:li>
               <xhtml:li>
                  <xhtml:span class="inline_block">httpd_sys_script_exec_t</xhtml:span>
 - Directories and files for executable content.          </xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
With the proper implementation of SELinux, vulnerabilities in the web application may be prevented from being exploited due to the additional restrictions. For example, a vulnerability that allows an attacker to read to inappropriate system files may be prevented from execution by SELinux because the inappropriate files are not labeled as           <xhtml:span class="inline_block">httpd_sys_content_t</xhtml:span>
. Likewise, writing to an unexpected directory or execution of unexpected content can be prevented by similar mandatory security labels enforced by SELinux.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/chap-Security-Enhanced_Linux-Targeted_Policy.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
If the running httpd processes are not confined to the               <xhtml:span class="inline_block">httpd_t</xhtml:span>
 SELinux context, check the context for the httpd binary and the               <xhtml:span class="inline_block">apachectl</xhtml:span>
 binary, and set the httpd binary to have a context of               <xhtml:span class="inline_block">httpd_exec_t</xhtml:span>
 and the               <xhtml:span class="inline_block">apachectl</xhtml:span>
 executable to have a context of               <xhtml:span class="inline_block">initrc_exec_t</xhtml:span>
, as shown below. Also note that on some platforms, such as Ubuntu, the Apache executable is named apache2 instead of httpd.            </xhtml:p>
                  <xhtml:p>
If the executable files are not labeled correctly, they may be relabeled with the               <xhtml:span class="inline_block">chcon</xhtml:span>
 command, as shown; however, the file system labeling is based on the SELinux file context policies, and the file systems will on some occasions be relabeled according to the policy.            </xhtml:p>
                  <xhtml:code class="code_block">
# chcon -t initrc_exec_t /usr/sbin/apachectl              <br></br>
# chcon -t httpd_exec_t /usr/sbin/httpd /usr/sbin/httpd.*   
            </xhtml:code>
                  <xhtml:p>
Since the file system may be relabeled based on SELinux policy, it's best to check the SELinux policy with the               <xhtml:span class="inline_block">semanage fcontext -l</xhtml:span>
 option. If the policy is not present, add the pattern to the policy using the               <xhtml:span class="inline_block">-a</xhtml:span>
 option. The               <xhtml:span class="inline_block">restorecon</xhtml:span>
 command shown below will restore the file context label according to the current policy, and is required if a pattern was added.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.3_Ensure_the_httpd_t_Type_Is_Not_in_Permissive_Mode" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the httpd_t Type Is Not in Permissive Mode</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
In addition to setting the entire SELinux configuration in permissive mode, it is possible to set individual process types (domains) such as           <xhtml:span class="inline_block">httpd_t</xhtml:span>
 into permissive mode as well. Permissive mode will not prevent any access or actions; instead, any actions that would have been denied are simply logged.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Protect Information With Access Control Lists" urn="urn:cisecurity.org:controls:6.0:14:4">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Usage of permissive mode is helpful for testing and ensuring that SELinux will not prevent access that is necessary for the proper function of a web application. However, all access is allowed in permissive mode by SELinux.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/sect-Security-Enhanced_Linux-Fixing_Problems-Permissive_Domains.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
If the               <xhtml:span class="inline_block">httpd_t</xhtml:span>
 type is in permissive mode, the customized permissive mode should be deleted with the following               <xhtml:span class="inline_block">semanage</xhtml:span>
 command.            </xhtml:p>
                  <xhtml:code class="code_block"># semanage permissive -d httpd_t 
</xhtml:code>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_11.4_Ensure_Only_the_Necessary_SELinux_Booleans_Are_Enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure Only the Necessary SELinux Booleans Are Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
SELinux booleans allow or disallow behavior specific to the Apache web server. Common examples include whether CGI execution is allowed, or if the httpd server is allowed to communicate with the current terminal (          <xhtml:span class="inline_block">tty</xhtml:span>
). Communication with the terminal may be necessary for entering a passphrase during startup to decrypt a private key.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:6.0:18"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling only the necessary httpd related booleans provides a defense in depth approach that will deny actions that are not in use or expected.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/18" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/sect-Security-Enhanced_Linux-Working_with_SELinux-Booleans.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:p>
To disable the SELinux httpd booleans that are determined to be unnecessary, use the               <xhtml:span class="inline_block">setsebool</xhtml:span>
 command as shown below with the               <xhtml:span class="inline_block">-P</xhtml:span>
 option to make the change persistent.            </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_12_Enable_AppArmor_to_Restrict_Apache_Processes">
      <xccdf:title xml:lang="en">Enable AppArmor to Restrict Apache Processes</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Recommendations in this section provide mandatory access controls (MAC) using the AppArmor kernel module. AppArmor provides additional enforced security which will prevent access to resources, files, and directories by the apache2 processes even in cases where an application or server vulnerability might allow inappropriate access. The AppArmor controls are advanced security controls that require significant effort to ensure they do not negatively impact the application and/or site functionality. It is highly recommended that the configuration states described in this section be tested thoroughly on test servers prior to deploying them to production servers.</xhtml:p>
         <xhtml:p>AppArmor and SELinux provide similar controls, and it is not recommended to use both SELinux and AppArmor on the same system. Depending on which Linux distribution is in use, either AppArmor or SELinux is likely to be already installed or readily available as packages. AppArmor differs from SELinux in that it binds the controls to programs rather than users and uses pathnames rather than labeled type enforcement.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_12.1_Ensure_the_AppArmor_Framework_Is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the AppArmor Framework Is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>AppArmor is a Linux kernel security module that provides named-based mandatory access control with security policies. AppArmor can enforce rules on programs for file access and network connections and restrict actions based on defined policies.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Deploy Application Whitelisting" urn="urn:cisecurity.org:controls:6.0:2:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Web applications and web services continue to be one of the leading attack vectors for criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The AppArmor mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model only allowing what is explicitly permitted.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://help.ubuntu.com/community/AppArmor</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
If the                 <xhtml:span class="inline_block">aa-status</xhtml:span>
 command is not found, the AppArmor package is not installed and needs to be installed using the appropriate Linux distribution package management. For example:
                <xhtml:code class="code_block"># apt-get install apparmor
# apt-get install libapache2-mod-apparmor
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
To enable the AppArmor framework, run the                 <xhtml:span class="inline_block">init.d</xhtml:span>
 script as shown below.
                <xhtml:code class="code_block"># /etc/init.d/apparmor start
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_12.2_Ensure_the_Apache_AppArmor_Profile_Is_Configured_Properly" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure the Apache AppArmor Profile Is Configured Properly</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
AppArmor includes customizable profiles that may be used to confine the Apache web server to enforce least privileges so the server has only the minimal access to specified directories, files, and network ports. Access is controlled by a profile defined for the apache2 process. The default AppArmor profile is typically a very permissive profile that allows read-write access to all system files. Therefore, it's important that the default profile be customized to enforce least privileges. The AppArmor utilities such as           <xhtml:span class="inline_block">aa-autodep</xhtml:span>
,           <xhtml:span class="inline_block">aa-complain</xhtml:span>
, and           <xhtml:span class="inline_block">aa-logprof</xhtml:span>
 can be used to generate an initial profile based on actual usage. However, thorough testing, review, and customization will be necessary to ensure the Apache profile restrictions allow the necessary functionality while implementing least privilege.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:control title="Inventory of Authorized and Unauthorized Software" urn="urn:cisecurity.org:controls:6.0:2"></controls:control>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>With the proper implementation of an AppArmor profile, vulnerabilities in the web application may be prevented from being exploited due to the additional restrictions. For example, a vulnerability that allows an attacker to read an inappropriate system files may be prevented from execution by AppArmor because the inappropriate files are not allowed by the profile. Likewise, writing to an unexpected directory or executing unexpected content can be prevented by similar mandatory security controls enforced by AppArmor.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:ident system="URL">https://wiki.ubuntu.com/AppArmor</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Stop the Apache server.
                <xhtml:code class="code_block"># service apache2 stop
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Create a mostly empty apache2 profile based on program dependencies.
                <xhtml:code class="code_block"># aa-autodep apache2
Writing updated profile for /usr/sbin/apache2.
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Set the apache2 profile in complain mode so access violations will be allowed and will be logged.
                <xhtml:code class="code_block"># aa-complain apache2
Setting /usr/sbin/apache2 to complain mode.
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Start the apache2 service.
                <xhtml:code class="code_block"># service apache2 start
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Thoroughly test the web application, attempting to exercise all intended functionality so AppArmor will generate the necessary logs of all resources accessed. The logs are sent via the system syslog utility and are typically found in either the                 <xhtml:span class="inline_block">/var/log/syslog</xhtml:span>
 or                 <xhtml:span class="inline_block">/var/log/messages</xhtml:span>
 files. Also stop and restart the web server as part of the testing process.              </xhtml:li>
                     <xhtml:li>
Use                 <xhtml:span class="inline_block">aa-logprof</xhtml:span>
 to update the profile based on logs generated during the testing. The tool will prompt for suggested modifications to the profile, based on the logs. The logs may also be reviewed manually in order to update the profile.
                <xhtml:code class="code_block"># aa-logprof
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Review and edit the profile, removing any inappropriate content and adding appropriate access rules. Directories with multiple files accessed with the same permission can be simplified with the usage of wild-cards when appropriate. Reload the updated profile using the                 <xhtml:span class="inline_block">apparmor_parser</xhtml:span>
 command.
                <xhtml:code class="code_block"># apparmor_parser -r /etc/apparmor.d/usr.sbin.apache2
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Test the new updated profile again, checking for any new apparmor denied logs generated. Update and reload the profile as necessary. Repeat the application tests until no new apparmor deny logs are created, except for access which should be prohibited.
                <xhtml:code class="code_block"># tail -f /var/log/syslog
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Set the apache2 profile to enforce mode, reload apparmor, and test the web site functionality again.
                <xhtml:code class="code_block"># aa-enforce /usr/sbin/apache2
# /etc/init.d/apparmor reload
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_12.3_Ensure_the_Apache_AppArmor_Profile_Is_in_Enforce_Mode" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure the Apache AppArmor Profile Is in Enforce Mode</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>AppArmor profiles may be in one of three modes: disabled, complain, or enforce. In the complain mode, any violations of the access controls are logged but the restrictions are not enforced. Also, once a profile mode has been changed, it is recommended to restart the Apache server, otherwise the currently running process may not be confined by the policy.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:6.0">
                  <controls:safeguard title="Deploy Application Whitelisting" urn="urn:cisecurity.org:controls:6.0:2:2">
                     <controls:implementation_groups></controls:implementation_groups>
                     <controls:asset_type></controls:asset_type>
                     <controls:security_function></controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The complain mode is useful for testing and debugging a profile but is not appropriate for production. Only the confined process running in enforce mode will prevent attacks that violate the configured access controls.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v6.0"></xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the recommended state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the profile state to enforce mode.
                <xhtml:code class="code_block"># aa-enforce apache2
Setting /usr/sbin/apache2 to enforce mode.
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Stop the Apache server and confirm that is it not running. In some cases, the AppArmor controls may prevent the web server from stopping properly, and it may be necessary to stop the process manually or even reboot the server.
                <xhtml:code class="code_block"># service apache2 stop
 * Stopping web server apache2 
# service apache2 status
 * apache2 is not running
</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
Restart the Apache service.
                <xhtml:code class="code_block"># service apache2 start
 * Starting web server apache2
</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>qHAG9sp2cAHDkSnepbA8mKjK6mcvVedftzk9Q2tDniU=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
qFpjT3n1OG9mGFE++rNNAIZVKklPcwIX3ucLBGoOE9hU4SG/SiVg0VaN7yg4trCnmgaGQswNhpLu
O7p+Ctw12VcR7Ba2ms1EPA4FxH7UJalcp7pyvAmzgSg/XK+KCreVJPAbORdBjWMDaJ2ZAataeIKQ
ziAh4g+xbnTXlXKOEW8Tu3W4kp2mKiyZx93KvFN390Abl9xI6Bba6ig6JYCI4JvxIqYEi+Qh6wX8
0td+9vlJDGHoM39IDkEAb1Fj3IPFoqLthDGLpb8dkP91hOt/6nR7QFhRrknzYYsUXC+K+egVFuXX
854FSIfZKkFxLYmw1lrG7OKFNRpioQd+a++HXkG8cifYvnr/vQjqdiCmg6ZFQQAnMdOH1OiDv0Mx
jIFvuQE5bTKVzfY6t9xU600h7UKnogCLaqKdGM2+03UJpXRe7ArMeAMGiHWgRiS1BiRbF71XNuFq
pQGiT8ZlBiNQT+3nOVcYN/jW0Q2rDmbWMplIuRhp5GdlisRPfBQZDsTg
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>