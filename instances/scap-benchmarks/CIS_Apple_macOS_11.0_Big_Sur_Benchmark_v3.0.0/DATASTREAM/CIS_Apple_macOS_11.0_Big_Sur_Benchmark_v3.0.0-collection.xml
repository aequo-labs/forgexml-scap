<ds:data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:sce="http://open-scap.org/page/SCE_xccdf_stream" xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_org.cisecurity_collection_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark" schematron-version="1.0">
   <ds:data-stream id="scap_org.cisecurity_datastream_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark" scap-version="1.2" timestamp="2024-11-10T19:31:57" use-case="CONFIGURATION">
      <ds:dictionaries>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-dictionary" xlink:href="#scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-dictionary">
            <cat:catalog>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-CPE-OVAL" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-oval"></cat:uri>
            </cat:catalog>
         </ds:component-ref>
      </ds:dictionaries>
      <ds:checklists>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-xccdf" xlink:href="#scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-xccdf">
            <cat:catalog>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-OVAL" uri="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-oval"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_software_update_current" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_current"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_auto_update" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_update"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_auto_download" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_download"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_appstore_install" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_appstore_install"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_security_system_download" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_system_download"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_update_os" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_update_os"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_software_update_deferment" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_deferment"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_bluetooth_menu" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_bluetooth_menu"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_wifi_menu" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_wifi_menu"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_time_set_auto" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_set_auto"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_time_server_sync" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_server_sync"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_screen_saver_inactivity" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_screen_saver_inactivity"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_secure_corners" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_corners"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_remote_apple_events" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_apple_events"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_internet_sharing" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_internet_sharing"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_screen_sharing" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_screen_sharing"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_print_sharing" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_print_sharing"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_remote_login" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_login"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_dvd_cd_share" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_dvd_cd_share"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_bluetooth_sharing" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bluetooth_sharing"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_file_share" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_file_share"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_ard_agent" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ard_agent"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_content_caching" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_content_caching"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_airdrop_disabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_airdrop_disabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_media_sharing" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_media_sharing"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_fdesetup_status" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_fdesetup_status"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_firewall_enable" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_enable"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_firewall_stealth" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_stealth"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_location_services" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_location_services"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_diagnostic_data" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_diagnostic_data"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_limit_ad_tracking" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_limit_ad_tracking"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_gatekeeper_enabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_gatekeeper_enabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_login_message" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_message"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_admin_password_required" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_password_required"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_wake_password" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_password"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_icloud_docs_desktop" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_icloud_docs_desktop"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_timemachine_autobackup" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_autobackup"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_timemachine_encrypted" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_encrypted"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_wake_on_lan" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_on_lan"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_powernap" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_powernap"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_hibernate_standby" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_hibernate_standby"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_efi_valid" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_efi_valid"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_security_audit" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_audit"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_audit_flags" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_flags"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_retain_install_log" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_retain_install_log"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_audit_retention" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_retention"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_audit_record_access" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_record_access"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_firewall_logging" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_logging"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_bonjour_services" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bonjour_services"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_httpd_disabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_httpd_disabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_nfs_server_disabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_nfs_server_disabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_secure_homefolder" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_homefolder"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_sip_enabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sip_enabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_amfi_enabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_amfi_enabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_ssv_enabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ssv_enabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_application_permissions" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_application_permissions"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_system_world_writable" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_system_world_writable"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_library_world_writable" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_library_world_writable"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_max_fail" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_max_fail"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_min_length" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_min_length"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_alpha_character" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_alpha_character"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_numeric_character" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_numeric_character"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_special_character" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_special_character"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_uppercase_lowercase" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_uppercase_lowercase"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_password_age" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_age"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_password_history" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_history"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_sudo_timeout" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sudo_timeout"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_tty_seperate_timestamp" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_tty_seperate_timestamp"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_root_disabled" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_root_disabled"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_disable_automatic_login" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_automatic_login"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_admin_session" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_session"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_login_banner_window" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_banner_window"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_no_password_hints" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_no_password_hints"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_terminal_secure_keyboard" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_terminal_secure_keyboard"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_login_show_fullname" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_show_fullname"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_show_password_hints" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_show_password_hints"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_disable_guest_login" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_guest_login"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_guest_sharing" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_sharing"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_guest_home_folder" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_home_folder"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_finder_show_file_extensions" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_finder_show_file_extensions"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_open_safe_files" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_open_safe_files"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_warn_fraudulent_site" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_warn_fraudulent_site"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_crosssite_tracking" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_crosssite_tracking"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_ad_privacy" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_ad_privacy"></cat:uri>
               <cat:uri name="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_show_full_address" uri="#scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_show_full_address"></cat:uri>
            </cat:catalog>
         </ds:component-ref>
      </ds:checklists>
      <ds:checks>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-oval" xlink:href="#scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-oval"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-oval" xlink:href="#scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-oval"></ds:component-ref>
      </ds:checks>
      <ds:extended-components>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_current" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_current"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_update" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_update"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_download" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_download"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_appstore_install" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_appstore_install"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_system_download" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_system_download"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_update_os" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_update_os"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_deferment" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_deferment"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_bluetooth_menu" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_bluetooth_menu"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_wifi_menu" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_wifi_menu"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_set_auto" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_set_auto"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_server_sync" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_server_sync"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_screen_saver_inactivity" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_screen_saver_inactivity"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_corners" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_corners"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_apple_events" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_apple_events"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_internet_sharing" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_internet_sharing"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_screen_sharing" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_screen_sharing"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_print_sharing" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_print_sharing"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_login" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_login"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_dvd_cd_share" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_dvd_cd_share"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bluetooth_sharing" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bluetooth_sharing"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_file_share" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_file_share"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ard_agent" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ard_agent"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_content_caching" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_content_caching"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_airdrop_disabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_airdrop_disabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_media_sharing" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_media_sharing"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_fdesetup_status" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_fdesetup_status"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_enable" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_enable"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_stealth" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_stealth"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_location_services" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_location_services"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_diagnostic_data" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_diagnostic_data"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_limit_ad_tracking" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_limit_ad_tracking"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_gatekeeper_enabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_gatekeeper_enabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_message" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_message"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_password_required" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_password_required"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_password" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_password"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_icloud_docs_desktop" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_icloud_docs_desktop"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_autobackup" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_autobackup"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_encrypted" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_encrypted"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_on_lan" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_on_lan"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_powernap" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_powernap"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_hibernate_standby" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_hibernate_standby"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_efi_valid" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_efi_valid"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_audit" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_audit"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_flags" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_flags"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_retain_install_log" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_retain_install_log"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_retention" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_retention"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_record_access" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_record_access"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_logging" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_logging"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bonjour_services" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bonjour_services"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_httpd_disabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_httpd_disabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_nfs_server_disabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_nfs_server_disabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_homefolder" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_homefolder"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sip_enabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sip_enabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_amfi_enabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_amfi_enabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ssv_enabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ssv_enabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_application_permissions" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_application_permissions"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_system_world_writable" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_system_world_writable"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_library_world_writable" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_library_world_writable"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_max_fail" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_max_fail"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_min_length" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_min_length"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_alpha_character" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_alpha_character"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_numeric_character" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_numeric_character"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_special_character" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_special_character"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_uppercase_lowercase" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_uppercase_lowercase"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_age" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_age"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_history" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_history"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sudo_timeout" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sudo_timeout"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_tty_seperate_timestamp" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_tty_seperate_timestamp"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_root_disabled" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_root_disabled"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_automatic_login" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_automatic_login"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_session" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_session"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_banner_window" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_banner_window"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_no_password_hints" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_no_password_hints"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_terminal_secure_keyboard" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_terminal_secure_keyboard"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_show_fullname" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_show_fullname"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_show_password_hints" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_show_password_hints"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_guest_login" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_guest_login"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_sharing" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_sharing"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_home_folder" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_home_folder"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_finder_show_file_extensions" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_finder_show_file_extensions"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_open_safe_files" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_open_safe_files"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_warn_fraudulent_site" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_warn_fraudulent_site"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_crosssite_tracking" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_crosssite_tracking"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_ad_privacy" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_ad_privacy"></ds:component-ref>
         <ds:component-ref id="scap_org.cisecurity_cref_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_show_full_address" xlink:href="#scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_show_full_address"></ds:component-ref>
      </ds:extended-components>
   </ds:data-stream>
   <ds:component id="scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-xccdf" timestamp="2024-11-10T19:31:57">
      <xccdf:Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
         <xccdf:status date="2024-11-10">accepted</xccdf:status>
         <xccdf:title xml:lang="en">CIS Apple macOS 11.0 Big Sur Benchmark</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:h3>This is the archive of the CIS Apple macOS 11.0 Big Sur Benchmark v3.0.0 . CIS encourages you to migrate to a more recent, supported version of this technology.</xhtml:h3>
            <xhtml:p>


This document, CIS Apple macOS 11.0 Big Sur Benchmark, provides prescriptive guidance for establishing a secure configuration posture for Apple macOS 11.0 Big Sur. This guide was tested against Apple macOS 11.0 Big Sur. To obtain the latest version of this guide, please visit                       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>


. If you have questions, comments, or have identified ways to improve this guide, please write us at                       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>


.                </xhtml:p>
            <xhtml:p>This Benchmark includes instructions for auditing and remediation containing three different methods: Graphical User Interface (GUI), Command Line Interface using Terminal (CLI), and Configuration Profiles. These may be used to evaluate current configuration status and make changes as desired. In most cases, all methods are supported by the Operating System and it is up to organizational implementation personnel on how best to implement. There are some recommendations that can only be managed through one of these methods. Each organization must decide if control management outside their standard process is required if no solution is possible through their organization's specific choice of implementation. It is best practice at this time for Enterprise-managed devices to use profiles for management. A mix of both profile device management and command line hardening scripts will be the most comprehensive solution.</xhtml:p>
            <xhtml:p>More profile information</xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://developer.apple.com/documentation/devicemanagement">https://developer.apple.com/documentation/devicemanagement</xhtml:a>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://developer.apple.com/documentation/devicemanagement/configuring_multiple_devices_using_profiles">https://developer.apple.com/documentation/devicemanagement/configuring_multiple_devices_using_profiles</xhtml:a>
            </xhtml:p>
            <xhtml:p>Organizations that are using profiles should remember that a profile can limit what, if any, settings can be changed based on the profile payload. Even authorized organization technical personnel may not be able to change a setting with a profile in place. If technical personnel are expected to make changes that are contrary to profile settings, the profile may need to be reviewed in order to verify which accounts and what conditions apply, or a process to temporarily remove the profile should be in place.</xhtml:p>
         </xccdf:description>
         <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
         <xccdf:platform idref="cpe:2.3:o:apple:mac_os_x:11.0.0:*:*:*:*:*:*:*"></xccdf:platform>
         <xccdf:version>3.0.0</xccdf:version>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
            <xccdf:title xml:lang="en">Level 1</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Items in this profile intend to:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>be practical and prudent;</xhtml:li>
                  <xhtml:li>provide a clear security benefit; and</xhtml:li>
                  <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_All_Apple-provided_Software_Is_Current" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Auto_Update_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Download_New_Updates_When_Available_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Installation_of_App_Update_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_System_Data_Files_and_Security_Updates_Are_Downloaded_Automatically_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_Ensure_Install_of_macOS_Updates_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7_Ensure_Software_Update_Deferment_Is_Less_Than_or_Equal_to_30_Days" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Show_Bluetooth_Status_in_Menu_Bar_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Show_Wi-Fi_status_in_Menu_Bar_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_Set_time_and_date_automatically_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_Time_Is_Set_Within_Appropriate_Limits" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_an_Inactivity_Interval_of_20_Minutes_Or_Less_for_the_Screen_Saver_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_Remote_Apple_Events_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_Internet_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_Screen_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_Printer_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Ensure_Remote_Login_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Ensure_DVD_or_CD_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Ensure_Bluetooth_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Ensure_File_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Ensure_Remote_Management_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.11_Ensure_AirDrop_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.1_Ensure_FileVault_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.2_Ensure_all_user_storage_APFS_volumes_are_encrypted" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.3_Ensure_all_user_storage_CoreStorage_volumes_are_encrypted" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2.1_Ensure_Firewall_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2.2_Ensure_Firewall_Stealth_Mode_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.6_Ensure_Limit_Ad_Tracking_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.7_Ensure_Gatekeeper_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.8_Ensure_a_Custom_Message_for_the_Login_Screen_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.9_Ensure_an_Administrator_Password_Is_Required_to_Access_System-Wide_Preferences" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.10_Ensure_a_Password_is_Required_to_Wake_the_Computer_From_Sleep_or_Screen_Saver_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.2_Ensure_Time_Machine_Volumes_Are_Encrypted_If_Time_Machine_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.1_Ensure_Wake_for_Network_Access_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.2_Ensure_Power_Nap_Is_Disabled_for_Intel_Macs" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Legacy_EFI_Is_Valid_and_Updating" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Audit_Siri_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Audit_Sidecar_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_Audit_Touch_ID_and_Wallet__Apple_Pay_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Audit_Notification__Focus_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Security_Auditing_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_install.log_Is_Retained_for_365_or_More_Days_and_No_Maximum_Size" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Security_Auditing_Retention_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_Access_to_Audit_Records_Is_Controlled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_Logging_Is_Enabled_and_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_HTTP_Server_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_NFS_Server_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Home_Folders_Are_Secure" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_System_Integrity_Protection_Status_SIP_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_Apple_Mobile_File_Integrity_AMFI_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_Sealed_System_Volume_SSV_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_Appropriate_Permissions_Are_Enabled_for_System_Wide_Applications" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_No_World_Writable_Files_Exist_in_the_System_Folder" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_Password_Account_Lockout_Threshold_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_Password_Minimum_Length_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_Password_Age_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_Password_History_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_the_Sudo_Timeout_Period_Is_Set_to_Zero" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_a_Separate_Timestamp_Is_Enabled_for_Each_Usertty_Combo" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_root_Account_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_Automatic_Login_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_an_Administrator_Account_Cannot_Login_to_Another_Users_Active_and_Locked_Session" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_Users_Accounts_Do_Not_Have_a_Password_Hint" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Secure_Keyboard_Entry_Terminal.app_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Ensure_Login_Window_Displays_as_Name_and_Password_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Ensure_Show_Password_Hints_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Ensure_Guest_Account_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Ensure_Guest_Access_to_Shared_Folders_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Ensure_the_Guest_Home_Folder_Does_Not_Exist" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Show_All_Filename_Extensions_Setting_is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.1_Ensure_Automatic_Opening_of_Safe_Files_in_Safari_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.3_Audit_Passwords_System_Preference_Setting" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.4_Ensure_Warn_When_Visiting_A_Fradulent_Website_in_Safari_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.5_Ensure_Prevent_Cross-site_Tracking_in_Safari_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.7_Ensure_Advertising_Privacy_Protection_in_Safari_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.8_Ensure_Show_Full_Website_Address_in_Safari_Is_Enabled" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
            <xccdf:title xml:lang="en">Level 2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
                  <xhtml:li>acts as defense in depth measure</xhtml:li>
                  <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_All_Apple-provided_Software_Is_Current" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Auto_Update_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Download_New_Updates_When_Available_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Installation_of_App_Update_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_System_Data_Files_and_Security_Updates_Are_Downloaded_Automatically_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_Ensure_Install_of_macOS_Updates_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7_Ensure_Software_Update_Deferment_Is_Less_Than_or_Equal_to_30_Days" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.8_Ensure_Computer_Name_Does_Not_Contain_PII_or_Protected_Organizational_Information" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Show_Bluetooth_Status_in_Menu_Bar_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Show_Wi-Fi_status_in_Menu_Bar_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_Set_time_and_date_automatically_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_Time_Is_Set_Within_Appropriate_Limits" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_an_Inactivity_Interval_of_20_Minutes_Or_Less_for_the_Screen_Saver_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_Screen_Saver_Corners_Are_Secure" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_Remote_Apple_Events_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_Internet_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_Screen_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_Printer_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Ensure_Remote_Login_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Ensure_DVD_or_CD_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Ensure_Bluetooth_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Ensure_File_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Ensure_Remote_Management_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.10_Ensure_Content_Caching_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.11_Ensure_AirDrop_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.12_Ensure_Media_Sharing_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.1_Ensure_FileVault_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.2_Ensure_all_user_storage_APFS_volumes_are_encrypted" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.3_Ensure_all_user_storage_CoreStorage_volumes_are_encrypted" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2.1_Ensure_Firewall_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2.2_Ensure_Firewall_Stealth_Mode_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Ensure_Location_Services_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Audit_Location_Services_Access" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.5_Ensure_Sending_Diagnostic_and_Usage_Data_to_Apple_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.6_Ensure_Limit_Ad_Tracking_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.7_Ensure_Gatekeeper_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.8_Ensure_a_Custom_Message_for_the_Login_Screen_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.9_Ensure_an_Administrator_Password_Is_Required_to_Access_System-Wide_Preferences" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.10_Ensure_a_Password_is_Required_to_Wake_the_Computer_From_Sleep_or_Screen_Saver_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1.1_Audit_iCloud_Keychain" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1.2_Audit_iCloud_Drive" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1.3_Ensure_iCloud_Drive_Document_and_Desktop_Sync_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Audit_App_Store_Password_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.1_Ensure_Backup_Automatically_is_Enabled_If_Time_Machine_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.2_Ensure_Time_Machine_Volumes_Are_Encrypted_If_Time_Machine_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.1_Ensure_Wake_for_Network_Access_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.2_Ensure_Power_Nap_Is_Disabled_for_Intel_Macs" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.3_Ensure_the_OS_is_not_Activate_When_Resuming_from_Sleep" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Legacy_EFI_Is_Valid_and_Updating" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Audit_Siri_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Audit_Sidecar_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_Audit_Touch_ID_and_Wallet__Apple_Pay_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Audit_Notification__Focus_Settings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Security_Auditing_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_Security_Auditing_Flags_For_User-Attributable_Events_Are_Configured_Per_Local_Organizational_Requirements" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_install.log_Is_Retained_for_365_or_More_Days_and_No_Maximum_Size" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Security_Auditing_Retention_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_Access_to_Audit_Records_Is_Controlled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_Logging_Is_Enabled_and_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Audit_Software_Inventory" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_Bonjour_Advertising_Services_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_HTTP_Server_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_NFS_Server_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Home_Folders_Are_Secure" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_System_Integrity_Protection_Status_SIP_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_Apple_Mobile_File_Integrity_AMFI_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_Sealed_System_Volume_SSV_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_Appropriate_Permissions_Are_Enabled_for_System_Wide_Applications" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_No_World_Writable_Files_Exist_in_the_System_Folder" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_No_World_Writable_Files_Exist_in_the_Library_Folder" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_Password_Account_Lockout_Threshold_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_Password_Minimum_Length_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_Complex_Password_Must_Contain_Alphabetic_Characters_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_Complex_Password_Must_Contain_Numeric_Character_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_Complex_Password_Must_Contain_Special_Character_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_Complex_Password_Must_Contain_Uppercase_and_Lowercase_Characters_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_Password_Age_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_Password_History_Is_Configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_the_Sudo_Timeout_Period_Is_Set_to_Zero" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_a_Separate_Timestamp_Is_Enabled_for_Each_Usertty_Combo" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_root_Account_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_Automatic_Login_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_an_Administrator_Account_Cannot_Login_to_Another_Users_Active_and_Locked_Session" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_a_Login_Window_Banner_Exists" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_Users_Accounts_Do_Not_Have_a_Password_Hint" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Secure_Keyboard_Entry_Terminal.app_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Ensure_Login_Window_Displays_as_Name_and_Password_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Ensure_Show_Password_Hints_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Ensure_Guest_Account_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Ensure_Guest_Access_to_Shared_Folders_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Ensure_the_Guest_Home_Folder_Does_Not_Exist" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Show_All_Filename_Extensions_Setting_is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1.1_Ensure_Protect_Mail_Activity_in_Mail_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.1_Ensure_Automatic_Opening_of_Safe_Files_in_Safari_Is_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.2_Audit_History_and_Remove_History_Items" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.3_Audit_Passwords_System_Preference_Setting" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.4_Ensure_Warn_When_Visiting_A_Fradulent_Website_in_Safari_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.5_Ensure_Prevent_Cross-site_Tracking_in_Safari_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.6_Audit_Hide_IP_Address_in_Safari_Setting" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.7_Ensure_Advertising_Privacy_Protection_in_Safari_Is_Enabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2.8_Ensure_Show_Full_Website_Address_in_Safari_Is_Enabled" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Install_Updates_Patches_and_Additional_Security_Software">
            <xccdf:title xml:lang="en">Install Updates, Patches and Additional Security Software</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Install Updates, Patches and Additional Security Software</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_All_Apple-provided_Software_Is_Current" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure All Apple-provided Software Is Current</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.</xhtml:p>
                  <xhtml:p>


Software updates should be run at minimum every 30 days. Run the following command to verify when software update was previously run:                                   <xhtml:span class="inline_block">$ /usr/bin/sudo /usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate | grep -e LastFullSuccessfulDate</xhtml:span>


. The response should be in the last 30 days (                                  <xhtml:em>Example</xhtml:em>


):                                   <xhtml:span class="inline_block">LastFullSuccessfulDate = "2020-07-30 12:45:25 +0000";</xhtml:span>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is important that these updates be applied in a timely manner to prevent unauthorized persons from exploiting the identified vulnerabilities.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to install all available software updates:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Software Update</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Show Updates</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Update All</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to verify what packages need to be installed:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/softwareupdate -l 
</xhtml:code>
                        <xhtml:p>


The output will include the following:
                                              <xhtml:span class="inline_block">Software Update found the following new or updated software:</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>Run the following command to install all the packages that need to be updated:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/softwareupdate -i -a -R
</xhtml:code>
                        <xhtml:p>Or run the following command to install individual packages:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/softwareupdate -i '&lt;package name&gt;'
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example:</xhtml:em>
                        </xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/softwareupdate -l                                               <br></br>


Software Update Tool                                              <br></br>
                           <br></br>


Finding available software                                              <br></br>


Software Update found the following new or updated software:                                              <br></br>


   * iTunesX-12.8.2                                              <br></br>


	iTunes (12.8.2), 273614K [recommended]                                              <br></br>
                           <br></br>


$ sudo /usr/sbin/softwareupdate -i 'iTunesX-12.8.2'                                              <br></br>


Software Update Tool                                              <br></br>
                           <br></br>
                           <br></br>


Downloaded iTunes                                              <br></br>


Installing iTunes                                              <br></br>


Done with iTunes                                              <br></br>


Done.
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Missing patches can lead to more exploit opportunities.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_software_update_current"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Auto_Update_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Auto Update Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Auto Update verifies that your system has the newest security patches and software updates. If "Automatically check for updates" is not selected, background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/">http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/">https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is important that a system has the newest updates applied so as to prevent unauthorized persons from exploiting identified vulnerabilities.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable the system to automatically check for updates:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Software Update</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Advanced</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Check for updates</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to enable auto update:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true  
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.SoftwareUpdate</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">AutomaticCheckEnabled</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Without automatic update, updates may not be made in a timely manner and the system will be exposed to additional risk.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_auto_update"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_Ensure_Download_New_Updates_When_Available_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Download New Updates When Available Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>In the GUI, both "Install macOS updates" and "Install app updates from the App Store" are dependent on whether "Download new updates when available" is selected.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is important that a system has the newest updates downloaded so that they can be applied.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable the system to automatically check for updates:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Software Update</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Advanced</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Download new updates when available</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to enable auto update:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool true  
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.SoftwareUpdate</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">AutomaticDownload</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>If "Download new updates when available" is not selected, updates may not be made in a timely manner and the system will be exposed to additional risk.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_auto_download"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_Ensure_Installation_of_App_Update_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Installation of App Update Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or administrator privileges for end users.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable App Store updates to install automatically:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Software Updates</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Advanced</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Install app updates from the App Store</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to to enable automatic checking and installing of macOS updates:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.commerce AutoUpdate -bool TRUE
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.SoftwareUpdate</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">AutomaticallyInstallAppUpdates</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Unpatched software may be exploited.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_appstore_install"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5_Ensure_System_Data_Files_and_Security_Updates_Are_Downloaded_Automatically_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure System Data Files and Security Updates Are Downloaded Automatically Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper. With this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://eclecticlight.co/2021/10/27/silently-updated-security-data-files-in-monterey/">Silently updated security data files in Monterey</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-us/HT202491">https://support.apple.com/en-us/HT202491</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>XProtect is Apple's built-in, signature-based security tool for detection and removal of malware.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/guide/security/protecting-against-malware-sec469d47bd8/web">Protecting against malware in macOS</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Remediate Detected Vulnerabilities" urn="urn:cisecurity.org:controls:8.0:7:7">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable system data files and security updates to install automatically:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Software Updates</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Advanced</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Install system data files and security updates</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following commands to enable automatic checking of system data files and security updates:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo  /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true                                               <br></br>
                           <br></br>


$ /usr/bin/sudo  /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 This remediation requires a log out and log in to show in the GUI.                                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.SoftwareUpdate</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">ConfigDataInstall</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to also include is                                                     <xhtml:span class="inline_block">CriticalUpdateInstall</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Unpatched software may be exploited.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_security_system_download"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6_Ensure_Install_of_macOS_Updates_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Install of macOS Updates Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to test first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off simply to allow the administrator to contact users in order to verify installation. A dependable, repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable macOS updates to run automatically:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Software Updates</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Advanced</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Install macOS updates</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following commands to enable automatic checking of system data files and security updates:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates -bool TRUE
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.SoftwareUpdate</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">AutomaticallyInstallMacOSUpdates</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Unpatched software may be exploited.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_update_os"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.7_Ensure_Software_Update_Deferment_Is_Less_Than_or_Equal_to_30_Days" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Software Update Deferment Is Less Than or Equal to 30 Days</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apple provides the capability to manage software updates on Apple devices through mobile device management. Part of those capabilities permit organizations to defer software updates and allow for testing. Many organizations have specialized software and configurations that may be negatively impacted by Apple updates. If software updates are deferred, they should not be deferred for more than 30 days. This control only verifies that deferred software updates are not deferred for more than 30 days.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/guide/deployment/manage-software-updates-depc4c80847a/web">Manage software updates for Apple devices</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Apple software updates almost always include security updates. Attackers evaluate updates to create exploit code in order to attack unpatched systems. The longer a system remains unpatched, the greater an exploit possibility exists in which there are publicly reported vulnerabilities.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">enforcedSoftwareUpdateDelay</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;integer&gt;&lt;1-30&gt;&lt;/integer&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Some organizations may need more than 30 days to evaluate the impact of software updates.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_software_update_deferment"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.8_Ensure_Computer_Name_Does_Not_Contain_PII_or_Protected_Organizational_Information" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure Computer Name Does Not Contain PII or Protected Organizational Information</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>If the computer is used in an organization that assigns host names, it is a good idea to change the computer name to the host name. This is more of a best practice than a security measure. If the host name and the computer name are the same, computer support may be able to track problems down more easily.</xhtml:p>
                  <xhtml:p>For organizations or for users that self-administer their own computers, it is important to not use sensitive or personal information in computer names. The name of a computer that uses untrusted networks will be exposed at a minimum to the responsible network team of that network. While I may not care if the computer name of Ron Colvin's MacBook Pro is visible on a Hooters WiFi network, other uses may not feel the same way.</xhtml:p>
                  <xhtml:p>Examples of possibly inappropriate content in computer names include:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>User directory account names</xhtml:li>
                     <xhtml:li>Computer directory account names where machine accounts exist</xhtml:li>
                     <xhtml:li>Contact phone numbers</xhtml:li>
                     <xhtml:li>Physical locations of offices or residences</xhtml:li>
                     <xhtml:li>Personal information that can be augmented with Facebook data to assist social engineering attacks</xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>Standard naming patterns avoid collisions and mitigate risk for computer users.</xhtml:p>
                  <xhtml:p>With mobile devices, using DHCP IP tracking has serious drawbacks; hostname or computer name tracking makes much more sense for those organizations that can implement it. If the computer is using different names for the "Computer Name" DNS and Directory environments, it can be difficult to manage Macs in an Enterprise asset inventory.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain Detailed Enterprise Asset Inventory" urn="urn:cisecurity.org:controls:8.0:1:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Part of IT security is having visibility into all of the devices for which an organization is responsible. Without a complete inventory, it is impossible to ensure all security controls are met on all organizational devices.</xhtml:p>
                  <xhtml:p>Default macOS naming deconfliction controls can create issues for appropriate management and tracking as well as privacy exposure. By default, the name of a macOS computer is derived from the first user created. If the user has multiple computers or an image is used without an appropriate name change, there will be multiple computers with names derived from the same user for discovery deconfliction. How many "Ron Colvin's MacBook Pro" should there be, and are any missing?</xhtml:p>
                  <xhtml:p>Local network auto renaming to avoid collisions also allows for the enumeration of local computer names. Computers should not be named after their users, especially on untrusted networks. For social engineering purposes, the computer name should not provide a full name of the user or an identifiable name that might be used to assist in targeted user attacks.</xhtml:p>
                  <xhtml:p>A documented plan to better enable a complete device inventory without exposing user or organizational information is part of mature security.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/1/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/mac-help/mchlp1177/11.0/mac/11.0</xccdf:ident>
               <xccdf:ident system="URL">https://uberagent.com/blog/choosing-macos-computer-names-wisely/</xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/mac-help/mchlp2322/11.0/mac/11.0</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to set the computer name:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Sharing</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Computer Name</xhtml:span>


 to your organization's parameters                                              </xhtml:li>
                        </xhtml:ol>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_System_Preferences">
            <xccdf:title xml:lang="en">System Preferences</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>


This section contains recommendations related to configurable options in the                             <xhtml:em>System Preferences</xhtml:em>


 panel.                      </xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Dock__Menu_Bar">
               <xccdf:title xml:lang="en">Dock &amp; Menu Bar</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The Dock &amp; Menu Bar System Preference pane allows modification to what is displayed in the Menu Bar and Control Center information.</xhtml:p>
                  <xhtml:p>Many Menu Bar icons provide additional status information when the option key is selected along with the menu, including WiFi and Bluetooth.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Show_Bluetooth_Status_in_Menu_Bar_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Show Bluetooth Status in Menu Bar Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Deploy Port-Level Access Control" urn="urn:cisecurity.org:controls:8.0:13:9">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Enabling "Show Bluetooth status in menu bar" is a security awareness method that helps understand the current state of Bluetooth, including whether it is enabled, discoverable, what paired devices exist, and what paired devices are currently active.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable Bluetooth status in the menu bar:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Dock &amp; Menu Bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Bluetooth</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Show in Menu Bar</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>For each user, run the following command to enable Bluetooth status in the menu bar:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults -currentHost write com.apple.controlcenter.plist Bluetooth -int 18
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults -currentHost write com.apple.controlcenter.plist Bluetooth -int 18
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.controlcenter</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">Bluetooth</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;18&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Bluetooth is a useful wireless tool that has been widely exploited when configured improperly. The user should have insight into the Bluetooth status.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_bluetooth_menu"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3221770"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Show_Wi-Fi_status_in_Menu_Bar_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Show Wi-Fi status in Menu Bar Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled. If so, the system will scan for available wireless networks in order to connect. At the time of this revision, all computers Apple builds have wireless network capability, which has not always been the case. This control only pertains to systems that have a wireless NIC available. Operating systems running in a virtual environment may not score as expected, either.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Use of Secure Network Management and Communication Protocols" urn="urn:cisecurity.org:controls:8.0:12:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Disable Wireless Access on Devices if Not Required" urn="urn:cisecurity.org:controls:7.0:15:4">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Limit Wireless Access on Client Devices" urn="urn:cisecurity.org:controls:7.0:15:5">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>AirPort is Apples marketing name for its 802.11x based wireless network interfaces.</xhtml:p>
                        <xhtml:p>Option-click the Wifi icon in the menu bar to find out more information about the connected wireless network.</xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Enabling "Show Wi-Fi status in menu bar" is a security awareness method that helps mitigate public area wireless exploits by making the user aware of their wireless connectivity status.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable Wi-Fi status in the menu bar:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Dock &amp; Menu Bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Wi-Fi</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Show in Menu Bar</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>For each user, run the following command to enable Wi-Fi status in the menu bar:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; defaults -currentHost write com.apple.controlcenter.plist WiFi -int 18
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser defaults -currentHost write com.apple.controlcenter.plist WiFi -int 18
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.controlcenter</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">WiFi</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;18&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The user of the system should have a quick check on their wireless network status available.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_wifi_menu"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3168698"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2_Date__Time">
               <xccdf:title xml:lang="en">Date &amp; Time</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


This section contains recommendations related to the configurable items under the                                   <xhtml:em>Date &amp; Time</xhtml:em>


 panel.                            </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_Set_time_and_date_automatically_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure "Set time and date automatically" Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>


 If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required, use the Date &amp; Time System Preference with each server separated by a space.                                  </xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Additional Note:</xhtml:strong>


 The default Apple time server is time.apple.com. Variations include time.euro.apple.com. While it is certainly more efficient to use internal time servers, there is no reason to block access to global Apple time servers or to add a time.apple.com alias to internal DNS records. There are no reports that Apple gathers any information from NTP synchronization, as the computers already phone home to Apple for Apple services including iCloud use and software updates. Best practice is to allow DNS resolution to an authoritative time service for time.apple.com, preferably to connect to Apple servers, but local servers are acceptable as well.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>


To learn more about                                               <xhtml:span class="inline_block">timed</xhtml:span>


, read:                                               <xhtml:a href="https://eclecticlight.co/2017/10/27/has-anyone-got-the-time-how-high-sierra-has-changed-time-synchronisation/">Has anyone got the time? How High Sierra has changed time synchronisation</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 The profile configuration has been removed since it requires a specific time server to be set.                                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable the date and time to be set automatically:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Date &amp; Time</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Set date and time automatically</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 By default, the operating system will use                                                     <xhtml:span class="inline_block">time.apple.com</xhtml:span>


 as the time server. You can change to any time server that meets your organization's requirements.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following commands to enable the date and time setting automatically:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver &lt;your.time.server&gt;                                                    <br></br>
                              <br></br>


setNetworkTimeServer: &lt;your.time.server&gt;                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on                                                    <br></br>
                              <br></br>


setUsingNetworkTime: On
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver time.apple.com                                                    <br></br>
                              <br></br>


setNetworkTimeServer: time.apple.com                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on                                                    <br></br>
                              <br></br>


setUsingNetworkTime: On
                                              </xhtml:code>
                           <xhtml:p>Run the following commands if you have not set, or need to set, a new time zone:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -listtimezones                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/sbin/systemsetup -settimezone &lt;selected time zone&gt;                                                    <br></br>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -listtimezones                                                    <br></br>
                              <br></br>


Time Zones:                                                    <br></br>


 Africa/Abidjan                                                    <br></br>


 Africa/Accra                                                    <br></br>


 ...                                                    <br></br>


 Pacific/Wake                                                    <br></br>


 Pacific/Wallis                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/sbin/systemsetup -settimezone America/New_York                                                    <br></br>
                              <br></br>


Set TimeZone: America/New_York
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


The                                                           <xhtml:span class="inline_block">timed</xhtml:span>


 service will periodically synchronize with named time servers and will make the computer time more accurate.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_time_set_auto"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_Time_Is_Set_Within_Appropriate_Limits" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Time Is Set Within Appropriate Limits</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds. For this audit, a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of macOS integration into Directory systems, the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time, this check is not strict, so it may be too great for your organization. Your organization can adjust to a smaller offset value as needed.</xhtml:p>
                     <xhtml:p>If there are consistent drift issues on the OS, some of the most common drift issues should be investigated:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>
                           <xhtml:p>The chosen time server is not reachable based on network firewall rules on the current network</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                           <xhtml:p>The computer is offline often and the battery drains, and the network is not immediately available</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                           <xhtml:p>The chosen time server is a special internal or non-public time server that does not provide a reliable time source</xhtml:p>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>
                        <xhtml:strong>Note:</xhtml:strong>
                        <xhtml:span class="inline_block">ntpdate</xhtml:span>


 has been deprecated with 10.14.                                         <xhtml:span class="inline_block">sntp</xhtml:span>


 replaces that command.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>The associated check will fail if no network connection is available.</xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features. Audit check is for more than 4 minutes and 30 seconds ahead or behind.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Run the following commands to ensure your time is set within an appropriate limit:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver    
</xhtml:code>
                           <xhtml:p>


The output will include                                                     <xhtml:span class="inline_block">Network Time Server: </xhtml:span>


 and the name of your time server
                                                    <xhtml:em>example</xhtml:em>


:                                                     <xhtml:span class="inline_block">Network Time Server: time.apple.com</xhtml:span>


.                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/sntp -sS &lt;your.time.server&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver                                                    <br></br>
                              <br></br>


Network Time Server: time.apple.com                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/bin/sntp -sS time.apple.com
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Accurate time is required for many computer functions.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_time_server_sync"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.3_Desktop__Screen_Saver">
               <xccdf:title xml:lang="en">Desktop &amp; Screen Saver</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section contains recommendations related to the configurable items under the Desktop &amp; Screen Saver panel.</xhtml:p>
                  <xhtml:p>It is vital that all users know how to quickly lock their screens if necessary. This capability in no way means that the user intends to hide unauthorized activity. The contents on the display screen may not be content authorized for someone that is visiting a user or their workspace. There are many simple ways to lock the screen, the obvious at this point is just selecting Lock Screen under the Apple menu or for a laptop to close the lid.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.howtogeek.com/703785/8-ways-to-lock-your-mac/">8 Ways to Lock Your Mac</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_an_Inactivity_Interval_of_20_Minutes_Or_Less_for_the_Screen_Saver_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure an Inactivity Interval of 20 Minutes Or Less for the Screen Saver Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>A locking screen saver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In macOS, the screen saver starts after a value is selected in the drop-down menu. 20 minutes or less is an acceptable value. Any value can be selected through the command line or script, but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Setting an inactivity interval for the screen saver prevents unauthorized persons from viewing a system left unattended for an extensive period of time.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set the screen saver to activate in 20 minutes or less:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Desktop &amp; Screen Saver</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Screen Saver</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select on option for                                                           <xhtml:span class="inline_block">Start after</xhtml:span>


 that is 20 minutes or less (1200)                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set individual users to an idle time of the screen saver is set to 20 minutes or less (1200):</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults -currentHost write com.apple.screensaver idleTime -int &lt;value 1200&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo -u seconduser /usr/bin/defaults -currentHost write com.apple.screensaver idleTime -int 600                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u seconduser /usr/bin/defaults -currentHost read com.apple.screensaver idleTime                                                    <br></br>
                              <br></br>


600
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Issues arise if the command line is used to make the setting something other than what is available in the GUI Menu. Choose either 1 (60), 2 (120), 5 (300), 10 (600), or 20 (1200) minutes to avoid any issues.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.screensaver</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">idleTime</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;1200&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If the screen saver is not set, users may leave the computer available for an unauthorized person to access information.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_screen_saver_inactivity"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_Screen_Saver_Corners_Are_Secure" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Screen Saver Corners Are Secure</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Setting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable a Hot Corner set to Disable Screen Saver:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Desktop &amp; Screen Saver</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Screen Saver</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Hot Corners...</xhtml:span>


 and set any corner that is set to                                                           <xhtml:span class="inline_block">Disable Screen Saver</xhtml:span>


 to another setting that corresponds to your organization's requirements                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>



Run the following command to turn off Disable Screen Saver for a Hot Corner:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.dock &lt;corner that is set to '6'&gt; -int 0
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo -u seconduser /usr/bin/defaults write com.apple.dock wvous-tl-corner -int 0                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u seconduser /usr/bin/defaults read com.apple.dock wvous-tl-corner                                                    <br></br>
                              <br></br>


0
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.dock</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">Forced</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to the following:</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


&lt;array&gt;                                                    <br></br>


	&lt;dict&gt;                                                    <br></br>


		&lt;key&gt;mcx_preference_settings&lt;/key&gt;                                                    <br></br>


			&lt;dict&gt;                                                    <br></br>


				&lt;key&gt;wvous-bl-corner&lt;/key&gt;                                                    <br></br>


				&lt;integer&gt;&lt;6&gt;&lt;/integer&gt;                                                    <br></br>


				&lt;key&gt;wvous-br-corner&lt;/key&gt;                                                    <br></br>


				&lt;integer&gt;&lt;6&gt;&lt;/integer&gt;                                                    <br></br>


				&lt;key&gt;wvous-tl-corner&lt;/key&gt;                                                    <br></br>


				&lt;integer&gt;&lt;6&gt;&lt;/integer&gt;                                                    <br></br>


				&lt;key&gt;wvous-tr-corner&lt;/key&gt;                                                    <br></br>


				&lt;integer&gt;&lt;6&gt;&lt;/integer&gt;                                                    <br></br>


			&lt;/dict&gt;                                                    <br></br>


		&lt;/dict&gt;                                                    <br></br>


&lt;/array&gt;
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_secure_corners"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.4_Sharing">
               <xccdf:title xml:lang="en">Sharing</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


This section contains recommendations related to the configurable items under the                                   <xhtml:em>Sharing</xhtml:em>


 panel.                            </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_Remote_Apple_Events_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Remote Apple Events Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Remote Apple Events mitigates the risk of an unauthorized program gaining access to the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Remote Apple Events:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>Open `System Preferences</xhtml:li>
                              <xhtml:li>Select `Sharing</xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Remote Apple Events</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following commands to set Remote Apple Events to Off:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -setremoteappleevents off                                                     <br></br>
                              <br></br>


setremoteappleevents: Off
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>With remote Apple events turned on, an AppleScript program running on another Mac can interact with the local computer.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_remote_apple_events"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_Internet_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Internet Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Internet Sharing uses the open source                                         <xhtml:span class="inline_block">natd</xhtml:span>


 process to share an internet connection with other computers and devices on a local network. This allows the Mac to function as a router and share the connection to other, possibly unauthorized, devices.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Internet Sharing reduces the remote attack surface of the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">STIGID AOSX-12-001270</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Internet Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Internet Sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to turn off Internet Sharing:</xhtml:p>
                           <xhtml:code class="code_block">$ usr/bin/sudo /usr/bin/defaults write /Library/Preferences/SystemConfiguration/com.apple.nat NAT -dict Enabled -int 0
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Using the Terminal Method will not be reflected in the GUI, but will disable the underlying service.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.MCX</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">forceInternetSharingOff</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Internet Sharing allows the computer to function as a router and other computers to use it for access. This can expose both the computer itself and the networks it is accessing to unacceptable access from unapproved devices.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_internet_sharing"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_Screen_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Screen Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Screen Sharing allows a computer to connect to another computer on a network and display the computers screen. While sharing the computers screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.</xhtml:p>
                     <xhtml:p>While mature administration and management does not use graphical connections for standard maintenance, most help desks have capabilities to assist users in performing their work when they have technical issues and need support. Help desks use graphical remote tools to understand what the user sees and assist them so they can get back to work. For MacOS, some of these remote capabilities can use Apple's OS tools. Control is therefore not meant to prohibit the use of a just-in-time graphical view from authorized personnel with authentication controls. Sharing should not be enabled except in narrow windows when help desk support is required.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Screen Sharing mitigates the risk of remote connections being made without the user of the console knowing that they are sharing the computer.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/turn-screen-sharing-on-or-off-mh11848/mac</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Screen Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Screen Sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to turn off Screen Sharing:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Help desks may require the periodic use of a graphical connection mechanism to assist users. Any support that relies on native MacOS components will not work unless a scripted solution to enable and disable sharing as neccessary.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_screen_sharing"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_Printer_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Printer Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>By enabling Printer Sharing, the computer is set up as a print server to accept print jobs from other computers. Dedicated print servers or direct IP printing should be used instead.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Printer Sharing mitigates the risk of attackers attempting to exploit the print server to gain access to the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Printer Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Printer Sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Printer Sharing:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/cupsctl --no-share-printers
</xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_print_sharing"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Ensure_Remote_Login_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Remote Login Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Remote Login allows an interactive terminal connection to a computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:span class="inline_block">man sshd_config</xhtml:span>
                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Remote Login mitigates the risk of an unauthorized person gaining access to the system via Secure Shell (SSH). While SSH is an industry standard to connect to posix servers, the scope of the benchmark is for Apple macOS clients, not servers.</xhtml:p>
                     <xhtml:p>macOS does have an IP-based firewall available (pf, ipfw has been deprecated) that is not enabled or configured. There are more details and links in section 7.5. macOS no longer has TCP Wrappers support built in and does not have strong Brute-Force password guessing mitigations, or frequent patching of openssh by Apple. Since most macOS computers are mobile workstations, managing IP-based firewall rules on mobile devices can be very resource intensive. All of these factors can be parts of running a hardened SSH server.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Remote Login:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Remote Login</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Remote Login:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/systemsetup -setremotelogin off                                                    <br></br>
                              <br></br>


Do you really want to turn remote login off? If you do, you will lose this connection and can only turn it back on locally at the server (yes/no)?
                                              </xhtml:code>
                           <xhtml:p>Entering yes will disable remote login.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The SSH server built into macOS should not be enabled on a standard user computer, particularly one that changes locations and IP addresses. A standard user that runs local applications, including email, web browser, and productivity tools, should not use the same device as a server. There are Enterprise management toolsets that do utilize SSH. If they are in use, the computer should be locked down to only respond to known, trusted IP addresses and appropriate administrator service accounts.</xhtml:p>
                              <xhtml:p>For macOS computers that are being used for specialized functions, there are several options to harden the SSH server to protect against unauthorized access including brute force attacks. There are some basic criteria that need to be considered:</xhtml:p>
                              <xhtml:ul>
                                 <xhtml:li>Do not open an SSH server to the internet without controls in place to mitigate SSH brute force attacks. This is particularly important for systems bound to Directory environments. It is great to have controls in place to protect the system, but if they trigger after the user is already locked out of their account, they are not optimal. If authorization happens after authentication, directory accounts for users that don't even use the system can be locked out.</xhtml:li>
                                 <xhtml:li>Do not use SSH key pairs when there is no insight to the security on the client system that will authenticate into the server with a private key. If an attacker gets access to the remote system and can find the key, they may not need a password or a key logger to access the SSH server.</xhtml:li>
                                 <xhtml:li>Detailed instructions on hardening an SSH server, if needed, are available in the CIS Linux Benchmarks, but it is beyond the scope of this benchmark.</xhtml:li>
                              </xhtml:ul>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_remote_login"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Ensure_DVD_or_CD_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure DVD or CD Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>DVD or CD Sharing allows users to remotely access the system's optical drive. While Apple does not ship Macs with built-in optical drives any longer, external optical drives are still recognized when they are connected. In testing, the sharing of an external optical drive persists when a drive is reconnected.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling DVD or CD Sharing minimizes the risk of an attacker using the optical drive as a vector for attack and exposure of sensitive data.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable DVD or CD Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">DVD or CD sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable DVD or CD Sharing:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/launchctl disable system/com.apple.ODSAgent 
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 If using the Terminal method, the GUI will still show the service checked until after a reboot.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Many Apple devices are now sold without optical drives, however drive sharing may be needed for legacy optical media. The media should be explicitly re-shared as needed rather than using a persistent share. Optical drives should not be used for long-term storage. To store necessary data from an optical drive it should be copied to another form of external storage. Optionally, an image can be made of the optical drive so that it is stored in its original form on another form of external storage.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_dvd_cd_share"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Ensure_Bluetooth_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Bluetooth Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Bluetooth Sharing allows files to be exchanged with Bluetooth-enabled devices.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Log and Alert on Changes to Administrative Group Membership" urn="urn:cisecurity.org:controls:7.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Bluetooth Sharing minimizes the risk of an attacker using Bluetooth to remotely attack the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Bluetooth Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Bluetooth Sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Bluetooth Sharing is disabled:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false
</xhtml:code>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Control 2.1.1 discusses disabling Bluetooth if no paired devices exist. There is a general expectation that Bluetooth peripherals will be used by most users in Apple's ecosystem. It is possible that sharing is required and Bluetooth peripherals are not. Bluetooth must be enabled if sharing is an acceptable use case.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_bluetooth_sharing"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Ensure_File_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure File Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>File sharing from a user workstation creates additional risks, such as:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Open ports are created that can be probed and attacked</xhtml:li>
                        <xhtml:li>Passwords are attached to user accounts for access that may be exposed and endanger other parts of the organizational environment, including directory accounts</xhtml:li>
                        <xhtml:li>Increased complexity makes security more difficult and may expose additional attack vectors</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>Apple's File Sharing uses the Server Message Block (SMB) protocol to share to other computers that can mount SMB shares. This includes other macOS computers.</xhtml:p>
                     <xhtml:p>Apple warns that SMB sharing stored passwords is less secure, and anyone with system access can gain access to the password for that account. When sharing with SMB, each user accessing the Mac must have SMB enabled. Storing passwords, especially copies of valid directory passwords, decrease security for the directory account and should not be used.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>By disabling File Sharing, the remote attack surface and risk of unauthorized access to files stored on the system is reduced.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable File Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">File Sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable File Sharing:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/launchctl disable system/com.apple.smbd
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>File Sharing can be used to share documents with other users, but hardened servers should be used rather than user endpoints. Turning on File Sharing increases the visibility and attack surface of a system unnecessarily.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_file_share"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Ensure_Remote_Management_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Remote Management Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Remote Management is the client portion of Apple Remote Desktop (ARD). Remote Management can be used by remote administrators to view the current screen, install software, report on, and generally manage client Macs.</xhtml:p>
                     <xhtml:p>The screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regard screen sharing.</xhtml:p>
                     <xhtml:p>Remote Management should only be enabled when a Directory is in place to manage the accounts with access. Computers will be available on port 5900 on a macOS System and could accept connections from untrusted hosts depending on the configuration, which is a major concern for mobile systems. As with other sharing options, an open port even for authorized management functions can be attacked, and both unauthorized access and Denial-of-Service vulnerabilities could be exploited. If remote management is required, the pf firewall should restrict access only to known, trusted management consoles. Remote management should not be used across the Internet without the use of a VPN tunnel.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Disable Workstation to Workstation Communication" urn="urn:cisecurity.org:controls:7.0:14:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:span class="inline_block">/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -help</xhtml:span>
                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Remote Management should only be enabled on trusted networks with strong user controls present in a Directory system. Mobile devices without strict controls are vulnerable to exploit and monitoring.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Remote Management:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Remote Management</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Remote Management:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop                                                    <br></br>
                              <br></br>


Starting...                                                    <br></br>


Removed preference to start ARD after reboot.                                                    <br></br>


Done.
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Many organizations utilize ARD for client management.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_ard_agent"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.10_Ensure_Content_Caching_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Content Caching Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Starting with 10.13 (macOS High Sierra), Apple introduced a service to make it easier to deploy data from Apple, including software updates, where there are bandwidth constraints to the Internet and fewer constraints or greater bandwidth exist on the local subnet. This capability can be very valuable for organizations that have throttled and possibly metered Internet connections. In heterogeneous enterprise networks with multiple subnets, the effectiveness of this capability would be determined by how many Macs were on each subnet at the time new, large updates were made available upstream.
This capability requires the use of mac OS clients as P2P nodes for updated Apple content. Unless there is a business requirement to manage operational Internet connectivity and bandwidth user endpoints should not store content and act as a cluster to provision data.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://support.apple.com/en-us/HT204675">Content types supported by Content Caching in macOS</xhtml:a>
                     </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The main use case for Mac computers is as mobile user endpoints. P2P sharing services should not be enabled on laptops that are using untrusted networks. Content Caching can allow a computer to be a server for local nodes on an untrusted network. While there are certainly logical controls that could be used to mitigate risk, they add to the management complexity. Since the value of the service is in specific use cases organizations with the use case described above can accept risk as necessary.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/about-content-caching-mchl9388ba1b/</xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/set-up-content-caching-on-mac-mchl3b6c3720/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Content Caching:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Content Caching</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Content Caching:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/AssetCacheManagerUtil deactivate
</xhtml:code>
                           <xhtml:p>


The output will include                                                     <xhtml:span class="inline_block">Content caching deactivated</xhtml:span>
                           </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">allowContentCaching</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>This setting will adversely affect bandwidth usage between local subnets and the Internet.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_content_caching"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.11_Ensure_AirDrop_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure AirDrop Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>AirDrop is Apple's built-in on demand ad hoc file exchange system that is compatible with both macOS and iOS. It uses Bluetooth LE for discovery that limits connectivity to Mac or iOS users that are in close proximity. Depending on the setting it allows everyone or only Contacts to share files when they are nearby to each other.</xhtml:p>
                     <xhtml:p>In many ways this technology is far superior to the alternatives. The file transfer is done over a TLS encrypted session, does not require any open ports that are required for file sharing, does not leave file copies on email servers or within cloud storage, and allows for the service to be mitigated so that only people already trusted and added to contacts can interact with you.</xhtml:p>
                     <xhtml:p>While there are positives to AirDrop, there are privacy concerns that could expose personal information. For that reason, AirDrop should be disabled, and should only be enabled when needed and disabled afterwards. The recommendation against enabling the sharing is not based on any known lack of security in the protocol but for specific user operational concerns.</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>If AirDrop is enabled the Mac is advertising that a Mac is addressable on the local network and open to either unwanted AirDrop upload requests or for a negotiation on whether the remote user is in the user's contacts list Neither process is desirable.</xhtml:li>
                        <xhtml:li>In most known use cases AirDrop use is ad hoc networking where AirDrop use is where Apple device users decide that a file should be exchanged and opt to use AirDrop which can be abled on the fly for that exchange.</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>For organizations concerned about any use of AirDrop because of Digital Loss Prevention (DLP) monitoring on other protocols JAMF has an article on reviewing AirDrop logs.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://www.jamf.com/blog/stop-potential-airdrop-transfer-data-leaks-with-jamf-protect/">Detecting outbound AirDrop transfers and logging them</xhtml:a>
                     </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Centralize Access Control" urn="urn:cisecurity.org:controls:8.0:6:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Disable Wireless Access on Devices if Not Required" urn="urn:cisecurity.org:controls:7.0:15:4">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>AirDrop can allow malicious files to be downloaded from unknown sources. Contacts Only limits may expose personal information to devices in the same area.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.techrepublic.com/article/apple-airdrop-users-reportedly-vulnerable-to-security-flaw/</xccdf:ident>
                  <xccdf:ident system="URL">https://www.imore.com/how-apple-keeps-your-airdrop-files-private-and-secure</xccdf:ident>
                  <xccdf:ident system="URL">https://en.wikipedia.org/wiki/AirDrop</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable AirDrop:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Settings</xhtml:span>


 in the Menu Bar                                                    </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">General</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">AirDrop &amp; Handoff</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">AirDrop</xhtml:span>


 to                                                           <xhtml:span class="inline_block">No One</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Settings</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Control Center</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">AirDrop</xhtml:span>


 to                                                           <xhtml:span class="inline_block">Don't show in Menu Bar</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following commands to disable AirDrop:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; defaults write com.apple.NetworkBrowser DisableAirDrop -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u seconduser defaults write com.apple.NetworkBrowser DisableAirDrop -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">allowAirDrop</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 AirDrop can only be enabled or disabled through configuration profiles. Any additional settings need to be set through the GUI or CL                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Disabling AirDrop can limit the ability to move files quickly over the network without using file shares.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_airdrop_disabled"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.12_Ensure_Media_Sharing_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Media Sharing Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Starting with macOS 10.15, Apple has provided a control which permits a user to share Apple downloaded content on all Apple devices that are signed in with the same Apple ID. This allows users to share downloaded Movies, Music, or TV shows with other controlled macOS, iOS and iPadOS devices, as well as photos with Apple TVs.</xhtml:p>
                     <xhtml:p>With this capability, guest users can also use media downloaded on the computer.</xhtml:p>
                     <xhtml:p>The recommended best practice is not to use the computer as a server, but to utilize Apple's cloud storage in order to download and use content stored there if content stored with Apple is used on multiple devices.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://support.apple.com/guide/mac-help/set-up-media-sharing-on-mac-mchlp13371337/mac">https://support.apple.com/guide/mac-help/set-up-media-sharing-on-mac-mchlp13371337/mac</xhtml:a>
                     </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling Media Sharing reduces the remote attack surface of the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Media Sharing:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Sharing</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Media Sharing</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Media Sharing:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.amp.mediasharingd home-sharing-enabled -int 0
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ sudo -u test2 /usr/bin/defaults write com.apple.amp.mediasharingd home-sharing-enabled -int 0
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.preferences.sharing.SharingPrefsExtension</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">homeSharingUIStatus</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;0&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key to also include is legacySharingUIStatus</xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;0&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key to also include is mediaSharingUIStatus</xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;0&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Media Sharing allows for pre-downloaded content on a Mac to be available to other Apple devices on the same network. Leaving this disabled forces device users to stream or download content from each Apple authorized device. This sharing could even allow unauthorized devices on the same network media access.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_media_sharing"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5_Security__Privacy">
               <xccdf:title xml:lang="en">Security &amp; Privacy</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


This section contains recommendations for configurable options under the                                   <xhtml:em>Security &amp; Privacy</xhtml:em>


 panel.                            </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-ca/guide/mac-help/mh32356/mac">Additional privacy preference information from Apple</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>If the computer is present in an area where there are privacy concerns or sensitive activity is taking place, the Mac should be configured appropriately for the sensitive area.</xhtml:p>
                  <xhtml:p>Camera:
If the computer is present in an area where there are privacy concerns or sensitive activity is taking place, the camera should be covered at those times. A permanent cover or alteration may be required when the computer is always located in a confidential area.</xhtml:p>
                  <xhtml:p>Microphone:
If the computer is present in an area where there are privacy concerns or sensitive activity is taking place, the microphone input should be set to zero in the input tab of the Sound preference pane at those times. Individual management of applications with access to the microphone may be managed in the Security &amp; Privacy Preference Pane under Microphone.</xhtml:p>
                  <xhtml:p>WiFi and Bluetooth
Some organizations have comprehensive rules that cover the use of wireless technologies in order to implement operational security. There are often specific policies governing the use of both Bluetooth and Wi-Fi (802.11) that may include disabling the wireless capability in either software or hardware or both. Wireless access is part of the feature set required for mobile computers and is considered essential for most users.</xhtml:p>
                  <xhtml:p>Malware is continuously discovered that circumvents the privacy controls of the built-in Video, audio or network capabilities. No computer has perfect security, and even if all the drivers are disabled or removed, working drivers can be reintroduced by a determined attacker.</xhtml:p>
                  <xhtml:p>


Additional info
                                  <xhtml:a href="https://threatpost.com/apple-bug-bounty-mac-webcam-hack/178114/">Apple Pays $100.5K Bug Bounty for Mac Webcam Hack</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.tomsguide.com/news/zoom-mac-microphone-listening">Mac users, update Zoom now  your microphone may be spying on you</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-vn/HT202068">Recommended settings for Wi-Fi routers and access points</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/guide/mac-help/control-access-to-the-microphone-on-mac-mchla1b1e1fe/mac">Control access to the microphone on Mac</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/guide/security/bluetooth-security-sec82597d97e/web">Bluetooth security</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5.1_Encryption">
                  <xccdf:title xml:lang="en">Encryption</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple has created simple, easy-to-use encryption capabilities built into macOS. Those tools need to be utilized in order to protect information processed by macOS computers.</xhtml:p>
                  </xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1.1_Ensure_FileVault_Is_Enabled" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Ensure FileVault Is Enabled</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>FileVault secures a system's data by automatically encrypting its boot volume and requiring a password or recovery key to access it.</xhtml:p>
                        <xhtml:p>FileVault should be used with a saved escrow key to ensure that the owner can decrypt their data if the password is lost.</xhtml:p>
                        <xhtml:p>


FileVault may also be enabled using command line using the                                               <xhtml:span class="inline_block">fdesetup</xhtml:span>


 command. To use this functionality, consult the Der Flounder blog for more details (see link below under References).                                        </xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Encrypt Data on End-User Devices" urn="urn:cisecurity.org:controls:8.0:3:6">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Encrypt the Hard Drive of All Mobile Devices." urn="urn:cisecurity.org:controls:7.0:13:6">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                                 <controls:implementation_groups ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                        <notes:notes xml:lang="en">
                           <xhtml:p>FileVault may not be desirable on a virtual OS. As long as the hypervisor and file storage are encrypted, the virtual OS does not need to be. Rather than checking if the OS is virtual and passing the control regardless of the encryption of the host system, the normal check will be run. Security officials can evaluate the comprehensive controls outside of the OS being tested.</xhtml:p>
                           <xhtml:p>


Part of FileVault management in an Enterprise environment is to ensure key management if technical staff need to decrypt encrypted volumes. More information here:
                                                    <xhtml:a href="https://derflounder.wordpress.com/2021/10/29/use-of-filevault-institutional-recovery-keys-no-longer-recommended-by-apple/">https://derflounder.wordpress.com/2021/10/29/use-of-filevault-institutional-recovery-keys-no-longer-recommended-by-apple/ </xhtml:a>
                           </xhtml:p>
                        </notes:notes>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Encrypting sensitive data minimizes the likelihood of unauthorized users gaining access to it.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://derflounder.wordpress.com/2015/02/02/managing-yosemites-filevault-2-with-fdesetup/</xccdf:ident>
                     <xccdf:ident system="URL">https://derflounder.wordpress.com/2019/01/15/unlock-or-decrypt-your-filevault-encrypted-boot-drive-from-the-command-line-on-macos-mojave/</xccdf:ident>
                     <xccdf:ident system="URL">https://derflounder.wordpress.com/2021/10/29/use-of-filevault-institutional-recovery-keys-no-longer-recommended-by-apple/</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Graphical Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Perform the following steps to enable FileVault:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


Open                                                                 <xhtml:span class="inline_block">System Preferences</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">FileVault</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Turn On FileVault</xhtml:span>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 This will allow you to create a recovery key for FileVault. Keep the key saved securely in case it is needed at a later date.                                                    </xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Profile Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


The PayloadType string is                                                                 <xhtml:span class="inline_block">com.apple.MCX</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key to include is                                                                 <xhtml:span class="inline_block">dontAllowFDEDisable</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key must be set to                                                                 <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 This profile is required to pass the audit.                                                    </xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Mounting a FileVault encrypted volume from an alternate boot source will require a valid password to decrypt it.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://open-scap.org/page/SCE">
                           <check-import import-name="stdout"></check-import>
                           <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_fdesetup_status"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1.2_Ensure_all_user_storage_APFS_volumes_are_encrypted" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Ensure all user storage APFS volumes are encrypted</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>


Apple developed a new file system which was first made available in 10.12 and then became the default in 10.13. The file system is optimized for Flash and Solid-State storage and encryption.
                                              <xhtml:a href="https://en.wikipedia.org/wiki/Apple_File_System">https://en.wikipedia.org/wiki/Apple_File_System</xhtml:a>



macOS computers generally have several volumes created as part of APFS formatting, including Preboot, Recovery and Virtual Memory (VM), as well as traditional user disks.                                        </xhtml:p>
                        <xhtml:p>All APFS volumes that do not have specific roles and do not require encryption should be encrypted. "Role" disks include Preboot, Recovery and VM. User disks are labelled with "(No specific role)" by default.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Encrypt Data on End-User Devices" urn="urn:cisecurity.org:controls:8.0:3:6">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Encrypt the Hard Drive of All Mobile Devices." urn="urn:cisecurity.org:controls:7.0:13:6">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                                 <controls:implementation_groups ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>In order to protect user data from loss or tampering volumes, carrying data should be encrypted.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Use Disk Utility to erase a user disk and format as APFS (Encrypted).</xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 APFS Encrypted disks will be described as "FileVault" whether they are the boot volume or not in the ap list.                                                    </xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>While FileVault protects the boot volume, data may be copied to other attached storage and reduce the protection afforded by FileVault. Ensure all user volumes are encrypted to protect data.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1.3_Ensure_all_user_storage_CoreStorage_volumes_are_encrypted" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Ensure all user storage CoreStorage volumes are encrypted</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Apple introduced CoreStorage with 10.7. It is used as the default for formatting on macOS volumes prior to 10.13.</xhtml:p>
                        <xhtml:p>All HFS and CoreStorage Volumes should be encrypted.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Encrypt Data on Removable Media" urn="urn:cisecurity.org:controls:8.0:3:9">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Encrypt the Hard Drive of All Mobile Devices." urn="urn:cisecurity.org:controls:7.0:13:6">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                                 <controls:implementation_groups ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>In order to protect user data from loss or tampering, volumes carrying data should be encrypted.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Use Disk Utility to erase a disk and format as macOS Extended (Journaled, Encrypted).</xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>While FileVault protects the boot volume, data may be copied to other attached storage and reduce the protection afforded by FileVault. Ensure all user volumes are encrypted to protect data.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5.2_Firewall">
                  <xccdf:title xml:lang="en">Firewall</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>macOS has a built-in firewall that has two main configuration aspects. Both the Application Layer Firewall (ALF) and the Packet Filter Firewall (PF) can be used to secure running ports and services on a Mac. The Application Firewall is the one accessible in System Preferences under security. The PF firewall contains many more capabilities than ALF, but also requires a greater understanding of firewall recipes and rule configurations. For standard use cases on a Mac, the PF firewall is not necessary. macOS may expose server services that are reachable remotely, but that is not the primary use case or design. If custom use cases are required, the PF firewall can provide additional security. Macs that are used as mobile desktops do not need to use the PF firewall capabilities unless permanently open ports need to be protected with more granular IP access controls.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Additional information</xhtml:strong>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://www.muo.com/tag/mac-really-need-firewall/">https://www.muo.com/tag/mac-really-need-firewall/</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://blog.neilsabol.site/post/quickly-easily-adding-pf-packet-filter-firewall-rules-macos-osx/">https://blog.neilsabol.site/post/quickly-easily-adding-pf-packet-filter-firewall-rules-macos-osx/</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="http://marckerr.com/a-simple-guild-to-the-mac-pf-firewall/">http://marckerr.com/a-simple-guild-to-the-mac-pf-firewall/</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/">https://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/</xhtml:a>
                     </xhtml:p>
                  </xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.2.1_Ensure_Firewall_Is_Enabled" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Ensure Firewall Is Enabled</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall:</xhtml:p>
                        <xhtml:p>
                           <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
                        </xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Centralize Security Event Alerting" urn="urn:cisecurity.org:controls:8.0:13:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Implement Application Firewalls" urn="urn:cisecurity.org:controls:7.0:9:5">
                                 <controls:implementation_groups ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                        <notes:notes xml:lang="en">
                           <xhtml:p>Your organization might want to verify and limit specific applications that allow incoming connectivity.</xhtml:p>
                           <xhtml:p>To verify those applications:</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to ensure the system is configured as prescribed:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp;amp;amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Firewall Options</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Verify that your organizations necessary rules are set</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to verify the what applications are allowing incoming connections:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --listapps    
</xhtml:code>
                           <xhtml:p>The output will show any applications, and their path, and their associated rule.</xhtml:p>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --listapps                                                       <br></br>


ALF: total number of apps = 3                                                     <br></br>
                              <br></br>


1 :  /System/Library/CoreServices/RemoteManagement/ARDAgent.app                                                     <br></br>


 	 ( Allow incoming connections )                                                     <br></br>
                              <br></br>


2 :  /Applications/Chess.app                                                     <br></br>


 	 ( Allow incoming connections )                                                     <br></br>
                              <br></br>


3 :  /Applications/Contacts.app                                                     <br></br>


 	 ( Block incoming connections ) 
                                              </xhtml:code>
                           <xhtml:p>To remove those applications:</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to remove unnecessary firewall rules:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp;amp;amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Firewall Options</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Select unneeded rule(s)</xhtml:li>
                              <xhtml:li>


Select the                                                           <xhtml:span class="inline_block">-</xhtml:span>


 below to delete them                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to remove specific applications:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --remove &amp;amp;lt;/path/application name&amp;amp;amp;gt;                                                    <br></br>
                              <br></br>


Application at path ( &amp;amp;lt;/path/application name&amp;amp;amp;gt; ) removed from firewall
                                              </xhtml:code>
                           <xhtml:p>


The                                                     <xhtml:span class="inline_block">&amp;amp;lt;/path/application name&amp;amp;amp;gt;</xhtml:span>


 is the one to be removed from the previous listing.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --listapps                                                       <br></br>


ALF: total number of apps = 3                                                     <br></br>
                              <br></br>


1 :  /System/Library/CoreServices/RemoteManagement/ARDAgent.app                                                     <br></br>


 	 ( Allow incoming connections )                                                     <br></br>
                              <br></br>


2 :  /Applications/Chess.app                                                     <br></br>


 	 ( Allow incoming connections )                                                     <br></br>
                              <br></br>


3 :  /Applications/Contacts.app                                                     <br></br>


 	 ( Block incoming connections ) 

$ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --remove /Applications/Chess.app

Application at path ( /Applications/Chess.app ) removed from firewall 
                                              </xhtml:code>
                        </notes:notes>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>A firewall minimizes the threat of unauthorized users gaining access to your system while connected to a network or the Internet.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/security/seca0e83763f/web</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Graphical Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Perform the following steps to turn the firewall on:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


Open                                                                 <xhtml:span class="inline_block">System Preferences</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Firewall</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Turn On Firewall</xhtml:span>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Terminal Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Run the following command to enable the firewall:</xhtml:p>
                              <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.alf globalstate -int &lt;value&gt;
</xhtml:code>
                              <xhtml:p>


For the                                                           <xhtml:span class="inline_block">&lt;value&gt;</xhtml:span>


, use either                                                           <xhtml:span class="inline_block">1</xhtml:span>


, specific services, or                                                           <xhtml:span class="inline_block">2</xhtml:span>


, essential services only.                                                    </xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Profile Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


The PayloadType string is                                                                 <xhtml:span class="inline_block">com.apple.security.firewall</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key to include is                                                                 <xhtml:span class="inline_block">EnableFirewall</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key must be set to                                                                 <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>The firewall may block legitimate traffic. Applications that are unsigned will require special handling.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://open-scap.org/page/SCE">
                           <check-import import-name="stdout"></check-import>
                           <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_firewall_enable"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.2.2_Ensure_Firewall_Stealth_Mode_Is_Enabled" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Ensure Firewall Stealth Mode Is Enabled</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>While in Stealth mode, the computer will not respond to unsolicited probes, dropping that traffic.</xhtml:p>
                        <xhtml:p>
                           <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
                        </xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Stealth mode on the firewall minimizes the threat of system discovery tools while connected to a network or the Internet.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Graphical Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Perform the following steps to enable stealth mode:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


Open                                                                 <xhtml:span class="inline_block">System Preferences</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Firewall Options...</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Set                                                                 <xhtml:span class="inline_block">Enable stealth mode</xhtml:span>


 to enabled                                                          </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Terminal Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Run the following command to enable stealth mode:</xhtml:p>
                              <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on                                                          <br></br>
                                 <br></br>


Stealth mode enabled
                                                    </xhtml:code>
                              <xhtml:p>
                                 <xhtml:strong>Profile Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


The PayloadType string is                                                                 <xhtml:span class="inline_block">com.apple.security.firewall</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key to include is                                                                 <xhtml:span class="inline_block">EnableStealthMode</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key must be set to                                                                 <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 This key must be set in the same configuration profile with                                                           <xhtml:span class="inline_block">EnableFirewall</xhtml:span>


 set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>


. If it is set in its own configuration profile, it will fail.                                                    </xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Traditional network discovery tools like ping will not succeed. Other network tools that measure activity and approved applications will work as expected.</xhtml:p>
                                 <xhtml:p>This control aligns with the primary macOS use case of a laptop that is often connected to untrusted networks where host segregation may be non-existent. In that use case, hiding from the other inmates is likely more than desirable. In use cases where use is only on trusted LANs with static IP addresses, stealth mode may not be desirable.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://open-scap.org/page/SCE">
                           <check-import import-name="stdout"></check-import>
                           <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_firewall_stealth"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Ensure_Location_Services_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Location Services Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. With the operating system verifying the location, users do not need to change the time or the time zone. The computer will change them based on the user's location. They do not need to specify their location for weather or travel times, and they will receive alerts on travel times to meetings and appointment where location information is supplied.</xhtml:p>
                     <xhtml:p>Location Services simplify some processes with mobile computers, such as asset management and time or log management.</xhtml:p>
                     <xhtml:p>There are some use cases where it is important that the computer not be able to report its exact location. While the general use case is to enable Location Services, it should not be allowed if the physical location of the computer and the user should not be public knowledge.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Location Services are helpful in most use cases and can simplify log and time management where computers change time zones.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/en-us/HT204690</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable Location Services:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Enable Location Services</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable Location Services:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.locationd.plist
</xhtml:code>
                           <xhtml:p>


If the                                                     <xhtml:span class="inline_block">com.apple.locationd.plist</xhtml:span>


 outputs                                                     <xhtml:span class="inline_block">0</xhtml:span>


, run the following command to also ensure Location Services is running:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool false                                                     <br></br>
                              <br></br>


$ /usr/bin/sudo /bin/launchctl kickstart -k system/com.apple.locationd
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 In some use cases, organizations may not want Location Services running. To disable Location Services, System Integrity Protection must be disabled.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_location_services"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Audit_Location_Services_Access" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Audit Location Services Access</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. While Location Services may be very useful, it may not be desirable to allow all applications that can use Location Services to use your location for Internet queries in order to provide tailored content based on your current location.</xhtml:p>
                     <xhtml:p>Ensure applications that can use Location Services are authorized and provide that information where the application interacts with external systems. Apple offers feedback within System Preferences and may be enabled to supply information on the menu bar when Location Services are used.</xhtml:p>
                     <xhtml:p>Safari can deny access from websites or prompt for access.</xhtml:p>
                     <xhtml:p>Applications that support Location Services can be individually controlled in the Privacy tab in Security &amp; Privacy under System Preferences.</xhtml:p>
                     <xhtml:p>Access should be evaluated to ensure that privacy controls are as expected.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Privacy controls should be monitored for appropriate settings.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following to disable unnecessary applications from accessing Location Services:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Location Services</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Set any applications that are not approved for access to Location Service information to disabled</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>Perform the following to set websites to ask for permission to access Location Services:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Websites</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Location</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Set When visiting other websites to Ask or Deny</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Many macOS features rely on Location Services for tailored information. Users expect their time zone and weather to be relevant to where they are without manual intervention. Find my Mac needs to know where your Mac is actually located. Where possible, the tolerance between location privacy and convenience may be best left to the user when the location itself is not sensitive. If facility locations are not public, location information should be tightly controlled.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.5_Ensure_Sending_Diagnostic_and_Usage_Data_to_Apple_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Sending Diagnostic and Usage Data to Apple Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple provides a mechanism to send diagnostic and analytics data back to Apple to help them improve the platform. Information sent to Apple may contain internal organizational information that should be controlled and not available for processing by Apple.
Turn off all Analytics and Improvements sharing.</xhtml:p>
                     <xhtml:p>Share Mac Analytics (Share with App Developers dependent on Mac Analytic sharing)</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Includes diagnostics, usage and location data</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>Share iCloud Analytics</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Includes iCloud data and usage information</xhtml:li>
                     </xhtml:ul>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Organizations should have knowledge of what is shared with the vendor and that this setting automatically forwards information to Apple.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/mac-help/mh27990/mac</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable diagnostic data being sent to Apple:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Analytics &amp; Improvements</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Share Mac Analytics</xhtml:span>


 to disabled                                                    </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Share with App Developers</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following commands to disable the sending of diagnostic data to Apple:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/defaults write /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist AutoSubmit -bool false                                                    <br></br>
                              <br></br>


/usr/bin/sudo /usr/bin/defaults write /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist ThirdPartyDataSubmit -bool false                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /bin/chmod 644 /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/sbin/chgrp admin /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.assistant.support "Siri Data Sharing Opt-In Status" -int 2
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u seconduser /usr/bin/defaults write /Users/seconduser/Library/Preferences/com.apple.assistant.support "Siri Data Sharing Opt-In Status" -int 2
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">allowDiagnosticSubmission</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">Siri Data Sharing Opt-In Status</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;2&lt;integer/&gt;</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


There must also be a second PayloadType string of                                                           <xhtml:span class="inline_block">com.apple.SubmitDiagInfo</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">AutoSubmit</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_diagnostic_data"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.6_Ensure_Limit_Ad_Tracking_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Limit Ad Tracking Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple provides a framework that allows advertisers to target Apple users and end-users with advertisements. While many people prefer to see advertising that is relevant to them and their interests, the detailed information that is collected, correlated, and available to advertisers in repositories via data mining is often disconcerting. This information is valuable to both advertisers and attackers, and has been used with other metadata to reveal users' identities.</xhtml:p>
                     <xhtml:p>Organizations should manage advertising settings on computers rather than allow users to configure the settings.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://support.apple.com/en-us/HT205223">Apple Information</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>Ad tracking should be limited on 10.15 and prior.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Organizations should manage user privacy settings on managed devices to align with organizational policies and user data protection requirements.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set limited ad tracking:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Apple Advertising</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Personalized Ads</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>For each needed user, run the following command to enable limited ad tracking:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.Adlib.plist allowApplePersonalizedAdvertising -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u seconduser /usr/bin/defaults write /Users/seconduser/Library/Preferences/com.apple.Adlib.plist allowApplePersonalizedAdvertising -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">allowApplePersonalizedAdvertising</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Uses will see generic advertising rather than targeted advertising. Apple warns that this will reduce the number of relevant ads.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_limit_ad_tracking"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.7_Ensure_Gatekeeper_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Gatekeeper Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Gatekeeper is Apples application that utilizes allowlisting to restrict downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Deploy and Maintain Anti-Malware Software" urn="urn:cisecurity.org:controls:8.0:10:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Configure Automatic Anti-Malware Signature Updates" urn="urn:cisecurity.org:controls:8.0:10:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Anti-Malware Software and Signatures are Updated" urn="urn:cisecurity.org:controls:7.0:8:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Configure Anti-Malware Scanning of Removable Devices" urn="urn:cisecurity.org:controls:7.0:8:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disallowing unsigned software will reduce the risk of unauthorized or malicious applications from running on the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable Gatekeeper:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">General</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Set 'Allow apps downloaded from:' to 'App Store and identified developers'</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable Gatekeeper to allow applications from App Store and identified developers:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/spctl --master-enable
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.systempolicy.control</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">AllowIdentifiedDevelopers</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">EnableAssessment</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_gatekeeper_enabled"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.8_Ensure_a_Custom_Message_for_the_Login_Screen_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure a Custom Message for the Login Screen Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable a login banner set to your organization's required text:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Show a message when the screen is locked</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Set Lock Message</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Insert text in the                                                           <xhtml:span class="inline_block">Set a message to appear on the lock screen</xhtml:span>


 that matches your organization's required text                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable a custom login screen message:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText "&lt;custom message&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText "Center for Internet Security Test Message"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.loginwindow</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">LoginwindowText</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;string&gt;&lt;Your organization's required text&gt;&lt;/string&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If users are not informed of their responsibilities, unapproved activities may occur. Users that are not approved for access may take the lack of a warning banner as implied consent to access.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_login_message"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.9_Ensure_an_Administrator_Password_Is_Required_to_Access_System-Wide_Preferences" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure an Administrator Password Is Required to Access System-Wide Preferences</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>System Preferences controls system and user settings on a macOS Computer. System Preferences allows the user to tailor their experience on the computer as well as allowing the System Administrator to configure global security settings. Some of the settings should only be altered by the person responsible for the computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>By requiring a password to unlock system-wide System Preferences, the risk is mitigated of a user changing configurations that affect the entire system and requires an admin user to re-authenticate to make changes</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to verify that an administrator password is required to access system-wide preferences:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">General</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Advanced...</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Require an administrator password to access system-wide preferences</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>The authorizationdb settings cannot be written to directly, so the plist must be exported out to temporary file. Changes can be made to the temporary plist, then imported back into the authorizationdb settings.</xhtml:p>
                           <xhtml:p>Run the following commands to enable that an administrator password is required to access system-wide preferences:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/security authorizationdb read system.preferences &gt; /tmp/system.preferences.plist                                                    <br></br>
                              <br></br>


YES (0)                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/bin/defaults write /tmp/system.preferences.plist shared -bool false                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/bin/security authorizationdb write system.preferences &lt; /tmp/system.preferences.plist                                                    <br></br>
                              <br></br>


YES (0)
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Users will need to enter their password to unlock some additional preference panes that are unlocked by default like Network, Startup and Printers &amp; Scanners.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_admin_password_required"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.10_Ensure_a_Password_is_Required_to_Wake_the_Computer_From_Sleep_or_Screen_Saver_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure a Password is Required to Wake the Computer From Sleep or Screen Saver Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Sleep and screen saver modes are low power modes that reduce electrical consumption while the system is not in use.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Manage Default Accounts on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:7">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Change Default Passwords" urn="urn:cisecurity.org:controls:7.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>This only protects the system when the screen saver is running.</xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 The command line check in previous versions of the Benchmark does not work as expected here. The use of a profile is recommended for both implementation and auditing on a 10.13 system or later.                                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Prompting for a password when waking from sleep or screen saver mode mitigates the threat of an unauthorized person gaining access to a system in the user's absence.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://blog.kolide.com/screensaver-security-on-macos-10-13-is-broken-a385726e2ae2</xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/rtrouton/profiles/blob/master/SetDefaultScreensaver/SetDefaultScreensaver.mobileconfig</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable a password for unlock after a screen saver begins or after sleep:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security &amp; Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">General</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Require password after or screensaver begins</xhtml:span>


 with a time of                                                           <xhtml:span class="inline_block">immediately</xhtml:span>


 or                                                           <xhtml:span class="inline_block">5 seconds</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to require a password to unlock the computer after the screen saver engages or the computer sleeps:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/sysadminctl -screenLock immediate -password &lt;administrator password&gt;
</xhtml:code>
                           <xhtml:p>or</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/sysadminctl -screenLock 5 seconds -password &lt;administrator password&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.screensaver</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">askForPassword</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">askForPasswordDelay</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;0,5&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Without a screenlock in place anyone with physical access to the computer would be logged in and able to use the active user's session.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_wake_password"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.6_Apple_ID">
               <xccdf:title xml:lang="en">Apple ID</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apple is a hardware manufacturer that develops operating systems for the hardware it creates. Apple is also a cloud service provider and those services include applications, music, books, television, cloud storage, etc. Apple simplifies the process to ensure that all user devices are entitled to content where the user has purchased access, or is part of an Apple basic level of entitlement (BLE) for purchasing an Apple device. The use of an Apple ID allows for a consistent access and experience across all Apple devices. An Apple ID functions as Single Sign-On access to all Apple provided services. It is critical that each user's account is protected appropriately so that unauthorized access risk is heavily mitigated.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-us/HT203993">https://support.apple.com/en-us/HT203993</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://en.wikipedia.org/wiki/Apple_ID">https://en.wikipedia.org/wiki/Apple_ID</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.lifewire.com/what-is-an-apple-id-1994330">https://www.lifewire.com/what-is-an-apple-id-1994330</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-us/HT201303">https://support.apple.com/en-us/HT201303</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.6.1_iCloud">
                  <xccdf:title xml:lang="en">iCloud</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>iCloud is Apple's service for synchronizing, storing, and backing up data from Apple applications in both macOS and iOS.</xhtml:p>
                     <xhtml:p>macOS controls for iCloud are part of the Apple ID settings in macOS. The configuration options in macOS resemble the options in iOS.</xhtml:p>
                     <xhtml:p>Apple's iCloud is a consumer-oriented service that allows a user to store data as well as find, control, and back up devices that are associated with their Apple ID (Apple account). The use of iCloud on Enterprise devices should align with the acceptable use policy for devices that are managed, as well as confidentiality requirements for data handled by the user. If iCloud is allowed, the data that is copied to Apple servers will likely be duplicated on both personal as well as Enterprise devices.</xhtml:p>
                     <xhtml:p>For many users, the Enterprise email system may replace many of the available features in iCloud. Calendars, notes, and contacts can sync to the official Enterprise repository and be available through multiple devices if using either an Exchange or Google environment email.</xhtml:p>
                     <xhtml:p>Depending on workplace requirements, it may not be appropriate to intermingle Enterprise and personal bookmarks, photos, and documents. Since the service allows every device associated with the user's ID to synchronize and have access to the cloud storage, the concern is not just about having sensitive data on Apple's servers, but also having that same data on the phone of the teenage son or daughter of an employee. The use of family sharing options can reduce the risk.</xhtml:p>
                     <xhtml:p>Apple's iCloud is just one of many cloud-based solutions being used for data synchronization across multiple platforms, and it should be controlled consistently with other cloud services in your environment. Work with your employees and configure the access to best enable data protection for your mission.</xhtml:p>
                  </xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.1.1_Audit_iCloud_Keychain" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Audit iCloud Keychain</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>The iCloud keychain is Apple's password manager that works with macOS and iOS. The capability allows users to store passwords in either iOS or macOS for use in Safari on both platforms and other iOS-integrated applications. The most pervasive use is driven by iOS use rather than macOS. The passwords stored in a macOS keychain on an Enterprise-managed computer could be stored in Apple's cloud and then be available on a personal computer using the same account. The stored passwords could be for organizational as well as for personal accounts.</xhtml:p>
                        <xhtml:p>If passwords are no longer being used as organizational tokens, they are not in scope for iCloud keychain storage.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Classify Service Providers" urn="urn:cisecurity.org:controls:8.0:15:3">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type></controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Ensure that the iCloud keychain is used consistently with organizational requirements.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/15/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Graphical Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Perform the following steps to set iCloud keychain sync based on your organization's requirements:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


Open                                                                 <xhtml:span class="inline_block">System Preferences</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Apple ID</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">iCloud</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Set                                                                 <xhtml:span class="inline_block">Keychain</xhtml:span>


 to meet your organization's requirements                                                          </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Profile Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


The PayloadType string is                                                                 <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key to include is                                                                 <xhtml:span class="inline_block">allowCloudKeychainSync</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key should be set                                                                 <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>


, to allow iCloud keychain syncing, or                                                                 <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>


, to disable it, based on your organization's requirements                                                          </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3168747"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.1.2_Audit_iCloud_Drive" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Audit iCloud Drive</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>iCloud Drive is Apple's storage solution for applications on both macOS and iOS to use the same files that are resident in Apple's cloud storage. The iCloud Drive folder is available much like Dropbox, Microsoft OneDrive, or Google Drive.</xhtml:p>
                        <xhtml:p>One of the concerns in public cloud storage is that proprietary data may be inappropriately stored in an end user's personal repository. Organizations that need specific controls on information should ensure that this service is turned off or the user knows what information must be stored on services that are approved for storage of controlled information.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Classify Service Providers" urn="urn:cisecurity.org:controls:8.0:15:3">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type></controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Organizations should review third party storage solutions pertaining to existing data confidentiality and integrity requirements.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/15/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://developer.apple.com/documentation/devicemanagement/restrictions</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Graphical Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Perform the following steps to set iCloud Drive to your organization's requirements:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


Open                                                                 <xhtml:span class="inline_block">System Preferences</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Apple ID</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">iCloud</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Set                                                                 <xhtml:span class="inline_block">iCloud Drive</xhtml:span>


 to for your organization's requirements                                                          </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Profile Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


The PayloadType string is                                                                 <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key to include is                                                                 <xhtml:span class="inline_block">allowCloudDocumentSync</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key should be set                                                                 <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>


, to allow iCloud Drive, or                                                                 <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>


, to disable it, based on your organization's requirements                                                          </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                                    </xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Users will not be able to use continuity on macOS to resume the use of newly composed but unsaved files.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3168748"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.1.3_Ensure_iCloud_Drive_Document_and_Desktop_Sync_Is_Disabled" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Ensure iCloud Drive Document and Desktop Sync Is Disabled</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>With macOS 10.12, Apple introduced the capability to have a user's Desktop and Documents folders automatically synchronize to the user's iCloud Drive, provided they have enough room purchased through Apple on their iCloud Drive. This capability mirrors what Microsoft is doing with the use of OneDrive and Office 365. There are concerns with using this capability.</xhtml:p>
                        <xhtml:p>The storage space that Apple provides for free is used by users with iCloud mail, all of a user's Photo Library created with the ever larger Multi-Pixel iPhone cameras, and all iOS Backups. Adding a synchronization capability for users who have files going back a decade or more, storage may be tight using the free 5GB provided without purchasing much larger storage capacity from Apple. Users with multiple computers running 10.12 and above with unique content on each will have issues as well.</xhtml:p>
                        <xhtml:p>Enterprise users may not be allowed to store Enterprise information in a third-party public cloud. In previous implementations, such as iCloud Drive or DropBox, the user selected what files were synchronized even if there were no other controls. The new feature synchronizes all files in a folder widely used to put working files.</xhtml:p>
                        <xhtml:p>The automatic synchronization of all files in a user's Desktop and Documents folders should be disabled.</xhtml:p>
                        <xhtml:p>
                           <xhtml:a href="https://derflounder.wordpress.com/2016/09/23/icloud-desktop-and-documents-in-macos-sierra-the-good-the-bad-and-the-ugly/">https://derflounder.wordpress.com/2016/09/23/icloud-desktop-and-documents-in-macos-sierra-the-good-the-bad-and-the-ugly/</xhtml:a>
                        </xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Devices</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Classify Service Providers" urn="urn:cisecurity.org:controls:8.0:15:3">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type></controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Automated Document synchronization should be planned and controlled to approved storage.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/15/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://developer.apple.com/documentation/devicemanagement/restrictions</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>
                                 <xhtml:strong>Graphical Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Perform the following steps to disable iCloud Desktop and Document syncing:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>Open `System Preferences</xhtml:li>
                                 <xhtml:li>Select `Apple ID</xhtml:li>
                                 <xhtml:li>Select `iCloud</xhtml:li>
                                 <xhtml:li>


Select                                                                 <xhtml:span class="inline_block">Options...</xhtml:span>


 next to                                                                 <xhtml:span class="inline_block">iCloud Drive</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


Set                                                                 <xhtml:span class="inline_block">Desktop &amp; Documents Folders</xhtml:span>


 to disabled                                                          </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Profile Method:</xhtml:strong>
                              </xhtml:p>
                              <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>


The PayloadType string is                                                                 <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key to include is                                                                 <xhtml:span class="inline_block">allowCloudDesktopAndDocuments</xhtml:span>
                                 </xhtml:li>
                                 <xhtml:li>


The key must be set to                                                                 <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                                    </xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Users will not be able to use iCloud for the automatic sync of the Desktop and Documents folders.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://open-scap.org/page/SCE">
                           <check-import import-name="stdout"></check-import>
                           <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_icloud_docs_desktop"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Audit_App_Store_Password_Settings" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Audit App Store Password Settings</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>With OS X 10.11, Apple added settings for password storage for the App Store in macOS. These settings parallel the settings in iOS. As with iOS, the choices are a requirement to provide a password after every purchase or to have a 15-minute grace period, and whether or not to require a password for free purchases. The response to this setting is stored in a cookie and processed by iCloud.</xhtml:p>
                     <xhtml:p>There is plenty of risk information on the wisdom of this setting for parents with children buying games on iPhones and iPads. The most relevant information here is the likelihood that users who are not authorized to download software may have physical access to an unlocked computer where someone who is authorized recently made a purchase. If that is a concern, a password should be required at all times for App Store access in the Password Settings controls.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set App Store Passwords to your organization's requirements:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Apple ID</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Media &amp; Purchases</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select the setting for                                                           <xhtml:span class="inline_block">Free Downloads</xhtml:span>


 that are withing your organization's requirements                                                    </xhtml:li>
                              <xhtml:li>


Select the setting for                                                           <xhtml:span class="inline_block">Purchases and In-App Purchases</xhtml:span>


 that are within your organization's requirements                                                    </xhtml:li>
                           </xhtml:ol>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.7_Time_Machine">
               <xccdf:title xml:lang="en">Time Machine</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>One of the most important IT Operational concerns is to ensure that information is protected against loss or tampering. The purpose of the IT devices is to process the data, after all. At one time the cost of IT equipment and the volume of the data might make protection of the equipment itself more important. At this point, the vast size of data archives and the lower cost of end-user equipment makes data protection central to operational planning. Backup strategies are generally focused on ensuring that there are multiple copies of relevant versions of user files. The plan is that no single hardware or software loss or failure will result in major data loss.</xhtml:p>
                  <xhtml:p>Apple does not provide a native remote logging capability that encrypts data in transit (DIT). If no third party tool or agent is installed on organizational-manned Macs, it is even more important to ensure that backup processes are implemented with log backups as part of the architecture.</xhtml:p>
                  <xhtml:p>In recent years the criticality of information backup, protection of data, and data backups has become even more important with the rise of cybercriminals that not only commit denial-of-service attacks using ransomware to encrypt your working data to make it inaccessible, but also encrypt the backups if reachable. Newer threats include blackmail to compromise data confidentiality. A comprehensive plan to protect data from compromise is even more vital with current threats. The Time Machine controls are only recommended best practices to assist in ease of frequent backups and the encryption of backup volumes.</xhtml:p>
                  <xhtml:p>Apple introduced Time Machine in 2007 as a simple-to-use, built-in mechanism for users to ensure that their machine was backed up, and if there was a mistake or loss, that information could be easily recovered. There are other solutions to ensure information is protected, including several Enterprise solutions and simple drive or directory cloning.</xhtml:p>
                  <xhtml:p>The controls in this section are specifically about Time Machine. The general ideas are applicable to any data backup solution. These controls are only pertinent to organizations already using Time Machine as part of their backup solutions to ensure the included Apple backup solution is being used effectively. We are not endorsing that Time Machine should be used exclusively or as part of the Enterprise backup solution. The controls first check that Time Machine is actually enabled.</xhtml:p>
                  <xhtml:p>


To enable Time Machine, follow the instructions here:                                   <xhtml:a href="https://support.apple.com/en-us/HT201250">https://support.apple.com/en-us/HT201250</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>For more details on Time Machine:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>
                        <xhtml:a href="https://eclecticlight.co/tag/time-machine/">https://eclecticlight.co/tag/time-machine/</xhtml:a>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:a href="https://www.pcmag.com/how-to/how-to-back-up-your-mac-with-time-machine">https://www.pcmag.com/how-to/how-to-back-up-your-mac-with-time-machine</xhtml:a>
                     </xhtml:li>
                  </xhtml:ul>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7.1_Ensure_Backup_Automatically_is_Enabled_If_Time_Machine_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Backup Automatically is Enabled If Time Machine Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Backup solutions are only effective if the backups run on a regular basis. The time to check for backups is before the hard drive fails or the computer goes missing. In order to simplify the user experience so that backups are more likely to occur, Time Machine should be on and set to Back Up Automatically whenever the target volume is available.</xhtml:p>
                     <xhtml:p>Operational staff should ensure that backups complete on a regular basis and the backups are tested to ensure that file restoration from backup is possible when needed.</xhtml:p>
                     <xhtml:p>Backup dates are available even when the target volume is not available in the Time Machine plist.</xhtml:p>
                     <xhtml:p>SnapshotDates = (</xhtml:p>
                     <xhtml:p>"2012-08-20 12:10:22 +0000",</xhtml:p>
                     <xhtml:p>"2013-02-03 23:43:22 +0000",</xhtml:p>
                     <xhtml:p>"2014-02-19 21:37:21 +0000",</xhtml:p>
                     <xhtml:p>"2015-02-22 13:07:25 +0000",</xhtml:p>
                     <xhtml:p>"2016-08-20 14:07:14 +0000"</xhtml:p>
                     <xhtml:p>When the backup volume is connected to the computer more extensive information is available through tmutil. See man tmutil</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Perform Automated Backups" urn="urn:cisecurity.org:controls:8.0:11:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Recover</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Regular Automated Back Ups" urn="urn:cisecurity.org:controls:7.0:10:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Backups should automatically run whenever the backup drive is available.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/11/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable to backup automatically if Time Machine is enabled:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Time Machine</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Verify that                                                           <xhtml:span class="inline_block">Time Machine</xhtml:span>


 is enabled                                                    </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Back Up Automatically</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable automatic backups if Time Machine is enabled:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.TimeMachine.plist AutoBackup -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.TimeMachine</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">Forced</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to:</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


&lt;array&gt;                                                    <br></br>


	&lt;dict&gt;                                                    <br></br>


		&lt;key&gt;mcx_preference_settings&lt;/key&gt;                                                    <br></br>


			&lt;dict&gt;                                                    <br></br>


				&lt;key&gt;AutoBackup&lt;/key&gt;                                                    <br></br>


				&lt;true/&gt;                                                    <br></br>


			&lt;/dict&gt;                                                    <br></br>


	&lt;/dict&gt;                                                    <br></br>


&lt;/array&gt;
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The backup will run periodically in the background and could have user impact while running.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_timemachine_autobackup"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7.2_Ensure_Time_Machine_Volumes_Are_Encrypted_If_Time_Machine_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Time Machine Volumes Are Encrypted If Time Machine Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>One of the most important security tools for data protection on macOS is FileVault. With encryption in place it makes it difficult for an outside party to access your data if they get physical possession of the computer. One very large weakness in data protection with FileVault is the level of protection on backup volumes. If the internal drive is encrypted but the external backup volume that goes home in the same laptop bag is not it is self-defeating. Apple tries to make this mistake easily avoided by providing a checkbox to enable encryption when setting-up a Time Machine backup. Using this option does require some password management, particularly if a large drive is used with multiple computers. A unique complex password to unlock the drive can be stored in keychains on multiple systems for ease of use.</xhtml:p>
                     <xhtml:p>While some portable drives may contain non-sensitive data and encryption may make interoperability with other systems difficult backup volumes should be protected just like boot volumes.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Data on End-User Devices" urn="urn:cisecurity.org:controls:8.0:3:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Protect Recovery Data" urn="urn:cisecurity.org:controls:8.0:11:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Protection of Backups" urn="urn:cisecurity.org:controls:7.0:10:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt the Hard Drive of All Mobile Devices." urn="urn:cisecurity.org:controls:7.0:13:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Backup volumes need to be encrypted.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/11/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable encryption on the Time Machine drive:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>Open `System Preferences</xhtml:li>
                              <xhtml:li>Select `Time Machine</xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Backup Disk...</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Select the existing Time Machine backup drive from the Available Drive list</xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Encrypt backups</xhtml:span>


 to enabled                                                    </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Use Disk</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note</xhtml:strong>


: You can set encryption through Disk Utility or                                                     <xhtml:span class="inline_block">/usr/bin/sudo /usr/sbin/diskutil</xhtml:span>


 in terminal, but it is advised to use the GUI.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_timemachine_encrypted"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.8_Battery_Energy_Saver">
               <xccdf:title xml:lang="en">Battery (Energy Saver)</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This section is for energy use controls. Prior to Big Sur (Mac OS 11) it was known only as Energy Saver.</xhtml:p>
                  <xhtml:p>On desktop Macs, this preference pane is still named Energy Saver and not Battery.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://cleanmymac.com/faq/mac-power-saving-mode">Mac Energy Saver preferences explained</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8.1_Ensure_Wake_for_Network_Access_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Wake for Network Access Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>This feature allows the computer to take action when the user is not present and the computer is in energy saving mode. These tools require FileVault to remain unlocked and fully rejoin known networks. This macOS feature is meant to allow the computer to resume activity as needed regardless of physical security controls.</xhtml:p>
                     <xhtml:p>This feature allows other users to be able to access your computers shared resources, such as shared printers or Apple Music playlists, even when your computer is in sleep mode. In a closed network when only authorized devices could wake a computer, it could be valuable to wake computers in order to do management push activity. Where mobile workstations and agents exist, the device will more likely check in to receive updates when already awake. Mobile devices should not be listening for signals on any unmanaged network or where untrusted devices exist that could send wake signals.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:span class="inline_block">man pmset</xhtml:span>
                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling this feature mitigates the risk of an attacker remotely waking the system and gaining access.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Wake for network access:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Battery</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Power Adapter</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Wake for network access</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Wake for network access:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pmset -a womp 0  
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.MCX</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">com.apple.EnergySaver.desktop.ACPower</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to:</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


&lt;dict&gt;                                                    <br></br>


	&lt;key&gt;Wake On LAN&lt;/key&gt;                                                    <br></br>


	&lt;integer&gt;0&lt;/integer&gt;                                                    <br></br>


	&lt;key&gt;Wake On Modem Ring&lt;/key&gt;                                                    <br></br>


	&lt;integer&gt;0&lt;/integer&gt;                                                    <br></br>


&lt;/dict&gt;
                                              </xhtml:code>
                           <xhtml:ol start="4">
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">com.apple.EnergySaver.portable.ACPower</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to:</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


&lt;dict&gt;                                                    <br></br>


	&lt;key&gt;Wake On LAN&lt;/key&gt;                                                    <br></br>


	&lt;integer&gt;0&lt;/integer&gt;                                                    <br></br>


	&lt;key&gt;Wake On Modem Ring&lt;/key&gt;                                                    <br></br>


	&lt;integer&gt;0&lt;/integer&gt;                                                    <br></br>


&lt;/dict&gt;
                                              </xhtml:code>
                           <xhtml:ol start="6">
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">com.apple.EnergySaver.portable.BatteryPower</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to:</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


&lt;dict&gt;                                                    <br></br>


	&lt;key&gt;Wake On LAN&lt;/key&gt;                                                    <br></br>


	&lt;integer&gt;0&lt;/integer&gt;                                                    <br></br>


	&lt;key&gt;Wake On Modem Ring&lt;/key&gt;                                                    <br></br>


	&lt;integer&gt;0&lt;/integer&gt;                                                    <br></br>


&lt;/dict&gt;
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Both                                                     <xhtml:span class="inline_block">Wake on LAN</xhtml:span>


 and                                                     <xhtml:span class="inline_block">Wake on Modem Ring</xhtml:span>


 need to be set. Only setting                                                     <xhtml:span class="inline_block">Wake On LAN</xhtml:span>


 will allow the profile to install but not set any settings. This profile will only apply the setting at installation and is not sticky.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Management programs like Apple Remote Desktop Administrator use wake-on-LAN to connect with computers. If turned off, such management programs will not be able to wake a computer over the LAN. If the wake-on-LAN feature is needed, do not turn off this feature.</xhtml:p>
                              <xhtml:p>The control to prevent computer sleep has been retired for this version of the Benchmark. Forcing the computer to stay on and use energy in case a management push is needed is contrary to most current management processes. Only keep computers unslept if after hours pushes are required on closed LANs.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_wake_on_lan"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8.2_Ensure_Power_Nap_Is_Disabled_for_Intel_Macs" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Power Nap Is Disabled for Intel Macs</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Power Nap allows the system to stay in low power mode, especially while on battery power, and periodically connect to previously known networks with stored credentials for user applications to phone home and get updates. This capability requires FileVault to remain unlocked and the use of previously joined networks to be risk accepted based on the SSID without user input.</xhtml:p>
                     <xhtml:p>This control has been updated to check the status on both battery and AC Power. The presence of an electrical outlet does not completely correlate with logical and physical security of the device or available networks.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:span class="inline_block">man pmset</xhtml:span>
                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling this feature mitigates the risk of an attacker remotely waking the system and gaining access.</xhtml:p>
                     <xhtml:p>The use of Power Nap adds to the risk of compromised physical and logical security. The user should be able to decrypt FileVault and have the applications download what is required when the computer is actively used.</xhtml:p>
                     <xhtml:p>The control to prevent computer sleep has been retired for this version of the Benchmark. Forcing the computer to stay on and use energy in case a management push is needed is contrary to most current management processes. Only keep computers unslept if after hours pushes are required on closed LANs.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable Power Nap:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Battery</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Battery</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Enable Power Nap</xhtml:span>


 to enabled                                                    </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Power Adapter</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Enable Power Nap</xhtml:span>


 to enabled                                                    </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">UPS</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Enable Power Nap</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable Power Nap:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pmset -a powernap 0
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Power Nap exists for unattended user application updates like email and social media clients. With Power Nap disabled, the computer will not wake and reconnect to known wireless SSIDs intermittently when slept.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_powernap"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8.3_Ensure_the_OS_is_not_Activate_When_Resuming_from_Sleep" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure the OS is not Activate When Resuming from Sleep</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>In order to use a computer with Full Disk Encryption (FDE), macOS must keep encryption keys in memory to allow the use of the disk that has been FileVault protected. The storage volume has been unlocked and acts as if it were not encrypted. When the system is not in use, the volume is protected through encryption. When the system is sleeping and available to quickly resume, the encryption keys remain in memory.</xhtml:p>
                     <xhtml:p>If an unauthorized party has possession of the computer and the computer is only slept, there are known attack vectors that can be attempted against the RAM that has the encryption keys or the running operating system protected by a login screen. Network attacks if network interfaces are on, as well as USB or other open device ports, are possible. Most of these attacks require knowledge of unpatched vulnerabilities or a high level of sophistication if all the other controls function as intended.</xhtml:p>
                     <xhtml:p>There is little impact on hibernating the system rather than sleeping after an appropriate time period to remediate the risk of OS level attacks. Hibernation writes the keys to disk and requires FileVault to be unlocked prior to the OS being available. In the case of unauthorized personnel with access to the computer, encryption would have to be broken prior to attacking the operating system in order to recover data from the system.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://www.helpnetsecurity.com/2018/08/20/laptop-sleep-security/">https://www.helpnetsecurity.com/2018/08/20/laptop-sleep-security/</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>Mac systems should be set to hibernate after sleeping for a risk-acceptable time period. The default value for "standbydelay" is three hours (10800 seconds). This value is likely appropriate for most desktops. If Mac desktops are deployed in unmonitored, less physically secure areas with confidential data, this value might be adjusted. The desktop would have to retain power, however, so that the running OS or physical RAM could be attacked.</xhtml:p>
                     <xhtml:p>MacBooks should be set so that the standbydelay is 15 minutes (900 seconds) or less. This setting should allow laptop users in most cases to stay within physically secured areas while going to a conference room, auditorium, or other internal location without having to unlock the encryption. When the user goes home at night, the laptop will auto-hibernate after 15 minutes and require the FileVault password to unlock prior to logging back into system when it resumes.</xhtml:p>
                     <xhtml:p>MacBooks should also be set to a hibernate mode that removes power from the RAM. This will stop the possibility of cold boot attacks on the system.</xhtml:p>
                     <xhtml:p>Macs running Apple silicon chips, rather than Intel chips, do not require the same configuration as Intel-based Macs.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>To mitigate the risk of data loss, the system should power down and lock the encrypted drive after a specified time. Laptops should hibernate 15 minutes or less after sleeping.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.lifewire.com/change-mac-sleep-settings-2260804</xccdf:ident>
                  <xccdf:ident system="URL">https://www.zdziarski.com/blog/?p=6705</xccdf:ident>
                  <xccdf:ident system="URL">https://www.howtogeek.com/260478/how-to-choose-when-your-mac-hibernates-or-enters-standby/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set the hibernate delays and to ensure the FileVault keys are set to be destroyed on standby:</xhtml:p>
                           <xhtml:p>Intel Processor Instructions:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/pmset -a standbydelaylow &lt;value900&gt;                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a standbydelayhigh &lt;value900&gt;                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a highstandbythreshold &lt;value90&gt;                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a destroyfvkeyonstandby 1                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a hibernatemode 25
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/pmset -a standbydelaylow 500                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a standbydelayhigh 500                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a highstandbythreshold 100                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a destroyfvkeyonstandby 1                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a hibernatemode 25
                                              </xhtml:code>
                           <xhtml:p>Apple Silicon Processor Instructions:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/pmset -a standby &lt;value900&gt;                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a destroyfvkeyonstandby 1                                                    <br></br>
                              <br></br>


`Setting destroyfvkeyonstandby to True. When system enters standby with this key set all maintenance wakes and powernap activities are disabled`                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a hibernatemode 25
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Setting hibernate mode and destroy filevault key will require the user to log into the machine after sleep and disable any wake options.                                                     <xhtml:span class="inline_block">hibernatemode</xhtml:span>


 must be set to                                                     <xhtml:span class="inline_block">25</xhtml:span>


 or it will not force the computer into a pre-boot state.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/pmset -a standby 500                                                    <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a destroyfvkeyonstandby 1                                                    <br></br>
                              <br></br>


`Setting destroyfvkeyonstandby to True. When system enters standby with this key set all maintenance wakes and powernap activities are disabled`                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /usr/bin/pmset -a hibernatemode 25
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The laptop will take additional time to resume normal operation then if only sleeping rather than hibernating.</xhtml:p>
                              <xhtml:p>


Setting                                                           <xhtml:span class="inline_block">hibernatemode</xhtml:span>


 to                                                           <xhtml:span class="inline_block">25</xhtml:span>


 will disable the "always-on" feature of the Apple Silicon Macs.                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_hibernate_standby"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Legacy_EFI_Is_Valid_and_Updating" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Legacy EFI Is Valid and Updating</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>In order to mitigate firmware attacks, Apple has created an automated Firmware check to ensure that the EFI version running is a known good version from Apple. There is also an automated process to check it every seven days.</xhtml:p>
                  <xhtml:p>This check is only valid on T1 chips and prior. Neither T2 chips nor Apple silicon require this control check</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>EFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load macOS from, and it also determines whether the user can enter single user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode, and protection against firewire DMA attacks. While it was easier in the past to reset the firmware password by removing RAM, it did make tampering slightly harder because having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to manage the firmware password on macOS computers, though some tools did make it much easier.</xhtml:p>
                     <xhtml:p>The EFI password management capability has been replaced in new Apple silicon Macs. The security features are replaced in the Silicon Mac recoveryOS. Long-term it appears that macOS EFI management is a deprecated technology in mixed Intel/Apple Silicon environments.</xhtml:p>
                     <xhtml:p>Apple patched OS X in 10.7 to mitigate the DMA attacks, and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses single user mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive.</xhtml:p>
                     <xhtml:p>Starting in late 2010 with the MacBook Air, Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password effectively more critical if it is used.</xhtml:p>
                     <xhtml:p>Setting the firmware password may be a good practice in some environments. We cannot recommend it as a standard security practice at this time.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>If the Firmware of a computer has been compromised, the Operating System that the Firmware loads cannot be trusted, either.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>If EFI does not pass the integrity check, you may send a report to Apple. Backing up files and clean installing a known good Operating System and Firmware is recommended.</xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_efi_valid"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.10_Audit_Siri_Settings" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Audit Siri Settings</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>With macOS 10.12 Sierra, Apple has introduced Siri from iOS to macOS. While there are data spillage concerns with the use of data-gathering personal assistant software, the risk here does not seem greater in sending queries to Apple through Siri than in sending search terms in a browser to Google or Microsoft. While it is possible that Siri will be used for local actions rather than Internet searches, Siri could, in theory, tell Apple about confidential Programs and Projects that should not be revealed. This appears be a usage edge case.</xhtml:p>
                  <xhtml:p>In cases where sensitive or protected data is processed and Siri could expose that information through assisting a user in navigating their machine, it should be disabled. Siri does need to phone home to Apple, so it should not be available from air-gapped networks as part of its requirements.</xhtml:p>
                  <xhtml:p>Most of the use case data published has shown that Siri is a tremendous time saver on iOS where multiple screens and menus need to be navigated through. Information like sports scores, weather, movie times, and simple to-do items on existing calendars can be easily found with Siri. None of the standard use cases should be more risky than already approved activity.</xhtml:p>
                  <xhtml:p>


For information on Apple's privacy policy for Siri,                                   <xhtml:a href="https://support.apple.com/en-us/HT210657">click here</xhtml:a>


.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Where "normal" user activity is already limited, Siri use should be controlled as well.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/en-us/HT210657</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to set Siri to your organization's parameters:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Siri</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>Select the settings that are within your organization's requirements</xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Show All</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Accessibility</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Siri</xhtml:span>



7 Select                                                     <xhtml:span class="inline_block">Enable Type to Siri</xhtml:span>


 to your organization's requirements                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following commands to enable or disable Siri settings:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.assistant.support.plist 'Assistant Enabled' -bool &lt;true/false&gt;                                              <br></br>
                           <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.Siri.plist LockscreenEnabled -bool &lt;true/false&gt;                                              <br></br>
                           <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.Siri.plist StatusMenuVisible -bool &lt;true/false&gt;                                              <br></br>
                           <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.Siri.plist TypeToSiriEnabled -bool &lt;true/false&gt;                                              <br></br>
                           <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write com.apple.Siri.plist VoiceTriggerUserEnabled -bool &lt;true/false&gt;
                                        </xhtml:code>
                        <xhtml:p>After running the default writes, the WindowServer needs to be restarted and the caches cleared. Run the following commands to perform that action:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/killall -HUP cfprefsd                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/bin/killall SystemUIServer
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example:</xhtml:em>
                        </xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo -u firstuser /usr/bin/defaults write com.apple.assistant.support.plist 'Assistant Enabled' -bool true

$ /usr/bin/sudo -u firstuser /usr/bin/defaults write com.apple.Siri.plist StatusMenuVisible -bool true

$ /usr/bin/sudo -u firstuser /usr/bin/defaults write com.apple.Siri.plist LockscreenEnabled -bool false

$ /usr/bin/sudo /usr/bin/killall -HUP cfprefsd                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/bin/killall SystemUIServer

$ /usr/bin/sudo -u seconduser /usr/bin/defaults write com.apple.assistant.support.plist 'Assistant Enabled' -bool false

$ /usr/bin/sudo /usr/bin/killall -HUP cfprefsd                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/bin/killall SystemUIServer

$ /usr/bin/sudo -u thirduser /usr/bin/defaults write com.apple.Siri.plist VoiceTriggerUserEnabled -bool false

$ /usr/bin/sudo -u thirduser /usr/bin/defaults write com.apple.Siri.plist TypeToSiriEnabled -bool false

$ /usr/bin/sudo /usr/bin/killall -HUP cfprefsd                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/bin/killall SystemUIServer
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.applicationaccess</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">allowAssistant</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Set the key to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>


 or                                                     <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>


 based on your organization's requirements                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Siri can only be enabled or disabled through configuration profiles. Any additional settings need to be set through either                                               <xhtml:span class="inline_block">System Settings</xhtml:span>


 or                                               <xhtml:span class="inline_block">Terminal</xhtml:span>


.                                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.11_Audit_Sidecar_Settings" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Audit Sidecar Settings</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apple introduced a technology called Sidecar with the release of mac OS 10.15 "Catalina" that allows the use of an Apple iPad as an additional screen. There are no known security issues with the use of Sidecar at the time of the publication of this Benchmark.
There are security concerns with some of the underlying technology that allows this feature to work. The Apple support article below has the additional requirements that are reproduced below. So while Sidecar may not have an explicit security concern some organizations may have requirements that block the use of the features required to allow Sidecar to work.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/en-afri/HT210380">https://support.apple.com/en-afri/HT210380</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>Additional requirements</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>Both devices must be signed in to iCloud with the same Apple ID using two-factor authentication.</xhtml:li>
                     <xhtml:li>To use Sidecar wirelessly, both devices must be within 10 meters (30 feet) of each other and have Bluetooth, Wi-Fi, and Handoff turned on. Also make sure that the iPad is not sharing its cellular connection and the Mac is not sharing its Internet connection.</xhtml:li>
                     <xhtml:li>To use Sidecar over USB, make sure that your iPad is set to trust your Mac.</xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>Organizations that do not allow the use of iCloud and more specifically Handoff will not be able to use Sidecar.</xhtml:p>
                  <xhtml:p>Some organizations may not allow the use of mixed ownership for P2P wireless or USB connections so that unless the organization controls both the Mac and the iPad connections may not be approved and the use of a single Apple ID for distinctly managed devices may be prohibited.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Organizations need to have an understanding of integration of organizational and personal inventory in the work environment.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://www.apple.com/macos/catalina/docs/Sidecar_Tech_Brief_Oct_2019.pdf</xccdf:ident>
               <xccdf:ident system="URL">https://www.pocket-lint.com/laptops/news/apple/148262-apple-sidecar-macos-ipados-features-explained</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to set Sidecar to your organization's parameters:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Sidecar</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>Select the settings that are within your organization's parameters</xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following to enable or disable Sidecar settings:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/defaults write com.apple.sidecar.display AllowAllDevices -bool &lt;true/false&gt;                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/bin/defaults write com.apple.sidecar.display hasShownPref -bool &lt;true/false&gt;
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.sidecar.display</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">Forced</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>The key must be set to:</xhtml:li>
                        </xhtml:ol>
                        <xhtml:code class="code_block">


&lt;dict&gt;                                              <br></br>


	&lt;key&gt;Forced&lt;/key&gt;                                              <br></br>


		&lt;array&gt;                                              <br></br>


			&lt;dict&gt;                                              <br></br>


				&lt;key&gt;mcx_preference_settings&lt;/key&gt;                                              <br></br>


					&lt;dict&gt;                                              <br></br>


						&lt;key&gt;AllowAllDevices&lt;/key&gt;                                              <br></br>


						&lt;&lt;true/false&gt;/&gt;                                              <br></br>


						&lt;key&gt;hasShownPref&lt;/key&gt;                                              <br></br>


						&lt;&lt;true/false&gt;/&gt;                                              <br></br>


					&lt;/dict&gt;                                              <br></br>


			&lt;/dict&gt;                                              <br></br>


		&lt;/array&gt;                                              <br></br>


&lt;/dict&gt;
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Using the Terminal and Profile Methods will not display in System Preferences, but will disable the underlying service.                                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.12_Audit_Touch_ID_and_Wallet__Apple_Pay_Settings" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Audit Touch ID and Wallet &amp; Apple Pay Settings</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Apple has integrated Touch ID with macOS and allows fingerprint use for many common operations. All use of Touch ID requires the presence of a password and the use of that password after every reboot, or when more than 48 hours has elapsed since the device was last unlocked.</xhtml:p>
                  <xhtml:p>Touch ID is a prerequisite for using Apple Pay and Wallet on macOS. Apple Pay allows an Apple account holder to enroll their credit cards in Apple Pay and pay enrolled vendors without using the physical card or number. Apple's service eliminates the requirement to send the credit card number itself to the vendor. Apple Pay on a Mac allows the use of credit cards the user has already enrolled and reduces user risk for credit card purchases.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Touch ID allows for an account-enrolled fingerprint to access a key that uses a previously provided password.</xhtml:p>
                  <xhtml:p>Some environments may have rules around purchases from organizationally managed computers and may want to discourage shopping from them. It is difficult to block access to websites that allow purchases, and Apple Pay has more controls for user protection than the manual entry of credit card information.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/use-wallet-apple-pay-on-mac-mchl4773988b/mac</xccdf:ident>
               <xccdf:ident system="URL">https://www.apple.com/apple-pay/</xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/guide/mac-help/touch-id-mchl16fbf90a/mac</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to set Touch ID to your organization's settings:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Touch ID</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select the                                                     <xhtml:span class="inline_block">Touch ID</xhtml:span>


 settings match your organization's settings                                              </xhtml:li>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Wallet &amp; Apple Pay</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select the                                                     <xhtml:span class="inline_block">Wallet &amp; Apple Pay</xhtml:span>


 settings match your organization's settings                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Touch ID is more convenient for use with aggressive screen lock controls.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.13_Audit_Notification__Focus_Settings" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Audit Notification &amp; Focus Settings</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Notification capabilities are designed to allow users to receive updates from applications that are not currently in use. These can be background applications or even notices from processes running on a computer that is not currently being actively used. Where the screen of a computer is visible to others other than the logged-in user due to shared working spaces or public spaces, consideration should be given to the exposure of sensitive data in notifications. Applications that use the system-wide application service may be individually managed, and applications that might expose confidential information to unauthorized users should not expose notifications except to the current user, especially on the locked screen when the computer may be unattended.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Some work environments will handle sensitive or confidential information with applications that can provide notifications to anyone who can see the computer screen. Organizations must review the likelihood that information may be exposed inappropriately and suppress notifications where risk is not organizationally accepted.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to set Notifications to your organization's requirements:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Notifications &amp; Focus</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select the setting for                                                     <xhtml:span class="inline_block">Show previews</xhtml:span>


 that are withing your organization's requirements                                              </xhtml:li>
                           <xhtml:li>Turn off or mute notifications that may expose information to unauthorized people that might be able to view screens of organizational computers.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Computer users are often juggling too much information through too many applications that want their attention and are often designed to get attention and never let it go. Notifications are a mechanism that can be used to cut through the deluge and allow important issues to be resolved in a timely way. Global controls on limiting user notifications, even for certain applications, could impact productivity and the timely remediation of issues.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Logging_and_Auditing">
            <xccdf:title xml:lang="en">Logging and Auditing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section provides guidance on configuring the logging and auditing facilities available in macOS. Starting with macOS 10.12, Apple introduced unified logging. This capability replaces the previous logging methodology with centralized, system-wide common controls. A full explanation of macOS logging behavior is beyond the scope of this Benchmark. These changes impact previous logging controls from macOS Benchmarks. At this point, many of the syslog controls have been or are being removed since the old logging methods have been deprecated. Controls that still appear useful will be retained. Some legacy controls have been removed for this release.</xhtml:p>
               <xhtml:p>


More info                             <xhtml:a href="https://developer.apple.com/documentation/os/logging">https://developer.apple.com/documentation/os/logging</xhtml:a>
                  <xhtml:a href="https://eclecticlight.co/2018/03/19/macos-unified-log-1-why-what-and-how/">https://eclecticlight.co/2018/03/19/macos-unified-log-1-why-what-and-how/</xhtml:a>
               </xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Security_Auditing_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Security Auditing Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


macOS's audit facility,                                   <xhtml:span class="inline_block">auditd</xhtml:span>


, receives notifications from the kernel when certain system calls, such as                                   <xhtml:span class="inline_block">open</xhtml:span>


,                                   <xhtml:span class="inline_block">fork</xhtml:span>


, and                                   <xhtml:span class="inline_block">exit</xhtml:span>


, are made. These notifications are captured and written to an audit log.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Logs generated by                                   <xhtml:span class="inline_block">auditd</xhtml:span>


 may be useful when investigating a security incident as they may help reveal the vulnerable application and the actions taken by a malicious actor.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following to enable security auditing:</xhtml:p>
                        <xhtml:p>Run the following command to load auditd:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_security_audit"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_Security_Auditing_Flags_For_User-Attributable_Events_Are_Configured_Per_Local_Organizational_Requirements" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Security Auditing Flags For User-Attributable Events Are Configured Per Local Organizational Requirements</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Auditing is the capture and maintenance of information about security-related events. Auditable events often depend on differing organizational requirements.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Log Sensitive Data Access" urn="urn:cisecurity.org:controls:8.0:3:14">
                           <controls:implementation_groups ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Enforce Detail Logging for Access or Changes to Sensitive Data" urn="urn:cisecurity.org:controls:7.0:14:9">
                           <controls:implementation_groups ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Flag settings are currently based on the guidance provided by the NIST through the macOS Security guidance they are providing in their GitHub repository. You can find that guidance                                         <xhtml:a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171r2.pdf">here</xhtml:a>


.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.</xhtml:p>
                  <xhtml:p>Depending on the governing authority, organizations can have vastly different auditing requirements. In this control we have selected a minimal set of audit flags that should be a part of any organizational requirements. The flags selected below may not adequately meet organizational requirements for users of this benchmark. The auditing checks for the flags proposed here will not impact additional flags that are selected.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/14" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident system="URL">https://derflounder.wordpress.com/2012/01/30/openbsm-auditing-on-mac-os-x/</xccdf:ident>
               <xccdf:ident system="URL">https://csrc.nist.gov/CSRC/media/Publications/sp/800-179/rev-1/draft/documents/sp800-179r1-draft.pdf</xccdf:ident>
               <xccdf:ident system="URL">https://www.scip.ch/en/?labs.20150108</xccdf:ident>
               <xccdf:ident system="URL">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171r2.pdf</xccdf:ident>
               <xccdf:ident system="URL">https://www.whitehouse.gov/wp-content/uploads/2021/08/M-21-31-Improving-the-Federal-Governments-Investigative-and-Remediation-Capabilities-Related-to-Cybersecurity-Incidents.pdf</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following to set the required Security Auditing Flags:</xhtml:p>
                        <xhtml:p>


Edit the                                               <xhtml:span class="inline_block">/etc/security/audit_control</xhtml:span>


 file and add                                               <xhtml:span class="inline_block">-fm</xhtml:span>


,                                               <xhtml:span class="inline_block">ad</xhtml:span>


,                                               <xhtml:span class="inline_block">-ex</xhtml:span>


,                                               <xhtml:span class="inline_block">aa</xhtml:span>


,                                               <xhtml:span class="inline_block">-fr</xhtml:span>


,                                               <xhtml:span class="inline_block">lo</xhtml:span>


, and                                               <xhtml:span class="inline_block">-fw</xhtml:span>


 to                                               <xhtml:span class="inline_block">flags</xhtml:span>


. You can also substitute                                               <xhtml:span class="inline_block">-all</xhtml:span>


 for                                               <xhtml:span class="inline_block">-fm</xhtml:span>


,                                               <xhtml:span class="inline_block">-ex</xhtml:span>


,                                               <xhtml:span class="inline_block">-fr</xhtml:span>


, and                                               <xhtml:span class="inline_block">-fw</xhtml:span>


.                                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_audit_flags"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_install.log_Is_Retained_for_365_or_More_Days_and_No_Maximum_Size" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure install.log Is Retained for 365 or More Days and No Maximum Size</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


macOS writes information pertaining to system-related events to the file                                   <xhtml:span class="inline_block">/var/log/install.log</xhtml:span>


 and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.                            </xhtml:p>
                  <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention, and a less precise rotation argument.</xhtml:p>
                  <xhtml:p>The all_max flag control will remove old log entries based only on the size of the log files. Log size can vary widely depending on how verbose installing applications are in their log entries. The decision here is to ensure that logs go back a year, and depending on the applications a size restriction could compromise the ability to store a full year.</xhtml:p>
                  <xhtml:p>While this Benchmark is not scoring for a rotation flag, the default rotation is sequential rather than using a timestamp. Auditors may prefer timestamps in order to simply review specific dates where event information is desired.</xhtml:p>
                  <xhtml:p>Please review the File Rotation section in the man page for more information.</xhtml:p>
                  <xhtml:code class="code_block">man asl.conf
</xhtml:code>
                  <xhtml:ul>
                     <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
                     <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
                     <xhtml:li>The rotation should be set with timestamps "rotate=utc" or "rotate=local"</xhtml:li>
                  </xhtml:ul>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Regularly Review Logs" urn="urn:cisecurity.org:controls:7.0:6:7">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Archiving and retaining                                   <xhtml:span class="inline_block">install.log</xhtml:span>


 for at least a year is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following to ensure that install logs are retained for at least 365 days:</xhtml:p>
                        <xhtml:p>


Edit the                                               <xhtml:span class="inline_block">/etc/asl/com.apple.install</xhtml:span>


 file and add or modify the                                               <xhtml:span class="inline_block">ttl</xhtml:span>


 value to                                               <xhtml:span class="inline_block">365</xhtml:span>


 or greater on the                                               <xhtml:span class="inline_block">file</xhtml:span>


 line. Also, remove the                                               <xhtml:span class="inline_block">all_max=</xhtml:span>


 setting and value from the                                               <xhtml:span class="inline_block">file</xhtml:span>


 line.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_retain_install_log"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_Security_Auditing_Retention_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Security Auditing Retention Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The macOS audit capability contains important information to investigate security or operational issues. This resource is only completely useful if it is retained long enough to allow technical staff to find the root cause of anomalies in the records.</xhtml:p>
                  <xhtml:p>Retention can be set to respect both size and longevity. To retain as much as possible under a certain size, the recommendation is to use the following:</xhtml:p>
                  <xhtml:p>expire-after:60d OR 5G</xhtml:p>
                  <xhtml:p>This recomendation is based on minimum storage for review and investigation. When a third party tool is in use to allow remote logging or the store and forwarding of logs, this local storage requirement is not required.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Regularly Review Logs" urn="urn:cisecurity.org:controls:7.0:6:7">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The audit records need to be retained long enough to be reviewed as necessary.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following to set the audit retention length:</xhtml:p>
                        <xhtml:p>


Edit the                                               <xhtml:span class="inline_block">/etc/security/audit_control</xhtml:span>


 file so that                                               <xhtml:span class="inline_block">expire-after:</xhtml:span>


 is at least                                               <xhtml:span class="inline_block">60d OR 5G</xhtml:span>
                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>The recommendation is that at least 60 days or 5 gigabytes of audit records are retained. Systems that have very little remaining disk space may have issues retaining sufficient data.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_audit_retention"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_Access_to_Audit_Records_Is_Controlled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Access to Audit Records Is Controlled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The audit system on macOS writes important operational and security information that can be both useful for an attacker and a place for an attacker to attempt to obfuscate unwanted changes that were recorded. As part of defense-in-depth, the /etc/security/audit_control configuration and the files in /var/audit should be owned only by root with group wheel with read-only rights and no other access allowed. macOS ACLs should not be used for these files.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>From ls man page</xhtml:p>
                     <xhtml:code class="code_block">


-e      Print the Access Control List (ACL) associated with the file, if                                        <br></br>


             present, in long (-l) output.
                                  </xhtml:code>
                     <xhtml:p>More info:</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://www.techrepublic.com/blog/apple-in-the-enterprise/introduction-to-os-x-access-control-lists-acls/">https://www.techrepublic.com/blog/apple-in-the-enterprise/introduction-to-os-x-access-control-lists-acls/</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="http://ahaack.net/technology/OS-X-Access-Control-Lists-ACL.html">http://ahaack.net/technology/OS-X-Access-Control-Lists-ACL.html</xhtml:a>
                     </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Audit records should never be changed except by the system daemon posting events. Records may be viewed or extracts manipulated, but the authoritative files should be protected from unauthorized changes.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following to commands to set the audit records to the root user and wheel group:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/chown -R root:wheel /etc/security/audit_control                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /bin/chmod -R o-rw /etc/security/audit_control                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/sbin/chown -R root:wheel /var/audit/                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /bin/chmod -R o-rw /var/audit/
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 It is recommended to do a thorough verification process on why the audit logs have been changed before following the remediation steps. If the system has different access controls on the audit logs, and the changes cannot be traced, a new install may be prudent. Check for signs of file tampering as well as unapproved OS changes.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This control is only checking the default configuration to ensure that unwanted access to audit records is not available.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_audit_record_access"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_Logging_Is_Enabled_and_Configured" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Firewall Logging Is Enabled and Configured</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The socketfilter Firewall is what is used when the Firewall is turned on in the Security &amp; Privacy Preference Pane. In order to appropriately monitor what access is allowed and denied, logging must be enabled.
The logging level must be set to "detailed" to be useful in monitoring connection attempts that the firewall detects. Throttled login is not sufficient for examine Firewall connection attempts.</xhtml:p>
                  <xhtml:p>In depth log monitoring on macOS may require changes to the "Enable-Private-Data" key in SystemLogging.System to ensure more complete logging.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.mandiant.com/resources/blog/reviewing-macos-unified-logs">Reviewing macOS Unified Logs</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>In order to troubleshoot the successes and failures of a Firewall, detailed logging should be enabled.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://developer.apple.com/documentation/devicemanagement/firewall?language=objc</xccdf:ident>
               <xccdf:ident system="URL">https://www.mandiant.com/resources/blog/reviewing-macos-unified-logs</xccdf:ident>
               <xccdf:ident system="URL">http://krypted.com/tag/socketfilterfw/</xccdf:ident>
               <xccdf:ident system="URL">https://github.com/mandiant/macos-UnifiedLogs</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to enable logging of the firewall:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on                                              <br></br>
                           <br></br>


Turning on log mode                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingopt detail                                              <br></br>
                           <br></br>


Setting detail log option 
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 If the Firewall settings are set through a configuration profile, then modifications cannot be done through the command line. If attempted, you will receive the message                                               <xhtml:span class="inline_block">Firewall settings cannot be modified from command line on managed Mac computers.</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.security.firewall</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">EnableFirewall</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to also include is                                                     <xhtml:span class="inline_block">EnableLogging</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to also include is                                                     <xhtml:span class="inline_block">LoggingOption</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;string&gt;detail&lt;/string&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Firewall Logging must be enabled with this profile. It can either be set with the Firewall and Stealth Mode (2.5.2.2 and 2.5.2.3) or as a separate profile. Setting logging with its own profile will not cause a conflict.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Detailed logging may result in excessive storage.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_firewall_logging"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_Audit_Software_Inventory" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Audit Software Inventory</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>With the introduction of Mac OS X 10.6.6, Apple added a new application, App Store, which resides in the Applications directory. This application allows a user with admin privileges and an Apple ID to browse Apple's online App Store, purchase (including no-cost purchases), and install new applications, bypassing Enterprise software inventory controls. Any admin user can install software in the /Applications directory whether from internet downloads, thumb drives, optical media, cloud storage, or even binaries through email. Even standard users can run executables downloaded to their home folder by default. The source of the software is not nearly as important as a consistent audit of all installed software for patch compliance and appropriateness.</xhtml:p>
                  <xhtml:p>A single user desktop where the user, administrator, and the person approving software are all the same person probably does not need to audit software inventory to this extent. It is helpful in the case of stability problems or malware, however.</xhtml:p>
                  <xhtml:p>Scan systems on a monthly basis and determine the number of unauthorized pieces of software that are installed. Verify that if an unauthorized piece of software is found one month, it is removed from the system the next.</xhtml:p>
                  <xhtml:p>Export System Information through the built-in System Information Application or other third-party tools on an organizationally defined timetable.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Software Inventory" urn="urn:cisecurity.org:controls:8.0:2:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Maintain Inventory of Authorized Software" urn="urn:cisecurity.org:controls:7.0:2:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Part of comprehensive IT security involves device management and ensuring that all software is authorized and patched. Checking for macOS updates and app updates are relatively simple for the end user, and can even be updated with minimal privileges from trusted sources, if enabled. Remote monitoring of the patch status for software maintained through Apple is very well supported by management applications. Neither Apple capabilities nor third-party patch management solutions will cover all mission-necessary software for most organizations. Full visibility into software present on the system enables vulnerability and risk management.</xhtml:p>
                  <xhtml:p>P.S. Don't forget about browser plugins/extensions for all installed software.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/en-us/HT203001</xccdf:ident>
               <xccdf:ident system="URL">https://www.cisecurity.org/controls/inventory-and-control-of-software-assets/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Delete any unnecessary applications from the system.</xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Network_Configurations">
            <xccdf:title xml:lang="en">Network Configurations</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains guidance on configuring the networking-related aspects of macOS.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_Bonjour_Advertising_Services_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Bonjour Advertising Services Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerate devices and services within a local subnet. DNS on macOS is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Anything Bonjour discovers is already available on the network and probably discoverable with network scanning tools. The security benefit of disabling Bonjour for that reason is minimal.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Bonjour can simplify device discovery from an internal rogue or compromised host. An attacker could use Bonjour's multicast DNS feature to discover a vulnerable or poorly-configured service or additional information to aid a targeted attack. Implementing this control disables the continuous broadcasting of "I'm here!" messages. Typical end-user endpoints should not have to advertise services to other computers. This setting does not stop the computer from sending out service discovery messages when looking for services on an internal subnet, if the computer is looking for a printer or server and using service discovery. To block all Bonjour traffic except to approved devices, the pf or other firewall would be needed.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to disable Bonjour Advertising services:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool true
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.mDNSResponder</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">NoMulticastAdvertisements</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


Some applications, like Final Cut Studio and AirPort Base Station management, may not operate properly if the                                                     <xhtml:span class="inline_block">mDNSResponder</xhtml:span>


 is turned off.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_bonjour_services"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_HTTP_Server_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure HTTP Server Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>macOS used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. Apache, however, is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end-user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Web serving should not be done from a user desktop. Dedicated webservers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230793</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to disable the HTTP server services:</xhtml:p>
                        <xhtml:code class="code_block">$ sudo /usr/bin/sudo /bin/launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist
</xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>The web server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_httpd_disabled"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_NFS_Server_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure NFS Server Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>macOS can act as an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end-user computer.</xhtml:p>
                  <xhtml:p>The etc/exports file contains the list of NFS shared directories. If the file exists, it is likely that NFS sharing has been enabled in the past or may be available periodically. As an additional check, the audit verifies that there is no /etc/exports file.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>File serving should not be done from a user desktop. Dedicated servers should be used. Open ports make it easier to exploit the computer.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to disable the nfsd fileserver services:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /bin/launchctl disable system/com.apple.nfsd
</xhtml:code>
                        <xhtml:p>Remove the exported Directory listing.</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /bin/rm /etc/exports
</xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>The nfs server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTosx_nfs_server_disabled"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_System_Access_Authentication_and_Authorization">
            <xccdf:title xml:lang="en">System Access, Authentication and Authorization</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The controls in this section are a combination of hardening controls that are not specifically in a System Preference pane. Many of these controls are only accessible using the Command Line or a Device Profile and not available in the Graphical User Interface. The Benchmark does contain simple, easy to follow instructions for technical staff to audit and implement recommended controls.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_File_System_Permissions_and_Access_Controls">
               <xccdf:title xml:lang="en">File System Permissions and Access Controls</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>File system permissions have always been part of computer security. There are several principles that are part of best practices for a POSIX-based system which are contained in this section. This section does not contain a complete list of every permission on a macOS System that might be problematic. Developers and use cases differ, and what some administrators who are long in the profession might consider a travesty a risk assessor steeped in BYOD trends may not give a second glance at. Here we document controls that should point out truly bad practices or anomalies which should be looked at and considered closely. Many of the controls are to mitigate the risk of privilege escalation attacks and data exposure to unauthorized parties.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Home_Folders_Are_Secure" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Home Folders Are Secure</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>By default, macOS allows all valid users into the top level of every other user's home folder and restricts access to the Apple default folders within. Another user on the same system can see you have a "Documents" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system.</xhtml:p>
                     <xhtml:p>The best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures. Similarly with macOS, users can see into every new Directory that is created because of the default permissions.</xhtml:p>
                     <xhtml:p>Home folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Allowing all users to view the top level of all networked users' home folder may not be desirable since it may lead to the revelation of sensitive information.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>For each user, run the following command to secure all home folders:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/chmod -R og-rwx /Users/&lt;username&gt;
</xhtml:code>
                           <xhtml:p>Alternately, run the following command if there needs to be executable access for a home folder:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/chmod -R og-rw /Users/&lt;username&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /bin/chmod -R og-rw /Users/thirduser/                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo /bin/chmod -R og-rwx /Users/fourthuser/                                                    <br></br>
                              <br></br>


# /bin/ls -l /Users/                                                     <br></br>
                              <br></br>


total 0                                                    <br></br>


drwxr-xr-x+ 12 Guest       _guest  384 24 Jul 13:42 Guest                                                    <br></br>


drwxrwxrwt   4 root        wheel   128 22 Jul 11:00 Shared                                                    <br></br>


drwx--x--x+ 18 firstuser   staff   576 10 Aug 14:36 firstuser                                                    <br></br>


drwx--x--x+ 15 seconduser  staff   480 10 Aug 09:16 seconduser                                                    <br></br>


drwx--x--x+ 11 thirduser   staff   352 10 Aug 14:53 thirduser                                                    <br></br>


drwx------+ 11 fourthuser  staff   352 10 Aug 14:53 fourthuser
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If implemented, users will not be able to use the "Public" folders in other users' home folders. "Public" folders with appropriate permissions would need to be set up in the /Shared folder.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_secure_homefolder"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_System_Integrity_Protection_Status_SIP_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure System Integrity Protection Status (SIP) Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>System Integrity Protection is a security feature introduced in OS X 10.11 El Capitan. System Integrity Protection restricts access to System domain locations and restricts runtime attachment to system processes. Any attempt to inspect or attach to a system process will fail. Kernel Extensions are now restricted to /Library/Extensions and are required to be signed with a Developer ID.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Allowlist Authorized Libraries" urn="urn:cisecurity.org:controls:8.0:2:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>Related to SIP controls, Library Validation is a security feature introduced in macOS 10.10 Yosemite. Library Validation protects processes from loading arbitrary libraries. This stops root from loading arbitrary libraries into any process (depending on SIP status), and keeps root from becoming more powerful. Security is strengthened, because some user processes can no longer be fooled to run additional code without root's explicit request, which may grant access to daemons that depend on Library Validation for secure validation of code identity.</xhtml:p>
                        <xhtml:p>With SIP enabled, Library Validation cannot be disabled. To test against a non-validated library, you will need to disabled SIP AND disable Library Validation.</xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Running without System Integrity Protection on a production system runs the risk of the modification of system binaries or code injection of system processes that would otherwise be protected by SIP.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection</xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/en-us/HT204899</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enable System Integrity Protection:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Reboot into the                                                           <xhtml:span class="inline_block">Recovery Partition</xhtml:span>


 (reboot and hold down                                                           <xhtml:span class="inline_block">Command ()</xhtml:span>


 +                                                           <xhtml:span class="inline_block">R</xhtml:span>


)                                                    </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Utilities</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Terminal</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Run the following command:</xhtml:li>
                           </xhtml:ol>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/csrutil enable                                                    <br></br>
                              <br></br>


Successfully enabled System Integrity Protection. Please restart the machine for the changes to take effect.
                                              </xhtml:code>
                           <xhtml:ol start="5">
                              <xhtml:li>Reboot the computer</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 If SIP has been disabled, the admin should research why it was disabled. You might also want to assume that the operating system has been compromised. If you believe that, back up any files, and do a clean install to a known good Operating System                                              </xhtml:p>
                           <xhtml:p>It might be a better option to erase the Mac and reinstall the operating system. That is at your discretion.</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 You cannot enable System Integrity Protection from the booted operating system. If the remediation is attempted in the booted OS and not the Recovery Partition the output will give the error                                                     <xhtml:span class="inline_block">csrutil: failed to modify system integrity configuration. This tool needs to be executed from the Recovery OS.</xhtml:span>
                           </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>System binaries and processes could become compromised.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_sip_enabled"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_Apple_Mobile_File_Integrity_AMFI_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Apple Mobile File Integrity (AMFI) Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple Mobile File Integrity (AMFI) was first released in macOS 10.12. The daemon and service block attempts to run unsigned code. AMFI uses lanchd, code signatures, certificates, entitlements, and provisioning profiles to create a filtered entitlement dictionary for an app. AMFI is the macOS kernel module that enforces code-signing and library validation.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Allowlist Authorized Libraries" urn="urn:cisecurity.org:controls:8.0:2:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Apple Mobile File Integrity validates that application code is validated.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://eclecticlight.co/2018/12/29/amfi-checking-file-integrity-on-your-mac/</xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/usnistgov/macos_security/issues/39</xccdf:ident>
                  <xccdf:ident system="URL">https://github.com/usnistgov/macos_security/issues/40</xccdf:ident>
                  <xccdf:ident system="URL">https://www.naut.ca/blog/2020/11/13/forbidden-commands-to-liberate-macos/</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable the Apple Mobile File Integrity service:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/nvram boot-args="" 
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Applications could be compromised with malicious code.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_amfi_enabled"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_Sealed_System_Volume_SSV_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Sealed System Volume (SSV) Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Sealed System Volume is a security feature introduced in macOS 11.0 Big Sur.</xhtml:p>
                     <xhtml:p>During system installation, a SHA-256 cryptographic hash is calculated for all immutable system files and stored in a Merkle tree which itself is hashed as the Seal. Both are stored in the metadata of the snapshot created of the System volume.</xhtml:p>
                     <xhtml:p>The seal is verified by the boot loader at startup. macOS will not boot if system files have been tampered with. If validation fails, the user will be instructed to reinstall the operating system.</xhtml:p>
                     <xhtml:p>During read operations for files located in the Sealed System Volume, a hash is calculated and compared to the value stored in the Merkle tree.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Data on End-User Devices" urn="urn:cisecurity.org:controls:8.0:3:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Encrypt the Hard Drive of All Mobile Devices." urn="urn:cisecurity.org:controls:7.0:13:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Running without Sealed System Volume on a production system could run the risk of Apple software that integrates directly with macOS being modified.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://developer.apple.com/news/?id=3xpv8r2m</xccdf:ident>
                  <xccdf:ident system="URL">https://eclecticlight.co/2020/11/30/is-big-surs-system-volume-sealed/</xccdf:ident>
                  <xccdf:ident system="URL">https://eclecticlight.co/2020/06/25/big-surs-signed-system-volume-added-security-protection/</xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/security/signed-system-volume-security-secd698747c9/web</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>If SSV has been disabled, assume that the operating system has been compromised. Back up any files, and do a clean install to a known good Operating System.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Apple Software that integrates with the operating system could become compromised.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_ssv_enabled"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_Appropriate_Permissions_Are_Enabled_for_System_Wide_Applications" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Appropriate Permissions Are Enabled for System Wide Applications</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Applications in the System Applications Directory (/Applications) should be world-executable since that is their reason to be on the system. They should not be world-writable and allow any process or user to alter them for other processes or users to then execute modified versions.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Unauthorized modifications of applications could lead to the execution of malicious code.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to change the permissions for each application that does not meet the requirements:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo IFS=$'\n'                                                    <br></br>


for apps in $( /usr/bin/find /Applications -iname "*\.app" -type d -perm -2 ); do                                                    <br></br>


  /bin/chmod -R o-w "$apps"                                                    <br></br>


done
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Global changes should not be performed where mission-critical applications are part of the improperly permissioned applications.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Applications changed will no longer be world-writable. Depending on the environment, there will be different risk tolerances on each non-conforming application. Global changes should not be performed where mission-critical applications are misconfigured.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_application_permissions"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_No_World_Writable_Files_Exist_in_the_System_Folder" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure No World Writable Files Exist in the System Folder</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Software sometimes insists on being installed in the                                         <xhtml:span class="inline_block">/System/Volumes/Data/System</xhtml:span>


 Directory and has inappropriate world-writable permissions.                                  </xhtml:p>
                     <xhtml:p>Macs with writable files in System should be investigated forensically. A file with open writable permissions is a sign of at best a rogue application.  It could also be a sign of a computer compromise and a persistent presence on the system.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Folders in                                         <xhtml:span class="inline_block">/System/Volumes/Data/System</xhtml:span>


 should not be world-writable. The audit check excludes the "Drop Box" folder that is part of Apple's default user template.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set permissions so that folders are not world-writable in the /System folder:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo IFS=$'\n'                                                    <br></br>


for sysPermissions in $( /usr/bin/find /System/Volumes/Data/System -type d -perm -2 | /usr/bin/grep -v "Drop Box" ); do                                                    <br></br>


  /bin/chmod -R o-w "$sysPermissions"                                                    <br></br>


done
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Changing file permissions could disrupt the use of applications that rely on files in the System Folder with vulnerable permissions.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_system_world_writable"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_No_World_Writable_Files_Exist_in_the_Library_Folder" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure No World Writable Files Exist in the Library Folder</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Software sometimes insists on being installed in the                                         <xhtml:span class="inline_block">/System/Volumes/Data/Library Directory</xhtml:span>


 and has inappropriate world-writable permissions.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Folders in                                         <xhtml:span class="inline_block">/System/Volumes/Data/Library</xhtml:span>


 should not be world-writable. The audit check excludes the                                         <xhtml:span class="inline_block">/System/Volumes/Data/Library/Caches</xhtml:span>


 and                                         <xhtml:span class="inline_block">/System/Volumes/Data/Library/Preferences/Audio/Data</xhtml:span>


 folders where the sticky bit is set.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>


Run the following command to set permissions so that folders are not world-writable in the                                                     <xhtml:span class="inline_block">/System/Volumes/Data/Library</xhtml:span>


 folder:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo IFS=$'\n'                                                    <br></br>


for libPermissions in $( /usr/bin/find /System/Volumes/Data/Library -type d -perm -2 | /usr/bin/grep -v Caches | /usr/bin/grep -v /Preferences/Audio/Data ); do                                                    <br></br>


  /bin/chmod -R o-w "$libPermissions"                                                    <br></br>


done
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_library_world_writable"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Password_Management">
               <xccdf:title xml:lang="en">Password Management</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Password security is an important part of general IT security where passwords are in use. For macOS, passwords are still much more widely used than other methods for account access. While there are other authentication and authorization methods for access from a macOS computer to organizational services, console access to the Mac is probably done using a password. This section contains password controls.</xhtml:p>
                  <xhtml:p>Apple has provided sufficient security controls to resist password attacks against the locked console, thus the CIS benchmark no longer recommends locking the keychain in addition to locking the console or display.</xhtml:p>
                  <xhtml:p>Recent updates based on research by NIST in SP800-63 call into question traditional password complexity and rotation requirements. Sticky notes are not a password management program, and password vault APIs are under increasing attack. Ideally, the user will remember their important passwords. The new understanding has informed changes to the previous password recommendations.</xhtml:p>
                  <xhtml:p>Length, threshold, and a yearly rotation requirement are the only scored controls below. Other controls will remain as unscored options. Passwords used for macOS are likely to also function as encryption keys for FileVault. Depending on the information confidentiality on FileVault volumes, stronger passwords may be required than are necessary to pass the controls in this Benchmark.</xhtml:p>
                  <xhtml:p>


Before applying your organizations password policy, the existing password policy should be cleared so there is no out-dated or conflicting legacy settings in the password policy. A pre-existing password policly could result in false results. To clear the password policy before applying the newest options, use the command                                   <xhtml:span class="inline_block">/usr/bin/sudo /usr/bin/pwpolicy -clearaccountpolicies</xhtml:span>
                  </xhtml:p>
                  <xhtml:p>Apple-supported solutions for managing local passwords on macOS are to use either an XML file that contains password rules that are imported with pwpolicy or through the use of a profile. In either case, the controls in this section can be implemented with an organizationally-approved password policy.</xhtml:p>
                  <xhtml:p>Content is available where security hardening content is available and is native to Management suites and MDM tools.</xhtml:p>
                  <xhtml:p>


Content also available here:                                   <xhtml:a href="https://github.com/ronc-LAemigre/macos-sec-config">https://github.com/ronc-LAemigre/macos-sec-config</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>NIST guidance on passwords starting at 5.1.1.1</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://pages.nist.gov/800-63-3/sp800-63b.html">https://pages.nist.gov/800-63-3/sp800-63b.html</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>Additional references:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>
                        <xhtml:a href="https://developer.apple.com/documentation/devicemanagement/passcode">https://developer.apple.com/documentation/devicemanagement/passcode</xhtml:a>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:a href="https://krypted.com/mac-security/programatically-setting-password-policies/">https://krypted.com/mac-security/programatically-setting-password-policies/</xhtml:a>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:a href="https://www.macworld.co.uk/news/flaw-mac-t2-chip-passwords-3813616/">https://www.macworld.co.uk/news/flaw-mac-t2-chip-passwords-3813616/</xhtml:a>
                     </xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>


 The current method of creating and setting password policy is using the                                   <xhtml:span class="inline_block">pwpolicy -setglobalpolicy</xhtml:span>


 command. That command has been deprecated by Apple, but is still in use in the current version of macOS. The Benchmark will continue to use this command line method for passwords until Apple removes it from the OS. Setting password policy with mobile configuration profiles is the preferred method going forward.                            </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_Password_Account_Lockout_Threshold_Is_Configured" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Password Account Lockout Threshold Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The account lockout threshold specifies the amount of times a user can enter an incorrect password before a lockout will occur.</xhtml:p>
                     <xhtml:p>Ensure that a lockout threshold is part of the password policy on the computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish an Access Revoking Process" urn="urn:cisecurity.org:controls:8.0:6:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Process for Revoking Access" urn="urn:cisecurity.org:controls:7.0:16:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The account lockout feature mitigates brute-force password attacks on the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">CIS Password Policy - https://workbench.cisecurity.org/communities/113</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set the maximum number of failed login attempts to less than or equal to 5:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "maxFailedLoginAttempts=&lt;value5&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 When the account lockout threshold is set with                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


, it will also set a reset value to                                                     <xhtml:span class="inline_block">policyAttributeMinutesUntilFailedAuthenticationReset</xhtml:span>


 that defaults to 1 minute. You can change this value with the command:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "policyAttributeMinutesUntilFailedAuthenticationReset=&lt;value in minutes&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "maxFailedLoginAttempts=5"                                                    <br></br>
                              <br></br>


/usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "policyAttributeMinutesUntilFailedAuthenticationReset=10"
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">maxFailedAttempts</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;value5&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 When setting the lockout threshold with a mobile configuration profile there is no default reset to the lockout. To set the reset value use the key                                                     <xhtml:span class="inline_block">autoEnableInSeconds</xhtml:span>


 and set the key to                                                     <xhtml:span class="inline_block">&lt;integer&gt;&lt;value in seconds&gt;&lt;/integer&gt;</xhtml:span>


.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The number of incorrect log on attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user log on.</xhtml:p>
                              <xhtml:p>The locked account will auto-unlock after a few minutes when bad password attempts stop. The computer will accept the still-valid password if remembered or recovered.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_max_fail"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_Password_Minimum_Length_Is_Configured" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Password Minimum Length Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>A minimum password length is the fewest number of characters a password can contain to meet a system's requirements.</xhtml:p>
                     <xhtml:p>Ensure that a minimum of a 15-character password is part of the password policy on the computer.</xhtml:p>
                     <xhtml:p>Where the confidentiality of encrypted information in FileVault is more of a concern, requiring a longer password or passphrase may be sufficient rather than imposing additional complexity requirements that may be self-defeating.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Information systems that are not protected with strong password schemes including passwords of minimum length provide a greater opportunity for attackers to crack the password and gain access to the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set the password length to greater than or equal to 15:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "minChars=&lt;value15&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "minChars=15"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">minLength</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;value15&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Short passwords can be easily attacked.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_min_length"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_Complex_Password_Must_Contain_Alphabetic_Characters_Is_Configured" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Alphabetic Characters Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
                     <xhtml:p>Ensure that an Alphabetic character is part of the password policy on the computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations                                               <xhtml:span class="inline_block">5.3</xhtml:span>


 -                                               <xhtml:span class="inline_block">5.6</xhtml:span>


). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.                                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set the that passwords must contain at least one letter:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy -setaccountpolicies "requiresAlpha=&lt;value1&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "requiresAlpha=1"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">requireAlphanumeric</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 This profile sets a requirement of both an alphabetical and a numeric character.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_alpha_character"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_Complex_Password_Must_Contain_Numeric_Character_Is_Configured" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Numeric Character Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
                     <xhtml:p>Ensure that a number or numeric value is part of the password policy on the computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations                                               <xhtml:span class="inline_block">5.3</xhtml:span>


 -                                               <xhtml:span class="inline_block">5.6</xhtml:span>


). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.                                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set passwords to require at least one number:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy -setaccountpolicies "requiresNumeric=&lt;value1&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "requiresNumeric=2"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">requireAlphanumeric</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 This profile sets a requirement of both an alphabetical and a numeric character.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_numeric_character"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_Complex_Password_Must_Contain_Special_Character_Is_Configured" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Special Character Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Ensure that a special character is part of the password policy on the computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 The CIS macOS community has decided to not require the additional password complexity settings (Recommendations                                               <xhtml:span class="inline_block">5.3</xhtml:span>


 -                                               <xhtml:span class="inline_block">5.6</xhtml:span>


). Because of that, we have left the complexity recommendations as a manual assessment. Since there are a large amount of admins in the greater macOS world that do need these settings, we include both the guidance for the proper setting as well as probes for CIS-CAT to test.                                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set passwords to require at least one special character:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy -setaccountpolicies "requiresSymbol=&lt;value1&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "requiresSymbol=1"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">minComplexChars</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;value1&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_special_character"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Ensure_Complex_Password_Must_Contain_Uppercase_and_Lowercase_Characters_Is_Configured" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Complex Password Must Contain Uppercase and Lowercase Characters Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
                     <xhtml:p>Ensure that both uppercase and lowercase letters are part of the password policy on the computer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The more complex a password, the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set passwords to require at upper and lower case letter:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "requiresMixedCase=&lt;value1&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "requiresMixedCase=1"
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_pw_uppercase_lowercase"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Ensure_Password_Age_Is_Configured" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Password Age Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users should reset passwords periodically.
This control uses 365 days as the acceptable value. Some organizations may be more or less restrictive. This control mainly exists to mitigate against password reuse of the macOS account password in other realms that may be more prone to compromise. Attackers take advantage of exposed information to attack other accounts.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:7.0:16:9">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Passwords should be changed periodically to reduce exposure.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to require that passwords expire after at most 365 days:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "maxMinutesUntilChangePassword=&lt;value525600&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "maxMinutesUntilChangePassword=43200"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">maxPINAgeInDays</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;value365&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Required password changes will lead to some locked computers requiring admin assistance.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_password_age"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Ensure_Password_History_Is_Configured" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Password History Is Configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous password hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15.
The latest NIST guidance based on exploit research referenced in this section details how one of the greatest risks is password exposure rather than password cracking. Passwords should be changed to a new unique value whenever a password might have been exposed to anyone other than the account holder. Attackers have maintained persistent control based on predictable password change patterns and substantially different patterns should be used in case of a leak.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Old passwords should not be reused.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to require that the password must to be different from at least the last 15 passwords:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "usingHistory=&lt;value15&gt;"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy "usingHistory=15"
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.mobiledevice.passwordpolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">pinHistory</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;value15&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The profile method is the preferred method for setting password policy since                                                     <xhtml:span class="inline_block">-setglobalpolicy</xhtml:span>


 in                                                     <xhtml:span class="inline_block">pwpolicy</xhtml:span>


 is deprecated and will likely be removed in a future macOS release.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Required password changes will lead to some locked computers requiring admin assistance.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_password_history"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_the_Sudo_Timeout_Period_Is_Set_to_Zero" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the Sudo Timeout Period Is Set to Zero</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The sudo command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system. This control, along with the control to use a separate timestamp for each tty, limits the window where an unauthorized user, process, or attacker could utilize legitimate credentials that are valid for longer than required.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


In previous iterations and OS versions of the macOS Benchmark, the guidance was to edit the sudoers file directly. While this would properly configure the OS, any update would change the settings back to the default configuration. Creating a configuration file in the                                         <xhtml:span class="inline_block">/etc/sudoers.d/</xhtml:span>


 folder will not be modified on an OS update and will keep the proper configuration.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">sudo</xhtml:span>


 command stays logged in as the root user for five minutes before timing out and re-requesting a password. This five-minute window should be eliminated since it leaves the system extremely vulnerable. This is especially true if an exploit were to gain access to the system, since they would be able to make changes as a root user.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to edit the sudo settings:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/&lt;configuration file name&gt;
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example:</xhtml:em>
                           <xhtml:span class="inline_block">$ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/10_cissudoconfiguration</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Unlike other Unix and/or Linux distros, macOS will ignore configuration files in the sudoers.d folder that contain a                                               <xhtml:span class="inline_block">.</xhtml:span>


 so do not add a file extension to the configuration file.                                        </xhtml:p>
                        <xhtml:p>


Add the line                                               <xhtml:span class="inline_block">Defaults timestamp_timeout=0</xhtml:span>


 to the configuration file.                                        </xhtml:p>
                        <xhtml:p>If /etc/sudoers.d/ is not owned by root or in the wheel group, run the following to change ownership and group:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/chown -R root:wheel /etc/security/sudoers.d/
</xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This control has a serious impact where users often have to use sudo. It is even more of an impact where users have to use sudo multiple times in quick succession as part of normal work processes. Organizations with that common use case will likely find this control too onerous and are better to accept the risk of not requiring a 0 grace period.</xhtml:p>
                           <xhtml:p>In some ways the use of sudo -s, which is undesirable, is better than a long grace period since that use does change the hash to show that it is a root shell rather than a normal shell where sudo commands will be implemented without a password.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_sudo_timeout"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_a_Separate_Timestamp_Is_Enabled_for_Each_Usertty_Combo" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure a Separate Timestamp Is Enabled for Each User/tty Combo</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Using tty tickets ensures that a user must enter the sudo password in each Terminal session.</xhtml:p>
                  <xhtml:p>With sudo versions 1.8 and higher, introduced in 10.12, the default value is to have tty tickets for each interface so that root access is limited to a specific terminal. The default configuration can be overwritten or not configured correctly on earlier versions of macOS.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


In previous iterations and OS versions of the macOS Benchmark, the guidance was to edit the sudoers file directly. While this would properly configure the OS, any update would change the settings back to the default configuration. Creating a configuration file in the                                         <xhtml:span class="inline_block">/etc/sudoers.d/</xhtml:span>


 folder will not be modified on an OS update and will keep the proper configuration.                                  </xhtml:p>
                     <xhtml:p>


With the configuration file, there is no need to remove the                                         <xhtml:span class="inline_block">Defaults !tty_tickets</xhtml:span>


 line from the                                         <xhtml:span class="inline_block">visudo</xhtml:span>


 settings. The configuration file will take precedent.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>In combination with removing the sudo timeout grace period, a further mitigation should be in place to reduce the possibility of a background process using elevated rights when a user elevates to root in an explicit context or tty.</xhtml:p>
                  <xhtml:p>Additional mitigation should be in place to reduce the risk of privilege escalation of background processes.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to edit the sudo settings:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/&lt;configuration file name&gt;
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example:</xhtml:em>
                           <xhtml:span class="inline_block">$ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/10_cissudoconfiguration</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Unlike other Unix and/or Linux distros, macOS will ignore configuration files in the sudoers.d folder that contain a                                               <xhtml:span class="inline_block">.</xhtml:span>


 so do not add a file extension to the configuration file.                                        </xhtml:p>
                        <xhtml:p>


Add the line                                               <xhtml:span class="inline_block">Defaults timestamp_type=tty</xhtml:span>


 to the configuration file.                                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 The                                               <xhtml:span class="inline_block">Defaults timestamp_type=tty</xhtml:span>


 line can be added to an existing configuration file or a new one. That will depend on your organization's preference and works either way.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This control should have no user impact. Developers or installers may have issues if background processes are spawned with different interfaces than where sudo was executed.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_tty_seperate_timestamp"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_the_root_Account_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the "root" Account Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. With some versions of Linux, the system administrator may commonly use the root account to perform administrative functions.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Enabling and using the root account puts the system at risk since any successful exploit or mistake while the root account is in use could have unlimited access privileges within the system. Using the                                   <xhtml:span class="inline_block">sudo</xhtml:span>


 command allows users to perform functions as a root user while limiting and password protecting the access privileges. By default the root account is not enabled on a macOS computer. An administrator can escalate privileges using the                                   <xhtml:span class="inline_block">sudo</xhtml:span>


 command (use                                   <xhtml:span class="inline_block">-s</xhtml:span>


 or                                   <xhtml:span class="inline_block">-i</xhtml:span>


 to get a root shell).                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to ensure that the root user is disabled:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">/System/Library/CoreServices/Applications/Directory Utility</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>Click the lock icon to unlock the service</xhtml:li>
                           <xhtml:li>


Click                                                     <xhtml:span class="inline_block">Edit</xhtml:span>


 in the                                                     <xhtml:span class="inline_block">menu bar</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Click                                                     <xhtml:span class="inline_block">Disable Root User</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to disable the root user:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/dsenableroot -d                                              <br></br>
                           <br></br>


username = root                                              <br></br>


user password:
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Some legacy POSIX software might expect an available root account.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_root_disabled"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_Automatic_Login_Is_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Automatic Login Is Disabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The automatic login feature saves a user's system access credentials and bypasses the login screen. Instead, the system automatically loads to the user's desktop screen.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Manage Default Accounts on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:7">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Change Default Passwords" urn="urn:cisecurity.org:controls:7.0:4:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Disabling automatic login decreases the likelihood of an unauthorized person gaining access to a system.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to set automatic login to off:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Users &amp; Groups</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>Click the lock to authenticate</xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Login Options</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Automatic login</xhtml:span>


 and set it to                                                     <xhtml:span class="inline_block">Off</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to disable automatic login:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults delete /Library/Preferences/com.apple.loginwindow autoLoginUser
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.loginwindow</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">com.apple.login.mcx.DisableAutoLoginClient</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 If both the profile is enabled and a user is set to autologin, the profile will take precedent. In this case, the graphical or terminal remediation method should also be applied in case the profile is ever removed.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>If automatic login is not disabled, an unauthorized user could gain access to the system without supplying any credentials.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_disable_automatic_login"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_Ensure_an_Administrator_Account_Cannot_Login_to_Another_Users_Active_and_Locked_Session" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure an Administrator Account Cannot Login to Another User's Active and Locked Session</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Automatic Session Locking on Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Lock Workstation Sessions After Inactivity" urn="urn:cisecurity.org:controls:7.0:16:11">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Disabling the administrator's and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://derflounder.wordpress.com/2014/02/16/managing-the-authorization-database-in-os-x-mavericks/</xccdf:ident>
               <xccdf:ident system="URL">https://www.jamf.com/jamf-nation/discussions/18195/system-login-screensaver</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to disable a user logging into another user's active and/or locked session:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/security authorizationdb write system.login.screensaver use-login-window-ui                                              <br></br>
                           <br></br>


YES (0)
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>While Fast user switching is a workaround for some lab environments, especially where there is even less of an expectation of privacy, this setting change may impact some maintenance workflows.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_admin_session"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_Ensure_a_Login_Window_Banner_Exists" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure a Login Window Banner Exists</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required. The system recognizes either the                                   <xhtml:span class="inline_block">.txt</xhtml:span>


 and the                                   <xhtml:span class="inline_block">.rtf</xhtml:span>


 formats.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/en-au/HT202277</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following commands to create or edit the login window text and set the proper permissions:</xhtml:p>
                        <xhtml:p>


Edit (or create) a                                               <xhtml:span class="inline_block">PolicyBanner.txt</xhtml:span>


 or                                               <xhtml:span class="inline_block">PolicyBanner.rtf</xhtml:span>


 file, in the                                               <xhtml:span class="inline_block">/Library/Security/</xhtml:span>


 folder, to include the required login window banner text.                                        </xhtml:p>
                        <xhtml:p>Perform the following to set permissions on the policy banner file:</xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/sbin/chown o+r /Library/Security/PolicyBanner.txt                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/sbin/chown o+r /Library/Security/PolicyBanner.rtf 
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 If your organization uses an                                               <xhtml:span class="inline_block">.rtfd</xhtml:span>


 file to set the policy banner, run                                               <xhtml:span class="inline_block">$ /usr/bin/sudo /usr/sbin/chown -R o+rx /Library/Security/PolicyBanner.rtfd</xhtml:span>


 to update the permissions.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Users will have to click on the window with the Login text before logging into the computer.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_login_banner_window"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_Ensure_Users_Accounts_Do_Not_Have_a_Password_Hint" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Users' Accounts Do Not Have a Password Hint</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>Organizations might consider entering an organizational help desk phone number or other text (such as a warning to the user). A help desk number is only appropriate for organizations with trained help desk personnel that are validating user identities for password resets.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Password hints that are closely related to the user's password are a security vulnerability, especially in the social media age. Unauthorized users are more likely to guess a user's password if there is a password hint. The password hint is very susceptible to social engineering attacks and information exposure on social media networks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to remove a user's password hint:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">System Preferences</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Users &amp; Groups</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>Select the Current User</xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Change Password</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>Change the password and ensure that no text is entered in the Password hint box</xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 This will only change the currently logged-in user's password, and not any others that are not compliant on the Mac. Use the terminal method if multiple users are not in compliance.                                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Run the following command to remove a user's password hint:</xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/&lt;username&gt; hint
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example</xhtml:em>


:                                        </xhtml:p>
                        <xhtml:code class="code_block">


$ /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/firstuser hint                                              <br></br>
                           <br></br>


$ /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/seconduser hint
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_no_password_hints"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_Secure_Keyboard_Entry_Terminal.app_Is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Secure Keyboard Entry Terminal.app Is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal. Unauthorized applications and malicious code could intercept keystrokes entered in the Terminal.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Maintain Inventory of Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:1">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enabling Secure Keyboard Entry minimizes the risk of a key logger from detecting what is entered in Terminal.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident system="URL">https://support.apple.com/en-ca/guide/terminal/trml109/mac</xccdf:ident>
               <xccdf:ident system="URL">https://developer.apple.com/library/archive/technotes/tn2150/_index.html</xccdf:ident>
               <xccdf:ident system="URL">https://krypted.com/mac-os-x/secure-keyboard-entry-on-macos/</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable secure keyboard entries in Terminal:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open the                                                     <xhtml:span class="inline_block">Applications</xhtml:span>


 folder                                              </xhtml:li>
                           <xhtml:li>


Open the                                                     <xhtml:span class="inline_block">Utilities</xhtml:span>


 folder                                              </xhtml:li>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">Terminal</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Terminal</xhtml:span>


 in the Menu Bar                                              </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Secure Keyboard Entry</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example</xhtml:em>


:                                        </xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.Terminal</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">SecureKeyboardEntry</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Enabling this in Terminal would prevent an application that is otherwise validly intercepting keyboard input from intercepting that input in Terminal.app. This could impact productivity tools.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_terminal_secure_keyboard"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_User_Accounts_and_Environment">
            <xccdf:title xml:lang="en">User Accounts and Environment</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Account management is a central part of security for any computer system, including macOS. General practices should be followed to ensure that all accounts on a system are still needed, and that default accounts have been removed. Users with administrator roles should have distinct accounts for both administrator functions as well as day-to-day work where the passwords are different and known only by the user assigned to the account. Accounts with elevated privileges should not be easily discerned from the account name from standard accounts.</xhtml:p>
               <xhtml:p>When any computer system is added to a directory system there are additional controls available, including user account management, that are not available in a standalone computer. One of the drawbacks is the local computer is no longer in control of the accounts that can access or manage it if given permission. For macOS, if the computer is connected to a directory, any standard user can now log into the computer at console, which by default may be desirable or not depending on the use case. If an administrator group is allowed to administer the local computer, the membership of that group is controlled completely in the directory.</xhtml:p>
               <xhtml:p>macOS computers connected to a directory should be configured so that the risk is appropriate for the mission use of the computer. Only those accounts that require local authentication should be allowed, and only required administrator accounts should be in the local administrator group. Authenticated users for console access and domain admins for administration may be too broad or too limited.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.1_Accounts_Preferences_Action_Items">
               <xccdf:title xml:lang="en">Accounts Preferences Action Items</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Proper account management is critical to computer security. Many options and settings in the Account System Preference Pane can be used to increase the security of the Mac.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Ensure_Login_Window_Displays_as_Name_and_Password_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Login Window Displays as Name and Password Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The login window prompts a user for his/her credentials, verifies their authorization level, and then allows or denies the user access to the system.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Prompting the user to enter both their username and password makes it twice as hard for unauthorized users to gain access to the system since they must discover two attributes.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to ensure the login window display name and password:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Users and Groups</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Login Options</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Display login window as:</xhtml:span>


 to                                                           <xhtml:span class="inline_block">Name and password</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable the login window to display name and password:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow SHOWFULLNAME -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 The GUI will not display the updated setting until the current user(s) logs out.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.loginwindow</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">SHOWFULLNAME</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_login_show_fullname"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Ensure_Show_Password_Hints_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Show Password Hints Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Password hints are user-created text displayed when an incorrect password is used for an account.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Password hints make it easier for unauthorized persons to gain access to systems by displaying information provided by the user to assist in remembering the password. This info could include the password itself or other information that might be readily discerned with basic knowledge of the end user.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable password hints from being shown:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Users &amp; Groups</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Login Options</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Show password hints</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable password hints:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow RetriesUntilHint -int 0
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.loginwindow</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">RetriesUntilHint</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;integer&gt;0&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The user can set the hint to any value, including the password itself or clues that allow trivial social engineering attacks.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_show_password_hints"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Ensure_Guest_Account_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Guest Account Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes and cannot remotely login to the system. All files, caches, and passwords created by the guest user are deleted upon logging out.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish an Access Revoking Process" urn="urn:cisecurity.org:controls:8.0:6:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>By default, the guest account is enabled for access to sharing services but is not allowed to log into the computer.</xhtml:p>
                        <xhtml:p>The guest account does not need a password when it is enabled to log into the computer.</xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Disabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to disable guest account availability:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Users &amp; Groups</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Guest User</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Allow guests to log in to this computer</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable the guest account:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.MCX</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">DisableGuestAccount</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>A guest user can use that access to find out additional information about the system and might be able to use privilege escalation vulnerabilities to establish greater access.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_disable_guest_login"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Ensure_Guest_Access_to_Shared_Folders_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Guest Access to Shared Folders Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Not allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly use privilege escalation attacks to take control of the system.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to no longer allow guest user access to shared folders:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>Open `System Preferences</xhtml:li>
                              <xhtml:li>Select `Users &amp; Groups</xhtml:li>
                              <xhtml:li>Select `Guest User</xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Allow guest users to connect to shared folders</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following commands to verify that shared folders are not accessible to guest users:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /usr/sbin/sysadminctl -smbGuestAccess off
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Unauthorized users could access shared files on the system.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_guest_sharing"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Ensure_the_Guest_Home_Folder_Does_Not_Exist" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure the Guest Home Folder Does Not Exist</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>In the previous two controls, the guest account login has been disabled and sharing to guests has been disabled, as well. There is no need for the legacy Guest home folder to remain in the file system. When normal user accounts are removed, you have the option to archive it, leave it in place, or delete. In the case of the guest folder, the folder remains in place without a GUI option to remove it. If at some point in the future a Guest account is needed, it will be re-created. The presence of the Guest home folder can cause automated audits to fail when looking for compliant settings within all User folders, as well. Rather than ignoring the folder's continued existence, it is best removed.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>The Guest home folders are unneeded after the Guest account is disabled and could be used inappropriately.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to remove the Guest user home folder:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo /bin/rm -R /Users/Guest 
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The Guest account should not be necessary after it is disabled, and it will be automatically re-created if the Guest account is re-enabled</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_guest_home_folder"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Show_All_Filename_Extensions_Setting_is_Enabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Show All Filename Extensions Setting is Enabled</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>A filename extension is a suffix added to a base filename that indicates the base filename's file format.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Address Unauthorized Software" urn="urn:cisecurity.org:controls:8.0:2:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Address unapproved software" urn="urn:cisecurity.org:controls:7.0:2:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Visible filename extensions allow the user to identify the file type and the application it is associated with which leads to quick identification of misrepresented malicious files.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:strong>Graphical Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Perform the following steps to enable secure keyboard entries in Terminal:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Open the                                                     <xhtml:span class="inline_block">Applications</xhtml:span>


 folder                                              </xhtml:li>
                           <xhtml:li>


Open the                                                     <xhtml:span class="inline_block">Utilities</xhtml:span>


 folder                                              </xhtml:li>
                           <xhtml:li>


Open                                                     <xhtml:span class="inline_block">Terminal</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


Select                                                     <xhtml:span class="inline_block">Terminal</xhtml:span>


 in the Menu Bar                                              </xhtml:li>
                           <xhtml:li>


Set                                                     <xhtml:span class="inline_block">Secure Keyboard Entry</xhtml:span>


 to enabled                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Terminal Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
                        <xhtml:p>
                           <xhtml:em>example</xhtml:em>


:                                        </xhtml:p>
                        <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Profile Method:</xhtml:strong>
                        </xhtml:p>
                        <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


The PayloadType string is                                                     <xhtml:span class="inline_block">com.apple.Terminal</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key to include is                                                     <xhtml:span class="inline_block">SecureKeyboardEntry</xhtml:span>
                           </xhtml:li>
                           <xhtml:li>


The key must be set to                                                     <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>The user of the system can open files of unknown or unexpected filetypes if the extension is not visible.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://open-scap.org/page/SCE">
                     <check-import import-name="stdout"></check-import>
                     <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_finder_show_file_extensions"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Applications">
            <xccdf:title xml:lang="en">Applications</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>All default Operating System default installs include OS vendor applications, or vendor endorsed channels. Most of these applications do not require explicit security controls as part of an OS Benchmark or a separate Benchmark. When the application is OS specific it is much more efficient to include security guidance as part of the OS Benchmark where security controls are available. This section contains a small list of macOS applications where security controls exist and should be reviewed.</xhtml:p>
               <xhtml:p>There is no insistence that any of the built-in application must be used, three are many alternative third party applications that may be used instead. Included applications are often core to the Operating System and a lack of security controls will likely make the OS itself more vulnerable.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7.1_Mail">
               <xccdf:title xml:lang="en">Mail</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Mail is Apple's OS included email client on both macOS and iOS. It supports a range of email server services including iCloud, Exchange, Gmail and standard IMAP and POP accounts. With the vast barrage of phishing attacks any Internet email client is an exploitable risk on a user system. Any email client should be hardened with controls that assist the user against social engineering attacks to reduce the risk of unwanted emails. This benchmark is not advocating for all users to use Apple Mail, just providing guidance on controls for the built-in email client. Other email clients will have their own set of security controls.</xhtml:p>
                  <xhtml:p>Apple Mail fully supports S/MIME without the use of any third party plugin. While there are very few remaining trusted CAs issuing free S/MIME certificates the use of a trusted CA and digital signing enables others to interact with you using end-to-end encryption through encrypted email. An internal CA may also be used but partner trust of the CA will have to be coordinated.</xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>More S/MIME info</xhtml:strong>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://support.apple.com/guide/mail/sign-or-encrypt-emails-mlhlp1180/mac">Sign or encrypt emails in Mail on Mac </xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.ssl.com/how-to/installing-an-s-mime-certificate-and-sending-secure-email-in-macos/">Installing an S/MIME Certificate and Sending Secure Email in macOS</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.sslmarket.com/ssl/obtaining-and-using-an-s-mime-certificate-on-apple-macos">Obtaining and using an S/MIME certificate on Apple MacOS</xhtml:a>
                  </xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="http://kb.mozillazine.org/Getting_an_SMIME_certificate">Sources of Free S/MIME Certificates</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1.1_Ensure_Protect_Mail_Activity_in_Mail_Is_Enabled" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Protect Mail Activity in Mail Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple provides privacy protection that should be enabled for the mail app on macOS to reduce information collection from a user that receives email.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:8.0:9:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:7.0:7:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Email is routinely abused by attackers, spammers and marketers. The "Protect Mail Activity" control reduces risk by hiring the current IP address of your Mac and privately downloading remote content.</xhtml:p>
                     <xhtml:p>The Protect Mail Activity function of privately downloading remote content is not applicable for those users that do not download any remote content. Typical Internet email is no longer plain text and will not render properly without remote content, personal email or mailing list email may function without complaint by blocking remote content.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/mail/use-mail-privacy-protection-mlhl03be2866/mac</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to enabled protect mail activity:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Mail</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Mail</xhtml:span>


 in the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences...</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Protect Mail Activity</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Some remote content may be access controlled and refuse to download with this setting enabled.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7.2_Safari">
               <xccdf:title xml:lang="en">Safari</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Safari is Apple's included web browser. Many macOS services only operate, or operate more efficiently through the use of Safari.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://www.apple.com/safari/">https://www.apple.com/safari/</xhtml:a>
                  </xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.1_Ensure_Automatic_Opening_of_Safe_Files_in_Safari_Is_Disabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Automatic Opening of Safe Files in Safari Is Disabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Safari evaluates file safety by using a list of filetypes maintained by Apple. The list of files include text, image, video and archive formats that would be run in the context of the OS rather than the browser.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Block Unnecessary File Types" urn="urn:cisecurity.org:controls:8.0:9:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Block Unnecessary File Types" urn="urn:cisecurity.org:controls:7.0:7:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Configure Devices Not To Auto-run Content" urn="urn:cisecurity.org:controls:7.0:8:5">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Hackers have taken advantage of this setting via drive-by attacks. These attacks occur when a user visits a legitimate website that has been corrupted. The user unknowingly downloads a malicious file either by closing an infected pop-up or hovering over a malicious banner. An attacker can create a malicious file that will fall within Safari's safe file list that will download and execute without user input.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set safe files to not open after downloading in Safari:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">General</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Open "safe" files after downloading</xhtml:span>


 to disabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to disable safe files from not opening when downloaded in Safari:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">AutoOpenSafeDownloads</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to:                                                           <xhtml:span class="inline_block">&lt;false/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Apple considers many files that the operating system itself auto-executes as "safe files." Many of these files could be malicious and could execute locally without the user even knowing that a file of a specific type had been downloaded.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_open_safe_files"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.2_Audit_History_and_Remove_History_Items" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Audit History and Remove History Items</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Organizational management of user web browsing history is a challenge effected by multiple facets. Organizations should decide whether to manage browser history and how much history should be maintained.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>There are conflicting concerns in the retention of browser history.
Unlimited retention:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Consumes disk space</xhtml:li>
                        <xhtml:li>Preferred by on disk forensics teams</xhtml:li>
                        <xhtml:li>User searchable for old visited pages</xhtml:li>
                        <xhtml:li>User privacy concerns</xhtml:li>
                        <xhtml:li>Security concerns to retain old links that may be stale or lead to compromised pages or pages with changes or inappropriate content</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>Old browser history becomes stale and the use or misuse of the data can lead to unwanted outcomes. Search engine results are maintained and often provide much more relevant current information than old website visit information.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set Safari to remove history after a set amount of days:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">General</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Remove history items</xhtml:span>


 to your organization's requirements                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to set when Safari will remove history items:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int &lt;1,7,14,31,365,36500&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int 36500                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u seconduser /usr/bin/defaults write /Users/seconduser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int 365                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u thirduser /usr/bin/defaults write /Users/thirduser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int 31                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u fourthuser /usr/bin/defaults write /Users/fourthuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int 14                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u fifthuser /usr/bin/defaults write /Users/fifthuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int 7                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u sixthuser /usr/bin/defaults write /Users/sixthuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari HistoryAgeInDaysLimit -int 1
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Setting the plist key to a value that is not represented by the GUI could cause issues.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">HistoryAgeInDaysLimit</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to:                                                           <xhtml:span class="inline_block">&lt;integer&gt;&lt;1,7,14,31,365,36500&gt;&lt;/integer&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Setting the plist key to a value that is not represented by the GUI could cause issues.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If old browsing history is not available it will not be available to authorized or unauthorized users. Some users may find old and even stale information useful.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.3_Audit_Passwords_System_Preference_Setting" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Audit Passwords System Preference Setting</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple has provided a new interface in macOS Monterey for managing passwords that mirrors the interfaced capability already available in iOS. Password management in macOS was previously available in both Safari Preferences and in Keychain Access. Apple is attempting to simplify password management for macOS and make the user experience more similar to iOS. Organizations are justifiably concerned about the risk of password managers, particularly as a possible backdoor to improved credential management regimes and greater use of Multi-Factor-Authentication (MFA).</xhtml:p>
                     <xhtml:p>Apple has information posted on this system preference with additional information.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://support.apple.com/guide/mac-help/change-passwords-preferences-on-mac-sfri40599/mac">Change Passwords preferences on Mac</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>A warning icon is shown next to a website for any of the following reasons:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Easily guessed</xhtml:li>
                        <xhtml:li>Appeared in a data leak</xhtml:li>
                        <xhtml:li>Reused on another website</xhtml:li>
                     </xhtml:ul>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Organizations should remove what passwords can be saved on user computes and the ability of attackers to potentially steal organizational credentials. Limits on password storage must be evaluated based on both user risk and Enterprise risk.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/security/password-monitoring-sec78e79fc3b/1/web/1</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set Password system settings to your organization's settings:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">System Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Passwords</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>Enter the user password</xhtml:li>
                              <xhtml:li>


Select the                                                           <xhtml:span class="inline_block">Detect compromised passwords</xhtml:span>


 setting to match your organization's settings                                                    </xhtml:li>
                              <xhtml:li>Remove stored passwords that should not be saved.</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Organizations using passwords are constantly reported as having their password databases leaked to the Internet so every password a user has should be unique. Locking down secure password management solutions so that it cannot be used pushes users to password reuse, sticky notes or always open text files with long lists of credentials.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.4_Ensure_Warn_When_Visiting_A_Fradulent_Website_in_Safari_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Warn When Visiting A Fradulent Website in Safari Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple uses the Google Safe Browsing API to check for fraudulent websites and report them to the user attempting visit one.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:8.0:9:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:7.0:7:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Attackers use crafted web pages to social engineer users to load unwanted content. Warning users prior to loading the content enables better security.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/safari/security-ibrw1074/16.0/mac/12.0</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set Safari to warn when visiting a fraudulent site:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Warn when visiting a fraudulent site</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable warn when visiting a fraudulent site in Safari:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WarnAboutFraudulentWebsites -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WarnAboutFraudulentWebsites -bool false
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">WarnAboutFraudulentWebsites</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to:                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Once compromised websites serving malware could be sanitized and remain in the database, though there is no widespread reporting of that risk.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_warn_fraudulent_site"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.5_Ensure_Prevent_Cross-site_Tracking_in_Safari_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Prevent Cross-site Tracking in Safari Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>There is a vast network of groups that collect, use and sell user data. One method used to collect user data is pay and provide contented and services for website owners, along with that "assistance" the site owners push tracking cookies on visitors. In many cases the help allows a content owner to keep the site up. The tracking cookies allow information brokers to track web users across visited sites. For better privacy and to provide some resistance to data brokers prevent cross-tracking.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Cross-tracking allows data-brokers to follow you across the Internet to enable their business model of selling personal data. Users should protect their data and not volunteer it to marketing companies.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/guide/safari/prevent-cross-site-tracking-sfri40732/mac</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set prevent cross-site tracking in Safari to enabled:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Prevent cross-site tracking</xhtml:span>


 is enable                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable Safari to prevent cross-site tracking:</xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari BlockStoragePolicy -int 2                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.storageBlockingPolicy -int 1                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitStorageBlockingPolicy -int 1
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari BlockStoragePolicy -int 2                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.storageBlockingPolicy -int 1                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitStorageBlockingPolicy -int 1
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">BlockStoragePolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to: 2</xhtml:li>
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">WebKitPreferences.storageBlockingPolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to: 1</xhtml:li>
                              <xhtml:li>


The key to also include is                                                           <xhtml:span class="inline_block">WebKitStorageBlockingPolicy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>The key must be set to: 1</xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Marketing companies will be unable to target you as effectively.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_crosssite_tracking"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.6_Audit_Hide_IP_Address_in_Safari_Setting" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Audit Hide IP Address in Safari Setting</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Public (Routable) IP addresses can be used to track people to their current location, including home and business addresses. While a valid IP addess is necessary to load the site the valid address does not need to be provided to known trackers and should be hidden.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:8.0:9:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain and Enforce Network-Based URL Filters" urn="urn:cisecurity.org:controls:7.0:7:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Trackers can correlate your visits through various applications including websites and is a threat to your privacy.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://support.apple.com/en-bn/guide/safari/sfri35610/16.0/mac/12.0</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set Safari whether or not to hide IP addresses from trackers:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Hide IP address from trackers</xhtml:span>


 to your organization's requirements                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable or disable hiding IP addresses from trackers in Safari:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WBSPrivacyProxyAvailabilityTraffic -int &lt;3296/3300&gt;
</xhtml:code>
                           <xhtml:p>
                              <xhtml:span class="inline_block">3296</xhtml:span>


 will set hide IP address from trackers to disabled.                                                     <xhtml:span class="inline_block">3300</xhtml:span>


 will enable it.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">


$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WBSPrivacyProxyAvailabilityTraffic -int 3300                                                    <br></br>
                              <br></br>


$ /usr/bin/sudo -u seconduser /usr/bin/defaults write /Users/seconduser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WBSPrivacyProxyAvailabilityTraffic -int 3296
                                              </xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Website address blocking through iCloud Private Relay made prevent some wanted pages to load that use IP geolocation access controls.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.7_Ensure_Advertising_Privacy_Protection_in_Safari_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Advertising Privacy Protection in Safari Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Apple provides a framework that allows advertisers to target Apple users and end-users with advertisements. While many people prefer that when they see advertising it is relevant to them and their interests, the detailed information that is data mining collected, correlated, and available to advertisers in repositories is often disconcerting. This information is valuable to both advertisers and attackers and has been used with other metadata to reveal users' identities.</xhtml:p>
                     <xhtml:p>Organizations should manage advertising settings on computers rather than allow users to configure the settings.</xhtml:p>
                     <xhtml:p>
                        <xhtml:a href="https://support.apple.com/en-us/HT205223">Apple Information</xhtml:a>
                     </xhtml:p>
                     <xhtml:p>Ad tracking should be limited on 10.15 and prior.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Organizations should manage user privacy settings on managed devices to align with organizational policies and user data protection requirements.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set Safari to allow privacy-preserving measurement of ad effectiveness:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Prefernces</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Privacy</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Warn when visiting a fraudulent site</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable allow privacy-preserving measurement of ad effectiveness in Safari:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.privateClickMeasurementEnabled -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.privateClickMeasurementEnabled -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Uses will see generic advertising rather than targeted advertising. Apple warns that this will reduce the number of relevant ads.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_ad_privacy"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2.8_Ensure_Show_Full_Website_Address_in_Safari_Is_Enabled" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Show Full Website Address in Safari Is Enabled</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Attackers use websites with malicious or unwanted content to exploit the user or the computer. Part of the attack chain is to lure someone to load their content rather than the desired content. In order to reduce the risk in interacting with unwanted content the full website address should always be displayed in Safari.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:8.0:9:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Use of Only Fully Supported Browsers and Email Clients" urn="urn:cisecurity.org:controls:7.0:7:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Full visibility into what site is being visited is important for privacy and security.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://apple.stackexchange.com/questions/371473/always-show-full-url-in-safari-address-bar</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Graphical Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Perform the following steps to set Safari to show full website addresses:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


Open                                                           <xhtml:span class="inline_block">Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Safari</xhtml:span>


 from the                                                           <xhtml:span class="inline_block">menu bar</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Preferences</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Select                                                           <xhtml:span class="inline_block">Security</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


Set                                                           <xhtml:span class="inline_block">Show full website address</xhtml:span>


 to enabled                                                    </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Terminal Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Run the following command to enable showing full website addresses in Safari:</xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u &lt;username&gt; /usr/bin/defaults write /Users/&lt;username&gt;/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari ShowFullURLInSmartSearchField -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:em>example</xhtml:em>


:                                              </xhtml:p>
                           <xhtml:code class="code_block">$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari ShowFullURLInSmartSearchField -bool true
</xhtml:code>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 To run the Terminal commands, Terminal must be granted Full Disk Access in the Security &amp; Privacy pane in System Preferences.                                              </xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>Profile Method:</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>Create or edit a configuration profile with the following information:</xhtml:p>
                           <xhtml:ol>
                              <xhtml:li>


The PayloadType string is                                                           <xhtml:span class="inline_block">com.apple.Safari</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key to include is                                                           <xhtml:span class="inline_block">ShowFullURLInSmartSearchField</xhtml:span>
                              </xhtml:li>
                              <xhtml:li>


The key must be set to:                                                           <xhtml:span class="inline_block">&lt;true/&gt;</xhtml:span>
                              </xhtml:li>
                           </xhtml:ol>
                           <xhtml:p>
                              <xhtml:strong>Note:</xhtml:strong>


 Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.                                              </xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Many URLs are very long and complicated, particularly for internal content management systems. Some complete URLS in the Smart Search Field may be difficult to parse.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://open-scap.org/page/SCE">
                        <check-import import-name="stdout"></check-import>
                        <check-content-ref href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-SCRIPTmacOS_safari_show_full_address"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
      </xccdf:Benchmark>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-oval" timestamp="2024-11-10T19:31:57">
      <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://oval.cisecurity.org/schemas/validator-oval-definitions-5.11.2.xsd">
         <generator>
            <oval:product_name>Center for Internet Security - Optimus</oval:product_name>
            <oval:schema_version>5.11.2</oval:schema_version>
            <oval:timestamp>2024-11-10T19:31:48.406Z</oval:timestamp>
         </generator>
         <definitions>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3221770" version="1">
               <metadata>
                  <title>Ensure Show Bluetooth Status in Menu Bar Is Enabled</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Show_Bluetooth_Status_in_Menu_Bar_Is_Enabled" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_Show_Bluetooth_Status_in_Menu_Bar_Is_Enabled"></reference>
                  <description>Ensure Show Bluetooth Status in Menu Bar Is Enabled</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3221770"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3168698" version="1">
               <metadata>
                  <title>Ensure Show Wi-Fi status in Menu Bar Is Enabled</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Show_Wi-Fi_status_in_Menu_Bar_Is_Enabled" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_Show_Wi-Fi_status_in_Menu_Bar_Is_Enabled"></reference>
                  <description>Ensure Show Wi-Fi status in Menu Bar Is Enabled</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3168698"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3168747" version="1">
               <metadata>
                  <title>Audit iCloud Keychain</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.6.1.1_Audit_iCloud_Keychain" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.6.1.1_Audit_iCloud_Keychain"></reference>
                  <description>Audit iCloud Keychain</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3168747"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:def:3168748" version="1">
               <metadata>
                  <title>Audit iCloud Drive</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.6.1.2_Audit_iCloud_Drive" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.6.1.2_Audit_iCloud_Drive"></reference>
                  <description>Audit iCloud Drive</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3168748"></criterion>
               </criteria>
            </definition>
         </definitions>
         <tests>
            <plist511_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="at_least_one_exists" comment="Ensure /plist/dict/key[text()='Bluetooth']/following-sibling::*[1]/number() in /Library/Managed Preferences/com.apple.controlcenter.plist operation equals datatype int and value 18" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3221770" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3221770"></object>
               <state state_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3221770"></state>
            </plist511_test>
            <plist511_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="at_least_one_exists" comment="Ensure /plist/dict/key[text()='WiFi']/following-sibling::*[1]/number() in /Library/Managed Preferences/com.apple.controlcenter.plist operation equals datatype int and value 18" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3168698" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3168698"></object>
               <state state_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3168698"></state>
            </plist511_test>
            <plist511_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="at_least_one_exists" comment="Ensure /plist/dict/key[text()='allowCloudKeychainSync']/following-sibling::*[1]/name() in /Library/Managed\ Preferences/com.apple.applicationaccess.plist operation equals datatype boolean and value false" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3168747" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3168747"></object>
               <state state_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3168747"></state>
            </plist511_test>
            <plist511_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="at_least_one_exists" comment="Ensure /plist/dict/key[text()='allowCloudDocumentSync']/following-sibling::*[1]/name() in /Library/Managed\ Preferences/com.apple.applicationaccess.plist operation equals datatype boolean and value false" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:tst:3168748" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3168748"></object>
               <state state_ref="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3168748"></state>
            </plist511_test>
         </tests>
         <objects>
            <plist511_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='Bluetooth']/following-sibling::*[1]/number() in /Library/Managed Preferences/com.apple.controlcenter.plist operation equals datatype int and value 18" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3221770" version="1">
               <filepath>/Library/Managed Preferences/com.apple.controlcenter.plist</filepath>
               <xpath>/plist/dict/key[text()='Bluetooth']/following-sibling::*[1]/number()</xpath>
            </plist511_object>
            <plist511_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='WiFi']/following-sibling::*[1]/number() in /Library/Managed Preferences/com.apple.controlcenter.plist operation equals datatype int and value 18" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3168698" version="1">
               <filepath>/Library/Managed Preferences/com.apple.controlcenter.plist</filepath>
               <xpath>/plist/dict/key[text()='WiFi']/following-sibling::*[1]/number()</xpath>
            </plist511_object>
            <plist511_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='allowCloudKeychainSync']/following-sibling::*[1]/name() in /Library/Managed\ Preferences/com.apple.applicationaccess.plist operation equals datatype boolean and value false" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3168747" version="1">
               <filepath>/Library/Managed Preferences/com.apple.applicationaccess.plist</filepath>
               <xpath>/plist/dict/key[text()='allowCloudKeychainSync']/following-sibling::*[1]/name()</xpath>
            </plist511_object>
            <plist511_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='allowCloudDocumentSync']/following-sibling::*[1]/name() in /Library/Managed\ Preferences/com.apple.applicationaccess.plist operation equals datatype boolean and value false" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:obj:3168748" version="1">
               <filepath>/Library/Managed Preferences/com.apple.applicationaccess.plist</filepath>
               <xpath>/plist/dict/key[text()='allowCloudDocumentSync']/following-sibling::*[1]/name()</xpath>
            </plist511_object>
         </objects>
         <states>
            <plist511_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='Bluetooth']/following-sibling::*[1]/number() in /Library/Managed Preferences/com.apple.controlcenter.plist operation equals datatype int and value 18" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3221770" version="1">
               <value_of datatype="int" operation="equals">18</value_of>
            </plist511_state>
            <plist511_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='WiFi']/following-sibling::*[1]/number() in /Library/Managed Preferences/com.apple.controlcenter.plist operation equals datatype int and value 18" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3168698" version="1">
               <value_of datatype="int" operation="equals">18</value_of>
            </plist511_state>
            <plist511_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='allowCloudKeychainSync']/following-sibling::*[1]/name() in /Library/Managed\ Preferences/com.apple.applicationaccess.plist operation equals datatype boolean and value false" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3168747" version="1">
               <value_of datatype="boolean" operation="equals">false</value_of>
            </plist511_state>
            <plist511_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Ensure /plist/dict/key[text()='allowCloudDocumentSync']/following-sibling::*[1]/name() in /Library/Managed\ Preferences/com.apple.applicationaccess.plist operation equals datatype boolean and value false" id="oval:org.cisecurity.benchmarks.apple_mac_os_x_11:ste:3168748" version="1">
               <value_of datatype="boolean" operation="equals">false</value_of>
            </plist511_state>
         </states>
      </oval_definitions>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-oval" timestamp="2024-11-10T19:31:57">
      <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:macos="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:unix="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://github.com/CISecurity/OVALRepo/raw/master/oval_schemas/5.11.2/oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 https://github.com/CISecurity/OVALRepo/raw/master/oval_schemas/5.11.2/oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#macos https://github.com/CISecurity/OVALRepo/raw/master/oval_schemas/5.11.2/macos-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix https://github.com/CISecurity/OVALRepo/raw/master/oval_schemas/5.11.2/unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent https://github.com/CISecurity/OVALRepo/raw/master/oval_schemas/5.11.2/independent-definitions-schema.xsd">
         <generator>
            <oval:product_name>Center for Internet Security</oval:product_name>
            <oval:schema_version>5.11.2</oval:schema_version>
            <oval:timestamp>2019-05-19T20:43:54+00:00</oval:timestamp>
         </generator>
         <definitions>
            <definition class="inventory" id="oval:org.cisecurity.benchmarks.o_apple_mac_os_x:def:101" version="42">
               <metadata>
                  <title>Apple Mac OS X 11.0 is installed</title>
                  <affected family="macos">
                     <platform>Apple Mac OS X</platform>
                  </affected>
                  <reference ref_id="cpe:/o:apple:mac_os_x:11.0" source="CPE"></reference>
                  <description>The operating system installed on the system is Apple Mac OS X 11.0.</description>
                  <oval_repository>
                     <dates>
                        <submitted date="2011-02-03T13:00:00">
                           <contributor organization="The MITRE Corporation">Dan Haynes</contributor>
                        </submitted>
                        <status_change date="2011-02-15T14:24:54.776-05:00">DRAFT</status_change>
                        <status_change date="2011-03-07T04:00:10.291-05:00">INTERIM</status_change>
                        <status_change date="2011-03-28T04:00:08.823-04:00">ACCEPTED</status_change>
                        <modified comment="EDITED oval:org.mitre.oval:def:12551 - Modifications vary from minor OVAL title/description changes to suggesting an alternative CPE name to use." date="2011-09-28T11:29:00.976-04:00">
                           <contributor organization="The MITRE Corporation">David Rothenberg</contributor>
                        </modified>
                        <status_change date="2011-09-28T11:33:32.218-04:00">INTERIM</status_change>
                        <status_change date="2011-10-17T04:00:10.456-04:00">ACCEPTED</status_change>
                     </dates>
                     <status>ACCEPTED</status>
                     <min_schema_version>5.3</min_schema_version>
                  </oval_repository>
               </metadata>
               <criteria operator="AND">
                  <criterion comment="The Installed Operating System is Part of the Mac OS Family" test_ref="oval:org.mitre.oval:tst:424761"></criterion>
                  <criterion comment="Apple Mac OS X version is less than 10.16.0" test_ref="oval:org.mitre.oval:tst:42476"></criterion>
               </criteria>
            </definition>
         </definitions>
         <tests>
            <plist_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="only_one_exists" comment="The Installed Operating System is Part of the Mac OS Family" id="oval:org.mitre.oval:tst:424761" version="2">
               <object object_ref="oval:org.mitre.oval:obj:155161"></object>
               <state state_ref="oval:org.mitre.oval:ste:116321"></state>
            </plist_test>
            <plist_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="only_one_exists" comment="Apple Mac OS X version is less than 10.16.0" id="oval:org.mitre.oval:tst:42476" version="2">
               <object object_ref="oval:org.mitre.oval:obj:15516"></object>
               <state state_ref="oval:org.mitre.oval:ste:11632"></state>
            </plist_test>
         </tests>
         <objects>
            <plist_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="The OSX product version plist object." id="oval:org.mitre.oval:obj:155161" version="1">
               <key>ProductName</key>
               <filepath>/System/Library/CoreServices/SystemVersion.plist</filepath>
            </plist_object>
            <plist_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="The OSX product version plist object." id="oval:org.mitre.oval:obj:15516" version="1">
               <key>ProductVersion</key>
               <filepath>/System/Library/CoreServices/SystemVersion.plist</filepath>
            </plist_object>
         </objects>
         <states>
            <plist_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="The value is less than '11.1.0'." id="oval:org.mitre.oval:ste:116321" version="1">
               <value datatype="string" operation="equals">macOS</value>
            </plist_state>
            <plist_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="The value is less than '11.1.0'." id="oval:org.mitre.oval:ste:11632" version="1">
               <value datatype="version" operation="less than">12.0.0</value>
            </plist_state>
         </states>
      </oval_definitions>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-cpe-dictionary" timestamp="2024-11-10T19:31:57">
      <cpe-list xmlns="http://cpe.mitre.org/dictionary/2.0" xmlns:cpe-23="http://scap.nist.gov/schema/cpe-extension/2.3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd">
         <cpe-item name="cpe:/o:apple:mac_os_x:11.0">
            <title xml:lang="en-US">Apple Mac OS X 11.0 is installed</title>
            <check href="scap_org.cisecurity_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-CPE-OVAL" system="http://oval.mitre.org/XMLSchema/oval-definitions-5">oval:org.cisecurity.benchmarks.o_apple_mac_os_x:def:101</check>
            <cpe-23:cpe23-item name="cpe:2.3:o:apple:mac_os_x:11.0.0:*:*:*:*:*:*:*"></cpe-23:cpe23-item>
         </cpe-item>
      </cpe-list>
   </ds:component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_current" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Ensure Software is up to date
# Edward Byrd		  09/21/20	 Updated script for better results
# Edward Byrd		  11/10/22	 Updated for new naming convention
# Edward Byrd		  06/18/23	 Updated for better results and to not fail if a newer major release of macOS is available
# Edward Byrd		  06/18/24	 Update to include whether the server is accessible
#

swversion=$(
(sw_vers -productVersion | cut -c1-2)
)

swversion1=$(($swversion+1))

swversion2=$(($swversion+2))

swuptodate=$(
softwareupdate -l 2&gt;&amp;1 | grep -e Version | grep -v "macOS.*$swversion1" | grep -v "macOS.*$swversion2" 2&gt; /dev/null
)

swupresponse=$(
softwareupdate -l 2&gt;&amp;1 | grep -c "Didnt get a response from the Apple Software Update server." 
)

if [ "$swuptodate" == "" ] &amp;&amp; [ $swupresponse = 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: There are no updates available"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: There are available updates that need to be installed or the software update servers cannot be reached"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_update" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that OS auto updates
# Edward Byrd		  06/19/23	 Update to echo why it failed
# Edward Byrd		  10/22/24	 Added version check for macOS 15
#

autoupdate=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticCheckEnabled').js
EOS
)

macOSversion=$(
/usr/bin/sw_vers | /usr/bin/grep ProductVersion | awk '{s+=$2} END {print s}' | cut -c1-2
)

if [ "$autoupdate" == "true" ] || [ $macOSversion -ge 15 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Updates are being checked automatically"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Updates are not being checked automatically"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_auto_download" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that OS updates automatically download
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

downloadupdates=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticDownload').js
EOS
)


if [ "$downloadupdates" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Updates are being automatically downloaded"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Updates are not being downloaded automatically"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_appstore_install" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that App Store applications install automatically
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

appstoreupdate=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.commerce')\
  .objectForKey('AutoUpdate'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
  .objectForKey('AutomaticallyInstallAppUpdates'))
  if ( pref1 == 1 || pref2 == 1 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)


if [ "$appstoreupdate" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: App Store updates are being automatically installed"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: App Store updates are not being installed automatically"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_system_download" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that security and system files automatically download
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

securityupdate=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
  .objectForKey('ConfigDataInstall'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
  .objectForKey('CriticalUpdateInstall'))
  if ( pref1 == 1 &amp;&amp; pref2 == 1 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)


if [ "$securityupdate" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Security updates are being automatically installed"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Security updates are not being installed automatically"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_update_os" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that OS updates automatically download
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

updateenabled=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticallyInstallMacOSUpdates').js
EOS
)


if [ "$updateenabled" = true ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Updates are being automatically installed"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Updates are not being installed automatically"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_software_update_deferment" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         07/10/20   Ensure software updates are not deferred
# Edward Byrd		  10/31/22	 Update name and new audit that is more accurate
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

softwaredeferment=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('enforcedSoftwareUpdateDelay'))
  if ( pref1  == null ) {
    return("true")
  }  else if ( pref1 &lt;= 30 ) {
    return("true")
  }  else {
    return("false")
  }
}
EOS
)


if [ "$softwaredeferment" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Updates are either not deffered or are deffered for 30 days or less"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Updates are being deferred for greater than 30 days"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_bluetooth_menu" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name       		Date       Description
# -------------------------------------------------------------------
# Edward Byrd  		02/13/21   Check if Bluetooth is in the Menubar
#

UUID=$(ioreg -rd1 -c IOPlatformExpertDevice | grep "IOPlatformUUID" | sed -e 's/^.* "\(.*\)"$/\1/')

for DIR in $(find /Users -type d -maxdepth 1); do
	PREF=$DIR/Library/Preferences/ByHost/com.apple.controlcenter.$UUID
	if [ -e $PREF.plist ]; then
		BTMenu=$(defaults read $PREF.plist Bluetooth 2&gt;&amp;1)
		if [ $BTMenu -ne 18 ]&amp;&amp; echo $BTMenu; then
			[ -z "$output" ] &amp;&amp; output="User: \"$DIR\" does not have Bluetooth in their menu bar" 
		fi
	fi
done

# If test passed, then no output would be generated. If so, we pass
if [ -z "$output" ] ; then
	echo "PASSED: All users have Bluetooth in the Menu Bar"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following users' do not have Bluetooth in their Menu Bar"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_wifi_menu" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name		       Date       Description
# -------------------------------------------------------------------
# Edward Byrd 	 02/25/21   Check WiFi in the Menu Bar
# Edward Byrd 	 11/10/22   Updated Audit
#

UUID=$(ioreg -rd1 -c IOPlatformExpertDevice | grep "IOPlatformUUID" | sed -e 's/^.* "\(.*\)"$/\1/')

wifiprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.controlcenter')\
.objectForKey('WiFi').js
EOS
)

if [ "$wifiprofile" == "18" ]; then
	echo "PASSED: Profile installed to enable the WiFi status in the menu bar"
    exit "${XCCDF_RESULT_PASS:-101}"
else
	for DIR in $(find /Users -type d -maxdepth 1); do
	PREF=$DIR/Library/Preferences/ByHost/com.apple.controlcenter.$UUID
	if [ -e $PREF.plist ]; then
		WiFiMenu=$(defaults read $PREF.plist WiFi 2&gt;&amp;1)
		if [ "$WiFiMenu" -ne "18" ]; then
			[ -z "$output" ] &amp;&amp; output="User: \"$DIR\" does not have WiFi status in their menu bar" 
		fi
	fi
done

# If test passed, then no output would be generated. If so, we pass
if [ -z "$output" ] ; then
	echo "PASSED: All users have the WiFi status in the Menu Bar"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following user(s) do not have the WiFi status in their Menu Bar"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_set_auto" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Ensure Date and Time are set automatically
# 

autotime=$(
systemsetup -getusingnetworktime
)

if [ "$autotime"  == "Network Time: On" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_time_server_sync" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/02/22	 Check the time server is synchronized
# Edward Byrd		  06/26/23	 Update to echo why it failed
#

timesync=$(
/usr/bin/sntp $(/usr/sbin/systemsetup -getnetworktimeserver | /usr/bin/awk '{print $4}') | /usr/bin/awk -F'.' '/\+\/\-/{if (substr($1,2) &gt;= 270) {print "No"} else {print "Yes"}}'
)


if [ "$timesync" == "Yes" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: The time server sync is within appropriate limits"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The time server is not in sync withing 270 seconds"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_screen_saver_inactivity" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name       Date       Description
# -------------------------------------------------------------------
# E. Pinnell  		  09/15/20   Set an inactivity interval of 20 minutes or less for the screen saver
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/06/23	 Update to echo why it failed and removed the individual user check
#

screensaverinterval=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)



if [ "$screensaverinterval" == "true" ]; then
  output=True
else
  output=False
fi


# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: A profile is installed that sets the screen saver to have an inactivity interval of 20 minutes or less"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Install a profile that sets the screen saver interval to 20 minutes or less"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi





</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_corners" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name       Date       Description
# -------------------------------------------------------------------
# Edward Byrd 11/08/22   Ensure Screen Saver Corners Are Secure
#


for DIR in $(find /Users -type d -maxdepth 1); do
	PREF=$DIR/Library/Preferences/com.apple.dock
	if [ -e $PREF.plist ]; then
		hotcorner=$(defaults read $PREF.plist 2&gt;&amp;1 | grep corner | cut -b 25-26 | grep -c "6;")
		if [ $hotcorner -ne 0 ]; then
			[ -z "$output" ] &amp;&amp; output="User: \"$DIR\" can disable the screen saver with a hot corner"
		fi
	fi
done

# If test passed, then no output would be generated. If so, we pass
if [ -z "$output" ] ; then
	echo "PASSED: All users' hot corners are secure"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following users' need their hot corners secured"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_apple_events" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Ensure Remote Apple Events Is Disabled
# 

eventsoff=$(
systemsetup -getremoteappleevents
)

if [ "$eventsoff"  == "Remote Apple Events: Off" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_internet_sharing" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         06/14/22   Disable Internet Sharing
# Edward Byrd		  11/02/22	 Updated name of the script and added profile check
# Edward Byrd		  06/27/23	 Update to echo why it failed
#

internetshare=$(
defaults read /Library/Preferences/SystemConfiguration/com.apple.nat 2&gt;&amp;1 | grep -c "Enabled = 1;"
)

internetshareprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('forceInternetSharingOff').js
EOS
)

if [ "$internetshareprofile" = "true"  ] ; then
	echo "$PASSED: A profile that disables Internet sharing is installed"
    exit "${XCCDF_RESULT_PASS:-101}"	
elif [ $internetshare -eq 0  ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Internet sharing is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile that disables internet sharing needs to be installed or the internet sharing daemon needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_screen_sharing" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         01/07/21   Ensure screen sharing is disabled
# 

screenshare=$(
launchctl print-disabled system | grep -c '"com.apple.screensharing" =&gt; true'
)


if [ $screenshare -eq 1   ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_print_sharing" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/01/20   Disable Print Sharing
# Edward Byrd         01/07/21   Updated with new check
# Edward Byrd		  11/02/22	 Updated name of the script to conform to other sce
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

printshare=$(
cupsctl | grep _share_printers | cut -d'=' -f2
)

if [ $printshare -eq 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Printer sharing is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The printer sharing (CUPS) daemon needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_remote_login" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Ensure Remote Login Is Disabled
# 

sshoff=$(
systemsetup -getremotelogin
)

if [ "$sshoff"  == "Remote Login: Off" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_dvd_cd_share" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/21/20   Disable DVD or CD Sharing
# Edward Byrd         02/25/21   Updated with new commands
# 

dvdshare=$(
launchctl print-disabled system  | grep -c '"com.apple.ODSAgent" =&gt; true'
)

if [ $dvdshare -eq 1 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bluetooth_sharing" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh
  
#
# CIS-CAT Script Check Engine
#
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         05/12/21   2.4.7 - Disable Bluetooth Sharing
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd		  11/03/22	 Updated the check and updated the name to match new sce name
#


UUID=$(ioreg -rd1 -c IOPlatformExpertDevice | grep "IOPlatformUUID" | sed -e 's/^.* "\(.*\)"$/\1/')

for DIR in $(find /Users -type d -maxdepth 1); do
        PREF=$DIR/Library/Preferences/ByHost/com.apple.Bluetooth.$UUID
        if [ -e $PREF.plist ]; then
                BTSharing=$(defaults read $PREF.plist PrefKeyServicesEnabled 2&gt;&amp;1)
                if [ -n "$BTSharing" ]; then
	                if [ "$BTSharing" -eq "1" ]; then
    	                    [ -z "$output" ] &amp;&amp; output="User: \"$DIR\" has Bluetooth Sharing Enabled"
        	        fi
				fi
        fi
done

# If test passed, then no output would be generated. If so, we pass
if [ -z "$output" ] ; then
        echo "PASSED: All users have Bluetooth Sharing Disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following user(s) have Bluetooth Sharing Enabled:"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_file_share" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         01/07/21   Ensure screen sharing is disabled
# Edward Byrd		  11/02/22	 Updated for to remove AFP and update name
# Edward Byrd		  06/27/23	 Update to echo why it failed
# 

smbshare=$(
/bin/launchctl list | grep -c "com.apple.smbd"
)


if [ $smbshare -eq 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: File sharing is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The file sharing daemon needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ard_agent" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Disable Remote Management
# Edward Byrd		  09/21/20	 Update to system call
# Edward Byrd		  11/02/22	 Updated name of the script to conform to other sce and more specific check
# Edward Byrd		  06/27/23	 Update to echo why it failed

ardagent=$(
ps -ef | awk '/ARDAgent/ {print $8}' | head -1 | grep -c "/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent"

)


if [ $ardagent == 0 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Remote Management is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The Remote Management daemon needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_content_caching" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/03/22	 Check that content caching is disabled
# Edward Byrd		  06/27/23	 Update to echo why it failed
#

contentcache=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.AssetCache')\
  .objectForKey('Activated'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('allowContentCaching'))
  if ( ( pref1 == 0 ) || ( pref2 == 0 ) ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)


if [ "$contentcache" == "true" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Content caching is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Content caching needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_airdrop_disabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that airdrop is disabled
# Edward Byrd		  06/21/23	 Update to echo why it failed and removed individual user check
#

airdropoff=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAirDrop').js
EOS
)


if [ "$airdropoff" == "false" ]; then
  output=True
else
  output=False
fi

	# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: A profile is installed that disables Airdrop"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that disables Airdrop"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_media_sharing" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/03/22	 Check that media sharing is disabled
# Edward Byrd		  06/27/23	 Update to echo why it failed
# Edward Byrd		  10/22/24	 Added version check for new Sequoia updates
#

mediasharing=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\
  .objectForKey('homeSharingUIStatus'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\
  .objectForKey('legacySharingUIStatus'))
  let pref3 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.preferences.sharing.SharingPrefsExtension')\
  .objectForKey('mediaSharingUIStatus'))
  if ( pref1 == 0 &amp;&amp; pref2 == 0 &amp;&amp; pref3 == 0 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

mediasharingnew=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('allowMediaSharing'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('allowMediaSharingModification'))
  if ( pref1 == 0 &amp;&amp; pref2 == 0 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

macOSversion=$(
/usr/bin/sw_vers | /usr/bin/grep ProductVersion | awk '{s+=$2} END {print s}' | cut -c1-2
)


if [ $macOSversion -ge 15 ] &amp;&amp; [ "$mediasharingnew" == "true" ]; then
  output=True
elif [ $macOSversion -lt 15 ] &amp;&amp; [ "$mediasharing" == "true" ]; then
  output=True
else
  output=False
fi

	# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: A profile is installed that disabled media sharing"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that disabled media sharing"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_fdesetup_status" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Ensure FireVault is enabled
# Edward Byrd		  06/14/22	 Updated for profile check
# Edward Byrd		  11/08/22	 Updated to new audit check
#

filevaultstatus=$(
fdesetup status
)

filevaultprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('dontAllowFDEDisable').js
EOS
)

# If result returns it is enabled pass, otherwise fail.
if [ "$filevaultstatus" == "FileVault is On." ] &amp;&amp; [ "$filevaultprofile" == "true" ]; then
	echo "FileVault is enabled and cannot be disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FileVault is disabled or can be disabled"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_enable" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that firewall is enabled
# Edward Byrd		  06/23/23	 Update to echo why it failed
# Edward Byrd		  10/21/24	 Added binary check for the binary for macOS 15 and forward
#

#firewall=$(
#/usr/bin/osascript -l JavaScript &lt;&lt; EOS
#function run() {
#    app = Application.currentApplication()
#    app.includeStandardAdditions = true;#
#
#    
#  let pref1 = app.doShellScript('/usr/bin/defaults read /Library/Preferences/com.apple.alf globalstate 2&amp;&gt;1')
#  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
#  .objectForKey('EnableFirewall'))
#  
#    if ( ( ( pref1 == 1 ) || ( pref1 == 2 ) || ( pref2 == "true" ) ) &amp;&amp; (pref1 != 0 ) ) {
#    return("true")
#  } else {
#    return("false")
#  }
#
#}
#EOS
#)

firewall=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.firewall')\
.objectForKey('EnableFirewall').js
EOS
)

firewallbinary=$(
/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate | grep -c "Firewall is enabled"
)

firewallplist=$(
/usr/bin/defaults read /Library/Preferences/com.apple.alf globalstate 2&amp;&gt;1
)

if [ "$firewall" == "true" ] &amp;&amp; [ $firewallplist = 1 ]; then
  output=True
elif [ "$firewall" == "true" ] &amp;&amp; [ $firewallplist = 2 ]; then
  output=True
elif [ $firewallbinary = 1 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: The firewall is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The firewall is not enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_stealth" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that firewall is enabled
# Edward Byrd		  06/19/23	 Update to echo why it failed
# Edward Byrd		  10/21/24	 Added binary check for the binary for macOS 15 and forward
#

firewallstealth=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.alf')\
  .objectForKey('stealthenabled'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
  .objectForKey('EnableStealthMode'))
  if ( ( pref1 == 1 ) || ( pref2 == "true" ) ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

firewallstealthbinary=$(
/usr/libexec/ApplicationFirewall/socketfilterfw --getstealthmode | grep -c "Firewall stealth mode is on"
)


if [ "$firewallstealth" == "true" ] || [ $firewallstealthbinary = 1 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: Firewall stealth mode is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Firewall stealth mode is not enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_location_services" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/08/20   Ensure Location Services is enabled
# Edward Byrd         10/22/21   Update Check
# Edward Byrd         06/22/22   Update for plist check
# Edward Byrd         06/22/22   Update script name and plist check
# Edward Byrd		  06/27/23	 Update to echo why it failed
# 

locationservice=$(
launchctl list | grep -c com.apple.locationd
)

locationplist=$(
defaults read /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled
)


if [ $locationservice == 1 ] &amp;&amp; [ "$locationplist" == "1" ] ; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Location services are enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Location services are disabled and need to be started"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi



</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_diagnostic_data" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/08/22	 Check if diagnostic data is being sent to Apple
# Edward Byrd		  06/27/23	 Update to echo why it failed and remove individual user check
# Edward Byrd		  06/18/24	 Update to include cloud tailored benchmark check
#

diagnosticprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
let pref1 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SubmitDiagInfo')\
.objectForKey('AutoSubmit').js
let pref2 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowDiagnosticSubmission').js
let pref3 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.assistant.support')\
.objectForKey('Siri Data Sharing Opt-In Status').js

if ( pref1 == false &amp;&amp; pref2 == false &amp;&amp; pref3 == 2){
    return("true")
} else {
    return("false")
}
}
EOS
)

diagnosticcloud1=$(
/usr/bin/defaults read /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist AutoSubmit
)

diagnosticcloud2=$(
/usr/bin/defaults read /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist ThirdPartyDataSubmit
)

if [ "$diagnosticprofile" = true ]; then
  output=True
elif	[ "$diagnosticcloud1" = "0" ] &amp;&amp; [ "$diagnosticcloud2" = "0" ]; then
  output=AlsoTrue
else
  output=False
fi

	# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to disable sending diagnostic data to Apple"
    exit "${XCCDF_RESULT_PASS:-101}"
elif [ "$output" = AlsoTrue ] ; then
	echo "PASSED: Diagnostic is disabled through Terminal"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Data and diagnostic data is being sent to Apple"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_limit_ad_tracking" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name		       Date       Description
# -------------------------------------------------------------------
# Edward Byrd 	 	  11/08/22   Check if Limit Ad Tracking is enabled
# Edward Byrd		  06/27/23	 Update to echo why it failed and removed the individual user check
#

adprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowApplePersonalizedAdvertising').js
EOS)

if [ "$adprofile" = false ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: A profile is installed that limits ad tracking"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: FAILED: A profile needs to be installed that limits ad tracking"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_gatekeeper_enabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Ensure Gatekeeper Is Enabled
# 

gatekeeperon=$(
spctl --status
)

if [ "$gatekeeperon"  == "assessments enabled" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_message" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/08/22	 Check a login message is set
# Edward Byrd		  07/06/23	 Update to echo why it failed
#

loginmessage=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS
)


if [ "$loginmessage" == "" ]; then
  output=False
else
  output=True
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: A message is set for the login screen"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A message on the login screen needs to be set and enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_password_required" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         10/15/20   Ensure that an administrator password is required to access system-wide prefernces
# Edward Byrd         11/08/22   Updated for the new naming
# 

adminpass=$(
security authorizationdb read system.preferences 2&gt; /dev/null | grep -A1 shared | grep false 
)

if [ $adminpass -n ] ; then
  output=False
else
  output=True
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_password" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/08/22	 Check that a password is required to wake the computer
# Edward Byrd		  07/06/23	 Update to echo why it failed 
#

adminpasswordprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
  .objectForKey('askForPassword'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
  .objectForKey('askForPasswordDelay'))
  if ( pref1 == 1 &amp;&amp; pref2 &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

if [ "$adminpasswordprofile" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: A password is required to wake the OS from sleep or screen saver either immediately or after 5 seconds"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A password is not required to wake the OS from sleep or screen saver, or it is greater than 5 seconds, and it needs to be set to the correct value"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_icloud_docs_desktop" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  10/31/22	 Check that iCloud Desktop and Documents is disabled
# Edward Byrd		  06/19/23	 Update to echo why it failed
#

iclouddocs=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('allowCloudDesktopAndDocuments'))
  if ( pref1  == false ) {
    return("true")
  }  else if ( pref1 == null ) {
    return("false")
  }  else {
    return("false")
  }
}
EOS
)


if [ "$iclouddocs" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" = True ] ; then
	echo "PASSED: iCloud is not syncing desktops and documents"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that disables iCloud Drive Desktop and Document syncing"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_autobackup" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/03/22	 Check that if Time Machine is enabled then auto back is enabled
# Edward Byrd		  06/27/23	 Update to echo why it failed
#

autotimemachine=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.TimeMachine')\
  .objectForKey('AutoBackup'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.TimeMachine')\
  .objectForKey('LastDestinationID'))
  if ( pref2  == null ) {
    return("Preference Not Set")
  }  else if ( pref1 == 1 ) {
    return("true")
  }  else {
    return("false")
  }
}
EOS
)


if [ "$autotimemachine" == "Preference Not Set" ]; then
	echo "Time Machine is not enabled so the computer is compliant"
    exit "${XCCDF_RESULT_PASS:-101}"
else if [ "$autotimemachine" == "true" ]; then
  output=True
else
  output=False
fi
fi

	# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Time Machine is either disabled or if it is enabled has automatic backups enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Time Machine is enabled but does not have auto backup enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_timemachine_encrypted" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Ensure Time Machine Volumes Are Encrypted
# Eric Pinnell        04/23/20   Correct test error
# Edward Byrd		  05/12/21	 Added Verification of Time Machine Being Enabled Plus updated Check for Status
# Edward Byrd		  10/21/21   Fixed typo in the command to resolve errors 
# Edward Byrd		  10/21/21   Added Check for FileVault flag 
# Edward Byrd		  11/03/22	 Updated the check the script name
#

timemachineencrypted=$(
defaults read /Library/Preferences/com.apple.TimeMachine.plist | grep -c NotEncrypted
)


# If results returns pass, otherwise fail.
if [ $timemachineencrypted == 0 ] ; then
	echo "Passed: Time Machine Backup is Encrypted or Time Machine is not Enabled"
	exit "${XCCDF_RESULT_PASS:-101}"
else
# print the reason why we are failing
	echo "Failed: Time Machine Backup is Not Encrypted"
	exit "${XCCDF_RESULT_FAIL:-102}"
fi
#echo "$output"
#exit "${XCCDF_RESULT_PASS:-101}"
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_wake_on_lan" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         08/31/20   Ensure system is set to to wake on LAN or use Power Nap
# Edward Byrd		  10/08/20   Forked from osx_wakenap.sh for 10.14 and 10.15 1.1.0 benchmarks due to power nap and wake on LAN being separate recommendations
# Edward Byrd		  06/15/22	 Added support for profiles
# Edward Byrd         11/08/22   Updated for the new naming
# Edward Byrd		  07/06/23	 Update to echo why it failed and updated audit
#

wakelan=$(
pmset -g custom | /usr/bin/grep womp | awk '{print$2}'
)

wakelanprofile=$(
profiles -P -o stdout | /usr/bin/grep -c '"Wake On LAN" = 0'
)

wakemodemprofile=$(
profiles -P -o stdout | /usr/bin/grep -c '"Wake On Modem Ring" = 0'
)


if [ $wakelanprofile -ge 1 ] &amp;&amp; [ $wakemodemprofile -ge 1 ]; then
  output=True
elif [ $wakelan == 1 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Wake on lan has been disabled or has a profile installed that disables it."
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Wake on lan us enabled and needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_powernap" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         08/31/20   Ensure system is set to to wake on LAN or use Power Nap
# Edward Byrd		  10/08/20   Forked from osx_wakenap.sh for 10.14 and 10.15 1.1.0 benchmarks due to power nap and wake on LAN being separate recommendations
# Edward Byrd		  06/15/22   Added check for processor
# Edward Byrd         11/08/22   Updated for the new naming
# Edward Byrd		  07/05/23	 Update to echo why it failed AND UPDATE THE AUDIT
#

processor=$(
sysctl -n machdep.cpu.brand_string | grep -c "Intel"
)

pnap=$(
pmset -g custom | /usr/bin/grep -c " powernap             1"
)

if [ $processor -eq 0 ] ; then
  echo "This recommendation is not applicable since the computer does not have an Intel processor" &amp;&amp; output=True
elif [ $pnap -eq 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Powernap is enabled and needs to be disabled"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_hibernate_standby" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Ensure system is set to hibernate
# Edward Byrd		  09/18/20   Forked from osx_standbydelay.sh to check 10.13 and earlier versions of macOS
# Edward Byrd		  09/18/20   Forked from osx_standbydelay.sh to check for delay as well as hibernate mode
# Edward Byrd		  06/14/22	 Updated for Apple Silicon Processor
# Edward Byrd         11/08/22   Updated for the new naming and updated Apple Silicon check
#

passing=""

processor=$(
sysctl -n machdep.cpu.brand_string | grep -c "Intel"
)

standby=$(
pmset -g | grep -e standby | awk '{print $2}'
)

standbydelay=$(
pmset -g | grep -e standbydelay | awk '{print $2}'
)

standbydelaylow=$(
pmset -g | grep -e standbydelaylow | awk '{print $2}'
)

standbydelayhigh=$(
pmset -g | grep -e standbydelayhigh | awk '{print $2}'
)

hibernatemode=$(
pmset -g | grep -c 'hibernatemode        25'
)

destroykey=$(
pmset -g | grep -c 'DestroyFVKeyOnStandby            1'
)

hardwaretype=$(
system_profiler SPHardwareDataType | awk '/MacBook/ {print $3}' | head -1
)

if [ -z $hardwaretype ] ; then
	output="Not a Portable" &amp;&amp; passing=true &amp;&amp; echo $hardwaretype
elif [ $processor == 0 ] &amp;&amp; [ $standby -le 900 ] &amp;&amp; [ $hibernatemode -eq 1 ] &amp;&amp; [ $destroykey -eq 1 ] || [ $processor == 0 ] &amp;&amp; [ $standby -le 900 ] &amp;&amp; [ $hibernatemode -eq 1 ] &amp;&amp; [ $destroykey -eq 1 ]; then
	passing=true
fi

# If result contains string pass, otherwise fail.
if [ "$passing" = true ] ; then
	echo "Passed: \"$output\""
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "Failed: \"$output\""
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_efi_valid" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Ensure EFI version is valid and being regularly checked
# Eric Pinnell        04/22/20   Update to exclude systems where no check is required
# Edward Byrd		  06/14/22	 Update to exclude Apple Silicon
# Edward Byrd 		  11/08/22   Updated for the new naming
# 

passing=""

processor=$(
sysctl -n machdep.cpu.brand_string | grep -c "Intel"
)

daemoneunning=$(
launchctl list | grep -c com.apple.driver.eficheck 
)


if [ $processor == 0 ] ; then
	output=$(sysctl -n machdep.cpu.brand_string) &amp;&amp; passing=true
elif [ -n "$(system_profiler SPiBridgeDataType)" ] ; then
	output=$(system_profiler SPiBridgeDataType | awk -F: '/Model Name/ {print $NF}' | sed 's/^ *//')
	system_profiler SPiBridgeDataType | grep -q 'Apple T2 Security Chip' &amp;&amp; passing=true
elif [ $daemoneunning == 0 ]; then
	output=$(EFI check daemon is not running) launchctl list | grep -c com.apple.driver.eficheck 
elif command -v /usr/libexec/firmwarecheckers/eficheck/eficheck ; then
	output=$(/usr/libexec/firmwarecheckers/eficheck/eficheck --integrity-check |  awk 'NR==2') 
	/usr/libexec/firmwarecheckers/eficheck/eficheck --integrity-check | grep -q 'No changes detected in primary hashes' &amp;&amp; passing=true
else
	output="Command not found or efi check failed"
fi

# If result contains string pass, otherwise fail.
if [ "$passing" = true ] ; then
	echo "Passed: \"$output\""
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "Failed: \"$output\""
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_security_audit" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/21/20   Enable Security Audit
# Edward Byrd         10/22/21   Update Check
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  06/27/23	 Updated the output
#

securityaudit=$(
launchctl list | grep -c auditd
)

if [ $securityaudit == 1 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Security auditing is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    echo "FAILED: Security auditing is disabled and the service needs to be loaded"    
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_flags" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/17/20   Security Audit has flags configured
# Edward Byrd		  01/20/21	 Updated with updated flags
# Edward Byrd		  10/25/21	 Updated with updated flags
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  06/27/23	 Updated the output
#

flagfm=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "fm"
) &amp;&amp;

flagad=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "ad"
)

flagex=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "ex"
)

flagaa=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "aa"
)

flagfr=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "fr"
)

flaglo=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "lo"
)

flagfw=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "fw"
)


flagall=$(
grep -e "^flags:" /etc/security/audit_control | grep -v "all"
)

if [ "$flagfm" == "" ] &amp;&amp; [ "$flagad" == "" ] &amp;&amp;  [ "$flagaa" == "" ] &amp;&amp; [ "$flaglo" == "" ] &amp;&amp; [ "$flagex" == "" ] &amp;&amp; [ "$flagfr" == "" ] &amp;&amp; [ "$flagfw" == "" ]; then
  output=True
elif [ "$flagad" == "" ] &amp;&amp;  [ "$flagaa" == "" ]  &amp;&amp;  [ "$flaglo" == "" ] &amp;&amp; [ "$flagall" == "" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Audit flags are correctly set"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Audit flags are incorrectly set and need to be modified"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_retain_install_log" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Retain install.log for 365 or more days
# Eric Pinnell        04/23/20   Corrected test
# Edward Byrd		  10/21/20	 Forked from osx_365_install_log.sh to also check for no maximum
# Edward Byrd 		  11/08/22   Updated for the new naming
#

output=$(grep -i ttl /etc/asl/com.apple.install)
grep -Eq '^\s*\*\s+file\s+\/var\/log\/install.log\s+([^#]+\s+)*ttl=(36[5-9]|3[7-9][0-9]|[4-9][0-9][0-9]|[[1-9][0-9]{3,})\b(\s*\S+\s*)*(\s+#.*)?$' /etc/asl/com.apple.install &amp;&amp; passing=true

anymax=$(grep -i all_max= /etc/asl/com.apple.install)

# If results returns pass, otherwise fail.
if [ "$passing" = "true" ] &amp;&amp; [ $anymax -n ]; then
	echo "Passed: \"$output\""
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "Failed: \"$output\""
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_retention" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Ensure security auditing retention
# Eric Pinnell        04/22/20   Modified to include regex for ge and case insensitive
# Edward Byrd		  05/13/22	 Updated to reflect current recommendation options
# Edward Byrd 		  11/08/22   Updated for the new naming
# 

output=$(
grep expire-after /etc/security/audit_control
)

passing=""

grep -Eiq '\s*expire-after:([6-9][0-9]|[1-9][0-9]{2,})D\b' /etc/security/audit_control &amp;&amp; passing=true
grep -Eiq '\s*expire-after:([5-9]|[1-9][0-9]+)G\b' /etc/security/audit_control &amp;&amp; passing=true
grep -Eiq '\s*expire-after:(10[2-9][4-9]|10[3-9][0-9]|[1-9][1-9][0-9]{2,}|[1-9][0-9]{4,})M\b' /etc/security/audit_control &amp;&amp; passing=true

# If either result returns pass, otherwise fail.
if [ "$passing" = true ] ; then
	echo "Passed: \"$output\""
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "Failed: \"$output\""
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_audit_record_access" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  09/18/20   Check audit record access
# Edward Byrd		  03/05/21   Updated to include file check
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  06/27/23	 Updated the output
# Edward Byrd		  10/22/24	 Audit updated to match benchmark
# 


controlowner=$(
/bin/ls -n /etc/security/audit_control | /usr/bin/awk '{s+=$3} END {print s}'
)

controlgroup=$(
/bin/ls -n /etc/security/audit_control | /usr/bin/awk '{s+=$4} END {print s}'
)

controlaccess=$(
/bin/ls -n /etc/security/audit_control | /usr/bin/awk '!/-r--r-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
)

auditowner=$(
/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$3} END {print s}'
)

auditgroup=$(
/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$4} END {print s}'
)

auditfilesaccess=$(
/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '!/-r--r-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
)

if [ $controlowner = 0 ] &amp;&amp; [ $controlgroup = 0 ] &amp;&amp; [ $auditowner = 0 ] &amp;&amp; [ $auditgroup = 0 ] &amp;&amp; [ $auditfilesaccess = 0 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Controlled access to audit records is correctly set"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Some files have the incorrect permissions"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_firewall_logging" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         11/08/22   Check that firewall logging is enabled
# Edward Byrd		  07/07/23	 Updated the output
#

firewalllogging=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
  .objectForKey('EnableLogging').js
  let pref2 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
  .objectForKey('LoggingOption').js
  let pref3 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.alf')\
  .objectForKey('loggingenabled').js
  let pref4 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.alf')\
  .objectForKey('loggingoption').js
  if ( ( pref1 == true &amp;&amp; pref2 == "detail" ) || ( pref3 == 1 &amp;&amp; pref4 == 2 ) ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

if [ "$firewalllogging" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Firewall logging and the detail log option are enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Firewall logging or the deteil log option is not enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_bonjour_services" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         11/08/22   Check Bonjour Advertising
# Edward Byrd		  07/07/23	 Updated the output
#

bonjourservice=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.mDNSResponder')\
.objectForKey('NoMulticastAdvertisements').js
EOS)

if [ "$bonjourservice" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The bonjour service is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The bonjour service needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_httpd_disabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  01/19/20   Updated to check versus newest audit

httpd=$(
launchctl print-disabled system | /usr/bin/grep -c '"org.apache.httpd" =&gt; true'
)

if [ $httpd -eq 1 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptosx_nfs_server_disabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         01/20/21   Verifying status of nfs server and /etc/exports
#

nfsstatus=$(
launchctl print-disabled system | grep -c '"com.apple.nfsd" =&gt; true'
)

exportsexist=$(
ls /etc/exports 2&gt;/dev/null
)


if [ $nfsstatus -eq 1 ] &amp;&amp; [ $exportsexist -n ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_secure_homefolder" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh
  
#
# CIS-CAT Script Check Engine
#
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/23/20   Secure Home Folders
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Updated the output and audit
# Edward Byrd		  10/22/24	 Updated audit check
#

securehome=$(
/usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \( -perm 700 -o -perm 711 \) | /usr/bin/grep -v "Shared" | /usr/bin/grep -v "Guest" | /usr/bin/wc -l | /usr/bin/xargs
)

if [ $securehome = 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Home folders are secure"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following home folders are not secure:"
    echo "$securehome"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sip_enabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/04/20   Ensure Integrity Protection is enabled
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Updated the output
# 

sip=$(
csrutil status
)

if [ "$sip" == "System Integrity Protection status: enabled." ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: System Integrity Protection is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: System Integrity Protection is disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_amfi_enabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         10/20/21   Ensure Apple Mobile File Integrity Is Enabled
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Updated the output
# 

amfienabled=$(
/usr/sbin/nvram -p | /usr/bin/grep -c "amfi_get_out_of_my_way=1"
)

if [ $amfienabled == 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Apple Mobile File Integrity is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Apple Mobile File Integrity is disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_ssv_enabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         01/20/20   Ensure  Sealed System Volume is enabled
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Updated the output
# 

ssv=$(
/usr/bin/csrutil authenticated-root status | grep -c 'Authenticated Root status: enabled'
)

if [ "$ssv" -eq 1 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Sealed System Volume is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Sealed System Volume is disabled and the system should wiped after backing up and files"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_application_permissions" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/16/20   Applications have appropriate permissions
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Updated the output and audit
# 

apppermission=$(
/usr/bin/find /Applications -iname "*\.app" -type d -perm -2 -ls | /usr/bin/grep -v Xcode.app | /usr/bin/wc -l | /usr/bin/xargs
)

failedapplications=$(
/usr/bin/find /Applications -iname "*\.app" -type d -perm -2 -ls | /usr/bin/awk '{print$11}'
)

if [ $apppermission == 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: All applicable applications have appropriate permissions"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following applications need their permissions verified:"
    echo "$failedapplications"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_system_world_writable" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/16/20   Folders in /System have appropriate permissions
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# 

systemwrite=$(
/usr/bin/find /System/Volumes/Data/System -type d -perm -2 -ls | /usr/bin/grep -vE "downloadDir|locks" | /usr/bin/wc -l | /usr/bin/xargs
)

failedsystemfiles=$(
/usr/bin/find /System/Volumes/Data/System -type d -perm -2 -ls | /usr/bin/grep -vE "downloadDir|locks" | /usr/bin/awk '{print$11}'
)


if [ $systemwrite == 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: There are no world writable folders in the System folder"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
	echo "Failed: The following folders are world writable and need to be addressed:"
	echo "$failedsystemfiles"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_library_world_writable" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/16/20   Folders in /System have appropriate permissions
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# 

librarywrite=$(
/usr/bin/find /System/Volumes/Data/Library -type d -perm -2 -ls | /usr/bin/grep -v Caches | /usr/bin/grep -v /Preferences/Audio/Data | /usr/bin/wc -l | /usr/bin/xargs
)

failedlibraryfiles=$(
/usr/bin/find /System/Volumes/Data/Library -type d -perm -2 -ls | /usr/bin/grep -v Caches | /usr/bin/grep -v /Preferences/Audio/Data | /usr/bin/awk '{print$11}'
)

if [ $librarywrite == 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: There are no world writable files in the Library folder"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
	echo "Failed: The following folders are world writable and need to be addressed:"
	echo "$failedlibraryfiles"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_max_fail" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/02/20   Ensure system is set to require 5 or lower failed logins
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output and audit
# Edward Byrd		  10/22/24	 Removed lockout time due to Apple's implementation no longer working correctly
# 


pwprofilemax=$(
/usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' -
)

if [ $pwprofilemax -le 5 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy for maximum amount of attempts and lockout time is set correctly"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy maximum amount of attempts is \"$pwprofilemax\" which is greater than the 5 allowable attempts or teh lockout time is set to less than 15 minutes"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_min_length" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/02/20   Ensure system is set to require passwords of at least 15 characters
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output
#

pwminlength=$(
/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -e "policyAttributePassword matches" | /usr/bin/cut -b 46-53 | /usr/bin/cut -d',' -f1 | /usr/bin/cut -d'{' -f2 |  head -1
)

if [ $pwminlength -ge 15 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The pasword policy minimum length is set correctly"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy minimum length is \"$pwminlength\" which is less than the minimum allowable of 15"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_alpha_character" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/02/20   Ensure system is set to require at least one alphabetical character in passwords
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output
# 

pwminalpha=$(
pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -e "Contain at least one number and one alphabetic character." | cut -b 13-68) &amp;&amp; pref2=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumLetters | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; if [ "$pref1" = "Contain at least one number and one alphabetic character" ]; then echo "true"; elif [[ "$pref2" != "" &amp;&amp; pref2 -ge 1 ]]; then echo "true"; else echo "false"; fi
)


if [ "$pwminalpha" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy requires at least 1 alphabetic character"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy does not require at least 1 alphabetic character"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_numeric_character" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/02/20   Ensure system is set to require at least one numeric character in passwords
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output
# 

pwminnum=$(
pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -e "Contain at least one number and one alphabetic character." | cut -b 13-68) &amp;&amp; pref2=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumNumericCharacters | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; if [ "$pref1" = "Contain at least one number and one alphabetic character" ]; then echo "true"; elif [[ "$pref2" != "" &amp;&amp; pref2 -ge 1 ]]; then echo "true"; else echo "false"; fi
)


if [ "$pwminnum" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy requires at least 1 numeric character"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy does not require at least 1 numeric character"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_special_character" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/03/20   Ensure system is set to require at least one special character in passwords
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# 

pwspecialchar=$(
pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -e "policyAttributePassword matches '(.*[^a-zA-Z0-9].*){1,}'" | cut -b 12-67) &amp;&amp; pref2=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumSymbols | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; if [ "$pref1" = "policyAttributePassword matches '(.*[^a-zA-Z0-9].*){1,}'" ]; then echo "true"; elif [[ "$pref2" != "" &amp;&amp; pref2 -ge 1 ]]; then echo "true"; else echo "false"; fi
)


if [ "$pwspecialchar" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy requires at least 1 special character"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy does not require at least 1 special character"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_pw_uppercase_lowercase" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/03/20   Ensure system is set to require at least one uppercase and one lowercase character in passwords
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output
# 

pwmcomplex=$(
pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumMixedCaseCharacters | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; if [[ "$pref2" != "" &amp;&amp; pref2 -ge 1 ]]; then echo "true"; else echo "false"; fi
)


if [ "$pwmcomplex" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy requires at least 1 uppercase and lowercase character"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
	echo "PASSED: The password policy requires at least 1 uppercase and lowercase character"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_age" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/03/20   Ensure system is set to require passwords to change at least every 365 days
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output and audit
# 

pwage=$(
pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributeExpiresEveryNDays | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; pref2=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributeDaysUntilExpiration | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; if [[ "$pref1" != "" &amp;&amp; pref1 -le 365 ]]; then echo "true" &amp;&amp; pwagevalue=($pref1); elif [[ "$pref2" != "" &amp;&amp; pref2 -le 365 ]]; then echo "true" &amp;&amp; pwagevalue=($pref2); else echo "false"; fi
)


if [ "$pwage" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy requires passwords expire after at most 365 days"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy expires passwords after \"$pwagevalue\" which is greater than the maximum allowable of 365 days"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_password_history" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/02/20   Ensure system is set to require 5 or lower failed logins
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# Edward Byrd		  07/12/23	 Update to output and audit
# 

pwhistory=$(
pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributePasswordHistoryDepth | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; pref2=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributePasswordHistoryDepth | /usr/bin/tail -1 | /usr/bin/cut -d'&gt;' -f2 | /usr/bin/cut -d '&lt;' -f1) &amp;&amp; if [[ "$pref1" != "" &amp;&amp; pref1 -ge 15 ]]; then echo "true" &amp;&amp; pwhistoryvalue=$pref1; elif [[ "$pref2" != "" &amp;&amp; pref2 -ge 15 ]]; then echo "true" &amp;&amp; pwhistoryvalue=$pref2; else echo "false"; fi
)


if [ "$pwhistory" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The password policy keeps at least the last 15 passwords"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The password policy keeps passwords for \"$pwhistoryvalue\" which is lass than the minimum allowable of the last 15 passwords"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_sudo_timeout" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Reduce the sudo timeout period
# Eric Pinnell        04/23/20   Fixed Test
# Edward Byrd		  06/16/22   Updated for new audit
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Update to output and audit
#

sudotimeout=$(
/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Authentication timestamp timeout: 0.0 minutes"
)

sudotovalue=$(
/usr/bin/sudo -V | /usr/bin/grep -e "Authentication timestamp timeout:" | /usr/bin/awk '{print$4}'
)

sudoersowner=$(
/bin/ls -al /etc/ | /usr/bin/grep sudoers.d | /usr/bin/awk '{print$3}'
)

sudoersgroup=$(
/bin/ls -al /etc/ | /usr/bin/grep sudoers.d | /usr/bin/awk '{print$4}'
)

# If results returns pass, otherwise fail.
if [ $sudotimeout == 1 ] &amp;&amp; [ "$sudoersowner" == "root" ] &amp;&amp; [ "$sudoersgroup" == "wheel" ]; then
	echo "PASSED: The sudo timeout period is 0.0, the owner is root, and the group is wheel"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The sudo timeout period, the owner of /etc/sudoers.d/, or the group of /etc/sudoers.d/ is incorrect"
    echo "The sudo timeout is \"sudotimeout\""
    echo "The owner of the sudoers.d folder is \"sudoersowner\""
    echo "The group of the sudoers.d folder is \"sudoersgroup\""
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_tty_seperate_timestamp" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         10/28/20   User a separate timestamp for each user/tty combo
# Edward Byrd         06/16/22   Updated to use new audit
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Update to output and audit
# 

ttyticket=$(
/usr/bin/sudo -V | /usr/bin/grep -c "Type of authentication timestamp record: tty"
)

ttyvalue=$(
/usr/bin/sudo -V | /usr/bin/grep "Type of authentication timestamp record" | /usr/bin/awk '{print$6}'
)

if [ $ttyticket == 1 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: A seperate timestamp is enabled for rach user/tty combo"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The type of authentication timestanp record is \"$ttyvalue\" which is not tty, and that needs to be modified"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_root_disabled" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Sara Lynn Archacki  04/02/19   Do not enable the "root" account
# Edward Byrd 		  11/08/22   Updated for the new naming and new audit
# 

output=$(
/usr/bin/dscl . -read /Users/root AuthenticationAuthority 2&gt;&amp;1 
)

# If result returns it should pass, otherwise fail.
if [ "$output" == "No such key: AuthenticationAuthority" ] ; then
	echo "PASSED: Root Disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Root is enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_automatic_login" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/22/20   Disable Automatic Login
# Edward Byrd         11/08/22   Updated for the new naming and new audit
# Edward Byrd		  06/27/23	 Updated the output
# 

automaticlogin=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
  .objectForKey('com.apple.login.mcx.DisableAutoLoginClient'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
  .objectForKey('autoLoginUser'))
  if ( pref1 == 1 || pref2 == null ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

if [ "$automaticlogin" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Automatic login is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Automatic login is enabled and needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi


</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_admin_session" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Ensure an Admin Cannot Log into Another User's Account
# 

adminnologin=$(
security authorizationdb read system.login.screensaver 2&gt;&amp;1 | /usr/bin/grep -c 'authenticate-session-owner'
)

if [ $adminnologin  == 1 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "$output"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_banner_window" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/22/20   Enable Login Window Banner
# Edward Byrd         06/16/20   Added permission check
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Update to output
# 

loginbanner=$(
ls /Library/Security | grep -c "PolicyBanner."
)

bannerpermission=$(
stat -f %A /Library/Security/PolicyBanner.* | /usr/bin/cut -c 3
)

if [ $loginbanner == 1 ] &amp;&amp; [ $bannerpermission == 4 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: A login banner is enabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A login banner is not enabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_no_password_hints" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/01/20   Disable Passwords Hints
# Edward Byrd         11/08/22   Updated for the new naming
# Edward Byrd		  06/27/23	 Update audit and output
# 

pwhint=$(
dscl . -list /Users hint | wc -l
)

pwhintuserslist=$(
dscl . -list /Users hint | awk '{print$1}'
)


if [ $pwhint -eq 0 ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: All users do not have a password hint"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following users have a password hint set"
    echo "$pwhintuserslist"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi






</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_terminal_secure_keyboard" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Enable Secure Keyboard in Terminal
# Edward Byrd		  07/12/23	 Update to output and removed individual user audit
#

terminalprofile=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Terminal')\
.objectForKey('SecureKeyboardEntry').js
EOS
)

if [ "$terminalprofile" == "true" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to secure keyboard entries in Terminal"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that enables secure keyboard enteries in Terminal"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi














</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_login_show_fullname" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/08/22	 Check that the login window shows as name and password
# Edward Byrd		  07/06/23	 Update to echo why it failed
#

loginshowname=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('SHOWFULLNAME').js
EOS
)


if [ "$loginshowname" == "true" ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The login window dispalys name and password"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The login windows needs to display name and password, not the individual user icons"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_show_password_hints" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/08/22	 Check that the password hints aren't shown on the login window
# Edward Byrd		  07/06/23	 Update to echo why it failed
#

showpasswordhints=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('RetriesUntilHint').js
EOS
)


if [ $showpasswordhints == 0 ]; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Password hints are disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Password hints are being displayed and need to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_disable_guest_login" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         05/13/20   Disable Guest Login
# Edward Byrd         11/08/22   Updated for the new naming and new audit
# Edward Byrd		  06/27/23	 Updated the output
#

guestlogin=$(
/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
  .objectForKey('DisableGuestAccount'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
  .objectForKey('GuestEnabled'))
  if ( pref1 == 1 || pref2 == 0 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
)

if [ "$guestlogin" == "true" ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The guest login is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The gues login is enabled and needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_sharing" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         06/16/22   Guest Sharing Disabled
# Edward Byrd 		  11/08/22   Updated for the new naming and removed AFP sharing since it is gone from macOS
# Edward Byrd		  06/27/23	 Updated the output
# 

guestsmb=$(
defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server | grep -A 0 AllowGuestAccess | grep -c "AllowGuestAccess = 1"
)

if [ $guestsmb == 0 ]; then 
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: Guest filing sharing is disabled"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: Guest file sharing is enabled and needs to be disabled"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_guest_home_folder" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         09/16/20   Remove Guest home folder
# Edward Byrd 		  11/08/22   Updated for the new naming
# Edward Byrd		  07/12/23	 Update to output
# 

guesthome=$(
/bin/ls /Users/ | /usr/bin/grep Guest 
)

if [ $guesthome -n ] ; then
  output=True
else
  output=False
fi

# If result returns 0 pass, otherwise fail.
if [ "$output" == True ] ; then
	echo "PASSED: The Guest home folder does not exist"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The Guest home folder exists"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_finder_show_file_extensions" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd		  11/03/22	 Check file extensions are shown
#

for DIR in $(find /Users -type d -maxdepth 1); do
	PREF=$DIR/Library/Preferences/.GlobalPreferences
	if [ -e $PREF.plist ]; then
		fileextension=$(defaults read $PREF.plist 2&gt;&amp;1 | grep AppleShowAllExtensions | grep -c "AppleShowAllExtensions = 1;")
		if [ $fileextension == 1 ]; then
			[ -z "$output" ]
		else
			[ -z "$output" ] &amp;&amp; output="User: \"$DIR\" does not have filename extensions enabled" 
		fi
	fi
done

	# If test passed, then no output would be generated. If so, we pass
if [ -z "$output" ] ; then
	echo "PASSED: All users have Finder showing all filename extensions"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: The following user(s) do not have filename extensions showing:"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_open_safe_files" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd         05/12/21   6.3. - Disable Open "Safe" Files Automatically in Safari
# Edward Byrd		  11/05/21	 Fixed unexpected operator error
# Edward Byrd 		  11/08/22   Updated for the new naming and profile check
# Edward Byrd		  07/12/23	 Update to output and individual user audit
#

safarisafeprofile=$(
profiles -P -o stdout | /usr/bin/grep -c "AutoOpenSafeDownloads = 0;")

if [ "$safarisafeprofile" == "1" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to disable open 'safe' files in Safari"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that disables opening safe files in Safari"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi




</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_warn_fraudulent_site" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Enable Safari to warn when visting fraudulent sites
# Edward Byrd		  07/12/23	 Update to output and removed individual user audit
#

safariwarnprofile=$(
profiles -P -o stdout | /usr/bin/grep -c "WarnAboutFraudulentWebsites = 1;")

if [ "$safariwarnprofile" == "1" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to warn when visiting a fraudulent site in Safari"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that warns when visiting fraudulent in Safari"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi
</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_crosssite_tracking" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Enable Safari to prevent cross-site tracking
# Edward Byrd		  07/12/23	 Update to output and removed individual user audit
#

safaricrosssiteprofile1=$(
profiles -P -o stdout | /usr/bin/grep -c "BlockStoragePolicy = 2;")

safaricrosssiteprofile2=$(
profiles -P -o stdout | /usr/bin/grep -c '"WebKitPreferences.storageBlockingPolicy" = 1';)

safaricrosssiteprofile3=$(
profiles -P -o stdout | /usr/bin/grep -c "WebKitStorageBlockingPolicy = 1;")

if [ "$safaricrosssiteprofile1" == "1" ] &amp;&amp; [ "$safaricrosssiteprofile2" == "1" ] &amp;&amp; [ "$safaricrosssiteprofile3" == "1" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to cros-site tracking in Safari"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that disables cross-site tracking in Safari"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_ad_privacy" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Enable Advertising Privacy in Safari
# Edward Byrd		  07/12/23	 Update to output and update to audit for profile
#

safariadprivacy=$(
profiles -P -o stdout | /usr/bin/grep -c '"WebKitPreferences.privateClickMeasurementEnabled" = 1;')


if [ "$safariadprivacy" == "1" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to enable advertising privacy in Safari"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that enables ad privacy in Safari"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi

</sce:script>
   </ds:extended-component>
   <ds:extended-component id="scap_org.cisecurity_ecomp_3.0.0_CIS_Apple_macOS_11.0_Big_Sur_Benchmark-scriptmacOS_safari_show_full_address" timestamp="2024-11-10T19:31:57">
      <sce:script lang="Shell">#!/usr/bin/env sh

#
# CIS-CAT Script Check Engine
# 
# Name                Date       Description
# -------------------------------------------------------------------
# Edward Byrd 		  11/08/22   Ensure full website addresses are shown in Safari
# Edward Byrd		  07/12/23	 Update to output and removed individual user audit
#

safarfulladdressprofile=$(
profiles -P -o stdout | /usr/bin/grep -c "ShowFullURLInSmartSearchField = 1;")

if [ "$safarfulladdressprofile" == "1" ]; then
  output=True
else
  output=False
fi

# If test passed, then no output would be generated. If so, we pass
if [ "$output" = True ] ; then
	echo "PASSED: Profile installed to enabled full website addresses in Safari"
    exit "${XCCDF_RESULT_PASS:-101}"
else
    # print the reason why we are failing
    echo "FAILED: A profile needs to be installed that enables full website addresses in Safari"
    echo "$output"
    exit "${XCCDF_RESULT_FAIL:-102}"
fi




</sce:script>
   </ds:extended-component>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>KJXF8PlMA3HWbnBgFSRb7WANY84v2XMCxP16zNhcWkk=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
mEPYSdyw6jtYa2qzA15de1UJb6TCN712UeByqaUnifOWkTHaz3ErDsgNjqJ8YQ71r9Vif0a1a3/p
dOxcfdI+7T7Bm4yYZ57IIBELJ9zbIpK9A7gHBT+WObkKaxxQbNsbgHltskfBK7F9Bqs+Lp8XisaL
nYPWTBnLOaYi0FddPcNPFZgs3+FIm5YCVlfM4pUyMqZuT6p+G8LqXobEBKA/jz5KAhXptsgKuBAO
zkRHRYm0nQQBrXxUG4WL0khFuesjCnQepZB9gVsg3jOMVv5wJrxAFkK6MojyETwAnWShZHfvMDX/
Y1uuyaAodFBKN25CSpzg/IDlrATnDJDtW/jQfbbH9a+ecsPLrh6acCWwvHKCpC+RgvEL/4gXGzl1
RIaWYha8qqW/vriQQoU36cot54kOYZ8j7VOwkLj8PIdOaXPNdfgxV7zbhlkIQpfFFdlMi9j/uboh
o/wYz8w/2/ZzcVqBDMpDFlO1o3C9EFYB+4rvfcBFRLK8LRhoKegN8kZr
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></ds:data-stream-collection>