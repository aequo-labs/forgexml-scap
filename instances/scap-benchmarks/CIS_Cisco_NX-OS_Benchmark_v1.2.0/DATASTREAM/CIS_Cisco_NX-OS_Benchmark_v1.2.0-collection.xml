<ds:data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:sce="http://open-scap.org/page/SCE_xccdf_stream" xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_org.cisecurity_collection_1.2.0_CIS_Cisco_NX-OS_Benchmark" schematron-version="1.0">
   <ds:data-stream id="scap_org.cisecurity_datastream_1.2.0_CIS_Cisco_NX-OS_Benchmark" scap-version="1.2" timestamp="2025-07-16T15:45:55" use-case="CONFIGURATION">
      <ds:checklists>
         <ds:component-ref id="scap_org.cisecurity_cref_1.2.0_CIS_Cisco_NX-OS_Benchmark-xccdf" xlink:href="#scap_org.cisecurity_comp_1.2.0_CIS_Cisco_NX-OS_Benchmark-xccdf">
            <cat:catalog>
               <cat:uri name="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" uri="scap_org.cisecurity_cref_1.2.0_CIS_Cisco_NX-OS_Benchmark-oval"></cat:uri>
            </cat:catalog>
         </ds:component-ref>
      </ds:checklists>
      <ds:checks>
         <ds:component-ref id="scap_org.cisecurity_cref_1.2.0_CIS_Cisco_NX-OS_Benchmark-oval" xlink:href="#scap_org.cisecurity_comp_1.2.0_CIS_Cisco_NX-OS_Benchmark-oval"></ds:component-ref>
      </ds:checks>
   </ds:data-stream>
   <ds:component id="scap_org.cisecurity_comp_1.2.0_CIS_Cisco_NX-OS_Benchmark-xccdf" timestamp="2025-07-16T15:45:55">
      <xccdf:Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.2.0_CIS_Cisco_NX-OS_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
         <xccdf:status date="2025-07-16">accepted</xccdf:status>
         <xccdf:title xml:lang="en">CIS Cisco NX-OS Benchmark</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This document, Security Configuration Benchmark for Cisco IOS, provides prescriptive guidance for establishing a secure configuration posture for Cisco Devices running Cisco NX-OS.</xhtml:p>
            <xhtml:p>The Cisco NX-OS is a data center class operating system designed for maximum scalability and application availability. The CLI interface for the NX-OS is very similar to Cisco IOS, so if you understand the Cisco IOS you can easily adapt to the Cisco NX-OS.</xhtml:p>
            <xhtml:p>


To obtain the complete benchmark and or the latest version of this guide, please visit                       <xhtml:a href="http://cisecurity.org">http://cisecurity.org</xhtml:a>


. If you have questions, comments, or have identified ways to improve this guide, please write us at                       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>


.                </xhtml:p>
         </xccdf:description>
         <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
         <xccdf:version>1.2.0</xccdf:version>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
            <xccdf:title xml:lang="en">Level 1</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Items in this profile intend to:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>be practical and prudent;</xhtml:li>
                  <xhtml:li>provide a clear security benefit; and</xhtml:li>
                  <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1.2_Configure_AAA_Authentication_-_Local_SSH_keys" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1.3_Configure_AAA_Authentication_-_RADIUS_if_applicable" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_vty_line_authentication" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Restrict_Access_to_VTY_Sessions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Configure_IP_Blocking_on_Failed_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Ensure_Exec_Timeout_for_Console_Sessions_is_set_for_less_than_10" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_Exec_Timeout_for_Remote_Administrative_Sessions_VTY_is_set_to_less_than_10" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Disable_the_Telnet_Feature" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Pre-authentication_Banner" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Post-authentication_Banner" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Enable_Password_Complexity_Requirements_for_Local_Credentials" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.4_Set_password_length_for_local_credentials" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5.4_Configure_Logging_Timestamps" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.1_Configure_at_least_2_external_NTP_Servers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.2_Configure_a_Time_Zone" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.3_If_a_Local_Time_Zone_is_used_Configure_Daylight_Savings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.3_Configure_source_interface_for_SNMP_Traps" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.4_Ensure_Read_Write_privileges_are_not_configured_for_SNMP" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Configure_Control_Plane_Policing" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1.2_Configure_EIGRP_Passive_interfaces_for_interfaces_that_do_not_have_peers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1.3_Configure_EIGRP__log-adjacency-changes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2.1_Configure_BGP_to_Log_Neighbor_Changes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3.1_Set_Interfaces_with_no_Peers_to_Passive-Interface" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3.3_Log_OSPF_Adjacency_Changes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4.1_If_VLAN_interfaces_have_IP_addreses_configure_anti_spoofing__ingress_filtering_protections" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4.4_Configure_HSRP_protections" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.1_Configure_RA_Guard" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Disable_IP_Directed_Broadcasts_on_all_Layer_3_Interfaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Disable_IP_Source-Routing" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.1_Configure_DHCP_Trust" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4.1_Configure_LLDP" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Configure_Local_Configuration_Backup_Schedule" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Configure_a_Remote_Backup_Schedule" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
            <xccdf:title xml:lang="en">Level 2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>are intended for environments or use cases where security is paramount.</xhtml:li>
                  <xhtml:li>acts as defense in depth measure.</xhtml:li>
                  <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1.2_Configure_AAA_Authentication_-_Local_SSH_keys" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1.3_Configure_AAA_Authentication_-_RADIUS_if_applicable" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_vty_line_authentication" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Restrict_Access_to_VTY_Sessions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Configure_IP_Blocking_on_Failed_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Ensure_Exec_Timeout_for_Console_Sessions_is_set_for_less_than_10" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_Exec_Timeout_for_Remote_Administrative_Sessions_VTY_is_set_to_less_than_10" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Disable_the_Telnet_Feature" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Pre-authentication_Banner" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Post-authentication_Banner" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Enable_Password_Complexity_Requirements_for_Local_Credentials" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.2_Configure_Password_Encryption" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.4_Set_password_length_for_local_credentials" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_Syslog_Logging_is_configured" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5.2_Log_all_Successful_and_Failed_Administrative_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5.3_Configure_Netflow_on_Strategic_Ports" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5.4_Configure_Logging_Timestamps" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.1_Configure_at_least_2_external_NTP_Servers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.2_Configure_a_Time_Zone" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.3_If_a_Local_Time_Zone_is_used_Configure_Daylight_Savings" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6.4_Configure_NTP_Authentication" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7.1_Disable_Power_on_Auto_Provisioning_POAP" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7.2_Disable_iPXE_Pre-boot_eXecution_Environment" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7.3_Set_SSH_Key_Modulus_Length" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.8.1_Enable_FIPS_Mode" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.3_Configure_source_interface_for_SNMP_Traps" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.9.4_Ensure_Read_Write_privileges_are_not_configured_for_SNMP" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.10_Use_Dedicated_mgmt_Interface_and_VRF_for_Administrative_Functions" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Configure_Control_Plane_Policing" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1.1_Configure_EIGRP_Authentication_on_all_EIGRP_Routing_Devices" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1.2_Configure_EIGRP_Passive_interfaces_for_interfaces_that_do_not_have_peers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1.3_Configure_EIGRP__log-adjacency-changes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2.1_Configure_BGP_to_Log_Neighbor_Changes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2.2_If_Possible_Limit_the_BGP_Routes_Accepted_from_Peers" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2.3_Configure_BGP_Authentication" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3.1_Set_Interfaces_with_no_Peers_to_Passive-Interface" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3.2_Authenticate_OSPF_peers_with_MD5_authentication_keys" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3.3_Log_OSPF_Adjacency_Changes" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4.1_If_VLAN_interfaces_have_IP_addreses_configure_anti_spoofing__ingress_filtering_protections" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4.2_Create_and_use_a_single_Loopback_Address_for_Routing_Protocol_Peering" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4.3_Use_Unicast_Routing_Protocols_Only" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4.4_Configure_HSRP_protections" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.1_Configure_RA_Guard" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Disable_IP_Directed_Broadcasts_on_all_Layer_3_Interfaces" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Disable_IP_Source-Routing" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.1_Configure_DHCP_Trust" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.2_Configure_Storm_Control" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4.1_Configure_LLDP" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4.2_Configure_CDP" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5.1_Basic_Fiber_Channel_Configuration" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5.2_Configure_FCoE_Zoning" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Configure_Local_Configuration_Backup_Schedule" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Configure_a_Remote_Backup_Schedule" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Configure_Alerts_on_all_Configuration_Changes" selected="true"></xccdf:select>
         </xccdf:Profile>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6886753_var" operator="equals" type="string">
            <title>Configure AAA Authentication - TACACS if applicable</title>
            <description>This value is used in Rule: Configure AAA Authentication - TACACS if applicable</description>
            <value>^\h*aaa\hgroup\hserver\htacacs.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6983732_var" operator="equals" type="string">
            <title>Configure AAA Authentication - TACACS if applicable</title>
            <description>This value is used in Rule: Configure AAA Authentication - TACACS if applicable</description>
            <value>^\h*feature\h+tacacs.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6886754_var" operator="equals" type="string">
            <title>Configure AAA Authentication - Local SSH keys</title>
            <description>This value is used in Rule: Configure AAA Authentication - Local SSH keys</description>
            <value>^\h*username\h.+\hsshkey\hssh-rsa\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6886755_var" operator="equals" type="string">
            <title>vty line authentication</title>
            <description>This value is used in Rule: vty line authentication</description>
            <value>aaa\hauthentication\hlogin\hdefault\hgroup\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6935321_var" operator="equals" type="string">
            <title>Limit SSH Login Attempts to 3 or less</title>
            <description>This value is used in Rule: Limit SSH Login Attempts to 3 or less</description>
            <value>^h*ssh\hlogin-attempts\h[1-2]</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6935323_var" operator="equals" type="string">
            <title>Limit SSH Login Attempts to 3 or less</title>
            <description>This value is used in Rule: Limit SSH Login Attempts to 3 or less</description>
            <value>^h*ssh\hlogin-attempts\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6937269_var" operator="equals" type="string">
            <title>Disable the Telnet Feature</title>
            <description>This value is used in Rule: Disable the Telnet Feature</description>
            <value>^\h*no\hfeature\htelnet</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6925965_var" operator="equals" type="string">
            <title>Pre-authentication Banner</title>
            <description>This value is used in Rule: Pre-authentication Banner</description>
            <value>^\h*banner\hmotd\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6925966_var" operator="equals" type="string">
            <title>Post-authentication Banner</title>
            <description>This value is used in Rule: Post-authentication Banner</description>
            <value>^\h*banner\hexec\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6939241_var" operator="equals" type="string">
            <title>Enable Password Complexity Requirements for Local Credentials</title>
            <description>This value is used in Rule: Enable Password Complexity Requirements for Local Credentials</description>
            <value>^\h*no\hpassword\hstrength-check$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6939238_var" operator="equals" type="string">
            <title>Set password lifetime, warning time and grace time for local credentials</title>
            <description>This value is used in Rule: Set password lifetime, warning time and grace time for local credentials</description>
            <value>^\h*userpassphrase\hdefault-lifetime\h(365|36[0-5]|3[0-5][0-9]|[1-2][0-9]{2}|[1-9][0-9]|[1-9])\b</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6939239_var" operator="equals" type="string">
            <title>Set password lifetime, warning time and grace time for local credentials</title>
            <description>This value is used in Rule: Set password lifetime, warning time and grace time for local credentials</description>
            <value>^\h*username\h+[A-Za-z0-9]+\h+passphrase\h+lifetime\h+(365|36[0-5]|3[0-5][0-9]|[1-2][0-9]{2}|[1-9][0-9]|[1-9])\b\h+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6939240_var" operator="equals" type="string">
            <title>Set password length for local credentials</title>
            <description>This value is used in Rule: Set password length for local credentials</description>
            <value>^\h*userpassphrase\h+min-length\h\b(1[6-9]|[2-9][0-9]|1[01][0-9]|12[0-7])\b\h+max-length\h+\b(1[6-9]|[2-9][0-9]|1[01][0-9]|12[0-7])\b$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6943546_var" operator="equals" type="string">
            <title>Ensure Syslog Logging is configured</title>
            <description>This value is used in Rule: Ensure Syslog Logging is configured</description>
            <value>^\h*logging\hserver\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6960031_var" operator="equals" type="string">
            <title>Configure a Time Zone</title>
            <description>This value is used in Rule: Configure a Time Zone</description>
            <value>^\h*clock\h+timezone\h...\h-\d\h\d$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6943547_var" operator="equals" type="string">
            <title>Disable Power on Auto Provisioning (POAP)</title>
            <description>This value is used in Rule: Disable Power on Auto Provisioning (POAP)</description>
            <value>^\h*boot\hpoap\henable</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6943548_var" operator="equals" type="string">
            <title>Disable iPXE (Pre-boot eXecution Environment)</title>
            <description>This value is used in Rule: Disable iPXE (Pre-boot eXecution Environment)</description>
            <value>^\h*boot\horder\hbootflash</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6939242_var" operator="equals" type="string">
            <title>Configure SNMPv3</title>
            <description>This value is used in Rule: Configure SNMPv3</description>
            <value>^\h*snmp-server\hhost\h[0-9]+.[0-9]+.[0-9]+.[0-9]+\htraps\hversion\h3.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6939244_var" operator="equals" type="string">
            <title>Configure SNMP Traps</title>
            <description>This value is used in Rule: Configure SNMP Traps</description>
            <value>^\h*snmp-server\hhost\h[0-9]+.[0-9]+.[0-9]+.[0-9]+\htraps\hversion\h3.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6950771_var" operator="equals" type="string">
            <title>Disable IP Source-Routing</title>
            <description>This value is used in Rule: Disable IP Source-Routing</description>
            <value>^\h*no\h+ip\h+source-route</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6935324_var" operator="equals" type="string">
            <title>Ensure Exec Timeout for Console Sessions is set for less than 10</title>
            <description>This value is used in Rule: Ensure Exec Timeout for Console Sessions is set for less than 10</description>
            <value>^\h*exec-timeout\h([0-9]|10)</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6935325_var" operator="equals" type="string">
            <title>Ensure Exec Timeout for Remote Administrative Sessions (VTY) is set to less than 10</title>
            <description>This value is used in Rule: Ensure Exec Timeout for Remote Administrative Sessions (VTY) is set to less than 10</description>
            <value>^\h*exec-timeout\h([0-9]|10)</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6935326_var" operator="equals" type="string">
            <title>Set the Maximum Number of VTY Sessions</title>
            <description>This value is used in Rule: Set the Maximum Number of VTY Sessions</description>
            <value>^\s*session-limit\s([1-9]|[1-2][0-9]|3[0-1])\b</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6935327_var" operator="equals" type="string">
            <title>Set the Maximum Number of VTY Sessions</title>
            <description>This value is used in Rule: Set the Maximum Number of VTY Sessions</description>
            <value>^\h*session-limit\h.+</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6951961_var" operator="equals" type="string">
            <title>If VLAN interfaces have IP addreses, configure anti spoofing / ingress filtering protections</title>
            <description>This value is used in Rule: If VLAN interfaces have IP addreses, configure anti spoofing / ingress filtering protections</description>
            <value>^\h+ip\h+verify\h+unicast\h+source\h+reachable-via\h+rx*$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6950152_var" operator="equals" type="string">
            <title>Disable ICMP Redirects on all Layer 3 Interfaces</title>
            <description>This value is used in Rule: Disable ICMP Redirects on all Layer 3 Interfaces</description>
            <value>^\h*no\h+ip\h+redirects</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6960032_var" operator="equals" type="string">
            <title>Disable ICMP Redirects on all Layer 3 Interfaces</title>
            <description>This value is used in Rule: Disable ICMP Redirects on all Layer 3 Interfaces</description>
            <value>^\h*no\h+shutdown.$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6950701_var" operator="equals" type="string">
            <title>Disable Proxy ARP on all Layer 3 Interfaces</title>
            <description>This value is used in Rule: Disable Proxy ARP on all Layer 3 Interfaces</description>
            <value>^h*proxy\h+arp</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_6951960_var" operator="equals" type="string">
            <title>Disable Proxy ARP on all Layer 3 Interfaces</title>
            <description>This value is used in Rule: Disable Proxy ARP on all Layer 3 Interfaces</description>
            <value>^\h*shutdown*$</value>
         </Value>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Management_Plane">
            <xccdf:title xml:lang="en">Management Plane</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Services, settings and data streams related to setting up and examining the static configuration of the firewall, and the authentication and authorization of firewall administrators. Examples of management plane services include: administrative device access (telnet, ssh, http, and https), SNMP, and security protocols like RADIUS and TACACS+.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1_Authentication_Authorization_and_Accounting_AAA_Rules">
               <xccdf:title xml:lang="en">Authentication, Authorization and Accounting (AAA) Rules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Rules in the authentication, authorization and accounting (AAA) configuration class enforce device access control, provide a mechanism for tracking configuration changes, and enforcing security policy.</xhtml:p>
               </xccdf:description>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1.1_AAA_prerequisites">
                  <xccdf:title xml:lang="en">AAA prerequisites</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>This sub-section contains prerequsites for effective AAA implementation.</xhtml:p>
                  </xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Configure AAA Authentication - TACACS if applicable</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>TACACS+ is an authentication protocol that Cisco NX-OS devices can use for authentication of management users against a remote AAA server. These management users can access the Cisco NX-OS device through any protocol and use this back-end authentication.  Using a central authentication store (such as Active Directory) ensures that all administrative actions are tied to named users, making the tracking of changes much easier.  It also makes tracking compromised accounts and malicious activities much easier.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Central authentication is key as it minimizes the effort in managing named user accounts.  Keeping local admin accounts opens the door to all the issues inherent in shared accounts, namely:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>Errors in implementation being done by generic admin accounts, which can then be denied by all.</xhtml:li>
                           <xhtml:li>Shared credentials staying unchanged when administrative staff leave the organization or change roles.</xhtml:li>
                           <xhtml:li>Giving malicious actors the ability to recover shared credentials from saved device backups</xhtml:li>
                        </xhtml:ul>
                        <xhtml:p>In many organizations TACACS+ is preferred over RADIUS when TACACS+ is supported by the AAA server and network device.  This is because (with additional work) TACACS+ also supports command authorization, restricting specific users to the command set that they can use on the device.  However, TACACS+ started as a Cisco centric protocol, so is not as widely supported by other vendors in comparison to RADIUS.</xhtml:p>
                        <xhtml:p>In addition, RADIUS use is much more widespread (primarily for secure wireless authentication), so is often already in place.</xhtml:p>
                        <xhtml:p>Finally, command authorization is a complex endeavor and is very rarely implemented because of that, so the main advantage of TACACS+ is very often not realized.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/m/en_us/techdoc/dc/reference/cli/nxos/commands/fund/show-running-config.html</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>First, enable TACACS+ in NX-OS</xhtml:p>
                              <xhtml:code class="code_block">switch(config)#feature tacacs+
</xhtml:code>
                              <xhtml:p>Next, define two or more TACACS+ servers:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)#tacacs-server host 3.4.5.6 key somekey                                                          <br></br>


switch(config)#tacacs-server host 4.5.6.7 key someotherkey
                                                    </xhtml:code>
                              <xhtml:p>define the aaa group for TACACS+:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)#aaa group server tacacs+ TACACSGROUP                                                          <br></br>


    server 3.4.5.6                                                          <br></br>


    server 4.5.6.7
                                                    </xhtml:code>
                              <xhtml:p>Finally, create the aaa authentication list for both console and default access:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)#aaa authentication login default group TACACSGROUP local                                                          <br></br>


switch(config)#aaa authentication login console group TACACSGROUP local
                                                    </xhtml:code>
                              <xhtml:p>It is common to include "local" as the last entry in the list, to allow access to administer the device even if the RADIUS server is offline. Note that while this ensures access in the case of the device or the RADIUS server being offline, it also means that if an attacker can DOS the RADIUS Servers, they can authenticate locally as well.</xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Implementing TACACS+ (or any central authentication solution) ensures that only named users are allowed to gain an administrative session to the device. This allows:</xhtml:p>
                                 <xhtml:ul>
                                    <xhtml:li>Tracking of all changes to named users</xhtml:li>
                                    <xhtml:li>Simplification of reconciling changes to a change management process</xhtml:li>
                                    <xhtml:li>Off-loading password change cycles and password complexity requirements to that central authentication store</xhtml:li>
                                    <xhtml:li>Simplification of removing admin access as administrators leave the organization or change their roles in the organization</xhtml:li>
                                 </xhtml:ul>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="OR">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-export export-name="oval:org.cisecurity.benchmarks:var:6886753" value-id="xccdf_org.cisecurity.benchmarks_value_6886753_var"></check-export>
                           <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6886753"></check-content-ref>
                        </check>
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-export export-name="oval:org.cisecurity.benchmarks:var:6983732" value-id="xccdf_org.cisecurity.benchmarks_value_6983732_var"></check-export>
                           <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6983732"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.1.2_Configure_AAA_Authentication_-_Local_SSH_keys" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Configure AAA Authentication - Local SSH keys</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Using the client's public key to authenticate their SSH sessions circumvents the need for using passwords for an administrative login to the switch.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>This is primarily an ease-of-use feature.  It means that the administrators don't need to remember or key in passwords.  It also can be used to significantly improve the security of any scripts or API calls that might use SSH.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:ul>
                                 <xhtml:li>Create the client's SSH public and private keys.  The keys must be in OpenSSH format for the NX-OS switch to interpret them correctly.  Use either RSA or DSA algorithms, and be sure to specify enough bits for entropy (2048 minimum, more is of course better)</xhtml:li>
                                 <xhtml:li>Upload the client's SSH public key, and store it on the bootflash of the switch.</xhtml:li>
                                 <xhtml:li>Be sure that the file has a meaningful name, often the users's initials and the key algorithm (RSA or DSA) is in the filename.  This makes it easier to remove or replace that file as keys are expired out, workstations migrate or administrators leave the organization.</xhtml:li>
                                 <xhtml:li>To enable key-based authentication for one local user (for instance, Davey Jones), enter the command:</xhtml:li>
                              </xhtml:ul>
                              <xhtml:code class="code_block">switch(config)# username djadmin sshkey file bootflash:dj_rsa.pub
</xhtml:code>
                              <xhtml:p>Alternatively, the ssh key can be defined in the username configuration line:</xhtml:p>
                              <xhtml:code class="code_block">switch(config)# username djadmin sshkey ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAy19oF6QaZl9G+3f1XswK3OiW4H7YyUyuA50rv7gsEPjhOBYmsi6PAVKui1nIf/DQhum+lJNqJP/eLowb7ubO+lVKRXFY/G+lJNIQW3g9igG30c6k6+XVn+NjnI1B7ihvpVh7dLddMOXwOnXHYshXmSiH3UD/vKyziEh5S4Tplx8=
</xhtml:code>
                              <xhtml:p>The file based method is usually preferred, as they keys can be changed without modifying the configuration of the switch.  Also, the keys are not stored in any archived copy of the configuration.</xhtml:p>
                              <xhtml:p>Note that the username and file name will vary depending on your organization's policies, procedures and standards</xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>There are pros and cons to this approach.</xhtml:p>
                                 <xhtml:p>Pro:</xhtml:p>
                                 <xhtml:ul>
                                    <xhtml:li>Scripts and API calls that use SSH no longer need to have credentials embedded in them.  While this can be done securely (using password vaults for instance), all to often the credentials are in clear-text, in the code or in an input file.</xhtml:li>
                                    <xhtml:li>This is popular with network administrators, as they no longer need to key in passwords, or "grab" their password from a password manager application.</xhtml:li>
                                    <xhtml:li>It means that administrators can no longer configure easy to guess passwords.</xhtml:li>
                                 </xhtml:ul>
                                 <xhtml:p>Con:</xhtml:p>
                                 <xhtml:ul>
                                    <xhtml:li>The private half of the PKI exchange (client side) can be available if the administrator's workstation or account is compromised</xhtml:li>
                                    <xhtml:li>An inventory of SSH hosts that use key based authentication needs to be maintained if this approach is used.  This is so that if a key needs to be replaced or deleted, the list of hosts that need to be updated is easily accessed.  This can be time sensitive if an administrator has left the organization, or if a laptop is lost or stolen.  Even if this is just due to regular hardware replacement or a policy that expires keys at regular intervals, missing a device can be a "time bomb" that is often not found until the worst possible moment</xhtml:li>
                                 </xhtml:ul>
                                 <xhtml:p>Normally the best recommendation is to use a back-end authentication source (such as AD), with RADIUS or TACACS+ as the authentication protocol.  The back end directory can then enforce whatever complexity or password change requirements are needed.  In particular if an administrator leaves the organization or changes departments, those situations can be managed by changing AD Group membership or by disabling the account in question.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-export export-name="oval:org.cisecurity.benchmarks:var:6886754" value-id="xccdf_org.cisecurity.benchmarks_value_6886754_var"></check-export>
                           <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6886754"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.1.3_Configure_AAA_Authentication_-_RADIUS_if_applicable" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">Configure AAA Authentication - RADIUS if applicable</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>RADIUS is an authentication protocol that Cisco NX-OS devices can use for authentication of management users against a remote AAA server. These management users can access the Cisco NX-OS device through any protocol and use this back-end authentication.  Using a central authentication store (such as Active Directory) ensures that all administrative actions are tied to named users, making the tracking of changes much easier.  It also makes tracking compromised accounts and malicious activities much easier.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Central authentication is key as it minimizes the effort in managing named user accounts.  Keeping local admin accounts opens the door to all the issues inherent in shared accounts, namely:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>Errors in implementation being done by generic admin accounts, which can then be denied by all.</xhtml:li>
                           <xhtml:li>Shared credentials staying unchanged when administrative staff leave the organization or change roles.</xhtml:li>
                           <xhtml:li>Giving malicious actors the ability to recover shared credentials from saved device backups</xhtml:li>
                        </xhtml:ul>
                        <xhtml:p>RADIUS is the most widely used protocol for this purpose, since it is a requirement for secure wireless authentication (EAP-TLS).  Just as important, RADIUS is much better supported by most non-Cisco vendors for back-end authentication.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/m/en_us/techdoc/dc/reference/cli/nxos/commands/fund/show-running-config.html</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>First define two or more RADIUS Servers</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)#radius-server host 3.4.5.6 key somekey authentication accounting                                                          <br></br>


switch(config)#radius-server host 4.5.6.7 key someotherkey authentication accounting
                                                    </xhtml:code>
                              <xhtml:p>Then create an AAA group for RADIUS</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# aaa group server radius RADIUSGROUP                                                          <br></br>


    server 3.4.5.6                                                          <br></br>


    server 4.5.6.7
                                                    </xhtml:code>
                              <xhtml:p>Finally, create the authentication lists in the correct order - to be effective the RADIUS group needs to appear first in the list.  Both the default and console access should be secured in the same way:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# aaa authentication login default group RADIUSGROUP local                                                          <br></br>


switch(config)# aaa authentication login console group RADIUSGROUP local
                                                    </xhtml:code>
                              <xhtml:p>It is common to include "local" as the last entry in the list, to allow access to administer the device even if the RADIUS server is offline.  Note that while this ensures access in the case of the device or the RADIUS server being offline, it also means that if an attacker can DOS the RADIUS Servers, they can authenticate locally as well.</xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Implementing RADIUS (or any central authentication solution) ensures that only named users are allowed to gain an administrative session to the device. This allows:</xhtml:p>
                                 <xhtml:ul>
                                    <xhtml:li>Tracking of all changes to named users</xhtml:li>
                                    <xhtml:li>Simplification of reconciling changes to a change management process</xhtml:li>
                                    <xhtml:li>Off-loading password change cycles and password complexity requirements to that central authentication store</xhtml:li>
                                    <xhtml:li>Simplification of removing admin access as administrators leave the organization or change their roles in the organization</xhtml:li>
                                 </xhtml:ul>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1.2_Authentication">
                  <xccdf:title xml:lang="en">Authentication</xccdf:title>
                  <xccdf:description xml:lang="en"></xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_vty_line_authentication" role="full" selected="false" weight="1.0">
                     <xccdf:title xml:lang="en">vty line authentication</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Authenticate management access to the network devices. Typically a central authentication store combined with a fallback mechanism should be implemented to allow emergency access, in case the central authentication servers are not available.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Centralize Network Authentication, Authorization, and Auditing (AAA)" urn="urn:cisecurity.org:controls:8.0:12:5">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Users</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Management access to network devices must be authenticated. The default under AAA (local or network) is to require users to log in using a valid user name and password. This rule applies for both local and network AAA. Fallback mode should also be enabled to allow emergency access to the router or switch in the event that the AAA server was unreachable.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/dcn/nx-os/nexus9000/102x/configuration/Security/cisco-nexus-9000-nx-os-security-configuration-guide-102x/m-configuring-aaa.html</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Configure central authentication for vty lines as follows:</xhtml:p>
                              <xhtml:code class="code_block">aaa authentication login default group &lt;servergroup&gt; 
</xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>If no authentication is implemented, any user with network reachability to the management interface can access network devices and change their configuration.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-export export-name="oval:org.cisecurity.benchmarks:var:6886755" value-id="xccdf_org.cisecurity.benchmarks_value_6886755_var"></check-export>
                           <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6886755"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
               </xccdf:Group>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.2_Access_Rules">
               <xccdf:title xml:lang="en">Access Rules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Rules in the access class enforce controls for device administrative connections.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Restrict_Access_to_VTY_Sessions" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Restrict Access to VTY Sessions</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Restrict Management Access to trusted management stations and VLANs.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain Dedicated Computing Resources for All Administrative Work" urn="urn:cisecurity.org:controls:8.0:12:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Dedicated Machines For All Network Administrative Tasks" urn="urn:cisecurity.org:controls:7.0:11:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Manage Network Infrastructure Through a Dedicated Network" urn="urn:cisecurity.org:controls:7.0:11:7">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Exposing the management interface too broadly exposes that interface to MiTM (Monkey in the Middle) attacks as well as to credential stuffing attacks.  The question "should your receptionist have access to your core switch?" usually illustrates the need for this if there are any disagreements.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Create an access-list that defines the various trusted subnets and/or stations:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# ip access-list ACL-MGT                                                    <br></br>


switch(config-acl)# remark access-class ACL                                                    <br></br>


switch(config-acl)# permit ip 192.168.12.0/24 any                                                    <br></br>


switch(config-acl)# deny ip any any log
                                              </xhtml:code>
                           <xhtml:p>It is suggested that all ACLs are commented to help self-document the configuration.</xhtml:p>
                           <xhtml:p>


The last line in the ACL should read                                                     <xhtml:span class="inline_block">deny ip any any log</xhtml:span>


 to record all attempts to reach the management interface from unauthorized stations.                                              </xhtml:p>
                           <xhtml:p>Apply the Access-Class to the VTY interface:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# line vty                                                    <br></br>


switch(config-line)# access-class ACL-MGT in
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Not restricting access to the management interface has several risks:</xhtml:p>
                              <xhtml:ul>
                                 <xhtml:li>exposes your interface to credential stuffing attacks from commodity malware (such as Mirai)</xhtml:li>
                                 <xhtml:li>highlights your device as missing simple security remediations to even simple scans.  This invites other attacks in addition to credential stuffing.</xhtml:li>
                              </xhtml:ul>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Configure_IP_Blocking_on_Failed_Logins" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure IP Blocking on Failed Logins</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>After a configured number of failed logins in a set window, offending IP addresses should be blocked from login for a configured amount of time.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use of Dedicated Machines For All Administrative Tasks" urn="urn:cisecurity.org:controls:7.0:4:6">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Monitor and Block Unauthorized Network Traffic" urn="urn:cisecurity.org:controls:7.0:13:3">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>This effectively makes brute force attacks much less practical, slowing automated processes from a rate of multiple attempts per second to per minute ranges.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_usr_cfg/configuration/xe-16-12/sec-usr-cfg-xe-16-12-book/sec-login-enhance.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>This configuration consists of:</xhtml:p>
                           <xhtml:ul>
                              <xhtml:li>A "watch" time window (in seconds)</xhtml:li>
                              <xhtml:li>the number of failed attempts to trigger on</xhtml:li>
                              <xhtml:li>the amount of time (in seconds) to block further login attempts from that IP address</xhtml:li>
                           </xhtml:ul>
                           <xhtml:code class="code_block">


For NX-OS 7.x:                                                    <br></br>


login block-for &lt;block time window&gt; attempts &lt;fail count&gt; within &lt;detect time window&gt;                                                    <br></br>


for instance:                                                    <br></br>


login block-for 120 attempts 5 within 120                                                    <br></br>
                              <br></br>


For NX-OS 9.x:                                                    <br></br>


system login block-for &lt;block time window&gt; attempts &lt;fail count&gt; within &lt;detect time window&gt;                                                    <br></br>


for instance:                                                    <br></br>


system login block-for 120 attempts 5 within 120                                                    <br></br>
                              <br></br>


Any values at all will thwart most brute force or dictionary attacks.
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Not only does this effectively impede brute force or dictionary login attacks, but logs them as such.  In addition, enabling this command limits login attempts to once per second, rather than as fast as the device can process them.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Limit SSH Login Attempts to 3 or less</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>After a configured number of failed password attempts, an SSH session terminate.  The default configuration for this is 3 failed attempts. CIS recommends using the default configuration for this setting.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Require All Remote Login to Use Multi-factor Authentication" urn="urn:cisecurity.org:controls:7.0:12:11">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>This setting makes brute force and dictionary attacks against SSH more difficult.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/93x/security/configuration/guide/b-cisco-nexus-9000-nx-os-security-configuration-guide-93x.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">switch(config)# ssh login attempts 3
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The default setting of 3 failed attempts is appropriate and does not need to be changed.  However, in this default configuration this setting does not appear in the running or saved configuration.  If it is important that this setting shows in the configuration this value can be modified.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6935321" value-id="xccdf_org.cisecurity.benchmarks_value_6935321_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6935321"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6935323" value-id="xccdf_org.cisecurity.benchmarks_value_6935323_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6935323"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Ensure_Exec_Timeout_for_Console_Sessions_is_set_for_less_than_10" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Exec Timeout for Console Sessions is set for less than 10</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Verify device is configured to automatically disconnect console sessions after a defined maximum session time, set in minutes.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Manage Network Devices Using Multi-Factor Authentication and Encrypted Sessions" urn="urn:cisecurity.org:controls:7.0:11:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>This prevents unauthorized users from misusing abandoned sessions. For example, if the network administrator disconnects leaving a console session open, that session will remain open (in the same state and privilege level) for the next person who connects a console cable to the device.</xhtml:p>
                     <xhtml:p>A shorter timeout is usually desired, but this can be extended for longer-running operations such as debug sessions or NX-OS updates.</xhtml:p>
                     <xhtml:p>This is not an idle timer, it is the maximum length of a session.  This is a key difference that should be taken into account when determining the best value for your organization and your work habits.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# line console                                                    <br></br>


switch(config)# exec-timeout 10
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6935324" value-id="xccdf_org.cisecurity.benchmarks_value_6935324_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6935324"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_Exec_Timeout_for_Remote_Administrative_Sessions_VTY_is_set_to_less_than_10" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Exec Timeout for Remote Administrative Sessions (VTY) is set to less than 10</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>This value sets the maximum time of an administrative session that is attached via a VTY line - in most installations this means the maximum time and SSH session can have.  This value is set in minutes.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# line vty                                                    <br></br>


switch(config)# exec-timeout 10
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6935325" value-id="xccdf_org.cisecurity.benchmarks_value_6935325_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6935325"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Set the Maximum Number of VTY Sessions</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>This sets the maximum number of remote administrative sessions, which in most environments means the maximum number of SSH sessions.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Require All Remote Login to Use Multi-factor Authentication" urn="urn:cisecurity.org:controls:7.0:12:11">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>This setting prevents an attacker from a resource-exhaustion attack using protocol such  as SSH.  If there is no limit, an attacker could simply create SSH sessions and leave them in place until the NX-OS host resources (memory) would be exhausted.  This is not a practical attack against NX-OS however, as the default value for this setting is 32, and the maximum is only 64.</xhtml:p>
                     <xhtml:p>Setting this value to something other than the default (32) ensures that it shows in the configuration, so that administrators understand what this value is both during regular administration or during an attack.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# line vty                                                    <br></br>


switch(config)# session-limit 16                                                    <br></br>
                           </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Whatever this value is set to, an attacker can exhaust all SSH sessions so that a legitimate administrator cannot connect remotely.  This is a reasonable thing for an attacker to do if they have an attack in progress and want to deny administrators access to the NX-OS platform, which they may need to do to thwart an in-progress attack.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6935326" value-id="xccdf_org.cisecurity.benchmarks_value_6935326_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6935326"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6935327" value-id="xccdf_org.cisecurity.benchmarks_value_6935327_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6935327"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Disable_the_Telnet_Feature" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Disable the Telnet Feature</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Telnet is a clear-text administrative protocol.  As such, both the credentials used to establish the session and all commands and data within the session are readable in clear-text, so can be intercepted or modified by an attacker</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Manage Network Devices Using Multi-Factor Authentication and Encrypted Sessions" urn="urn:cisecurity.org:controls:7.0:11:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Deny Communication over Unauthorized Ports" urn="urn:cisecurity.org:controls:7.0:12:4">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# no feature telnet                                                    <br></br>
                           </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6937269" value-id="xccdf_org.cisecurity.benchmarks_value_6937269_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6937269"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.3_Banner_Rules">
               <xccdf:title xml:lang="en">Banner Rules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Rules in the banner class communicate legal rights to users.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Pre-authentication_Banner" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Pre-authentication Banner</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>A pre-authentication banner is displayed when a terminal connects, before a login occurs. This banner is useful for sending messages that affect all users (such as impending system shutdowns). This banner can also be used to notify unauthorized users of any penalties to accessing the device, or any logging that may be configured.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>In contrast to IOS(-XE) or IOS XR, NX-OS just supports two banner types:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>motd banner  (shown before authentication)</xhtml:li>
                           <xhtml:li>exec banner  (shown after successful authentication)</xhtml:li>
                        </xhtml:ol>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Network banners are electronic messages that provide notice of legal rights to users of computer networks. From a legal standpoint, banners have following primary functions.</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>


Banners may be used to generate consent to real-time monitoring under                                               <xhtml:a href="https://bja.ojp.gov/program/it/privacy-civil-liberties/authorities/statutes/1285">ECPA</xhtml:a>


 Title III.                                        </xhtml:li>
                        <xhtml:li>


Banners may be used to generate consent to the retrieval of stored files and records pursuant to                                               <xhtml:a href="https://bja.ojp.gov/program/it/privacy-civil-liberties/authorities/statutes/1285">ECPA</xhtml:a>


.                                        </xhtml:li>
                        <xhtml:li>in the case of government networks, banners may eliminate any Fourth Amendment "reasonable expectation of privacy" that government employees or other users might otherwise retain in their use of the government's network under O'Connor v. Ortega, 480 U.S. 709 (1987).</xhtml:li>
                        <xhtml:li>In the case of a non-government network, banners may establish a system administrator's "common authority" to consent to a law enforcement search pursuant to United States v. Matlock, 415 U.S. 164 (1974)." (US Department of Justice APPENDIX A: Sample Network Banner Language)</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>In your country different laws might apply. Please consult with your corporate legal team to assess the exact legal context and rules for banners.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Configure an MOTD banner as shown below. The delimiter character shown is a "^", but any character can serve as a delimiter.</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# banner motd ^                                                    <br></br>


&gt; Enter MOTD Banner here.                                                    <br></br>


&gt; End this message with the same delimiter as above                                                    <br></br>


&gt; ^                                                    <br></br>


switch(config)#
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Organizations provide appropriate legal notice(s) and warning(s) to persons accessing their networks by using a 'banner-text'.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6925965" value-id="xccdf_org.cisecurity.benchmarks_value_6925965_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6925965"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Post-authentication_Banner" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Post-authentication Banner</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>A post-authentication banner is displayed to the user after a successful login. It can also serve as a legal notice to authorized users of the equipment to notify them of any logging that may be configured.</xhtml:p>
                     <xhtml:p>This banner is not appropriate to notify unauthorized users of any penalties to accessing the device, because after successful login corresponding laws might have already been violated.</xhtml:p>
                     <xhtml:p>A post-authentication banner can often also hold asset-specific information, such as:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>The primary technical contacts for the equipment</xhtml:li>
                        <xhtml:li>Location or environment information - for instance the street address or rack number or production / test / lab environment</xhtml:li>
                        <xhtml:li>The purchase date</xhtml:li>
                        <xhtml:li>The asset tag information for the device</xhtml:li>
                        <xhtml:li>Any upstream circuit numbers</xhtml:li>
                        <xhtml:li>Carrier or ISP support phone numbers</xhtml:li>
                        <xhtml:li>Any other asset-specific information that may be important to the organization</xhtml:li>
                     </xhtml:ul>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>In contrast to IOS(-XE) or IOS XR, NX-OS just supports two banner types:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>motd banner  (shown before authentication)</xhtml:li>
                           <xhtml:li>exec banner  (shown after successful authentication)</xhtml:li>
                        </xhtml:ol>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Post-authentication banners can be used to reduce the risk of human error. For example by highlighting the current environment (Production or Lab).</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Configure an exec banner as shown below. The delimiter character shown is a "^", but any character can serve as a delimiter.</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# banner exec ^                                                    <br></br>


&gt; Enter your standard EXEC Banner text here.  End with the same delimiter as used above                                                    <br></br>


&gt; ^                                                    <br></br>


switch(config)#
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Organizations provide appropriate notice(s) and warning(s) to persons accessing their networks by using a 'banner-text'.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6925966" value-id="xccdf_org.cisecurity.benchmarks_value_6925966_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6925966"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.4_Password_Rules">
               <xccdf:title xml:lang="en">Password Rules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Rules in the password class enforce secure, local device authentication credentials.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Enable_Password_Complexity_Requirements_for_Local_Credentials" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Enable Password Complexity Requirements for Local Credentials</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>While configuring a back-end authentication store is the recommended configuration, at least one local administrative account must be configured.  For this reason, ensuring a minimum bar for password strength for all local administrative accounts is important.  Enabling this setting enforces passwords that conform to the following rules:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>At least eight characters long</xhtml:li>
                        <xhtml:li>Does not contain many consecutive characters (such as "abcd")</xhtml:li>
                        <xhtml:li>Does not contain many repeating characters (such as "aaabbb")</xhtml:li>
                        <xhtml:li>Does not contain dictionary words</xhtml:li>
                        <xhtml:li>Does not contain proper names</xhtml:li>
                        <xhtml:li>Contains both uppercase and lowercase characters</xhtml:li>
                        <xhtml:li>Contains numbers</xhtml:li>
                     </xhtml:ul>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:a href="https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_0/nx-os/security/configuration/guide/sec_nx-os_config/sec_rbac.html#wp1314939">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_0/nx-os/security/configuration/guide/sec_nx-os_config/sec_rbac.html#wp1314939</xhtml:a>
                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>While in ideal conditions local credentials won't be used, there are many scenarios (such as deployed on a purely public network or on an air gapped network) where this is the only option.  Even if a back-end authentication source is used, if that service is not available the fall-back authentication is often to local credentials.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>A single command enables this:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# password strength-check
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Having a simple password (for instance, based on a dictionary word) for administrative credentials makes that account susceptible to credential stuffing attacks.  Even if using a back-end credential store such as TACACS+ or RADIUS, an attacker can drill down to the local credentials by taking the back-end service offline.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6939241" value-id="xccdf_org.cisecurity.benchmarks_value_6939241_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939241"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4.2_Configure_Password_Encryption" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure Password Encryption</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>You can enable strong, reversible 128-bit Advanced Encryption Standard (AES) password encryption, also known as type-6 encryption. To start using type-6 encryption, you must enable the AES password encryption feature and configure a master encryption key, which is used to encrypt and decrypt passwords. After you enable AES password encryption and configure a master key, all existing and newly created clear-text passwords for supported applications (currently RADIUS and TACACS+) are stored in type-6 encrypted format, unless you disable type-6 password encryption. You can also configure Cisco NX-OS to convert all existing weakly encrypted passwords to type-6 encrypted passwords.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Encrypt Data on Removable Media" urn="urn:cisecurity.org:controls:8.0:3:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Encryption is a good way to protect data that will be used later. Encrypted data can later be decrypted to its original value. Although encrypting passwords protects them, typically, an application uses the same encryption key for storing all user passwords.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/5_x/nx-os/security/configuration/guide/b_Cisco_Nexus_7000_NX-OS_Security_Configuration_Guide__Release_5-x/b_Cisco_Nexus_7000_NX-OS_Security_Configuration_Guide__Release_5-x_chapter_010101.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Configure a master key to be used with the AES password encryption feature.  The key can contain between 16 and 32 alphanumeric characters</xhtml:p>
                           <xhtml:code class="code_block">


switch# key config-key ascii                                                    <br></br>


New Master Key:                                                    <br></br>


Retype Master Key:
                                              </xhtml:code>
                           <xhtml:code class="code_block">switch(config)# feature password encryption aes
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Encryption of passwords is used to protect it from being sent over the wire cleartext. By applying encryption you are making it more difficult for an adversary to gain access to your device/network</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Set password lifetime, warning time and grace time for local credentials</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>NX-OS has commands to adjust the permitted lifetime of passphrases for local credentials, as well as the "warning time" before expiry and the "grace time" after expiry.
If local credentials are in use, it is recommended that these be set to a value appropriate to the organization.
Note that these timers cannot be set for the "admin" credential.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Log Sensitive Data Access" urn="urn:cisecurity.org:controls:8.0:3:14">
                              <controls:implementation_groups ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Data</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Regularly changing passwords helps mitigate the risks associated with compromised credentials, as passwords can be compromised through various means such as phishing attacks, data breaches, or being shared inadvertently. Even if your password is strong, it might still be leaked in a data breach from another service, so regularly changing passwords reduces the impact of such leaks by ensuring compromised passwords eventually become outdated. Additionally, regular password changes encourage users to maintain good security hygiene, serving as a reminder to choose strong, unique passwords and avoid reusing old ones. Many organizations have policies and compliance requirements that mandate regular password changes, and adhering to these policies ensures that security standards are met and reduces the risk of non-compliance penalties. Finally, if an attacker gains access to an account, they can maintain access for an extended period if the password is never changed. Regularly changing passwords helps disrupt such long-term unauthorized access.</xhtml:p>
                     <xhtml:p>In accordance with CIS password guidance it is recommended that you change the passphrase every 365 days or less.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/14" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To set passphrase timers globally:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# userpassphrase default-warntime &lt;days&gt;                                                    <br></br>


switch(config)# userpassphrase default-gracetime &lt;days&gt;                                                    <br></br>


switch(config)# userpassphrase default-lifetime &lt;days&gt;                                                    <br></br>
                           </xhtml:code>
                           <xhtml:p>example:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# userpassphrase default-warntime 10                                                    <br></br>


switch(config)# userpassphrase default-gracetime 10                                                    <br></br>


switch(config)# userpassphrase default-lifetime 365
                                              </xhtml:code>
                           <xhtml:p>To set passphrase time values per-user:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# username &lt;userid&gt; passphrase lifetime &lt;days&gt; warntime &lt;time in days&gt; gradetime &lt;time in days&gt;
</xhtml:code>
                           <xhtml:p>example</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# username test passphrase lifetime 365 warntime 10 gracetime 10
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


If local credentials are in regular use, it is recommended that a reasonable (non default) value be set for the passphrase timer values.                                                          <xhtml:br></xhtml:br>



The default of an infinite lifetime is of course not appropriate.  Previous guidance of password changes on 30 or 60 day cycles however is also not appropriate if complex passwords are used and enforced.
Some middle ground should be set - for instance, a password change cycle on a 6 or 12 month rotation is often easy to track.                                                    </xhtml:p>
                              <xhtml:p>This entire discussion illustrates clearly why it is most often advisable to use a back-end authentication source for credential storage.  In an organization that has multiple switches and other infrastructure, setting a password rotation is a recipe that has the risk of missing or entirely forgetting the change date, or of missing one or more devices in the change procedure.  Since password recovery after the grace period involves a reboot of the entire switch, this end result is undesirable in the extreme.</xhtml:p>
                              <xhtml:p>The best recommendation is to set a long, complex password for any local administrative accounts, then use a back-end authentication source, so that these local accounts are only used in the event that the back-end authentication source is not reachable.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6939238" value-id="xccdf_org.cisecurity.benchmarks_value_6939238_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939238"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6939239" value-id="xccdf_org.cisecurity.benchmarks_value_6939239_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939239"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4.4_Set_password_length_for_local_credentials" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Set password length for local credentials</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>


Password length should be set to some value that makes compromising any captured hashed difficult.  This generally means that the maximum value of 127 should never be changed, and that the minimum value, which defaults to 8, should always be increased.
Typical values for minimum passphrase length of administrative users are generally 20 characters or longer (values of 30 or 32 are often seen).                                        <xhtml:br></xhtml:br>



A specific value is not recommended, since then a savvy attacker may start their attack with "only passwords of the exact length recommended in the CIS benchmark", which would reduce their attack time.                                  </xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Passwords are stored in a non-reversible, hashed and salted format.  If an attacker should "harvest" a password hash, it is of course hashed in a non-reversible format - however, it can be decoded using dictionary and/or brute-force attacks using tools such as hashcat or John the Ripper (JtR).  The single best obstacle to an attack of this type is password length - the longer the password the more difficult it is to decode.                                        <xhtml:br></xhtml:br>



Since the default password hash schema on the NX-OS version 9 platform is MD5, it's recommended that the password length be set to (and enforced at) some longer value, for instance 24, 32 or even longer values.  CIS recommends a minimum length of 16 for passphrases.
This discussion actually illustrates why the best recommendation is to not use local credentials at all, but rather to use a back-end authentication source (using RADIUS or TACACS+).  In this scenario, local administrative accounts are only used if the back-end authentication source is unavailable.  This makes any compromised local credentials much harder to use, a successful attack would have to also take back end authentication sources offline (or make them otherwise unavailable).                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Passphrase length values can only be set globally, not per-local user</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# userpassphrase min-length &lt;minimum passphrase length&gt;                                                    <br></br>


switch(config)# userpassphrase max-length &lt;maximum passphrase length&gt;
                                              </xhtml:code>
                           <xhtml:p>or in a single command:
userpassphrase min-length  max-length </xhtml:p>
                           <xhtml:p>example:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# userpassphrase min-length 20                                                    <br></br>


switch(config)# userpassphrase max-length 127
                                              </xhtml:code>
                           <xhtml:p>Or in a single command:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# userpassphrase min-length 20 max-length 127
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Not setting a maximum value leaves administrators with the freedom to set short passwords.  If a stored configuration file is collected by an attacker (perhaps from a file share), this means that any password hashes in the stored configuration will be more likely to be "cracked", giving the attacker the unencrypted credential to the target switch.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6939240" value-id="xccdf_org.cisecurity.benchmarks_value_6939240_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939240"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.5_Logging">
               <xccdf:title xml:lang="en">Logging</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_Syslog_Logging_is_configured" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Ensure Syslog Logging is configured</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Logging should be configured such that:
Logging level is set to a level sufficient for the target device
Logs should be sent off the device to a syslog or trap server or servers
Logs should be sourced from a consistent interface to ensure easy attribution of logs to the correct device
Logging levels should be explicitly set to a level appropriate to the device.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Command-Line Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:8">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Logging on any network device is always limited by how much storage can be set aside for logs.  It's important for this reason to send all log entries to a central device that can collect and correlate all logs, either in a database or in flat text files.
The key thing this approach contributes is central logs on a larger storage device (disk)
Logging to an off-device target also makes clearing any incriminating logs more difficult for an attacker, or if an attempt is made to hide a mistake.                                        <xhtml:br></xhtml:br>



Logging off-device also ensures that any clearing of logs is also seen and can be alerted on.
Sourcing all logs from a consistent interface ensures that log entries can be easily attributed to the correct device once they arrive at the log server.  If a logging interface is not set, the source IP address of individual log entries can change as the network topology changes.  This situation can make any subsequent log analysis more difficult.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Configure a logging level and a syslog host:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#logging server &lt;server ip address or name&gt;                                                     <br></br>


switch(config)#logging level &lt;service name&gt; &lt;logging level&gt;
                                              </xhtml:code>
                           <xhtml:p>or</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#logging level all &lt;logging level&gt;
switch(config)#logging source-interface &lt;interface name&gt;
switch(config)#logging server &lt;server ip address or name&gt; 
</xhtml:code>
                           <xhtml:p>optionally:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#logging server &lt;server ip address or name&gt;  vrf [management vrf name]
switch(config)#logging source-interface &lt;mgmt 0 or other dedicated management interface&gt;
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Because syslog traffic is not encrypted, it's recommended to ensure that the path the log traffic takes is not susceptible to any MiTM (Monkey in the Middle) attacks.  Often this means assigning a dedicated management interface, which by default is in a separate VRF.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6943546" value-id="xccdf_org.cisecurity.benchmarks_value_6943546_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6943546"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5.2_Log_all_Successful_and_Failed_Administrative_Logins" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Log all Successful and Failed Administrative Logins</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>By default failed logins are logged, but successful logins are not logged.  This makes any configuration changes or successful malicious activity difficult to correctly attribute.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Enforce Automatic Device Lockout on Portable End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:10">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Respond</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Require MFA for Administrative Access" urn="urn:cisecurity.org:controls:8.0:6:5">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Monitor Attempts to Access Deactivated Accounts" urn="urn:cisecurity.org:controls:7.0:16:12">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Users</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>The methods in this recommendation are applicable to all NX-OS platforms.  Some platforms will also support "login on-success" and "login on-failure" commands, but because of inconsistent support the use of these commands are not recommended.</xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Logging of all device login attempts allows the security team to investigate all login attempts and successful logins as needed.  In some organizations and for some switches, even successful logins will be configured to generate an alert that must be compared against authorized changes or assigned tickets.
Without logging both successful and failed logins, several important components of any investigation may not be easily available for any subsequent investigation or analysis (userids, source IP addresses, login times and so on).</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/12" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">switch(config)# login level authpriv 5
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Not logging successful logins means that unauthorized commands changes will be more difficult to attribute to the right person (though changes are logged with the login name by default on NX-OS).  It also means that otherwise suspicious but successful logins (either because of the time of login, the source IP or other indicator) are not logged for further investigation.</xhtml:p>
                              <xhtml:p>Not logging unsuccessful logins means that brute force login attempts are not properly logged.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5.3_Configure_Netflow_on_Strategic_Ports" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure Netflow on Strategic Ports</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Netflow allows for detailed logging of transit traffic.  For a Layer 3 Netflow configuration, this outlines several values identified as "keys": source and destination ports and protocols, source and destination IP addresses as well as traffic volumes in any combination.  Sometimes QOS values (TOS bits only) is also used as a key.  Each combination of Protocol, source port, destination port, source IP, destination IP is called a "tuple".  The possible keys in a Layer 2 Tuple include source mac address, destination mac address, ethertype and vlan.</xhtml:p>
                     <xhtml:p>In most cases logging to this level is not recommended for all ports of an NX-OS device, with 10G or faster ports there is just too much data to log and process in a meaningful way, even with sampling (which is required).</xhtml:p>
                     <xhtml:p>However, for strategic ports (for instance, something facing a WAN link or traffic constrained server) this can be a good tool for troubleshooting.  This sort of logging does take a fair amount of host resources, so if there is an upstream firewall or router, that device is often better suited to be a Netflow initiator, but if for instance the upstream device is owned by a carrier or a client, or is a host that needs this sort of telemetry, most NX-OS devices are certainly capable of providing Netflow telemetry.</xhtml:p>
                     <xhtml:p>On many NX-OS platforms only inbound Netflow is supported.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Centralize Security Event Alerting" urn="urn:cisecurity.org:controls:8.0:13:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Network Traffic Flow Logs " urn="urn:cisecurity.org:controls:8.0:13:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>If needed, either Layer 3 or Layer 2 netflow can be configured.</xhtml:p>
                           <xhtml:p>Layer 3 IP and IPv6 flow monitors can be applied to VLANs, SVIs, Layer 3 routed interfaces or subinterfaces.</xhtml:p>
                           <xhtml:p>Layer 2 flow monitors can be applied to a physical interface or trunks</xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>L3 netflow - typical application to a VLAN is shown</xhtml:strong>
                           </xhtml:p>
                           <xhtml:p>First, enable the netflow feature:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#feature netflow
</xhtml:code>
                           <xhtml:p>The flow record defines what data to record and export.  Typical settings are shown, the important thing is that a valid flow record setting exists:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# flow-record FLOW-RECORD                                                    <br></br>


switch(config-flow-record)#  match ipv4 protocol                                                    <br></br>


switch(config-flow-record)#  match ipv4 source address                                                    <br></br>


switch(config-flow-record)#  match ipv4 destination address                                                    <br></br>


switch(config-flow-record)#  match transport source-port                                                    <br></br>


switch(config-flow-record)#  match transport destination-port                                                    <br></br>


switch(config-flow-record)#  collect routing source as                                                    <br></br>


switch(config-flow-record)#  collect routing destination as                                                    <br></br>


switch(config-flow-record)#  collect transport tcp flags                                                    <br></br>


switch(config-flow-record)#  collect counter bytes                                                    <br></br>


switch(config-flow-record)#  collect counter packets
                                              </xhtml:code>
                           <xhtml:p>The flow exporter defines the destination and options around sent data.  Again, the specific values are not important.  The VRF can be specified in the "destination" line if needed.:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# flow exporter FLOW-EXPORT                                                    <br></br>


switch(config-flow-exporter)# transport udp 9996                                                    <br></br>


switch(config-flow-exporter)# destination 10.10.10.10                                                    <br></br>


switch(config-flow-exporter)# source mgmt 0                                                    <br></br>


switch(config-flow-exporter)# version 9                                                    <br></br>


switch(config-flow-exporter-version-9)# option exporter-stats timeout 120                                                    <br></br>


switch(config-flow-exporter-version-9)# option interface-table timeout 120
                                              </xhtml:code>
                           <xhtml:p>The flow monitor "ties" the exporter and record together:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# flow monitor FLOW-MONITOR                                                    <br></br>


switch(config-flow-monitor)# exporter FLOW-EXPORT                                                    <br></br>


switch(config-flow-monitor)#  record FLOW-RECORD
                                              </xhtml:code>
                           <xhtml:p>The sampling rate, "x packets out of y" can also be defined. Both should be a power of 2 (for instance, 8 out-of 64 is a valid combination)</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#sampler FLOWSAMPLER01                                                     <br></br>


switch(config-flow-sampler)# mode 8 out-of 64
                                              </xhtml:code>
                           <xhtml:p>Finally, apply the monitor and optionally the sampler to a layer 3 interface:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config-flow-monitor)# int vlan &lt;interface number&gt;                                                    <br></br>


10GCORE01(config-if)# ip flow monitor FLOW-MONITOR input sampler FLOWSAMPLER01
                                              </xhtml:code>
                           <xhtml:p>=======================================</xhtml:p>
                           <xhtml:p>**L2 netflow - typical application to physical interface shown **</xhtml:p>
                           <xhtml:p>Because if it's reliance on MAC Addresses, L2 netflow implementations are much less often used</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#feature netflow
</xhtml:code>
                           <xhtml:p>The exporter configuration remains the same as L3:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# flow exporter L2_FLOWEXPORTER01                                                     <br></br>


switch(config-flow-exporter)# destination &lt;netflow server ip&gt; [use-vrf management]                                                    <br></br>


switch(config-flow-exporter)# transport udp &lt;netflow port&gt;                                                     <br></br>


switch(config-flow-exporter)# source mgmt0                                                     <br></br>


switch(config-flow-exporter)# version 9
                                              </xhtml:code>
                           <xhtml:p>The flow record reflects different (layer 2) tuple inputs:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# flow record L2_FLOWRECORD01                                                    <br></br>


switch(config-flow-record)#  match datalink ethertype                                                     <br></br>


switch(config-flow-record)#  match datalink mac source-address                                                     <br></br>


switch(config-flow-record)#  match datalink mac destination-address                                                     <br></br>


switch(config-flow-record)#  match datalink vlan
                                              </xhtml:code>
                           <xhtml:p>The flow monitor remains similar:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# flow monitor L2_FLOWMONITOR01                                                     <br></br>


switch(config-flow-monitor)# record L2_FLOWRECORD01                                                     <br></br>


switch(config-flow-monitor)# exporter L2_FLOWEXPORTER01
                                              </xhtml:code>
                           <xhtml:p>The flow sampler commands remain the same</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#sampler FLOWSAMPLER01                                                     <br></br>


switch(config-flow-sampler)# mode &lt;x&gt; out-of &lt;y&gt;
                                              </xhtml:code>
                           <xhtml:p>Finally, apply the L2 definition to an L2 interface:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# int Ethernet x/yy                                                     <br></br>


switch(config-if)# layer2-switched flow monitor L2_FLOWMONITOR01 input sampler FLOWSAMPLER01
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If monitored graphically, often just a visual inspection of the netflow graphs will highlight anomalous traffic.  For instance, a high volume exfiltration from a database server would show a spike of traffic from that database server to a host on the internet (which in most environments is not a normal pattern).</xhtml:p>
                              <xhtml:p>In many cases the netflow database can be queried directly, so anomalies can be queried for programmatically.  However, coding "what is not normal" is not something that is easily done in procedural languages.  AI or ML frameworks such as TensorFlow may be helpful in this situation.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5.4_Configure_Logging_Timestamps" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure Logging Timestamps</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Timestamps are incredibly important since they drive a number of important activities in our product. Most importantly, we use timestamps to filter data in your search results.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Using timestamps allow you to discover the timeframe of an incident.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Use the "logging timestampe" command to configure this setting.  Note that if set to "seconds" (the default), this command will not appear in the configuration.</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# logging timestamp {microseconds | milliseconds | seconds}
</xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.6_Time_Services">
               <xccdf:title xml:lang="en">Time Services</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6.1_Configure_at_least_2_external_NTP_Servers" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure at least 2 external NTP Servers</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Accurate time is a critical piece of security infrastructure.  Without accurate time on all infrastructure, it is complex or even impossible to correlate events from multiple sources to get an accurate view of a security incident or technical issue.
Using multiple sources gives redundancy in time sources.
In most infrastructures, for efficiency only a small subset of devices (often a redundant pair of routers or switches) will use redundant external time sources.  All other infrastructure will then synchronize time from them.  This also means that any perimeter firewalls can be configured to limit NTP requests to the public internet to just those sources and destinations.
The exception would of course be if the organization has an on-premise, internal atomic or GPS based network time source.  Even in those situations an tiered NTP infrastructure is generally recommended on the internal network.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Accurate time is a critical piece of security infrastructure.  Without accurate time on all infrastructure, it is complex or even impossible to correlate events from multiple sources to get an accurate view of a security incident or technical issue.
Also, without accurate time authentication issues can arise.  If an attacker can influence the NTP traffic, it is possible to "back-date" NTP responses to permit the use of older certificates, or "forward-date" NTP responses to invalidate any certificates in use on the device.
Using multiple sources gives redundancy in time sources.
If a management network is in use in the infrastructure, using the management VRF to source time can help to protect NTP response traffic from tampering.
It is key to set an NTP source interface, so that any perimeter devices can be configured to permit NTP requests from those IP addresses, and to restrict NTP requests to a list of authorized IP addresses.  Be sure that this is a "reliable" interface.  In many cases this means using a loopback interface, so that any of several interfaces can be used to route the request to the NTP server.  If a non-loopback interface is used, understand that if that interface is in a down state then NTP requests will not be sent.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>If the default VRF is used (note that the IP addresses are for demonstrations purposes only, production configurations will likely vary):</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#ntp server 13.86.101.172 use-vrf default                                                    <br></br>


switch(config)#ntp server 132.163.97.6 use-vrf default                                                    <br></br>


switch(config)#ntp server 132.246.11.231 use-vrf default                                                    <br></br>


switch(config)#ntp source-interface loopback1
                                              </xhtml:code>
                           <xhtml:p>If a management VRF is used:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#ntp server 13.86.101.172 use-vrf management                                                    <br></br>


switch(config)#ntp server 132.163.97.6 use-vrf management                                                    <br></br>


switch(config)#ntp server 132.246.11.231 use-vrf management                                                    <br></br>


switch(config)#ntp source-interface loopback1
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Accurate time is a critical piece of security infrastructure.  Without accurate time on all infrastructure, it is complex or even impossible to correlate events from multiple sources to get an accurate view of a security incident or technical issue.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6.2_Configure_a_Time_Zone" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Configure a Time Zone</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Timezones are a source of contention in larger corporations.  On one hand, if infrastructure is configured with time consistent with the local timezone, then it is simpler to co-relate end-user symptoms and logs on end-user equipment with logs from network equipment.
On the other hand, in organizations that span multiple time zones, configuring local time can make it easy to mis-match log entries from gear in different time zones.</xhtml:p>
                     <xhtml:p>In some organizations, the solution is to post both local and UTC time in all log entries.  In other organizations, all gear is configured for one timezone (either UTC or "head office time").</xhtml:p>
                     <xhtml:p>The important thing is to have a standard for time zone, and to configure it consistently across all hosts and infrastructure equipment.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To set the timezone, define the timezone name, the offset in hours, then the offset in seconds.  The example below shows EST (Offset of -5 hours, zero seconds).</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# clock timezone EST -5 0
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Not having a consistent time zone policy across all hosts and infrastructure means that when dealing with a security incident or technical issue, it becomes very easy to mis-match logs as affected hosts span multiple time zones.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6960031" value-id="xccdf_org.cisecurity.benchmarks_value_6960031_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6960031"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6.3_If_a_Local_Time_Zone_is_used_Configure_Daylight_Savings" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">If a Local Time Zone is used, Configure Daylight Savings</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>If local time zones are configured on network infrastructure, it is important to also configure the time "shift" that occurs as a result of Daylight Savings Time.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Utilize Three Synchronized Time Sources" urn="urn:cisecurity.org:controls:7.0:6:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>In most cases, just the name of the DST timezone name is sufficient.  NX-OS assumes 1 hour offset, using the United States dates for DST.</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# clock summer-time &lt;DST Timezone Name&gt;
</xhtml:code>
                           <xhtml:p>for example:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# clock summer-time EDT
</xhtml:code>
                           <xhtml:p>If a full definition of the change is needed, it can certainly be set:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# clock summer-time &lt;DST Timezone Name&gt; &lt;day1&gt; &lt;month1&gt; &lt;time1&gt; &lt;day2&gt; &lt;month2&gt; &lt;time2&gt; &lt;offset in minutes&gt;
</xhtml:code>
                           <xhtml:p>where:</xhtml:p>
                           <xhtml:ul>
                              <xhtml:li>day1, month1, time1 define the start of the DST period</xhtml:li>
                              <xhtml:li>day2, month2, time2 define the end of the DST period</xhtml:li>
                           </xhtml:ul>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If local time zones are configured on network infrastructure, it is usually to simplify relating reported end-user issues back to local time entries in the logs.  So if local time zones are configured and used in this manner, it becomes important to also configure the time "shift" that occurs as a result of Daylight Savings Time (or "summer-time" on the Cisco CLI)</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6.4_Configure_NTP_Authentication" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure NTP Authentication</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>By default, NTP is a clear text, unauthenticated protocol.  However, it can be configured to authenticate time sources.  NTP authentication is an upstream protocol only - authenticated clients have assurance that they are receiving correct time, that the ntp packets have not been tampered with.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Standardize Time Synchronization" urn="urn:cisecurity.org:controls:8.0:8:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Centralize Network Authentication, Authorization, and Auditing (AAA)" urn="urn:cisecurity.org:controls:8.0:12:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Maintenance, Monitoring and Analysis of Audit Logs" urn="urn:cisecurity.org:controls:7.0:6"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Configuring authentication ensures that if the server key does not match the key configured on the NTP client, that the client will drop any NTP replies from that server.
If multiple keys are configured,</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# ntp authenticate                                                     <br></br>


switch(config)# ntp authentication-key 42 md5 my-ntp-key                                                    <br></br>


switch(config)# ntp trusted-key 42                                                    <br></br>


switch(config)# ntp server 132.246.11.231 use-vrf management key 42
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.7_Other_Services_and_Accesses">
               <xccdf:title xml:lang="en">Other Services and Accesses</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.7.1_Disable_Power_on_Auto_Provisioning_POAP" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Disable Power on Auto Provisioning (POAP)</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>PowerOn Auto Provisioning (POAP) allows the switch to be auto-provisioned at the time of power-on.  This can be extremely useful in a tightly controlled environment, with a solid "network as code" mindset and dev-ops procedures in place for network operations.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190306-info-poap</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To disable POAP, use the command:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# no boot poap enable
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Without solid procedures and a well-controlled environment, POAP provides a malicious actor the ability to compromise a switch as it is being deployed out of the box.  This "day 0" approach to compromising gives the attacker control of the switch from the start - it can be difficult to detect that this has occurred, and may require physical access to gain control back.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6943547" value-id="xccdf_org.cisecurity.benchmarks_value_6943547_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6943547"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.7.2_Disable_iPXE_Pre-boot_eXecution_Environment" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Disable iPXE (Pre-boot eXecution Environment)</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>iPXE allows a NX-OS device to boot from the network, usually using HTTP.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Use Automated Tools to Verify Standard Device Configurations and Detect Changes" urn="urn:cisecurity.org:controls:7.0:11:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>This method allows the switch bootup image to be controlled centrally, often using DHCP services.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Setting the boot order explicity to "bootflash" will remediate a PXE configured device.</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# boot order bootflash
</xhtml:code>
                           <xhtml:p>You can also "no" the current boot order line to revert to the default setting.  For instance, to remove the configuration line "boot order pxe bootflash" command, use</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# no boot order pxe bootflash
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>The risks of using this boot method are obvious.  First, DHCP is a broadcast request, so any host (including a malicious host) can provide the DHCP response - the first response "wins".  This means that a malicious actor can control operating system being booted on the switch.
In addition, the HTTP protocol is clear-text, so is susceptible to modification in transit by an attacker.  This is a less likely attack however, as the NX-OS boot sequence has multiple checks in place to verify the validity of the OS, and all most succeed for the boot sequence to proceed.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6943548" value-id="xccdf_org.cisecurity.benchmarks_value_6943548_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6943548"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.7.3_Set_SSH_Key_Modulus_Length" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Set SSH Key Modulus Length</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>SSH sessions are encrypted using a key unique to the host (in this case the NX-OS switch).  It is recommended that this key be 2048 bytes long or longer.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use Only Standardized and Extensively Reviewed Encryption Algorithms" urn="urn:cisecurity.org:controls:7.0:18:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>While attacking encryption algorithms is not practical for commodity malware, it definitely is possible.  As remediation is so easily done it is definitely recommended.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Again, this must be implemented using an out-of-band (ie - not ssh) method.</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# no feature ssh                                                    <br></br>


switch(config)# ssh key rsa 2048 force                                                    <br></br>


switch(config)# feature ssh
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Implementing this feature requires the deletion of the existing (default) ssh keys, which are 1024 bytes in length.
This means that this change must be implemented using some other access method, such as using the console port or a temporary telnet session (be sure to disable telnet after remediation if this method is used)</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.8_Encryption">
               <xccdf:title xml:lang="en">Encryption</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.8.1_Enable_FIPS_Mode" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Enable FIPS Mode</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>FIPS mode in NX-OS refers to the Federal Information Processing Standards (FIPS) 140-2 compliance mode. FIPS 140-2 is a U.S. government standard that specifies security requirements for cryptographic modules. When FIPS mode is enabled on NX-OS devices, it ensures that the cryptographic functions and processes adhere to these stringent security standards.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Explicitly Not Mapped" urn="urn:cisecurity.org:controls:8.0:0:0">
                              <controls:implementation_groups></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Explicitly Not Mapped" urn="urn:cisecurity.org:controls:7.0:0:0">
                              <controls:implementation_groups></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                     <notes:notes xml:lang="en">
                        <xhtml:p>
                           <xhtml:strong>
                              <xhtml:span class="inline_block">This setting has potential to impact systems if they are not in compliance.  Ensure proper steps are taken before enabling this feature</xhtml:span>
                           </xhtml:strong>
                        </xhtml:p>
                     </notes:notes>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>


Enabling FIPS mode in NX-OS is important for several reasons:
                                        <xhtml:strong>1.</xhtml:strong>


 Compliance with Government Standards: FIPS 140-2 is a U.S. government standard that specifies security requirements for cryptographic modules. Enabling FIPS mode ensures that your device complies with these stringent security standards, which is often a requirement for government and regulated industries.
                                        <xhtml:strong>2.</xhtml:strong>


 Enhanced Security: FIPS mode enforces the use of FIPS-approved cryptographic algorithms and modules. This ensures that only secure and validated cryptographic functions are used, reducing the risk of vulnerabilities and attacks.
                                        <xhtml:strong>3.</xhtml:strong>


 Self-Tests and Error Handling: FIPS mode includes self-tests and error handling mechanisms. The device performs power-up self-tests and conditional self-tests to verify the proper functioning of cryptographic modules. If any self-test fails, the device logs a system message and enters an error state, ensuring that any issues are promptly detected and addressed.
                                        <xhtml:strong>4.</xhtml:strong>


 Trust and Assurance: Enabling FIPS mode provides assurance to users and stakeholders that the device meets high security standards. This can be particularly important in environments where data security and integrity are critical.                                  </xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/0/subcontrol/0" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/0/subcontrol/0" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus7000/sw/security/config/cisco_nexus7000_security_config_guide_8x/configuring_fips.html#:~:text=NX%2DOS%20devices.-,Enabling%20FIPS%20Mode,Disabling%20FIPS%20Mode</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">switch(config)#fips mode enable
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Enabling FIPS mode may cause some performance overhead because of the extra processing required. Additionally, it limits the range of available algorithms, meaning that some non-FIPS protocols and algorithms might be restricted or disabled. To ensure compliance with FIPS standards, certain configuration options and features may also be limited.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.9_SNMP">
               <xccdf:title xml:lang="en">SNMP</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Configure SNMPv3</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The Simple Network Management Protocol (SNMP) is an application-layer protocol that provides a message format for communication between SNMP managers and agents. SNMP provides a standardized framework and a common language used for the monitoring and management of devices in a network. SNMPv3 provides secure access to devices by a combination of authenticating and encrypting frames over the network.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Manage Network Devices Using Multi-Factor Authentication and Encrypted Sessions" urn="urn:cisecurity.org:controls:7.0:11:5">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>SNMPv3 provides for both security models and security levels. A security model is an authentication strategy that is set up for a user and the role in which the user resides. A security level is the permitted level of security within a security model. A combination of a security model and a security level determines which security mechanism is employed when handling an SNMP packet.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/system_management/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide/sm_9snmp.html?form=MG0AV3</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Create SNMPv3 Users (and groups if needed).  Ensure that SHA hashes are used rather than MD5.  Also ensure that appropriate authorization levels are set ("network-admin" is shown below):</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#snmp-server user SNMPv3_UserName network-admin auth sha 0x12624c4dcb90cffeb43a1177324f547d priv 0x12624c4dcb90cffeb43a1177324f547d localizedkey
</xhtml:code>
                           <xhtml:p>To set SNMP to version 3, add the "version" parameter to the snmp-server command (note that SNMPv3 users and groups need to be configured first):</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# snmp-server host 1.2.3.4 traps version 3 priv &lt;SNMPv3_UserName&gt;
</xhtml:code>
                           <xhtml:p>To enforce encryption for all SNMPv3 Users.  This can be done by individual user, but it's recommended to enforce it globally:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# snmp-server globalEnforcePriv
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>SNMPv3 provides security features such as:</xhtml:p>
                              <xhtml:ul>
                                 <xhtml:li>
                                    <xhtml:strong>
                                       <xhtml:em>Message Integrity</xhtml:em>
                                    </xhtml:strong>


 - Ensures that a packet has not be tampered with                                                          </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:strong>
                                       <xhtml:em>Authentication</xhtml:em>
                                    </xhtml:strong>


 - Determines message is from a valid source                                                          </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:strong>
                                       <xhtml:em>Encryption</xhtml:em>
                                    </xhtml:strong>


 - Scrambles the packet content to prevent being seen by unauthorized sources.                                                          </xhtml:li>
                              </xhtml:ul>
                              <xhtml:p>SNMPv2 does not provide any of these features, as SNMPv2 is a cleartext protocol that exposes the community string in each exchange of information.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6939242" value-id="xccdf_org.cisecurity.benchmarks_value_6939242_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939242"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939243"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Configure SNMP Traps</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>SNMP relies on an architecture which consists of a manager and an agent. SNMP Managers can be any machine on the network that is running SNMP to collect and process information from the devices on either the LAN or WAN.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Collect Network Traffic Flow Logs " urn="urn:cisecurity.org:controls:8.0:13:6">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Utilizing traps can alert the user of issues or compromises in advance. For example if the device is overheating or if an admin users account is being utilized during odd hours.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/system_management/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide/sm_9snmp.html?form=MG0AV3</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:strong>
                                 <xhtml:em>Examples of traps</xhtml:em>
                              </xhtml:strong>



All notifications                                              </xhtml:p>
                           <xhtml:code class="code_block">switch(config)##switch(config)#snmp-server enable traps
</xhtml:code>
                           <xhtml:p>CISCO-AAA-SERVER-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#switch(config)#snmp-server enable traps aaa
</xhtml:code>
                           <xhtml:p>ENITY-MIB, CISCO-ENTITY-FRU-CONTROL-MIB, CISCO-ENTITY-SENSOR-MIB</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#switch(config)#snmp-server enable traps entity                                                    <br></br>


switch(config)#switch(config)#snmp-server enable traps entity fru
                                              </xhtml:code>
                           <xhtml:p>CISCO-LICENSE-MGR-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#switch(config)#snmp-server enable traps license
</xhtml:code>
                           <xhtml:p>IF-MIB</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#switch(config)#snmp-server enable traps link                                                    <br></br>


switch(config)#CISCO-PSM-MIB                                                    <br></br>


switch(config)#switch(config)#snmp-server enable traps port-security                                                    <br></br>


switch(config)#snmpv2-MIB                                                    <br></br>


switch(config)#switch(config)#snmp-server enable traps switch(config)#snmp                                                    <br></br>


switch(config)#switch(config)#snmp-server enable traps switch(config)#snmp authentication
                                              </xhtml:code>
                           <xhtml:p>CISCO-FCC-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)##switch(config)#snmp-server enable traps fcc
</xhtml:code>
                           <xhtml:p>CISCO-DM-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#snmp-server enable traps fcdomain
</xhtml:code>
                           <xhtml:p>CISCO-NS-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#snmp-server enable traps fcns
</xhtml:code>
                           <xhtml:p>CISCO-FCS-MIB</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#snmp-server enable traps fcs discovery-complete                                                    <br></br>


switch(config)#snmp-server enable traps fcs request-reject
                                              </xhtml:code>
                           <xhtml:p>CISCO-FDMI-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#snmp-server enable traps fdmi
</xhtml:code>
                           <xhtml:p>CISCO-FSPF-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#snmp-server enable traps fspf
</xhtml:code>
                           <xhtml:p>CISCO-PSM-MIB</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#snmp-server enable traps port-security
</xhtml:code>
                           <xhtml:p>CISCO-RSCN-MIB</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#snmp-server enable traps rscn                                                    <br></br>


switch(config)#snmp-server enable traps rscn els                                                    <br></br>


switch(config)#snmp-server enable traps rscn ils
                                              </xhtml:code>
                           <xhtml:p>CISCO-ZS-MIB</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)#snmp-server enable traps zone                                                    <br></br>


switch(config)#snmp-server enable traps zone default-zone-behavior-change                                                    <br></br>


switch(config)#snmp-server enable traps zone merge-failure                                                    <br></br>


switch(config)#snmp-server enable traps zone merge-success                                                    <br></br>


switch(config)#snmp-server enable traps zone request-reject                                                    <br></br>


switch(config)#snmp-server enable traps zone unsupp-mem
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6939244" value-id="xccdf_org.cisecurity.benchmarks_value_6939244_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939244"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6939245"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.9.3_Configure_source_interface_for_SNMP_Traps" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure source interface for SNMP Traps</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The administrator can configure SNMP to the interfaces source IP address for notifications</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Explicitly Not Mapped" urn="urn:cisecurity.org:controls:8.0:0:0">
                              <controls:implementation_groups></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Explicitly Not Mapped" urn="urn:cisecurity.org:controls:7.0:0:0">
                              <controls:implementation_groups></controls:implementation_groups>
                              <controls:asset_type></controls:asset_type>
                              <controls:security_function></controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>By using a source interface the administrator can ensure that the source IP of SNMP traps does not change as the network topology changes.  For instance, if a link fails or is reconfigured, and a different IP address is now topologically "closer" to the SNMP trap server.
There are a few typical candidates for an SNMP source IP address:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>A loopback address, as loopbacks are always up, and can then route over any transit interface.</xhtml:li>
                        <xhtml:li>The MGMT 0 address, as that provides an out-of-band path to the SNMP server.  SNMP traffic volume will not affect traffic volumes, and SNMP cannot be "starved" for bandwidth by production traffic.  If the entire path is out-of-band, this also provides excellent protection from eavesdropping by malicious actors that may be on the "production data side" of the switch.</xhtml:li>
                        <xhtml:li>A combination of the two (this is less common) - for instance a loopback address in the management VRF</xhtml:li>
                     </xhtml:ul>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/0/subcontrol/0" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/0/subcontrol/0" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/system_management/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide/sm_9snmp.html?form=MG0AV3</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">switch(config)# snmp-server host 1.2.3.4 source-interface mgmt 0
</xhtml:code>
                           <xhtml:p>or</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# snmp-server host 1.2.3.4 source-interface loopback 0
</xhtml:code>
                           <xhtml:p>SNMP Server traps or informs:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# snmp-server source-interface traps loopback 0                                                    <br></br>


switch(config)# snmp-server source-interface informs loopback 0
                                              </xhtml:code>
                           <xhtml:p>or</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# snmp-server source-interface traps mgmt 0                                                    <br></br>


switch(config)# snmp-server source-interface informs mgmt 0
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.9.4_Ensure_Read_Write_privileges_are_not_configured_for_SNMP" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Ensure Read Write privileges are not configured for SNMP</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>SNMP RW (Read-Write) access allows stations with Management access to both read and write SNMP MIB objects.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>SNMP is typically used for monitoring specific operational characteristics of the switch. These tasks typically only require read access. Permitting RW (Read-Write) access permits SNMP to modify some SNMP values.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Only use RO groups for SNMPv2.  The most common implementation is "network-operator", because if you use the legacy syntax:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# snmp-server community &lt;some complex string&gt; ro
</xhtml:code>
                           <xhtml:p>the switch will translate this to the new syntax, using "network-operator" group</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# snmp-server community &lt;some complex string&gt; group network-operator
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Permitting SNMP RW Access not only allows "write" access to some SNMP MIB Objects, which allows a malicious attacker to modify some operational characterstics of the switch. By extension this access allows a malicious actor to collect the entire configuration of the device.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.10_Use_Dedicated_mgmt_Interface_and_VRF_for_Administrative_Functions" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Use Dedicated "mgmt" Interface and VRF for Administrative Functions</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Vendors provisioning dedicated management interfaces is a widespread practice, and gives some significant security advantages when implementing:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>SSH access</xhtml:li>
                     <xhtml:li>SNMP polling</xhtml:li>
                     <xhtml:li>Syslog logging</xhtml:li>
                     <xhtml:li>SNMP traps</xhtml:li>
                     <xhtml:li>NTP requests</xhtml:li>
                  </xhtml:ul>
                  <xhtml:p>This practice facilitates implementation of segmented, access controlled Management VLANs or VRFs, which acts as a significant deterrent to attackers. It provides management access outside of the regular data plane operations. Also, if there is a routing or switching issue that might interfere with in-band access, the management interface is very often not affected by this and is still acceptable.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Use Dedicated Machines For All Network Administrative Tasks" urn="urn:cisecurity.org:controls:7.0:11:6">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Manage Network Infrastructure Through a Dedicated Network" urn="urn:cisecurity.org:controls:7.0:11:7">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Administration via the mgmt interface bypasses the default routing and switching processing on the switch. This means that any routing issues or switching problems on the device itself will not affect access to the mgmt0 interface. Note however that in most cases the uplink from the mgmt0 interface is part of the larger switching infrastructure - this should be taken into account when architecting the overall network.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>First configure the mgmt0 interface:</xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# interface mgmt0                                              <br></br>


switch(config-if)#   ip address 1.2.3.1/24
                                        </xhtml:code>
                        <xhtml:p>If needed, add the various routes needed for connectivity for the mgmt interface.  Note that this can also be accomplished with a routing protocol implemented for the vrf "management"</xhtml:p>
                        <xhtml:code class="code_block">


ip route 5.6.7.8 255.255.255.0 1.2.3.254 vrf management                                              <br></br>
                        </xhtml:code>
                        <xhtml:p>Then, configure the source-interface commands for each target protocol that is implemented:</xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# snmp-server source-interface traps mgmt0                                              <br></br>


switch(config)# snmp-server source-interface informs mgmt0                                              <br></br>


switch(config)# snmp-server host 1.2.3.4 source-interface loopback0                                              <br></br>


switch(config)# ntp source-interface mgmt0                                              <br></br>


switch(config)# logging source-interface mgmt0
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Using the MGMT interface and a dedicated Management VRF ensures that production and management traffic can never interfere with each other.</xhtml:p>
                           <xhtml:p>More importantly, this provides a segregated path outside of the production data plane path for management traffic.  This is important because often management traffic such as syslog and NTP are in clear text.  Routing this traffic using the production data paths gives a malicious actor the opportunity to intercept or modify this traffic, which facilitates several opportunities for reconnaissance or active attacks by modifying this data.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Control_Plane">
            <xccdf:title xml:lang="en">Control Plane</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The control plane covers monitoring, route table updates, and generally the dynamic operation of the router. This includes services, settings, and data streams that support and document the operation, traffic handling, and dynamic status of the router. Examples of control plane services include: logging (e.g. Syslog), routing protocols, status protocols like CDP and HSRP, network topology protocols like STP, and traffic security control protocols like IKE. Network control protocols like ICMP, NTP, ARP, and IGMP directed to or sent by the router itself also fall into this area.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Global_Service_Rules">
               <xccdf:title xml:lang="en">Global Service Rules</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Rules in the global service class enforce server and service controls that protect against attacks or expose the device to exploitation.</xhtml:p>
               </xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Configure_Control_Plane_Policing" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure Control Plane Policing</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Control Plane Policing is used to create a set of policies governing specific traffic.  Normally this limits the volume and type of traffic that can be directed to the IP addresses on the device, as this traffic normally must be handled in process mode by the switch CPU.  For instance, limiting the volume of ICMP traffic that can be sent to a device IP will both limit the CPU impact of that traffic and also limit the bandwidth that this traffic can take.  With 10GB and faster interfaces available, both of these considerations are important.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>You must configure control plane class maps for control plane policies.</xhtml:p>
                     <xhtml:p>You can classify traffic by matching packets based on existing ACLs. The permit and deny ACL keywords are ignored in the matching.</xhtml:p>
                     <xhtml:p>You can configure policies for IP version 4 (IPv4) and IP version 6 (IPv6) packets.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/security/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_Security_Configuration_Guide/b_Cisco_Nexus_9000_Series_NX-OS_Security_Configuration_Guide_chapter_010001.html#con_1060709</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Normally the "strict" Control Plane Policing Policy is recommended.  If additional protections are required for a specific situation, then this policy can be copied - the copy can then be modified and applied.</xhtml:p>
                           <xhtml:p>As noted in the command's response, applying a COPP Policy may disrupt other control traffic.</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# copp profile strict                                                    <br></br>


This operation can cause disruption of control traffic. Proceed (y/n)?  [no] y                                                    <br></br>


switch(config)#
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>


Configuring Control Plane Policing both limits the impact of traffic (either diagnostic or malicious traffic) on the CPU and interfaces of the device.  It also limits the impact of this traffic on available bandwidth - it can't restrict how much traffic is sent, but it certainly limits how much is processed, so by that limits the volume of reply traffic.                                                          <xhtml:br></xhtml:br>



In many DOS attacks, ideally the attacker wants the volume of the reply traffic to exceed the traffic sent - getting the victim to "amplify" the attack is almost always a desired goal of the attacker.  This DOS attack can then be directed to a third "victim" host by the use of spoofing, or the DOS attack may be just against the vulnerable device or host (in this case the NX-OS switch)                                                    </xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Data_Plane">
            <xccdf:title xml:lang="en">Data Plane</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Services and settings related to the data passing through the router (as opposed to direct to it). The data plane is for everything not in control or management planes. Settings on a router concerned with the data plane include interface access lists, firewall functionality (e.g. CBAC), NAT, and IPSec. Settings for traffic-affecting services like unicast RPF verification and CAR/QoS also fall into this area.</xhtml:p>
            </xccdf:description>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1_Secure_Routing_Protocols">
               <xccdf:title xml:lang="en">Secure Routing Protocols</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1.1_EIGRP">
                  <xccdf:title xml:lang="en">EIGRP</xccdf:title>
                  <xccdf:description xml:lang="en"></xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1.1_Configure_EIGRP_Authentication_on_all_EIGRP_Routing_Devices" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure EIGRP Authentication on all EIGRP Routing Devices</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>You can configure authentication between neighbors for EIGRP</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                        <notes:notes xml:lang="en">
                           <xhtml:p>For EIGRP environments only</xhtml:p>
                        </notes:notes>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>You can configure EIGRP authentication for the EIGRP process or for individual interfaces. Interface EIGRP authentication configuration overrides the EIGRP process-level authentication configuration.</xhtml:p>
                        <xhtml:p>Because EIGRP is a multicast protocol, any device can advertise EIGRP capabilities and routes, and by default all connected EIGRP devices will honor those advertisements.  This means that a malicious actor can advertise bogus routes to valid hosts or networks, allowing the interception and modification of traffic intended for those hosts or subnets.</xhtml:p>
                        <xhtml:p>For this reason it is important that EIGRP endpoints authenticate to each other, ensuring that only valid routers can participate in the exchange of routes.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_2/nx-os/unicast/configuration/guide/l3_cli_nxos/l3_eigrp.html#wp1075849</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Ensure that you have enabled the EIGRP feature.</xhtml:p>
                              <xhtml:p>Ensure that all neighbors for an EIGRP process share the same authentication configuration, including the shared authentication key.</xhtml:p>
                              <xhtml:p>Create the key-chain for this authentication configuration. See the Cisco NX-OS Security Configuration Guide.</xhtml:p>
                              <xhtml:p>Ensure that you are in the correct VDC (or use the switchto vdc command)</xhtml:p>
                              <xhtml:p>Configure authentication:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# router eigrp [instance-tag]                                                          <br></br>


switch(config-router)# address-family {ipv4 | ipv6} unicast                                                          <br></br>


switch(config-router)# authentication key-chain [key-chain]                                                          <br></br>


switch(config-router)# authentication mode md5
                                                    </xhtml:code>
                              <xhtml:p>Next assign the interface:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# interface [interface-type slot/port]                                                          <br></br>


switch(config-if)# router eigrp [instance-tag]                                                          <br></br>


switch(config-if)# authentication key-chain eigrp [instance-tag key-chain]                                                          <br></br>


switch(config-if)# authentication mode eigrp [instance-tag] md5
                                                    </xhtml:code>
                              <xhtml:p>Every EIGRP routeable interface should be set to either passive-interface, or be configured with authentication keys.</xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1.2_Configure_EIGRP_Passive_interfaces_for_interfaces_that_do_not_have_peers" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure EIGRP Passive interfaces for interfaces that do not have peers</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>


EIGRP both listens on and advertises on all interfaces that have IPs in subnets that are defined as "networks" in the EIGRP configuration.                                              <xhtml:br></xhtml:br>



Ensure that interfaces that do not "face" an EIGRP peer are set to passive.                                        </xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>If an interface is set to "passive", then EIGRP will not advertise out of that interface or listen on that interface for EIGRP neighbors.
By default, all interfaces advertise via multicast to solicit EIGRP neighbors, and also listen for neighbor advertisements.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>If some IP interfaces have peers and some do not, set the ones with no peers to "passive"</xhtml:p>
                              <xhtml:code class="code_block">


switch(config-if)# int vlan 1                                                          <br></br>


switch(config-if)# ip passive-interface eigrp &lt;EIGRP process number&gt;
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>If an interface is set to the default (ie - not passive), then an attacker can pose as an EIGRP peer, either to collect EIGRP information from advertisements or to inject bogus routes into the table.  Bogus routes can then be used to DOS that subnet, or to intercept traffic to or from that subnet either to eavesdrop on conversations or to modify data in transit.</xhtml:p>
                                 <xhtml:p>Quite often the goal of an attack of this type is to collect login credentials from a malicious copy of the target website.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1.3_Configure_EIGRP__log-adjacency-changes" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure EIGRP  log-adjacency-changes</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Logging changes to the EIGRP peering relationships is recommended.  This setting is enabled by default.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Securely Manage Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:12:3">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Document Traffic Configuration Rules" urn="urn:cisecurity.org:controls:7.0:11:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Any logged changes in a routing peer relationship will in the best case indicate a service issue due to standard operational issues (connectivity issues and so on) or in the worst case, could indicate malicious activity attempting to subvert the peering relationship and/or the routing table.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>By default EIGRP adjacency changes are logged, and this does not show in the configuration.
If however it is disabled, it can be re-enabled as shown below.</xhtml:p>
                              <xhtml:code class="code_block">
                                 <br></br>


switch(config)# router eigrp &lt;eigrp process tag&gt;                                                          <br></br>


switch(config-router)# log-adjacency-changes
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Errors on adjacency relationships are a common early warning message in attacks on routers. If successful, a malicious actor can advertise bogus routes to valid hosts or networks, allowing the interception and modification of traffic intended for those hosts or subnets.</xhtml:p>
                                 <xhtml:p>For this reason it is important that EIGRP endpoints alert on any interruptions in adjacency.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1.2_BGP">
                  <xccdf:title xml:lang="en">BGP</xccdf:title>
                  <xccdf:description xml:lang="en"></xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2.1_Configure_BGP_to_Log_Neighbor_Changes" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure BGP to Log Neighbor Changes</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Logging changes to the BGP peering relationships is recommended.  Any logged changes will in the best case indicate a service issue due to standard operational issues (connectivity issues and so on) or in the worst case, could indicate malicious activity attempting to subvert the peering relationship and/or the routing table.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Securely Manage Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:12:3">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en"></xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_2/nx-os/unicast/configuration/guide/l3_cli_nxos/l3_bgp.html</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>In each "neigbor" stanza of the BGP configuration, add the command "log-neighbor-changes"</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# router bgp &lt;asn&gt;                                                          <br></br>


switch(config-router)#   router-id &lt;local ip, preferably a loopback&gt;                                                          <br></br>


switch(config-router)#   neighbor &lt;neighbor ip address&gt;                                                          <br></br>


switch(config-router-neighbor)#     remote-as &lt;neighbor asn&gt;                                                          <br></br>


switch(config-router-neighbor)#     log-neighbor-changes
                                                    </xhtml:code>
                              <xhtml:p>In addition, the events below should be configured in any log or SIEM solution to generate an alert for investigation.  A good keyword to alert on is "ADJCHANGE"</xhtml:p>
                              <xhtml:code class="code_block">


2020 May 20 11:54:18 CISNXOS9 %BGP-5-ADJCHANGE:  bgp- [7984] (default) neighbor 10.10.10.11 Up                                                          <br></br>


2020 May 20 13:08:15 CISNXOS9 %BGP-5-ADJCHANGE:  bgp- [7984] (default) neighbor 10.10.10.11 Down - sent:  holdtimer expired error                                                          <br></br>
                              </xhtml:code>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2.2_If_Possible_Limit_the_BGP_Routes_Accepted_from_Peers" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">If Possible, Limit the BGP Routes Accepted from Peers</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Once a BGP relationship is established, the BGP process will accept routes from any connected peers and consider those routes to be valid.  For this reason, especially in ISP or other carrier situations, it is important that only routes that are valid for any particular peer are accepted for that peer.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en"></xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_2/nx-os/unicast/configuration/guide/l3_cli_nxos/l3_bgp.html</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>First, define the subnets that will be permitted from the peer PEERNAME (use descriptive, self documenting names in NX-OS constructions where possible).  Note that any subnets not listed as permitted are by default denied (there is an implicit "deny all" at the bottom of the list)</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# ip prefix-list PL_PEERNAME_PERMIT_SUBNETS description Permitted Subnets from Peer PEERNAME                                                           <br></br>


switch(config)# ip prefix-list PL_PEERNAME_PERMIT_SUBNETS permit 10.11.11.0/24                                                          <br></br>


switch(config)# ip prefix-list PL_PEERNAME_PERMIT_SUBNETS permit 10.11.12.0/24
                                                    </xhtml:code>
                              <xhtml:p>In this example above, only "permits" are defined.  Deny lines are also allowed - refusing routes that are not accepted (for instance "bogon" or "martian" subnets), and may be more important in some situations, for example if this switch is accepting routes from the public internet.  (note that this is not typical deployment scenario for an NX-OS switch)</xhtml:p>
                              <xhtml:p>Next, create the route-map, will will apply that list:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# route-map RM_BGP_PEERNAME_IN permit 10                                                          <br></br>


switch(config-route-map)#   match ip address prefix-list PL_PEERNAME_PERMIT_SUBNETS
                                                    </xhtml:code>
                              <xhtml:p>Finally, within the BGP configuration, apply that route-map to the BGP peer definition.  Note that the "in" keyword denotes inbound (accepted) information.:</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# router bgp 65520                                                          <br></br>


switch(config-router)#   router-id 10.10.10.10                                                          <br></br>


switch(config-router)#   address-family ipv4 unicast                                                          <br></br>


switch(config-router-af)#     network 10.10.10.0/24                                                          <br></br>


switch(config-router-af)#   neighbor 10.10.10.11                                                          <br></br>


switch(config-router-neighbor)#     remote-as 65521                                                          <br></br>


switch(config-router-neighbor)#     address-family ipv4 unicast                                                          <br></br>


switch(config-router-neighbor-af)#      route-map RM_BGP_PEERNAME_IN in
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Without configuring route filtering, any route advertised by any BGP peer is considered valid.  For this reason, especially in carrier or ISP situations it is important that route filtering be configured.  Without filtering, a misconfigured or compromised peer can easily advertise entire subnets that should be routed elsewhere, either routing them to nul or receiving traffic to the compromised subnet for for interception or modification, then forwarding it on to it's final destination.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2.3_Configure_BGP_Authentication" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure BGP Authentication</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>BGP is a usually configured as a point-to-point / unicast protocol.  Configuring authentication as part of the neighbor configuration adds an additional layer of security to the conversation.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Applications</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en"></xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_2/nx-os/unicast/configuration/guide/l3_cli_nxos/l3_advbgp.html#wp1066903</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>For each BGP neighbor, add the "password"  command to the matching stanza, with a long and complex string.  Note that the same password must be used on the matching peer.
Different passwords should be used for each peer.</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# router bgp 65520                                                          <br></br>


switch(config-router)# neigh 10.10.10.11                                                          <br></br>


switch(config-router-neighbor)# password ?                                                          <br></br>


  0     Specifies an UNENCRYPTED neighbor password will follow                                                          <br></br>


  3     Specifies an 3DES ENCRYPTED neighbor password will follow                                                          <br></br>


  7     Specifies a Cisco type 7  ENCRYPTED neighbor password will follow                                                          <br></br>


  LINE  The UNENCRYPTED (cleartext) neighbor password                                                          <br></br>
                                 <br></br>


switch(config-router-neighbor)# password somelongcomplexstring
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Configuring authentication adds an MD5 hash to the neighbor negotiation that occurs between two BGP peers.  An authentication failure would indicate either a misconfiguration, or possibly an attacker mounting an impersonation attack, masquerading as the BGP peer (possibly by ARP cache poisoning attack) and attempting to then peer up with incorrect credentials.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1.3_OSPF">
                  <xccdf:title xml:lang="en">OSPF</xccdf:title>
                  <xccdf:description xml:lang="en"></xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3.1_Set_Interfaces_with_no_Peers_to_Passive-Interface" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Set Interfaces with no Peers to Passive-Interface</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>By default, OSPF will advertise via multicast to solicit peers, and will listen for neighbor / peer advertisements on all OSPF configured interfaces.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>If an interface is set to "passive", then EIGRP will not advertise out of that interface or listen on that interface for EIGRP neighbors. I will however still advertise the networks associated with that interface to peers on other interfaces.  By default, all interfaces advertise via multicast to solicit OSPF neighbors, and also listen for neighbor advertisements.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>For each routeable interface, if there is no facing peer on that interface set that interface to passive with the "ip ospf passive-interface" configuration command.
Every routeable interface should be set to either passive-interface, or be configured with authentication keys.</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# int vlan 1                                                          <br></br>


switch(config-if)# ip router ospf 10 area 0                                                          <br></br>


switch(config-if)# ip ospf passive-interface
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>If an interface is set to the default (ie - not passive), then an attacker can pose as an OSPF peer, either to collect OSPF information from advertisements or to inject bogus routes into the table. Bogus routes can then be used to DOS that subnet, or to intercept traffic to or from that subnet either to eavesdrop on conversations or to modify data in transit.</xhtml:p>
                                 <xhtml:p>Quite often the goal of an attack of this type is to collect login credentials from a malicious copy of the target website.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3.2_Authenticate_OSPF_peers_with_MD5_authentication_keys" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Authenticate OSPF peers with MD5 authentication keys</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>If OSPF is configured, peers can be authenticated using keys.  This is not configured by default.  If configured, MD5 hashes are recommended as the authentication mechanism.  MD5 is the best option for multi-vendor support, and is also the best cryptographic option available in the OSPF standard.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Data</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en"></xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>For each OSPF routeable interface, set the message-digest authentication method, and assign the appropriate keychain.
Each OSPF routeable interface should either have authentication configured or be configured as an OSPF passive interface.</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# interface Vlan1                                                          <br></br>


switch(config-int)# ip ospf authentication message-digest                                                          <br></br>


switch(config-int)#  ip ospf authentication key-chain &lt;OSPF Key Chain&gt;
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Because OSPF is a multicast protocol, any device can advertise OSPF capabilities and routes, and by default all connected OSPF devices will honor those advertisements. This means that a malicious actor can advertise bogus routes to valid hosts or networks, allowing the interception and modification of traffic intended for those hosts or subnets.</xhtml:p>
                                 <xhtml:p>For this reason it is important that OSPF endpoints authenticate to each other, ensuring that only valid routers can participate in the exchange of routes.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3.3_Log_OSPF_Adjacency_Changes" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Log OSPF Adjacency Changes</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Logging changes to the BGP peering relationships is recommended.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Collect Network Traffic Flow Logs " urn="urn:cisecurity.org:controls:8.0:13:6">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Any logged changes in a routing peer relationship will in the best case indicate a service issue due to standard operational issues (connectivity issues and so on) or in the worst case, could indicate malicious activity attempting to subvert the peering relationship and/or the routing table.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Enabling the logging of adjacencies is a single line in the OSPF process section.  It is globally applied to all OSPF neighbors.</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# router ospf &lt;Process tag&gt;                                                          <br></br>


switch(config-router)# log-adjacency-changes
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Errors on adjacency relationships are a common early warning message in attacks on routers.  If successful, a malicious actor can advertise bogus routes to valid hosts or networks, allowing the interception and modification of traffic intended for those hosts or subnets.</xhtml:p>
                                 <xhtml:p>For this reason it is important that OSPF endpoints alert on any interruptions in adjacency.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1.4_Protocol_Independent_Routing_Protections">
                  <xccdf:title xml:lang="en">Protocol Independent Routing Protections</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Some routing protections are independent of the routing protocol, they are recommended in all cases, even if only static routes are configured.</xhtml:p>
                  </xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4.1_If_VLAN_interfaces_have_IP_addreses_configure_anti_spoofing__ingress_filtering_protections" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">If VLAN interfaces have IP addreses, configure anti spoofing / ingress filtering protections</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>If VLAN interfaces have IP addresses, it is important that anti-spoofing protections are in place, to prevent an attacker from spoofing an address that is illegal on that inbound interface.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Deploy a Network Intrusion Detection Solution" urn="urn:cisecurity.org:controls:8.0:13:3">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Perform Traffic Filtering Between Network Segments" urn="urn:cisecurity.org:controls:8.0:13:4">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Collect Network Traffic Flow Logs " urn="urn:cisecurity.org:controls:8.0:13:6">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Regularly Tune SIEM" urn="urn:cisecurity.org:controls:7.0:6:8">
                                 <controls:implementation_groups ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Detect</controls:security_function>
                              </controls:safeguard>
                              <controls:safeguard title="Document Traffic Configuration Rules" urn="urn:cisecurity.org:controls:7.0:11:2">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>If an attacker is allowed to "spoof" addresses to the point that packets are permitted to arrive on the incorrect interface, it becomes possible for an attacker to spoof their trust level from a network point of view, for instance to source "inside" addresses from an "outside" interface.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Apply the command "ip verify unicast source reachable-via rx" to all VLAN interfaces that have IP addresses.  This forces the check to verify that the packet is arriving on the correct interface.
The command variant "ip verify unicast source reachable-via any" is not recommended, as it only filters for valid IP addresses.  If the device has a default route, then this command variant has no affect.</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# interface Vlan X                                                          <br></br>


switch(config-if)# ip verify unicast source reachable-via rx                                                          <br></br>
                              </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>The URPF feature uses the same tables as the routing protocol, so the CPU impact of configuring this feature is low.
However, logging of high volume URPF attacks (or URPF misconfigurations) can result in:</xhtml:p>
                                 <xhtml:ul>
                                    <xhtml:li>higher CPU impacts on the switch</xhtml:li>
                                    <xhtml:li>as higher network utilization on the path to the logging server</xhtml:li>
                                    <xhtml:li>higher disk utilization on the logging server</xhtml:li>
                                    <xhtml:li>higher cpu utilization on the logging server</xhtml:li>
                                 </xhtml:ul>
                                 <xhtml:p>Because of this, URPF events, especially in higher volumes should be configured to generate a high priority alert in your logging server or SIEM.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                     <xccdf:complex-check operator="AND">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-export export-name="oval:org.cisecurity.benchmarks:var:6951961" value-id="xccdf_org.cisecurity.benchmarks_value_6951961_var"></check-export>
                           <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6951961"></check-content-ref>
                        </check>
                     </xccdf:complex-check>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4.2_Create_and_use_a_single_Loopback_Address_for_Routing_Protocol_Peering" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Create and use a single Loopback Address for Routing Protocol Peering</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>The use of a loopback interface is recommended for use in all routing protocols.
This recommendation describes the configuration of the loopback interface.  Routing protocol specific configurations are described under the respective routing protocols.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Loopback interfaces are always up, and so are not dependent on physical interface link state issues (cabling or other link issues for instance).  This means traffic sourced from a loopback interface can take any valid path to establish a routing relationship or to route traffic.
Loopback interfaces by their nature cannot "flap" (toggle between up and down states). Depending on the error condition, most physical interfaces are susceptible to interface flapping.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Creating the loopback interface is a simple process.  Addressing the loopback, in particular computing the subnet mask will vary by the organization and application.  Often smaller subnets can be used for loopbacks, depending on how many potential peers are possible.</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# int loopback 0                                                          <br></br>


switch(config-if)# ip address 10.11.11.1 255.255.255.252
                                                    </xhtml:code>
                              <xhtml:p>In order to use the loopback interface (rather than the closest interface to the routing peer), it must be explicitly configured in the routing protocol.  This is described in the recommendations for each respective routing protocol.</xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>Using a loopback interface makes a routing device much less susceptible to intermittent or permanent interface failures.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4.3_Use_Unicast_Routing_Protocols_Only" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Use Unicast Routing Protocols Only</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>Unicast routing protocols describe the destination routing peers by IP address.
Multicast and Broadcast based routing protocols will discover routing neighbors dynamically.  Because of this discovery process, a malicious actor can much more easily establish a peering relationship and hijack the routing protocol.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>While most routing protocols can be configured with authentication, multicast and broadcast routing protocols have an inherent weakness in their "trust" of any neighbor that advertises or will answer an advertisment.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>Configure unicast routing only, for instance BGP.</xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>In multicast and broadcast routing protocols, the router (in this case the NX-OS device) will advertise its presence to all devices on a subnet, soliciting other routers using that same protocol.  In that situation, an attacker can simply reply to those advertisements and establish a peering relationship.  At that point the attacker can inject any route desired, so that traffic for that destination will route through the malicious router, putting the attacker in a "monkey in the middle" position, able to eavesdrop on or change any traffic to or from that destination, then forward it on.
Tools such as scapy have well-established attack scripts for most broadcast or multicast routing protocols.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4.4_Configure_HSRP_protections" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure HSRP protections</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>HSRP is a valuable redundancy protocol, but like many protocols discussed in this document can be attacked and compromised.  HSRP Authentication is recommended to protect against such attacks.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en"></xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/unicast/configuration/guide/l3_cli_nxos/l3_hsrp.html#47962</xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>First, enable HSRP</xhtml:p>
                              <xhtml:code class="code_block">switch(config)# feature hsrp
</xhtml:code>
                              <xhtml:p>set the HSRP version to "2" to allow for MD5 encryption (per interface)</xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# int vlan 1                                                          <br></br>


switch(config-if)# hsrp version 2
                                                    </xhtml:code>
                              <xhtml:p>Finally, configure the remainder of that interfaces HSRP setup.  The key command is of course the "authentication md5" clause</xhtml:p>
                              <xhtml:code class="code_block">


switch(config-if)#   hsrp 1                                                          <br></br>


switch(config-if-hsrp)#     authentication md5 key-chain &lt;HSRP-KEYCHAIN&gt;                                                          <br></br>


switch(config-if-hsrp)#     name HSRPVLAN1                                                          <br></br>


switch(config-if-hsrp)#     preempt                                                          <br></br>


switch(config-if-hsrp)#     priority 110                                                          <br></br>


switch(config-if-hsrp)#     ip 10.10.10.1
                                                    </xhtml:code>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>By default, HSRP is a clear-text protocol that negotiates which of a number of routing peers host the logical "standby" IP address.  Communication to negotiate this is via clear-text messages using the multicast address 224.0.0.2.  By default, the protocol is authenticated in cleartext, with a passphrase of "cisco".
In a two device HSRP pair, a tool such as SCAPY can be used to impersonate a third participant, advertising itself as an HSRP candidate at a higher priority value.</xhtml:p>
                                 <xhtml:p>A successful attack of this type usually results in the malicious actor becoming the default gateway for that subnet, which puts the attacker in the position to inspect all traffic leaving the network, either for eavesdropping or for modifying traffic in transit.  Return traffic will not usually be routed through the attacker (unless a second attack is mounted successfully to accomplish this), but intercepting sent traffic gives the attacker the ability to read credentials directly or modify the destination IP address (two common goals).  Modifying the destination address allows the attacker to stand up a malicious copy of a target website (for instance, a bank site or paypal), where high value, encrypted credentials can be harvested.</xhtml:p>
                                 <xhtml:p>Protecting HSRP with hashed credentials makes this type of attack much more difficult, the attacker must either reverse the hash, or otherwise mount a "pass the hash" attack on the HSRP hosts.  Note however that this setting will not prevent all HSRP attacks - it will however make it much more likely that an attack will generate alerts in the log, giving the defending team a good indication that the attack occurred and should be investigated.  Automated attacks are often simpler (for instance, may only try the default value), so those may be defeated.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2_Basic_Layer_3_Protections">
               <xccdf:title xml:lang="en">Basic Layer 3 Protections</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2.1_IPv6_Specific_Protections">
                  <xccdf:title xml:lang="en">IPv6 Specific Protections</xccdf:title>
                  <xccdf:description xml:lang="en"></xccdf:description>
                  <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.1_Configure_RA_Guard" role="unscored" selected="false" weight="0.0">
                     <xccdf:title xml:lang="en">Configure RA Guard</xccdf:title>
                     <xccdf:description xml:lang="en">
                        <xhtml:p>The IPv6 RA Guard feature provides support for allowing the network administrator to block or reject unwanted or rogue RA guard messages that arrive at the network device platform. RAs are used by devices to announce themselves on the link. The IPv6 RA Guard feature analyzes these RAs and filters out RAs that are sent by unauthorized devices. In host mode, all RA and router redirect messages are disallowed on the port. The RA guard feature compares configuration information on the Layer 2 (L2) device with the information found in the received RA frame. Once the L2 device has validated the content of the RA frame and router redirect frame against the configuration, it forwards the RA to its unicast or multicast destination. If the RA frame content is not validated, the RA is dropped.</xhtml:p>
                     </xccdf:description>
                     <xccdf:metadata>
                        <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                           <controls:framework urn="urn:cisecurity.org:controls:8.0">
                              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                                 <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Protect</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                           <controls:framework urn="urn:cisecurity.org:controls:7.0">
                              <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                                 <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                                 <controls:asset_type>Network</controls:asset_type>
                                 <controls:security_function>Identify</controls:security_function>
                              </controls:safeguard>
                           </controls:framework>
                        </controls:cis_controls>
                     </xccdf:metadata>
                     <xccdf:rationale xml:lang="en">
                        <xhtml:p>Packets are classified into one of three DHCP type messages. If a packet arriving from DHCP server is a Relay Forward or a Relay Reply, only the device role is checked. In addition, IPv6 DHCP Guard doesn't apply the policy for a packet sent out by the local relay agent running on the switch.</xhtml:p>
                     </xccdf:rationale>
                     <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                     <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                     <xccdf:fixtext xml:lang="en">
                        <xhtml:div>
                           <xhtml:p>
                              <xhtml:p>In the example below, the RA Guard policy is created, then applied to a VLAN.</xhtml:p>
                              <xhtml:p>
                                 <xhtml:em>Example</xhtml:em>
                              </xhtml:p>
                              <xhtml:code class="code_block">


switch(config)# ipv6 nd raguard policy RAGuardPol01                                                          <br></br>


switch(config-ra-guard)# device-role router                                                          <br></br>


switch(config-ra-guard)# hop-limit minimum 3                                                          <br></br>


switch(config-ra-guard)# managed-config-flag on                                                          <br></br>


switch(config-ra-guard)# other-config-flag on                                                          <br></br>


switch(config-ra-guard)# router-preference maximum high                                                          <br></br>


switch(config-ra-guard)# trusted-port
                                                    </xhtml:code>
                              <xhtml:p>


Configuring RA Guard on an interface
                                                          <xhtml:em>Example</xhtml:em>



switch(config)#vlan configuration 10
switch(config-if) ipv6 nd raguard attach-policy RAGuardPol01                                                    </xhtml:p>
                              <xhtml:p class="bold">Impact:</xhtml:p>
                              <xhtml:p>
                                 <xhtml:p>With RA Guard in it's default "not configured" state, a malicious actor can send IPv6 RA (Router Advertisement) packets, and present their station as a valid router.  This places the attacker in a position where they can send specific traffic to a malicious site (usually to steal credentials).  Also an attacker in this position can eavesdrop on or modify traffic in transit, before forwarding it on.</xhtml:p>
                              </xhtml:p>
                           </xhtml:p>
                        </xhtml:div>
                     </xccdf:fixtext>
                  </xccdf:Rule>
               </xccdf:Group>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Disable ICMP Redirects on all Layer 3 Interfaces</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>A redirect packet basically informs the host that there is a better way to get to the destination host or network.  This route is then cached on the (victim) host.</xhtml:p>
                     <xhtml:p>For instance, if the default gateway of a host is the NX-OS switch, and the victim host sends a packet to an internet or WAN IP, the NX-OS switch will inform the host that the firewall or WAN router will be a better path.  If at some future time, if that firewall or WAN router should fail and trigger a routing change, the route to that failed device will persist in the victim host.</xhtml:p>
                     <xhtml:p>This scenario is only in play if the NX-OS device is the gateway for the victim host, and the Firewall or WAN router (or other next hop device) is also on the same subnet as the victim host.  Also, if the next hop device handles its own failover (for instance, using HSRP), there is no routing change, so the "redirect" issue will not be a problem.</xhtml:p>
                     <xhtml:p>This situation is generally a problem only if the path to the destination is handled by a "next hop" mechanism, for instance by a routing protocol or a local route-map, and a backup path exists.  In this situation, the route to the target will fail, the route will change to the backup path, and the victim will cache the old route for minutes or hours after the failure.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/nx-os-software/213841-understanding-icmp-redirect-messages.html#anc17</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>


It is recommended that you perform this task on all Layer 3 Interfaces which have both a primary and a backup routed path to any destination.  In particular, the next hop will need to be in the same subnet as the potential victim hosts.                                                    <xhtml:br></xhtml:br>



The corollary to this is that if the network is architected such that all layer 3 egress paths are on dedicated or "point to point" segments (with no other hosts on those segments), then the ip redirect issue will never arise.                                              </xhtml:p>
                           <xhtml:code class="code_block">switch(config-if) no ip redirects
</xhtml:code>
                           <xhtml:p>switch(config)#</xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6950152" value-id="xccdf_org.cisecurity.benchmarks_value_6950152_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6950152"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6960032" value-id="xccdf_org.cisecurity.benchmarks_value_6960032_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6960032"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Disable Proxy ARP on all Layer 3 Interfaces</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Proxy ARP is the technique in which one host, usually a router, answers ARP requests intended for another machine on a different network segment (vlan or subnet). By faking its identity, the router accepts responsibility for routing packets to the real destination.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Proxy ARP is disabled on all interfaces by default, and that configuration does not appear in the running or saved configuration.  Proxy ARP only appears in the configuration if it is enabled (which is not desired in most cases).</xhtml:p>
                           <xhtml:p>To disable this on an interface if it is enabled:</xhtml:p>
                           <xhtml:code class="code_block">switch(config-if)# no ip proxy-arp
</xhtml:code>
                           <xhtml:p>for instance:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# int vlan 9                                                    <br></br>


switch(config-if)# no ip proxy-arp
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="OR">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6950701" value-id="xccdf_org.cisecurity.benchmarks_value_6950701_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6950701"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6951960" value-id="xccdf_org.cisecurity.benchmarks_value_6951960_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6951960"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Disable_IP_Directed_Broadcasts_on_all_Layer_3_Interfaces" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Disable IP Directed Broadcasts on all Layer 3 Interfaces</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>An IP directed broadcast is an IP packet whose destination address is a valid broadcast address for an IP subnet, but which originates from a node that is not itself a part of that destination subnet.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>Directed broadcasts can be abused in several ways:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>a volumetric DOS attack against the NX-OS switch itself, the sent volume of data can be much larger than the received request</xhtml:li>
                        <xhtml:li>a volumetric DOS attack against a third party (often called a "smurf attack")</xhtml:li>
                        <xhtml:li>a single-packet reconnaissance of a local subnet</xhtml:li>
                     </xhtml:ul>
                     <xhtml:p>We recommend that you disable the ip directed-broadcast command on any interface where they are not required for some reason.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus7000/sw/unicast/config/cisco_nexus7000_unicast_routing_config_guide_8x/configuring_ipv4.html#concept_e5q_4tt_cbb</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">switch(config-if)# no ip directed-broadcast
</xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Disable_IP_Source-Routing" role="full" selected="false" weight="1.0">
                  <xccdf:title xml:lang="en">Disable IP Source-Routing</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>A malicious actor can influence the path that their traffic should take using source-routing.  Disabling this on the NX-OS platform disables this feature for all transit traffic.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Applications</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:7.0:9"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:code class="code_block">switch(config)# no ip source-route
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>Source Routing can be used to influence the path taken by attack traffic, potentially routing around devices that implement network protections that might detect or prevent the attack being "steered" using source routing.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:6950771" value-id="xccdf_org.cisecurity.benchmarks_value_6950771_var"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.2.0_CIS_Cisco_NX-OS_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:6950771"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.3_Basic_Layer_2_Protections">
               <xccdf:title xml:lang="en">Basic Layer 2 Protections</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.1_Configure_DHCP_Trust" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure DHCP Trust</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>You can configure whether DHCP snooping trusts traffic sources. An untrusted source may initiate traffic attacks or other hostile actions. To prevent such attacks, DHCP snooping filters messages from untrusted sources.</xhtml:p>
                     <xhtml:p>In an enterprise network, a trusted source is a device that is under your administrative control. These devices include the switches, routers, and servers in the network. Any device beyond the firewall or outside the network is an untrusted source. Generally, host ports are treated as untrusted sources.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Use DHCP Logging to Update Asset Inventory" urn="urn:cisecurity.org:controls:7.0:1:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Devices</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                           <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>In a service provider environment, any device that is not in the service provider network is an untrusted source (such as a customer switch). Host ports are untrusted sources.</xhtml:p>
                     <xhtml:p>In the Cisco NX-OS device, you indicate that a source is trusted by configuring the trust state of its connecting interface.</xhtml:p>
                     <xhtml:p>The default trust state of all interfaces is untrusted. You must configure DHCP server interfaces as trusted. You can also configure other interfaces as trusted if they connect to devices (such as switches or routers) inside your network. You usually do not configure host port interfaces as trusted.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/sw/4_1/nx-os/security/configuration/guide/sec_nx-os-cfg/sec_dhcpsnoop.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>First, enable DHCP Snooping</xhtml:p>
                           <xhtml:code class="code_block">switch(config)#ip dhcp snooping
</xhtml:code>
                           <xhtml:p>Next, enable DHCP Snooping on target VLANs</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# ip dhcp snooping vlan 100,200,250-252
</xhtml:code>
                           <xhtml:p>Configure Interface as Trusted</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# interface port-channel 5                                                    <br></br>


switch(config)# ip dhcp snooping trust
                                              </xhtml:code>
                           <xhtml:p>On a distribution or access switch (for instance in a wiring closet or branch office), typically only the uplink ports are configured as trusted - the ports leading towards the DHCP server
On a datacenter switch, especially with virtualization, usually multiple ports are candidates for where the DHCP servers may appear on, all possible ports that may have a DHCP server on them should be trusted.</xhtml:p>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>If DHCP Trust is not configured, all ports are trusted to provide DHCP services.</xhtml:p>
                              <xhtml:p>This situation enables a malicious attacker to provide incorrect DHCP information, for instance an attacker could:</xhtml:p>
                              <xhtml:ul>
                                 <xhtml:li>provide a malicious host IP as the default gateway, putting that host into a "Monkey in the Middle" position, able to intercept or modify traffic.</xhtml:li>
                                 <xhtml:li>Provide a malicious host as a proxy, via DHCP option 252 (commonly called a "WPAD attack").  This routes all browser traffic to that malicious host (for browsers that use the system setting for proxy)</xhtml:li>
                                 <xhtml:li>The final scenario is an end-user bringing in a rogue dhcp server in the form of an access point or switch that they've purchased themselves.  The impact of this is usually that the entire subnet will be DOS'd - normally impacted workstations will have a different subnet (192.168.0.0/24 ort 192.168.1.0/24), with the rogue device as the default gateway.</xhtml:li>
                              </xhtml:ul>
                              <xhtml:p>Configuring DHCP trust not only sends an alert to the log server or SIEM, it also puts the rogue DHCP port into ERR-DISABLE mode.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.2_Configure_Storm_Control" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure Storm Control</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Traffic storm control (also called traffic suppression) allows you to monitor the levels of the incoming broadcast, multicast, and unicast traffic over a 3.9-millisecond interval. During this interval, the traffic level, which is a percentage of the total available bandwidth of the port, is compared with the traffic storm control level that you configured. When the ingress traffic reaches the traffic storm control level that is configured on the port, traffic storm control drops the traffic until the interval ends.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Centralize Security Event Alerting" urn="urn:cisecurity.org:controls:8.0:13:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Deploy a Network Intrusion Detection Solution" urn="urn:cisecurity.org:controls:8.0:13:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>When the traffic exceeds the configured level, you can configure traffic storm control to perform the following optional corrective actions :</xhtml:p>
                     <xhtml:p>Shut downWhen ingress traffic exceeds the traffic storm control level that is configured on a port, traffic storm control puts the port into the error-disabled state. To reenable this port, you can use either the shutdown and no shutdown options on the configured interface, or the error-disable detection and recovery feature. You are recommended to use the errdisable recovery cause storm-control command for error-disable detection and recovery along with the errdisable recovery interval command for defining the recovery interval. The interval can range between 30 and 65535 seconds.</xhtml:p>
                     <xhtml:p>TrapYou can configure traffic storm control to generate an SNMP trap when ingress traffic exceeds the configured traffic storm control level. The SNMP trap action is enabled by default. However, storm control traps are not rate-limited by default. You can control the number of traps generated per minute by using the snmp-server enable traps storm-control trap-rate command.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/security/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_Security_Configuration_Guide/b_Cisco_Nexus_9000_Series_NX-OS_Security_Configuration_Guide_chapter_010000.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To set the broadcast limit in percent (multicast limit shown):</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# interface ethernet 1/1                                                    <br></br>


switch(config)# storm-control multicast level 10
                                              </xhtml:code>
                           <xhtml:p>or to set in packets per second (broadcast limit shown)</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# storm-control broadcast level pps 8000
</xhtml:code>
                           <xhtml:p>Configure to send SNMP trap if a broadcast limit is exceeded</xhtml:p>
                           <xhtml:code class="code_block">switch(config-if)# storm-control action trap
</xhtml:code>
                           <xhtml:p>or to place an interface into an ERR-DISABLE state if a broadcast limit is exceeded:</xhtml:p>
                           <xhtml:code class="code_block">switch(config-if)# storm-control action disable
</xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>This configuration is normally non-impactful - host network interfaces operating normally do not broadcast at the levels that are normally set in this command.</xhtml:p>
                              <xhtml:p>This command is primarily meant to protect the switch and more importantly other hosts in a broadcast domain (VLAN) from a network interface that is malfunctioning, either due to a hardware failure or a driver problem.</xhtml:p>
                              <xhtml:p>Note however that this protection can prevent some malicious activity, for instance VLAN wide DOS attacks, higher volume ARP Cache Poisoning attacks and CAM Table overflow attacks.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.4_Discovery_Protocols">
               <xccdf:title xml:lang="en">Discovery Protocols</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4.1_Configure_LLDP" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure LLDP</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>LLDP is a discovery protocol that transmits information about the capabilities and current status of a device and its interfaces. LLDP devices use the protocol to solicit information only from other LLDP devices.  You can use LLDP to discover and view information about many devices that are directly attached to the switch.</xhtml:p>
                     <xhtml:p>In many situations LLDP is required for normal operation (for instance for auto-provisioning, or for network configuration of VOIP handsets or Wireless Access Points).</xhtml:p>
                     <xhtml:p>LLDP advertises potentially sensitive information, including the current version of NX-OS. For this reason it is recommended that LLDP be disabled or restricted to receive-only on any link that links to equipment not owned by your organization.</xhtml:p>
                     <xhtml:p>In more sensitive environments, in particular in carrier or cloud services environments (where the majority of the endpoints are customer controlled hosts), it is recommended to disable LLDP entirely.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Deploy a Network Intrusion Detection Solution" urn="urn:cisecurity.org:controls:8.0:13:3">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Detect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Perform Traffic Filtering Between Network Segments" urn="urn:cisecurity.org:controls:8.0:13:4">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>To permit the discovery of non-Cisco devices, the switch also supports the Link Layer Discovery Protocol (LLDP), a vendor-neutral device discovery protocol that is defined in the IEEE 802.1ab standard. LLDP allows network devices to advertise information about themselves to other devices on the network. This protocol runs over the data-link layer, which allows two systems running different network layer protocols to learn about each other.</xhtml:p>
                     <xhtml:p>LLDP advertises potentially sensitive information, including the current version of NX-OS and exposed IP addresses.  This information can be used by a malicious actor to identify which vulnerabilities exist on the device, and from there which exploits might be most effective to compromise it.  For this reason, enabling LLDP is generally not recommended except for troubleshooting or network discovery purposes.  In particular, any ports connected to service provider gear, or any system not owned by your organization should have LLDP explicitly disabled.</xhtml:p>
                     <xhtml:p>In more sensitive environments, disable LLDP globally.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/7-x/system_management/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide_7x/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide_7x_chapter_010010.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>To enable the LLDP feature, then enable LLDP:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# feature lldp
</xhtml:code>
                           <xhtml:p>To disable LLDP globally:</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# no feature lldp
</xhtml:code>
                           <xhtml:p>To disable LLDP on a specific interface - note that transmit and receive capabilities are controlled independently. While in many cases LLDP is not required at all, often only LLDP receive is needed for correct operation.:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# int Ethernet x/y                                                    <br></br>


switch(config-if)# no lldp transmit                                                    <br></br>


switch(config-if)# no lldp receive
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4.2_Configure_CDP" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure CDP</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>The Cisco Discovery Protocol (CDP) is a media-independent and protocol-independent protocol that runs on all Cisco-manufactured equipment including routers, bridges, access and communication servers, and switches. You can use CDP to discover and view information about all the Cisco devices that are directly attached to the device.</xhtml:p>
                     <xhtml:p>Each device that you configure for CDP sends periodic advertisements to a multicast address. Each device advertises at least one address at which it can receive SNMP messages. The advertisements also contain hold-time information, which indicates the length of time that a receiving device should hold CDP information before removing it. You can configure the advertisement or refresh timer and the hold timer.</xhtml:p>
                     <xhtml:p>CDP advertises potentially sensitive information, including the current version of NX-OS. For this reason it is recommended that CDP be disabled on any link that links to equipment not owned by your organization.
In more sensitive environments, in particular in carrier or cloud services environments (where the majority of the endpoints are customer controlled hosts), it is recommended to disable CDP entirely</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en">
                     <xhtml:p>CDP advertises potentially sensitive information, including the current version of NX-OS.  This information can be used by a malicious actor to identify which vulnerabilities exist on the device, and from there which exploits might be most effective to compromise it.  For this reason, enabling CDP is generally not recommended except for troubleshooting or network discovery purposes.  In particular, any ports connected to service provider gear, or any system not owned by your organization should have CDP explicitly disabled.</xhtml:p>
                     <xhtml:p>In more sensitive environments, disable CDP globally.</xhtml:p>
                  </xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/7-x/system_management/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide_7x/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide_7x_chapter_0101.html</xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Enabling CDP Globally</xhtml:p>
                           <xhtml:code class="code_block">switch(config)# cdp enable
</xhtml:code>
                           <xhtml:p>Enabling on one interface</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# int Ethernet x/y                                                    <br></br>


switch(config-if)# cdp enable
                                              </xhtml:code>
                           <xhtml:p>To disable CDP globally:</xhtml:p>
                           <xhtml:code class="code_block">switch(config-if)# no cdp enable
</xhtml:code>
                           <xhtml:p>To disable CDP on one interface only:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# int Ethernet x/y                                                    <br></br>


switch(config-if)# no cdp enable                                                    <br></br>
                           </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.5_Fiber_Channel__Fiber_Channel_over_Ethernet">
               <xccdf:title xml:lang="en">Fiber Channel / Fiber Channel over Ethernet</xccdf:title>
               <xccdf:description xml:lang="en"></xccdf:description>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5.1_Basic_Fiber_Channel_Configuration" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Basic Fiber Channel Configuration</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Fibre Channel over Ethernet (FCoE) encapsulation allows a physical Ethernet cable to carry standard Fibre Channel traffic within Ethernet frames. In Cisco Nexus devices, an FCoE-capable physical Ethernet interface can carry traffic for one virtual Fibre Channel (vFC) interface.
If FCoE functionality is not required, this functionality should be disabled.
Note also that this is a licensed feature, so is not available without a purchased license.</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:safeguard title="Maintain Standard Security Configurations for Network Devices" urn="urn:cisecurity.org:controls:7.0:11:1">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Identify</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Enable the FCoE feature globally on the switch:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# feature fcoe                                                    <br></br>


FC license checked out successfully                                                    <br></br>
                              <br></br>


fc_plugin extracted successfully                                                    <br></br>


FC plugin loaded successfully                                                    <br></br>


FCoE manager enabled successfully                                                    <br></br>


FC enabled on all modules successfully                                                    <br></br>


Warning: Ensure class-fcoe is included in qos policy-maps of all types
                                              </xhtml:code>
                           <xhtml:p>Enable FCoE on a specific port (not required on all models):</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# interface ethernet x/y                                                    <br></br>


switch(config-if)# fcoe mode on 
                                              </xhtml:code>
                           <xhtml:p>set the priority flow mode on a specific port:</xhtml:p>
                           <xhtml:code class="code_block">switch(config-if)# priority-flow-control mode auto
</xhtml:code>
                           <xhtml:p>FCoE also requires the DCBX (Data Center Bridging Exchange) protocol, which is used to negotiate capabilities between the FCOE endpoints.  DCBX is an extension of LLDP, and LLDP is enabled globally and on all interfaces by default.
If LLDP is disabled on any particular interface, it can be re-enabled as:</xhtml:p>
                           <xhtml:code class="code_block">


switch(config-if)# int Ethernet x/y                                                    <br></br>


switch(config-if)# lldp transmit                                                    <br></br>


switch(config-if)# lldp receive
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
               <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5.2_Configure_FCoE_Zoning" role="unscored" selected="false" weight="0.0">
                  <xccdf:title xml:lang="en">Configure FCoE Zoning</xccdf:title>
                  <xccdf:description xml:lang="en">
                     <xhtml:p>Cisco uses a construction called a "VSAN" (analagous to a VLAN) which is used to restrict access between hosts and SAN resources.
In restrictive cases, a typical VSAN will include two entries for the two host FCoE interfaces, and two entries for the SAN Controller interfaces (usually an FCoE SAN will have at least two).  In the most restrictive case, the FCOE infrastructure will be split into two fabrics, and zones can hold as few as 2 entries (one for the host and one for the SAN controller on that fabric).</xhtml:p>
                  </xccdf:description>
                  <xccdf:metadata>
                     <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                        <controls:framework urn="urn:cisecurity.org:controls:8.0">
                           <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                              <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                           <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                              <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                              <controls:asset_type>Network</controls:asset_type>
                              <controls:security_function>Protect</controls:security_function>
                           </controls:safeguard>
                        </controls:framework>
                        <controls:framework urn="urn:cisecurity.org:controls:7.0">
                           <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:7.0:9"></controls:control>
                        </controls:framework>
                     </controls:cis_controls>
                  </xccdf:metadata>
                  <xccdf:rationale xml:lang="en"></xccdf:rationale>
                  <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
                  <xccdf:fixtext xml:lang="en">
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:p>Create a VSAN.  Give it a meaningful name</xhtml:p>
                           <xhtml:code class="code_block">


switch(config-if)# vsan database                                                    <br></br>


switch(config-vsan-db)# vsan 101                                                    <br></br>


switch(config-vsan-db)# vsan 101 name HOST_X_SAN_Y
                                              </xhtml:code>
                           <xhtml:p>Create Virtual Fiber Channel Interfaces.</xhtml:p>
                           <xhtml:code class="code_block">


switch(config)# interface vfc 1001                                                    <br></br>


switch(config-if)# bind mac-address 00:01:0b:00:00:02                                                    <br></br>


switch(config-if)# int vfc 1002                                                    <br></br>


switch(config-if)# bind mac-address 00:01:0b:00:00:08                                                    <br></br>


switch(config)# int vfc 1003                                                    <br></br>


switch(config-if)# bind interface e 1/4
                                              </xhtml:code>
                           <xhtml:p>Add VFC interfaces to the VSAN</xhtml:p>
                           <xhtml:code class="code_block">


switch(config-if)# vsan database                                                    <br></br>


switch(config-vsan-db)# vsan 101 interface vfc 1001                                                    <br></br>


switch(config-vsan-db)# vsan 101 interface vfc 1002                                                    <br></br>


switch(config-vsan-db)# vsan 101 interface vfc 1003
                                              </xhtml:code>
                           <xhtml:p class="bold">Impact:</xhtml:p>
                           <xhtml:p>
                              <xhtml:p>This configuration limits the reconnaissance available to a compromised or malicious host.  Without configuring Zoning, a compromised host can collect the FCoE information from all other hosts in the same VSAN.  It can then use that information to impersonate any of these hosts, and access their respective LUNs (unless some other control prevents that).</xhtml:p>
                              <xhtml:p>Note that in Virtualized environments and in most Cluster architectures, multiple hypervisor hosts will access the a common set of LUNs on the SAN.  In these situations the VSAN can have significantly more members (all host interfaces as well as all target SAN controller interfaces), since the reconnaissance and impersonation risks are somewhat lessened - you would need a compromised hypervisor to attack another hypervisor.  While this risk is non-zero, it is understood that hypervisors typically (hopefully) have more strict protections than many other physical hosts.</xhtml:p>
                              <xhtml:p>In addition, risk occurs if different server operating systems are in play.  The most common issue is that if a Windows host can mount a volume that is partitioned for Linux or VMware ESXi, Windows will ask a logged in administrator for permission to "sign" that volume.  If the administrator selects "Yes", then that volume will no longer be readable by the Linux or ESXi host(s).</xhtml:p>
                              <xhtml:p>At a minimum, hypervisors should not share a zone with other physical hosts.  Physical hosts should not share zones with each other.  Hosts with different operating systems or incompatible filesystems should never share the same zone.  In the best case, the "one host / one SAN controller / one zone" rule is the safest approach.</xhtml:p>
                           </xhtml:p>
                        </xhtml:p>
                     </xhtml:div>
                  </xccdf:fixtext>
               </xccdf:Rule>
            </xccdf:Group>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Operations_and_Management">
            <xccdf:title xml:lang="en">Operations and Management</xccdf:title>
            <xccdf:description xml:lang="en"></xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Configure_Local_Configuration_Backup_Schedule" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Configure Local Configuration Backup Schedule</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Using the job scheduler function allows the user to automate backups. This ensures that regular backups are created.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Backups" urn="urn:cisecurity.org:controls:8.0:11:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Recover</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Perform Complete System Backups" urn="urn:cisecurity.org:controls:7.0:10:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Use Automated Tools to Verify Standard Device Configurations and Detect Changes" urn="urn:cisecurity.org:controls:7.0:11:3">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Having current backups creates an environment where the user can roll back a config in the event of configuration failure.  Additionally in the event of a compromise a recent backup can get the device back up to running condition in a small matter of time.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/11/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus9000/sw/6-x/system_management/configuration/guide/b_Cisco_Nexus_9000_Series_NX-OS_System_Management_Configuration_Guide/sm_8scheduler.html</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# scheduler job name [local backup]                                              <br></br>


switch(config-job)#copy running-config startup-config
                                        </xhtml:code>
                        <xhtml:p>Set up timetable for this backup.</xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# scheduler schedule name [backups]                                              <br></br>


switch(config-schedule)# schedule name [backups]                                              <br></br>


switch(config-schedule)# time weekly [day 00:00]
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Configure_a_Remote_Backup_Schedule" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Configure a Remote Backup Schedule</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>NX-OS can be configured to initiate remote backups using scheduled jobs.
This recommendation can also be satisfied (and likely satisfied better) using a host based backup tool, using SSH or SCP.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Perform Automated Backups" urn="urn:cisecurity.org:controls:8.0:11:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Recover</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Perform Complete System Backups" urn="urn:cisecurity.org:controls:7.0:10:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Use Automated Tools to Verify Standard Device Configurations and Detect Changes" urn="urn:cisecurity.org:controls:7.0:11:3">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Remote backups are preferred over local backups, as an attacker that has compromised a device also has full access to any locally stored files (which local backups are).
In that situation, an attacker can modify or delete the stored backups, impeding any recovery or remediation efforts.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/11/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Note that this first example job uses tftp for backups.  The risk here is that the backup is sent in clear-text, so can be intercepted and/or modified in transit.</xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# Scheduler job name [backup-cfg]                                              <br></br>


switch(config-job)copy running-config tftp://1.2.3.4/$(SWITCHNAME)-cfg.$(TIMESTAMP) vrf management
                                        </xhtml:code>
                        <xhtml:p>This example job uses SCP.  The risk here is that the credentials need to be embedded in the configuration, so can be recovered if the backup repository is compromised.  As this is true for all local passwords, the risk may be deemed low in some organizations.</xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# scheduler aaa-authentication username &lt;username&gt; password &lt;some complex password&gt;                                              <br></br>
                           <br></br>


switch(config)# Scheduler job name &lt;backup-cfg&gt;                                              <br></br>


switch(config-job)copy running-config scp://1.2.3.4/$(SWITCHNAME)-cfg.$(TIMESTAMP) vrf management
                                        </xhtml:code>
                        <xhtml:p>Whatever the protocol, set timetable for this backup</xhtml:p>
                        <xhtml:code class="code_block">


switch(config)# scheduler schedule name [backups]                                              <br></br>


switch(config-schedule)# schedule name [backups]                                              <br></br>


switch(config-schedule)# job name &lt;backup-cfg&gt;                                              <br></br>


switch(config-schedule)# time weekly [day 00:00]
                                        </xhtml:code>
                        <xhtml:p>While this can certainly work, if the backup server IP should ever change, the effort to fix this across multiple switches can be both error-prone and time-intensive.  It is normally recommended to backup configurations from the backup server to the NX-OS switch over SSH or SCP, rather than from the switch to the host.  As this config (host to switch) resides on the remote host, it cannot be audited from the switch.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>A host-based backup solution is preferred over one implemented locally.  Locally configured backups have several security issues.  By protocol, they are:</xhtml:p>
                           <xhtml:ul>
                              <xhtml:li>TFTP - cleartext, which is susceptible to interception or modification over the wire and the target filesystem allows unauthenticated writes (and usually unauthenticated reads)</xhtml:li>
                              <xhtml:li>FTP or HTTP - cleartext, which is susceptible to interception or modification over the wire.  Credentials are embedded in the job configuration</xhtml:li>
                              <xhtml:li>HTTPS, SCP, SFTP: encrypted, but credentials are still embedded in the job configuration</xhtml:li>
                           </xhtml:ul>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Configure_Alerts_on_all_Configuration_Changes" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Configure Alerts on all Configuration Changes</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This is not easily implemented directly on the switch.  Changes should ideally be backed up remotely, and a "diff" process to highlight any changes in successive configurations is a good process to implement.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Explicitly Not Mapped" urn="urn:cisecurity.org:controls:8.0:0:0">
                           <controls:implementation_groups></controls:implementation_groups>
                           <controls:asset_type></controls:asset_type>
                           <controls:security_function></controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Use Automated Tools to Verify Standard Device Configurations and Detect Changes" urn="urn:cisecurity.org:controls:7.0:11:3">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Change Control processes are ubiquitous in the industry.  Especially with a text-based configuration such as most network devices have, it is easy to extract the exact changes from one version of the saved or running configuration to the next.  This can then be correlated back to the change control process, to see:</xhtml:p>
                  <xhtml:ul>
                     <xhtml:li>Did any and all approved changes get executed?</xhtml:li>
                     <xhtml:li>Did any unapproved changes get executed?</xhtml:li>
                     <xhtml:li>Relating this back to the syslogs created by named user logins, did the change happen within the correct window?</xhtml:li>
                     <xhtml:li>Also relating back to the syslogs created by named user logins, did the correct person make the change?  (see the AAA section, and named administrative users)</xhtml:li>
                     <xhtml:li>Is there a pattern of any one or more administrators making unapproved or outside of window changes?</xhtml:li>
                  </xhtml:ul>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/0/subcontrol/0" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>This is not a process that typically runs on the switch, there is no on-switch remediation.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>A formal change control process can manage conflicts in changes nicely, especially between disparate sections of the infrastructure.  For instance, the situation where "a server upgrade failed because the firewall changes interrupted the VPN session" is much less likely to occur if all changes are reviewed in advance.</xhtml:p>
                           <xhtml:p>In addition, changes made without planning tend to result in the "testing in prod" scenario, ending up with a much higher ratio of service interruptions.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
      </xccdf:Benchmark>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_1.2.0_CIS_Cisco_NX-OS_Benchmark-oval" timestamp="2025-07-16T15:45:55">
      <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://oval.cisecurity.org/schemas/validator-oval-definitions-5.11.2.xsd">
         <generator>
            <oval:product_name>Center for Internet Security - Optimus</oval:product_name>
            <oval:schema_version>5.11.2</oval:schema_version>
            <oval:timestamp>2025-07-16T15:45:45.840Z</oval:timestamp>
         </generator>
         <definitions>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6886753" version="1">
               <metadata>
                  <title>Configure AAA Authentication - TACACS if applicable</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable"></reference>
                  <description>Configure AAA Authentication - TACACS if applicable</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6886753"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6983732" version="1">
               <metadata>
                  <title>Configure AAA Authentication - TACACS if applicable</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.1.1.1_Configure_AAA_Authentication_-_TACACS_if_applicable"></reference>
                  <description>Configure AAA Authentication - TACACS if applicable</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6983732"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6886754" version="1">
               <metadata>
                  <title>Configure AAA Authentication - Local SSH keys</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.1.1.2_Configure_AAA_Authentication_-_Local_SSH_keys" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.1.1.2_Configure_AAA_Authentication_-_Local_SSH_keys"></reference>
                  <description>Configure AAA Authentication - Local SSH keys</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6886754"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6886755" version="1">
               <metadata>
                  <title>vty line authentication</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_vty_line_authentication" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.1.2.1_vty_line_authentication"></reference>
                  <description>vty line authentication</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6886755"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6935321" version="1">
               <metadata>
                  <title>Limit SSH Login Attempts to 3 or less</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less"></reference>
                  <description>Limit SSH Login Attempts to 3 or less</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6935321"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6935323" version="1">
               <metadata>
                  <title>Limit SSH Login Attempts to 3 or less</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Limit_SSH_Login_Attempts_to_3_or_less"></reference>
                  <description>Limit SSH Login Attempts to 3 or less</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6935323"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6937269" version="1">
               <metadata>
                  <title>Disable the Telnet Feature</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Disable_the_Telnet_Feature" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Disable_the_Telnet_Feature"></reference>
                  <description>Disable the Telnet Feature</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6937269"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6925965" version="1">
               <metadata>
                  <title>Pre-authentication Banner</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Pre-authentication_Banner" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Pre-authentication_Banner"></reference>
                  <description>Pre-authentication Banner</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6925965"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6925966" version="1">
               <metadata>
                  <title>Post-authentication Banner</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Post-authentication_Banner" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Post-authentication_Banner"></reference>
                  <description>Post-authentication Banner</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6925966"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939241" version="1">
               <metadata>
                  <title>Enable Password Complexity Requirements for Local Credentials</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Enable_Password_Complexity_Requirements_for_Local_Credentials" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Enable_Password_Complexity_Requirements_for_Local_Credentials"></reference>
                  <description>Enable Password Complexity Requirements for Local Credentials</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939241"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939238" version="1">
               <metadata>
                  <title>Set password lifetime, warning time and grace time for local credentials</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials"></reference>
                  <description>Set password lifetime, warning time and grace time for local credentials</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939238"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939239" version="1">
               <metadata>
                  <title>Set password lifetime, warning time and grace time for local credentials</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.4.3_Set_password_lifetime_warning_time_and_grace_time_for_local_credentials"></reference>
                  <description>Set password lifetime, warning time and grace time for local credentials</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939239"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939240" version="1">
               <metadata>
                  <title>Set password length for local credentials</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.4.4_Set_password_length_for_local_credentials" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.4.4_Set_password_length_for_local_credentials"></reference>
                  <description>Set password length for local credentials</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939240"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6943546" version="1">
               <metadata>
                  <title>Ensure Syslog Logging is configured</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_Syslog_Logging_is_configured" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.5.1_Ensure_Syslog_Logging_is_configured"></reference>
                  <description>Ensure Syslog Logging is configured</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6943546"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6960031" version="1">
               <metadata>
                  <title>Configure a Time Zone</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.6.2_Configure_a_Time_Zone" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.6.2_Configure_a_Time_Zone"></reference>
                  <description>Configure a Time Zone</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6960031"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6943547" version="1">
               <metadata>
                  <title>Disable Power on Auto Provisioning (POAP)</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.7.1_Disable_Power_on_Auto_Provisioning_POAP" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.7.1_Disable_Power_on_Auto_Provisioning_POAP"></reference>
                  <description>Disable Power on Auto Provisioning (POAP)</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6943547"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6943548" version="1">
               <metadata>
                  <title>Disable iPXE (Pre-boot eXecution Environment)</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.7.2_Disable_iPXE_Pre-boot_eXecution_Environment" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.7.2_Disable_iPXE_Pre-boot_eXecution_Environment"></reference>
                  <description>Disable iPXE (Pre-boot eXecution Environment)</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6943548"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939242" version="1">
               <metadata>
                  <title>Configure SNMPv3</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3"></reference>
                  <description>Configure SNMPv3</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939242"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939244" version="1">
               <metadata>
                  <title>Configure SNMP Traps</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps"></reference>
                  <description>Configure SNMP Traps</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939244"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6950771" version="1">
               <metadata>
                  <title>Disable IP Source-Routing</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Disable_IP_Source-Routing" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Disable_IP_Source-Routing"></reference>
                  <description>Disable IP Source-Routing</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6950771"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6935324" version="1">
               <metadata>
                  <title>Ensure Exec Timeout for Console Sessions is set for less than 10</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Ensure_Exec_Timeout_for_Console_Sessions_is_set_for_less_than_10" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Ensure_Exec_Timeout_for_Console_Sessions_is_set_for_less_than_10"></reference>
                  <description>Ensure Exec Timeout for Console Sessions is set for less than 10</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6935324"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6935325" version="1">
               <metadata>
                  <title>Ensure Exec Timeout for Remote Administrative Sessions (VTY) is set to less than 10</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_Exec_Timeout_for_Remote_Administrative_Sessions_VTY_is_set_to_less_than_10" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_Exec_Timeout_for_Remote_Administrative_Sessions_VTY_is_set_to_less_than_10"></reference>
                  <description>Ensure Exec Timeout for Remote Administrative Sessions (VTY) is set to less than 10</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6935325"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6935326" version="1">
               <metadata>
                  <title>Set the Maximum Number of VTY Sessions</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions"></reference>
                  <description>Set the Maximum Number of VTY Sessions</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6935326"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6935327" version="1">
               <metadata>
                  <title>Set the Maximum Number of VTY Sessions</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Set_the_Maximum_Number_of_VTY_Sessions"></reference>
                  <description>Set the Maximum Number of VTY Sessions</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6935327"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6951961" version="1">
               <metadata>
                  <title>If VLAN interfaces have IP addreses, configure anti spoofing / ingress filtering protections</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.1.4.1_If_VLAN_interfaces_have_IP_addreses_configure_anti_spoofing__ingress_filtering_protections" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.1.4.1_If_VLAN_interfaces_have_IP_addreses_configure_anti_spoofing__ingress_filtering_protections"></reference>
                  <description>If VLAN interfaces have IP addreses, configure anti spoofing / ingress filtering protections</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6951961"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6950152" version="1">
               <metadata>
                  <title>Disable ICMP Redirects on all Layer 3 Interfaces</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces"></reference>
                  <description>Disable ICMP Redirects on all Layer 3 Interfaces</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6950152"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6960032" version="1">
               <metadata>
                  <title>Disable ICMP Redirects on all Layer 3 Interfaces</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Disable_ICMP_Redirects_on_all_Layer_3_Interfaces"></reference>
                  <description>Disable ICMP Redirects on all Layer 3 Interfaces</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6960032"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6950701" version="1">
               <metadata>
                  <title>Disable Proxy ARP on all Layer 3 Interfaces</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces"></reference>
                  <description>Disable Proxy ARP on all Layer 3 Interfaces</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6950701"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6951960" version="1">
               <metadata>
                  <title>Disable Proxy ARP on all Layer 3 Interfaces</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Disable_Proxy_ARP_on_all_Layer_3_Interfaces"></reference>
                  <description>Disable Proxy ARP on all Layer 3 Interfaces</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6951960"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939243" version="1">
               <metadata>
                  <title>Configure SNMPv3</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.9.1_Configure_SNMPv3"></reference>
                  <description>Configure SNMPv3</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939243"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:6939245" version="1">
               <metadata>
                  <title>Configure SNMP Traps</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_1.9.2_Configure_SNMP_Traps"></reference>
                  <description>Configure SNMP Traps</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:6939245"></criterion>
               </criteria>
            </definition>
         </definitions>
         <tests>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Configure AAA Auth" id="oval:org.cisecurity.benchmarks:tst:6886753" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6886753"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6886753"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="tacacs doesn't exist" id="oval:org.cisecurity.benchmarks:tst:6983732" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6983732"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6983732"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Local SSH keys" id="oval:org.cisecurity.benchmarks:tst:6886754" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6886754"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6886754"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="VTY Auth" id="oval:org.cisecurity.benchmarks:tst:6886755" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6886755"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6886755"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="SSH Login-attempts 3 or less" id="oval:org.cisecurity.benchmarks:tst:6935321" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6935321"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6935321"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="SSH Login-attempts default of 3" id="oval:org.cisecurity.benchmarks:tst:6935323" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6935323"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6935323"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="tellnet disabled" id="oval:org.cisecurity.benchmarks:tst:6937269" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6937269"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6937269"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Banner MOTD" id="oval:org.cisecurity.benchmarks:tst:6925965" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6925965"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6925965"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Banner EXEC" id="oval:org.cisecurity.benchmarks:tst:6925966" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6925966"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6925966"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="Password strength check enabled" id="oval:org.cisecurity.benchmarks:tst:6939241" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939241"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6939241"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Passphrase default lifetime is established" id="oval:org.cisecurity.benchmarks:tst:6939238" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939238"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6939238"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Username passphrase length is established" id="oval:org.cisecurity.benchmarks:tst:6939239" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939239"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6939239"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="password length" id="oval:org.cisecurity.benchmarks:tst:6939240" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939240"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6939240"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="logging server established" id="oval:org.cisecurity.benchmarks:tst:6943546" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6943546"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6943546"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Timezone configured" id="oval:org.cisecurity.benchmarks:tst:6960031" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6960031"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6960031"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="Boot POAP disabled" id="oval:org.cisecurity.benchmarks:tst:6943547" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6943547"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6943547"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="Disable iPXE" id="oval:org.cisecurity.benchmarks:tst:6943548" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6943548"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6943548"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="SNMP v3 traps" id="oval:org.cisecurity.benchmarks:tst:6939242" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939242"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6939242"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="SNMP traps enabled" id="oval:org.cisecurity.benchmarks:tst:6939244" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939244"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6939244"></state>
            </global_test>
            <global_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="no ip source route" id="oval:org.cisecurity.benchmarks:tst:6950771" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6950771"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6950771"></state>
            </global_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Ensure exec timeout is less than 10" id="oval:org.cisecurity.benchmarks:tst:6935324" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6935324"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6935324"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Exec timeout on line VTY" id="oval:org.cisecurity.benchmarks:tst:6935325" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6935325"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6935325"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Sessions 31 or less" id="oval:org.cisecurity.benchmarks:tst:6935326" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6935326"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6935326"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Default enabled does not display" id="oval:org.cisecurity.benchmarks:tst:6935327" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6935327"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6935327"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="Anti Spoofing configured" id="oval:org.cisecurity.benchmarks:tst:6951961" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6951961"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6951961"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="No ip redirects" id="oval:org.cisecurity.benchmarks:tst:6950152" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6950152"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6950152"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="interface shutdown" id="oval:org.cisecurity.benchmarks:tst:6960032" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6960032"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6960032"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="no proxy arp" id="oval:org.cisecurity.benchmarks:tst:6950701" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6950701"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6950701"></state>
            </section_test>
            <section_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="at_least_one_exists" comment="interface shutdown" id="oval:org.cisecurity.benchmarks:tst:6951960" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6951960"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:6951960"></state>
            </section_test>
            <snmp_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="SNMP not configured" id="oval:org.cisecurity.benchmarks:tst:6939243" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939243"></object>
            </snmp_test>
            <snmp_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" check="all" check_existence="none_exist" comment="SNMP not enabled" id="oval:org.cisecurity.benchmarks:tst:6939245" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:6939245"></object>
            </snmp_test>
         </tests>
         <objects>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Configure AAA Auth" id="oval:org.cisecurity.benchmarks:obj:6886753" version="1">
               <global_command operation="pattern match">^\h*aaa\hgroup\hserver\htacacs.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="tacacs doesn't exist" id="oval:org.cisecurity.benchmarks:obj:6983732" version="1">
               <global_command operation="pattern match">^\h*feature\h+tacacs.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Local SSH keys" id="oval:org.cisecurity.benchmarks:obj:6886754" version="1">
               <global_command operation="pattern match">^\h*username\h.+\hsshkey\hssh-rsa\h.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="VTY Auth" id="oval:org.cisecurity.benchmarks:obj:6886755" version="1">
               <global_command operation="pattern match">aaa\hauthentication\hlogin\hdefault\hgroup\h.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SSH Login-attempts 3 or less" id="oval:org.cisecurity.benchmarks:obj:6935321" version="1">
               <global_command operation="pattern match">^h*ssh\hlogin-attempts\h[1-2]</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SSH Login-attempts default of 3" id="oval:org.cisecurity.benchmarks:obj:6935323" version="1">
               <global_command operation="pattern match">^h*ssh\hlogin-attempts\h.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="tellnet disabled" id="oval:org.cisecurity.benchmarks:obj:6937269" version="1">
               <global_command operation="pattern match">^\h*no\hfeature\htelnet</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Banner MOTD" id="oval:org.cisecurity.benchmarks:obj:6925965" version="1">
               <global_command operation="pattern match">^\h*banner\hmotd\h.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Banner EXEC" id="oval:org.cisecurity.benchmarks:obj:6925966" version="1">
               <global_command operation="pattern match">^\h*banner\hexec\h.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Password strength check enabled" id="oval:org.cisecurity.benchmarks:obj:6939241" version="1">
               <global_command operation="pattern match">^\h*no\hpassword\hstrength-check$</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Passphrase default lifetime is established" id="oval:org.cisecurity.benchmarks:obj:6939238" version="1">
               <global_command operation="pattern match">^\h*userpassphrase\hdefault-lifetime\h(365|36[0-5]|3[0-5][0-9]|[1-2][0-9]{2}|[1-9][0-9]|[1-9])\b</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Username passphrase length is established" id="oval:org.cisecurity.benchmarks:obj:6939239" version="1">
               <global_command operation="pattern match">^\h*username\h+[A-Za-z0-9]+\h+passphrase\h+lifetime\h+(365|36[0-5]|3[0-5][0-9]|[1-2][0-9]{2}|[1-9][0-9]|[1-9])\b\h+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="password length" id="oval:org.cisecurity.benchmarks:obj:6939240" version="1">
               <global_command operation="pattern match">^\h*userpassphrase\h+min-length\h\b(1[6-9]|[2-9][0-9]|1[01][0-9]|12[0-7])\b\h+max-length\h+\b(1[6-9]|[2-9][0-9]|1[01][0-9]|12[0-7])\b$</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="logging server established" id="oval:org.cisecurity.benchmarks:obj:6943546" version="1">
               <global_command operation="pattern match">^\h*logging\hserver\h.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Timezone configured" id="oval:org.cisecurity.benchmarks:obj:6960031" version="1">
               <global_command operation="pattern match">^\h*clock\h+timezone\h...\h-\d\h\d$</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Boot POAP disabled" id="oval:org.cisecurity.benchmarks:obj:6943547" version="1">
               <global_command operation="pattern match">^\h*boot\hpoap\henable</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Disable iPXE" id="oval:org.cisecurity.benchmarks:obj:6943548" version="1">
               <global_command operation="pattern match">^\h*boot\horder\hbootflash</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SNMP v3 traps" id="oval:org.cisecurity.benchmarks:obj:6939242" version="1">
               <global_command operation="pattern match">^\h*snmp-server\hhost\h[0-9]+.[0-9]+.[0-9]+.[0-9]+\htraps\hversion\h3.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SNMP traps enabled" id="oval:org.cisecurity.benchmarks:obj:6939244" version="1">
               <global_command operation="pattern match">^\h*snmp-server\hhost\h[0-9]+.[0-9]+.[0-9]+.[0-9]+\htraps\hversion\h3.+</global_command>
            </global_object>
            <global_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="no ip source route" id="oval:org.cisecurity.benchmarks:obj:6950771" version="1">
               <global_command operation="pattern match">^\h*no\h+ip\h+source-route$</global_command>
            </global_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Ensure exec timeout is less than 10" id="oval:org.cisecurity.benchmarks:obj:6935324" version="1">
               <section_command>line console</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Exec timeout on line VTY" id="oval:org.cisecurity.benchmarks:obj:6935325" version="1">
               <section_command>line vty</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Sessions 31 or less" id="oval:org.cisecurity.benchmarks:obj:6935326" version="1">
               <section_command>line vty</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Default enabled does not display" id="oval:org.cisecurity.benchmarks:obj:6935327" version="1">
               <section_command>line vty</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Anti Spoofing configured" id="oval:org.cisecurity.benchmarks:obj:6951961" version="1">
               <section_command>^\h*interface\h+Vlan.+$</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="No ip redirects" id="oval:org.cisecurity.benchmarks:obj:6950152" version="1">
               <section_command>^\h*interface\h.+</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="interface shutdown" id="oval:org.cisecurity.benchmarks:obj:6960032" version="1">
               <section_command>^\h*interface\h+</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="no proxy arp" id="oval:org.cisecurity.benchmarks:obj:6950701" version="1">
               <section_command>^\h*interface\h.+</section_command>
            </section_object>
            <section_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="interface shutdown" id="oval:org.cisecurity.benchmarks:obj:6951960" version="1">
               <section_command>^\h*interface\h.+</section_command>
            </section_object>
            <snmp_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SNMP not configured" id="oval:org.cisecurity.benchmarks:obj:6939243" version="1"></snmp_object>
            <snmp_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SNMP not enabled" id="oval:org.cisecurity.benchmarks:obj:6939245" version="1"></snmp_object>
         </objects>
         <states>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Configure AAA Auth" id="oval:org.cisecurity.benchmarks:ste:6886753" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6886753"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="tacacs doesn't exist" id="oval:org.cisecurity.benchmarks:ste:6983732" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6983732"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Local SSH keys" id="oval:org.cisecurity.benchmarks:ste:6886754" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6886754"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="VTY Auth" id="oval:org.cisecurity.benchmarks:ste:6886755" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6886755"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SSH Login-attempts 3 or less" id="oval:org.cisecurity.benchmarks:ste:6935321" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6935321"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SSH Login-attempts default of 3" id="oval:org.cisecurity.benchmarks:ste:6935323" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6935323"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="tellnet disabled" id="oval:org.cisecurity.benchmarks:ste:6937269" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6937269"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Banner MOTD" id="oval:org.cisecurity.benchmarks:ste:6925965" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6925965"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Banner EXEC" id="oval:org.cisecurity.benchmarks:ste:6925966" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6925966"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Password strength check enabled" id="oval:org.cisecurity.benchmarks:ste:6939241" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6939241"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Passphrase default lifetime is established" id="oval:org.cisecurity.benchmarks:ste:6939238" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6939238"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Username passphrase length is established" id="oval:org.cisecurity.benchmarks:ste:6939239" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6939239"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="password length" id="oval:org.cisecurity.benchmarks:ste:6939240" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6939240"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="logging server established" id="oval:org.cisecurity.benchmarks:ste:6943546" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6943546"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Timezone configured" id="oval:org.cisecurity.benchmarks:ste:6960031" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6960031"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Boot POAP disabled" id="oval:org.cisecurity.benchmarks:ste:6943547" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6943547"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Disable iPXE" id="oval:org.cisecurity.benchmarks:ste:6943548" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6943548"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SNMP v3 traps" id="oval:org.cisecurity.benchmarks:ste:6939242" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6939242"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="SNMP traps enabled" id="oval:org.cisecurity.benchmarks:ste:6939244" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6939244"></global_command>
            </global_state>
            <global_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="no ip source route" id="oval:org.cisecurity.benchmarks:ste:6950771" version="1">
               <global_command operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6950771"></global_command>
            </global_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Ensure exec timeout is less than 10" id="oval:org.cisecurity.benchmarks:ste:6935324" version="1">
               <config_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6935324"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Exec timeout on line VTY" id="oval:org.cisecurity.benchmarks:ste:6935325" version="1">
               <config_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6935325"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Sessions 31 or less" id="oval:org.cisecurity.benchmarks:ste:6935326" version="1">
               <config_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6935326"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Default enabled does not display" id="oval:org.cisecurity.benchmarks:ste:6935327" version="1">
               <config_line entity_check="none satisfy" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6935327"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="Anti Spoofing configured" id="oval:org.cisecurity.benchmarks:ste:6951961" version="1">
               <config_line entity_check="all" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6951961"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="No ip redirects" id="oval:org.cisecurity.benchmarks:ste:6950152" version="1">
               <config_line entity_check="at least one" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6950152"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="interface shutdown" id="oval:org.cisecurity.benchmarks:ste:6960032" version="1">
               <config_line entity_check="none satisfy" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6960032"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="no proxy arp" id="oval:org.cisecurity.benchmarks:ste:6950701" version="1">
               <config_line entity_check="none satisfy" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6950701"></config_line>
            </section_state>
            <section_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#ios" comment="interface shutdown" id="oval:org.cisecurity.benchmarks:ste:6951960" version="1">
               <config_line entity_check="all" operation="pattern match" var_ref="oval:org.cisecurity.benchmarks:var:6951960"></config_line>
            </section_state>
         </states>
         <variables>
            <external_variable comment="This value is used in Rule: Configure AAA Authentication - TACACS if applicable" datatype="string" id="oval:org.cisecurity.benchmarks:var:6886753" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Configure AAA Authentication - TACACS if applicable" datatype="string" id="oval:org.cisecurity.benchmarks:var:6983732" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Configure AAA Authentication - Local SSH keys" datatype="string" id="oval:org.cisecurity.benchmarks:var:6886754" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: vty line authentication" datatype="string" id="oval:org.cisecurity.benchmarks:var:6886755" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Limit SSH Login Attempts to 3 or less" datatype="string" id="oval:org.cisecurity.benchmarks:var:6935321" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Limit SSH Login Attempts to 3 or less" datatype="string" id="oval:org.cisecurity.benchmarks:var:6935323" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable the Telnet Feature" datatype="string" id="oval:org.cisecurity.benchmarks:var:6937269" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Pre-authentication Banner" datatype="string" id="oval:org.cisecurity.benchmarks:var:6925965" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Post-authentication Banner" datatype="string" id="oval:org.cisecurity.benchmarks:var:6925966" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Enable Password Complexity Requirements for Local Credentials" datatype="string" id="oval:org.cisecurity.benchmarks:var:6939241" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Set password lifetime, warning time and grace time for local credentials" datatype="string" id="oval:org.cisecurity.benchmarks:var:6939238" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Set password lifetime, warning time and grace time for local credentials" datatype="string" id="oval:org.cisecurity.benchmarks:var:6939239" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Set password length for local credentials" datatype="string" id="oval:org.cisecurity.benchmarks:var:6939240" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Ensure Syslog Logging is configured" datatype="string" id="oval:org.cisecurity.benchmarks:var:6943546" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Configure a Time Zone" datatype="string" id="oval:org.cisecurity.benchmarks:var:6960031" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable Power on Auto Provisioning (POAP)" datatype="string" id="oval:org.cisecurity.benchmarks:var:6943547" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable iPXE (Pre-boot eXecution Environment)" datatype="string" id="oval:org.cisecurity.benchmarks:var:6943548" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Configure SNMPv3" datatype="string" id="oval:org.cisecurity.benchmarks:var:6939242" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Configure SNMP Traps" datatype="string" id="oval:org.cisecurity.benchmarks:var:6939244" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable IP Source-Routing" datatype="string" id="oval:org.cisecurity.benchmarks:var:6950771" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Ensure Exec Timeout for Console Sessions is set for less than 10" datatype="string" id="oval:org.cisecurity.benchmarks:var:6935324" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Ensure Exec Timeout for Remote Administrative Sessions (VTY) is set to less than 10" datatype="string" id="oval:org.cisecurity.benchmarks:var:6935325" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Set the Maximum Number of VTY Sessions" datatype="string" id="oval:org.cisecurity.benchmarks:var:6935326" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Set the Maximum Number of VTY Sessions" datatype="string" id="oval:org.cisecurity.benchmarks:var:6935327" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: If VLAN interfaces have IP addreses, configure anti spoofing / ingress filtering protections" datatype="string" id="oval:org.cisecurity.benchmarks:var:6951961" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable ICMP Redirects on all Layer 3 Interfaces" datatype="string" id="oval:org.cisecurity.benchmarks:var:6950152" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable ICMP Redirects on all Layer 3 Interfaces" datatype="string" id="oval:org.cisecurity.benchmarks:var:6960032" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable Proxy ARP on all Layer 3 Interfaces" datatype="string" id="oval:org.cisecurity.benchmarks:var:6950701" version="1"></external_variable>
            <external_variable comment="This value is used in Rule: Disable Proxy ARP on all Layer 3 Interfaces" datatype="string" id="oval:org.cisecurity.benchmarks:var:6951960" version="1"></external_variable>
         </variables>
      </oval_definitions>
   </ds:component>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>cTXoNj6ChF78a/Ei84UOwSC6ukJSkueLO+iSqQXS+vw=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
KPdAGWcvlWdAfmK+b4yOrdMtIpLitVjlINkFytTwx6gptbIsL+TZQDWHYD3bQStuJnqI8Cyx5Axn
Ybu6JDZg1yfVQC9Gx9SfA/aSgkzi6CqcsDMkCeS5ZT4xoSJjy+KUBb51kqFqMrjVgBYT7sVZQeZl
2XOoyqZis6UvDzC3VjVkubgel6O8uxByz+MtO0HarS16C0D/LYKx6ZzMGoIi2cwbw0uBsvxxh68q
0tr28KwdlCPxDoRtVISL4giu+WCZGuZy40BYoF5OTJRTlZIdaxqIqGHAFm4Sm8XEG+FexDif0tIr
jQucF+IiPClfrbw92XHTsKNzRy16OZ1ZtV+mOpeqo8P4lC1Q92DtkE+BCDSpF9XQ6FrBBQhKbsG5
mUNB1yzulRI55hgs4Llb6YMNRDvzWu2gvxtHrktIsTHCYB/1Zu/GSDSbbHTeNcrD5kTIWrZ0dqPb
wkBqaUrVfTJbHAji1ULc88mJMTb1jy9kspP5TmVj3Rk/IJ16d0YmDAOi
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></ds:data-stream-collection>