<ds:data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:sce="http://open-scap.org/page/SCE_xccdf_stream" xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_org.cisecurity_collection_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark" schematron-version="1.0">
   <ds:data-stream id="scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark" scap-version="1.2" timestamp="2025-04-23T16:10:58" use-case="CONFIGURATION">
      <ds:checklists>
         <ds:component-ref id="scap_org.cisecurity_cref_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-xccdf" xlink:href="#scap_org.cisecurity_comp_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-xccdf">
            <cat:catalog>
               <cat:uri name="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" uri="scap_org.cisecurity_cref_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-oval"></cat:uri>
            </cat:catalog>
         </ds:component-ref>
      </ds:checklists>
      <ds:checks>
         <ds:component-ref id="scap_org.cisecurity_cref_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-oval" xlink:href="#scap_org.cisecurity_comp_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-oval"></ds:component-ref>
      </ds:checks>
   </ds:data-stream>
   <ds:component id="scap_org.cisecurity_comp_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-xccdf" timestamp="2025-04-23T16:10:58">
      <xccdf:Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
         <xccdf:status date="2025-04-23">accepted</xccdf:status>
         <xccdf:title xml:lang="en">CIS Microsoft SQL Server 2022 Benchmark</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>


This document provides prescriptive guidance for establishing a secure configuration posture for Microsoft SQL Server 2022. This guide was tested against Microsoft SQL Server 2022. To obtain the latest version of this guide, please visit                       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>


. If you have questions, comments, or have identified ways to improve this guide, please write us at                       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>


.                </xhtml:p>
         </xccdf:description>
         <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
         <xccdf:version>1.0.0</xccdf:version>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_Database_Engine">
            <xccdf:title xml:lang="en">Level 1 - Database Engine</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Items in this profile apply to Microsoft SQL Server 2022 and intend to:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>be practical and prudent;</xhtml:li>
                  <xhtml:li>provide a clear security benefit; and</xhtml:li>
                  <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_Latest_SQL_Server_Cumulative_and_Security_Updates_are_Installed" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Single-Function_Member_Servers_are_Used" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Ad_Hoc_Distributed_Queries_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_Cross_DB_Ownership_Chaining_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_Database_Mail_XPs_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_Ole_Automation_Procedures_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_Remote_Admin_Connections_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Trustworthy_Database_Property_is_set_to_Off" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Ensure_Unnecessary_SQL_Server_Protocols_are_set_to_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Ensure_SQL_Server_is_configured_to_use_non-standard_ports" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_Ensure_Hide_Instance_option_is_set_to_Yes_for_Production_SQL_Server_instances" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_the_sa_Login_Account_is_set_to_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.15_Ensure_AUTO_CLOSE_is_set_to_OFF_on_contained_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.16_Ensure_no_login_exists_with_the_name_sa" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Server_Authentication_Property_is_set_to_Windows_Authentication_Mode" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_CONNECT_permissions_on_the_guest_user_is_Revoked_within_all_SQL_Server_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_Orphaned_Users_are_Dropped_From_SQL_Server_Databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_SQL_Authentication_is_not_used_in_contained_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_the_SQL_Servers_MSSQL_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_the_SQL_Servers_SQLAgent_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_the_SQL_Servers_Full-Text_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_only_the_default_permissions_specified_by_Microsoft_are_granted_to_the_public_server_role" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_Windows_BUILTIN_groups_are_not_SQL_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_Windows_local_groups_are_not_SQL_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_the_public_role_in_the_msdb_database_is_not_granted_access_to_SQL_Agent_proxies" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_MUST_CHANGE_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_CHECK_EXPIRATION_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins_Within_the_Sysadmin_Role" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_CHECK_POLICY_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Maximum_number_of_error_log_files_is_set_to_greater_than_or_equal_to_12" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Login_Auditing_is_set_to_failed_logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_Database_and_Application_User_Input_is_Sanitized" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_CLR_Assembly_Permission_Set_is_set_to_SAFE_ACCESS_for_All_CLR_Assemblies" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_Symmetric_Key_encryption_algorithm_is_set_to_AES_128_or_higher_in_non-system_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_Asymmetric_Key_Size_is_set_to_greater_than_or_equal_to_2048_in_non-system_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_SQL_Server_Browser_Service_is_configured_correctly" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_AWS_RDS">
            <xccdf:title xml:lang="en">Level 1 - AWS RDS</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Items in this profile are applicable to Microsoft SQL Server 2022 on AWS RDS and intend to:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>be practical and prudent;</xhtml:li>
                  <xhtml:li>provide a clear security benefit; and</xhtml:li>
                  <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_Latest_SQL_Server_Cumulative_and_Security_Updates_are_Installed" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Single-Function_Member_Servers_are_Used" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Ad_Hoc_Distributed_Queries_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_Cross_DB_Ownership_Chaining_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_Database_Mail_XPs_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Ensure_SQL_Server_is_configured_to_use_non-standard_ports" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_the_sa_Login_Account_is_set_to_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.15_Ensure_AUTO_CLOSE_is_set_to_OFF_on_contained_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.16_Ensure_no_login_exists_with_the_name_sa" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_CONNECT_permissions_on_the_guest_user_is_Revoked_within_all_SQL_Server_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_Orphaned_Users_are_Dropped_From_SQL_Server_Databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_SQL_Authentication_is_not_used_in_contained_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_the_SQL_Servers_MSSQL_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_the_SQL_Servers_SQLAgent_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_the_SQL_Servers_Full-Text_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_only_the_default_permissions_specified_by_Microsoft_are_granted_to_the_public_server_role" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_Windows_BUILTIN_groups_are_not_SQL_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_Windows_local_groups_are_not_SQL_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_CHECK_EXPIRATION_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins_Within_the_Sysadmin_Role" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_CHECK_POLICY_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Maximum_number_of_error_log_files_is_set_to_greater_than_or_equal_to_12" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Login_Auditing_is_set_to_failed_logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_CLR_Assembly_Permission_Set_is_set_to_SAFE_ACCESS_for_All_CLR_Assemblies" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_Symmetric_Key_encryption_algorithm_is_set_to_AES_128_or_higher_in_non-system_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_Asymmetric_Key_Size_is_set_to_greater_than_or_equal_to_2048_in_non-system_databases" selected="true"></xccdf:select>
         </xccdf:Profile>
         <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Database_Engine">
            <xccdf:title xml:lang="en">Level 2 - Database Engine</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This profile extends the "Level 1 - Database Engine" profile. Items in this profile apply to Microsoft SQL Server 2022 and exhibit one or more of the following characteristics:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>are intended for environments or use cases where security is paramount;</xhtml:li>
                  <xhtml:li>acts as defense in depth measure; and</xhtml:li>
                  <xhtml:li>may impact the utility or performance of the technology.</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_Latest_SQL_Server_Cumulative_and_Security_Updates_are_Installed" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Single-Function_Member_Servers_are_Used" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Ad_Hoc_Distributed_Queries_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_Cross_DB_Ownership_Chaining_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_Database_Mail_XPs_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_Ole_Automation_Procedures_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_Remote_Admin_Connections_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Trustworthy_Database_Property_is_set_to_Off" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Ensure_Unnecessary_SQL_Server_Protocols_are_set_to_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Ensure_SQL_Server_is_configured_to_use_non-standard_ports" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_Ensure_Hide_Instance_option_is_set_to_Yes_for_Production_SQL_Server_instances" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_the_sa_Login_Account_is_set_to_Disabled" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.15_Ensure_AUTO_CLOSE_is_set_to_OFF_on_contained_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.16_Ensure_no_login_exists_with_the_name_sa" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Server_Authentication_Property_is_set_to_Windows_Authentication_Mode" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_CONNECT_permissions_on_the_guest_user_is_Revoked_within_all_SQL_Server_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_Orphaned_Users_are_Dropped_From_SQL_Server_Databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_SQL_Authentication_is_not_used_in_contained_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_the_SQL_Servers_MSSQL_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_the_SQL_Servers_SQLAgent_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_the_SQL_Servers_Full-Text_Service_Account_is_Not_an_Administrator" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_only_the_default_permissions_specified_by_Microsoft_are_granted_to_the_public_server_role" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_Windows_BUILTIN_groups_are_not_SQL_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_Windows_local_groups_are_not_SQL_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_the_public_role_in_the_msdb_database_is_not_granted_access_to_SQL_Agent_proxies" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_MUST_CHANGE_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_CHECK_EXPIRATION_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins_Within_the_Sysadmin_Role" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_CHECK_POLICY_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Maximum_number_of_error_log_files_is_set_to_greater_than_or_equal_to_12" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Login_Auditing_is_set_to_failed_logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_Database_and_Application_User_Input_is_Sanitized" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_CLR_Assembly_Permission_Set_is_set_to_SAFE_ACCESS_for_All_CLR_Assemblies" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_Symmetric_Key_encryption_algorithm_is_set_to_AES_128_or_higher_in_non-system_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_Asymmetric_Key_Size_is_set_to_greater_than_or_equal_to_2048_in_non-system_databases" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_Database_Backups_are_Encrypted" selected="true"></xccdf:select>
            <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_SQL_Server_Browser_Service_is_configured_correctly" selected="true"></xccdf:select>
         </xccdf:Profile>
         <Value abstract="false" hidden="false" id="xccdf_org.cisecurity_value_jdbc.url" interactive="1" prohibitChanges="false" type="string">
            <title override="0">Database connection string</title>
            <description override="0">This value allows for user-supplied connection strings</description>
            <value selector=""></value>
            <default>Consult the Assessor User Guide for the applicable tool version.</default>
            <source uri="https://ccpa-docs.readthedocs.io/en/latest/"></source>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223241_var" operator="equals" type="number">
            <title>Ensure 'Ad Hoc Distributed Queries' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Ad Hoc Distributed Queries' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223251_var" operator="equals" type="number">
            <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223261_var" operator="equals" type="number">
            <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223271_var" operator="equals" type="number">
            <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223281_var" operator="equals" type="number">
            <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223291_var" operator="equals" type="number">
            <title>Ensure 'Cross DB Ownership Chaining' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Cross DB Ownership Chaining' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760121_var" operator="equals" type="number">
            <title>Ensure 'Database Mail XPs' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Database Mail XPs' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760141_var" operator="equals" type="number">
            <title>Ensure 'Ole Automation Procedures' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Ole Automation Procedures' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223301_var" operator="equals" type="number">
            <title>Ensure 'Remote Access' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Remote Access' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223311_var" operator="equals" type="number">
            <title>Ensure 'Remote Access' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Remote Access' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_36023501_var" operator="equals" type="number">
            <title>Ensure 'Remote Admin Connections' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Remote Admin Connections' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760221_var" operator="equals" type="number">
            <title>Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760241_var" operator="equals" type="number">
            <title>Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</title>
            <description>This value is used in Rule: Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</description>
            <value>0</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_34223321_var" operator="equals" type="number">
            <title>Ensure 'Hide Instance' option is set to 'Yes' for Production SQL Server instances</title>
            <description>This value is used in Rule: Ensure 'Hide Instance' option is set to 'Yes' for Production SQL Server instances</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760351_var" operator="equals" type="number">
            <title>Ensure the 'sa' Login Account is set to 'Disabled'</title>
            <description>This value is used in Rule: Ensure the 'sa' Login Account is set to 'Disabled'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760361_var" operator="not equal" type="string">
            <title>Ensure the 'sa' Login Account has been renamed</title>
            <description>This value is used in Rule: Ensure the 'sa' Login Account has been renamed</description>
            <value>sa</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760381_var" operator="not equal" type="string">
            <title>Ensure the 'sa' Login Account has been renamed</title>
            <description>This value is used in Rule: Ensure the 'sa' Login Account has been renamed</description>
            <value>rdsa</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760421_var" operator="equals" type="number">
            <title>Ensure 'clr strict security' Server Configuration Option is set to '1'</title>
            <description>This value is used in Rule: Ensure 'clr strict security' Server Configuration Option is set to '1'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760431_var" operator="equals" type="number">
            <title>Ensure 'clr strict security' Server Configuration Option is set to '1'</title>
            <description>This value is used in Rule: Ensure 'clr strict security' Server Configuration Option is set to '1'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760001_var" operator="equals" type="number">
            <title>Ensure 'Server Authentication' Property is set to 'Windows Authentication Mode'</title>
            <description>This value is used in Rule: Ensure 'Server Authentication' Property is set to 'Windows Authentication Mode'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760211_var" operator="greater than or equal" type="number">
            <title>Ensure 'Maximum number of error log files' is set to greater than or equal to '12'</title>
            <description>This value is used in Rule: Ensure 'Maximum number of error log files' is set to greater than or equal to '12'</description>
            <value>12</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760231_var" operator="equals" type="number">
            <title>Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</title>
            <description>This value is used in Rule: Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760251_var" operator="equals" type="number">
            <title>Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</title>
            <description>This value is used in Rule: Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</description>
            <value>1</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_33760271_var" operator="pattern match" type="string">
            <title>Ensure 'Login Auditing' is set to 'failed logins'</title>
            <description>This value is used in Rule: Ensure 'Login Auditing' is set to 'failed logins'</description>
            <value>^(all|failure)$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_36192991_var" operator="pattern match" type="string">
            <title>Ensure Database Backups are Encrypted</title>
            <description>This value is used in Rule: Ensure Database Backups are Encrypted</description>
            <value>^.+$</value>
         </Value>
         <Value id="xccdf_org.cisecurity.benchmarks_value_36193001_var" operator="pattern match" type="string">
            <title>Ensure Database Backups are Encrypted</title>
            <description>This value is used in Rule: Ensure Database Backups are Encrypted</description>
            <value>^.+$</value>
         </Value>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Installation_Updates_and_Patches">
            <xccdf:title xml:lang="en">Installation, Updates and Patches</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations related to installing and patching SQL Server.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_Ensure_Latest_SQL_Server_Cumulative_and_Security_Updates_are_Installed" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure Latest SQL Server Cumulative and Security Updates are Installed</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SQL Server patches contain program updates that fix security and product functionality issues found in the software. These patches can be installed with a security update, which is a single patch, or a cumulative update which is a group of patches. The SQL Server version and patch levels should be the most recent compatible with the organizations' operational needs.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Ensure Authorized Software is Currently Supported " urn="urn:cisecurity.org:controls:8.0:2:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Identify</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Using the most recent SQL Server software, along with all applicable patches can help limit the possibilities for vulnerabilities in the software. The installation version and/or patches applied during setup should be established according to the needs of the organization.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/install-windows/latest-updates-for-microsoft-sql-server</xccdf:ident>
               <xccdf:ident system="URL">https://support.microsoft.com/en-us/help/4041553/sql-server-service-packs-are-discontinued-starting-from-sql-server</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Identify the current version and patch level of your SQL Server instances and ensure they contain the latest security fixes. Make sure to test these fixes in your test environments before updating production instances.</xhtml:p>
                        <xhtml:p>The most recent SQL Server patches can be found here:</xhtml:p>
                        <xhtml:p>
                           <xhtml:a href="https://docs.microsoft.com/en-us/sql/database-engine/install-windows/latest-updates-for-microsoft-sql-server?view=sql-server-ver15">https://docs.microsoft.com/en-us/sql/database-engine/install-windows/latest-updates-for-microsoft-sql-server?view=sql-server-ver15</xhtml:a>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Ensure_Single-Function_Member_Servers_are_Used" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure Single-Function Member Servers are Used</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>It is recommended that SQL Server software be installed on a dedicated server. This architectural consideration affords security flexibility in that the database server can be placed on a separate subnet allowing access only from particular hosts and over particular protocols. Degrees of availability are easier to achieve as well - over time, an enterprise can move from a single database server to a failover to a cluster using load balancing or to some combination thereof.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Segment Data Processing and Storage Based on Sensitivity" urn="urn:cisecurity.org:controls:8.0:3:12">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Physically or Logically Segregate High Risk Applications" urn="urn:cisecurity.org:controls:7.0:2:10">
                           <controls:implementation_groups ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>It is easier to manage (i.e. reduce) the attack surface of the server hosting SQL Server software if the only surfaces to consider are the underlying operating system, SQL Server itself, and any security/operational tooling that may additionally be installed. As noted in the description, availability can be more easily addressed if the database is on a dedicated server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/10" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/12" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Uninstall excess tooling and/or remove unnecessary roles from the underlying operating system.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>It is difficult to see any reasonably adverse impact to making this architectural change, once the costs of making the change have been paid. Custom applications may need to be modified to accommodate database connections over the wire rather than on the host (i.e. using TCP/IP instead of Named Pipes). Additional hardware and operating system licenses may be required to make these architectural changes.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Surface_Area_Reduction">
            <xccdf:title xml:lang="en">Surface Area Reduction</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>


SQL Server offers various configuration options, some of them can be controlled by the                             <xhtml:span class="inline_block">sp_configure</xhtml:span>


 stored procedure. This section contains the listing of the corresponding recommendations.                      </xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Ad_Hoc_Distributed_Queries_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Ad Hoc Distributed Queries' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Enabling Ad Hoc Distributed Queries allows users to query data and execute statements on external data sources. This functionality should be disabled.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This feature can be used to remotely access and exploit vulnerabilities on remote SQL Server instances and to run unsafe Visual Basic for Application functions.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/ad-hoc-distributed-queries-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>For AWS RDS Instances, please refer to the documentation for using Parameter Groups here:</xhtml:p>
                        <xhtml:p>
                           <xhtml:a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html">Working with parameter groups</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'Ad Hoc Distributed Queries', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE; 
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422324" value-id="xccdf_org.cisecurity.benchmarks_value_34223241_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422324"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'CLR Enabled' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">clr enabled</xhtml:span>


 option specifies whether user assemblies can be run by SQL Server.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Use Standard Hardening Configuration Templates for Databases" urn="urn:cisecurity.org:controls:7.0:18:11">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type></controls:asset_type>
                           <controls:security_function></controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


If                                         <xhtml:span class="inline_block">clr strict security</xhtml:span>


 is set to                                         <xhtml:span class="inline_block">1</xhtml:span>


 this recommendation is not applicable. By default,                                         <xhtml:span class="inline_block">clr strict security</xhtml:span>


 is enabled and treats                                         <xhtml:span class="inline_block">SAFE</xhtml:span>


 and                                         <xhtml:span class="inline_block">EXTERNAL_ACCESS</xhtml:span>


 assemblies as if they were marked                                         <xhtml:span class="inline_block">UNSAFE</xhtml:span>


. Though not recommended, the                                         <xhtml:span class="inline_block">clr strict security</xhtml:span>


 option can be disabled for backward compatibility. This recommendation has been retained for environments configured for backwards compatibility.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enabling use of CLR assemblies widens the attack surface of SQL Server and puts it at risk from both inadvertent and malicious assemblies.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/t-sql/statements/create-assembly-transact-sql</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


For AWS RDS Instances, please refer to the documentation for using Parameter Groups here:
                                              <xhtml:a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html">Working with parameter groups</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'clr enabled', 0;                                              <br></br>


RECONFIGURE;
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


If CLR assemblies are in use, applications may need to be rearchitected to eliminate their usage before disabling this setting. Alternatively, some organizations may allow this setting to be enabled                                                     <xhtml:span class="inline_block">1</xhtml:span>


 for assemblies created with the                                                     <xhtml:span class="inline_block">SAFE</xhtml:span>


 permission set, but disallow assemblies created with the riskier                                                     <xhtml:span class="inline_block">UNSAFE</xhtml:span>


 and                                                     <xhtml:span class="inline_block">EXTERNAL_ACCESS</xhtml:span>


 permission sets. To find user-created assemblies, run the following query in all databases, replacing                                                     <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;database_name&gt;</xhtml:span>
                              </xhtml:em>


 with each database name:                                              </xhtml:p>
                           <xhtml:code class="code_block">


USE [&lt;database_name&gt;]                                                    <br></br>


GO                                                    <br></br>


SELECT name AS Assembly_Name, permission_set_desc                                                    <br></br>


FROM sys.assemblies                                                    <br></br>


WHERE is_user_defined = 1;                                                    <br></br>


GO
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="OR">
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422325" value-id="xccdf_org.cisecurity.benchmarks_value_34223251_var"></check-export>
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422325"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422326" value-id="xccdf_org.cisecurity.benchmarks_value_34223261_var"></check-export>
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422326"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422327" value-id="xccdf_org.cisecurity.benchmarks_value_34223271_var"></check-export>
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422327"></check-content-ref>
                     </check>
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422328" value-id="xccdf_org.cisecurity.benchmarks_value_34223281_var"></check-export>
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422328"></check-content-ref>
                     </check>
                  </xccdf:complex-check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_Cross_DB_Ownership_Chaining_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Cross DB Ownership Chaining' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">cross db ownership chaining</xhtml:span>


 option controls cross-database ownership chaining across all databases at the instance (or server) level.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


When enabled, this option allows a member of the                                   <xhtml:span class="inline_block">db_owner</xhtml:span>


 role in a database to gain access to objects owned by a login in any other database, causing an unnecessary information disclosure. When required, cross-database ownership chaining should only be enabled for the specific databases requiring it instead of at the instance level for all databases by using the                                   <xhtml:span class="inline_block">ALTER DATABASE</xhtml:span>
                     <xhtml:em>
                        <xhtml:span class="inline_block">&lt;database_name&gt;</xhtml:span>
                     </xhtml:em>
                     <xhtml:span class="inline_block">SET DB_CHAINING ON</xhtml:span>


 command. This database option may not be changed on the                                   <xhtml:span class="inline_block">master</xhtml:span>


,                                   <xhtml:span class="inline_block">model</xhtml:span>


, or                                   <xhtml:span class="inline_block">tempdb</xhtml:span>


 system databases.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


For AWS RDS Instances, please refer to the documentation for using Parameter Groups here:
                                              <xhtml:a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html">Working with parameter groups</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'cross db ownership chaining', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO 
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422329" value-id="xccdf_org.cisecurity.benchmarks_value_34223291_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422329"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_Database_Mail_XPs_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Database Mail XPs' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">Database Mail XPs</xhtml:span>


 option controls the ability to generate and transmit email messages from SQL Server.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Disabling the                                   <xhtml:span class="inline_block">Database Mail XPs</xhtml:span>


 option reduces the SQL Server surface, eliminates a DOS attack vector and channel to exfiltrate data from the database server to a remote host.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/database-mail/database-mail</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'Database Mail XPs', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE;
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376012" value-id="xccdf_org.cisecurity.benchmarks_value_33760121_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376012"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_Ole_Automation_Procedures_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Ole Automation Procedures' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">Ole Automation Procedures</xhtml:span>


 option controls whether OLE Automation objects can be instantiated within Transact-SQL batches. These are extended stored procedures that allow SQL Server users to execute functions external to SQL Server.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enabling this option will increase the attack surface of SQL Server and allow users to execute functions in the security context of SQL Server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/ole-automation-procedures-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'Ole Automation Procedures', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE; 
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376014" value-id="xccdf_org.cisecurity.benchmarks_value_33760141_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376014"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Remote Access' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">remote access</xhtml:span>


 option controls the execution of local stored procedures on remote servers or remote stored procedures on local server.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Functionality can be abused to launch a Denial-of-Service (DoS) attack on remote servers by off-loading query processing to a target.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/configure-the-remote-access-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


For AWS RDS Instances, please refer to the documentation for using Parameter Groups here:
                                              <xhtml:a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html">Working with parameter groups</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>Otherwise, run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'remote access', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE;
                                        </xhtml:code>
                        <xhtml:p>Restart the Database Engine.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


Per Microsoft: This feature may be removed in a future version of Microsoft SQL Server. Do not use this feature in new development work, and modify applications that currently use this feature as soon as possible. Use                                                     <xhtml:span class="inline_block">sp_addlinkedserver</xhtml:span>


 instead.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422330" value-id="xccdf_org.cisecurity.benchmarks_value_34223301_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422330"></check-content-ref>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422331" value-id="xccdf_org.cisecurity.benchmarks_value_34223311_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422331"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_Remote_Admin_Connections_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Remote Admin Connections' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">remote admin connections</xhtml:span>


 option controls whether a client application on a remote computer can use the Dedicated Administrator Connection (DAC).                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>If it's a clustered installation, this option must be enabled as a clustered SQL Server cannot bind to localhost and DAC will be unavailable otherwise. Enable it for clustered installations. Disable it for standalone installations where not required.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The Dedicated Administrator Connection (DAC) lets an administrator access a running server to execute diagnostic functions or Transact-SQL statements, or to troubleshoot problems on the server, even when the server is locked or running in an abnormal state and not responding to a SQL Server Database Engine connection. In a cluster scenario, the administrator may not actually be logged on to the same node that is currently hosting the SQL Server instance and thus is considered "remote". Therefore, this setting should usually be enabled (                                  <xhtml:span class="inline_block">1</xhtml:span>


) for SQL Server failover clusters; otherwise, it should be disabled (                                  <xhtml:span class="inline_block">0</xhtml:span>


) which is the default.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/remote-admin-connections-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following T-SQL command on non-clustered installations:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'remote admin connections', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3602350" value-id="xccdf_org.cisecurity.benchmarks_value_36023501_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3602350"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">scan for startup procs</xhtml:span>


 option, if enabled, causes SQL Server to scan for and automatically run all stored procedures that are set to execute upon service startup.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enforcing this control reduces the threat of an entity leveraging these facilities for malicious purposes.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/configure-the-scan-for-startup-procs-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'scan for startup procs', 0;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE;
                                        </xhtml:code>
                        <xhtml:p>Restart the Database Engine.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


Setting Scan for Startup Procedures to                                                     <xhtml:span class="inline_block">0</xhtml:span>


 will prevent certain audit traces and other commonly used monitoring stored procedures from re-starting on start up. Additionally, replication requires this setting to be enabled (                                                    <xhtml:span class="inline_block">1</xhtml:span>


) and will automatically change this setting if needed.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376022" value-id="xccdf_org.cisecurity.benchmarks_value_33760221_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376022"></check-content-ref>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376024" value-id="xccdf_org.cisecurity.benchmarks_value_33760241_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376024"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Trustworthy_Database_Property_is_set_to_Off" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Trustworthy' Database Property is set to 'Off'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">TRUSTWORTHY</xhtml:span>


 database option allows database objects to access objects in other databases under certain circumstances.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Provides protection from malicious CLR assemblies or extended procedures.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/trustworthy-database-property</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Execute the following T-SQL statement against the databases (replace                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;database_name&gt;</xhtml:span>
                           </xhtml:em>


 below) returned by the Audit Procedure:                                        </xhtml:p>
                        <xhtml:code class="code_block">ALTER DATABASE [&lt;database_name&gt;] SET TRUSTWORTHY OFF;
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376026"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.10_Ensure_Unnecessary_SQL_Server_Protocols_are_set_to_Disabled" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure Unnecessary SQL Server Protocols are set to 'Disabled'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SQL Server supports Shared Memory, Named Pipes, and TCP/IP protocols. However, SQL Server should be configured to use the bare minimum required based on the organization's needs.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Using fewer protocols minimizes the attack surface of SQL Server and, in some cases, can protect it from remote attacks.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/enable-or-disable-a-server-network-protocol</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Open                                               <xhtml:strong>SQL Server 2022 Configuration Manager</xhtml:strong>


; go to the                                               <xhtml:strong>SQL Server Network Configuration</xhtml:strong>


. Ensure that only required protocols are enabled. Disable protocols not necessary.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>The Database Engine (MSSQL and SQLAgent) services must be stopped and restarted for the change to take effect.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.11_Ensure_SQL_Server_is_configured_to_use_non-standard_ports" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure SQL Server is configured to use non-standard ports</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


If installed, a default SQL Server instance will be assigned a default port of                                   <xhtml:span class="inline_block">TCP:1433</xhtml:span>


 for TCP/IP communication. Administrators can also manually configure named instances to use                                   <xhtml:span class="inline_block">TCP:1433</xhtml:span>


 for communication.                                   <xhtml:span class="inline_block">TCP:1433</xhtml:span>


 is a widely known SQL Server port and this port assignment should be changed. In a multi-instance scenario, each instance must be assigned its own dedicated TCP/IP port.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>In the case of AWS RDS, this is only configurable during the build process.</xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Using a non-default port helps protect the database from attacks directed to the default port.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


In                                                     <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


, in the console pane, expand                                                     <xhtml:strong>SQL Server Network Configuration</xhtml:strong>


, expand Protocols for                                                     <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;InstanceName&gt;</xhtml:span>
                              </xhtml:em>


, and then double-click the TCP/IP protocol                                              </xhtml:li>
                           <xhtml:li>


In the                                                     <xhtml:strong>TCP/IP Properties</xhtml:strong>


 dialog box, on the                                                     <xhtml:strong>IP Addresses</xhtml:strong>


 tab, several IP addresses appear in the format                                                     <xhtml:span class="inline_block">IP1</xhtml:span>


,                                                     <xhtml:span class="inline_block">IP2</xhtml:span>


, up to                                                     <xhtml:span class="inline_block">IPAll</xhtml:span>


. One of these is for the IP address of the loopback adapter,                                                     <xhtml:span class="inline_block">127.0.0.1</xhtml:span>


. Additional IP addresses appear for each IP Address on the computer.                                              </xhtml:li>
                           <xhtml:li>


Under                                                     <xhtml:span class="inline_block">IPAll</xhtml:span>


, change the                                                     <xhtml:strong>TCP Port</xhtml:strong>


 field from                                                     <xhtml:span class="inline_block">1433</xhtml:span>


 to a non-standard port or leave the                                                     <xhtml:strong>TCP Port</xhtml:strong>


 field empty and set the                                                     <xhtml:strong>TCP Dynamic Ports</xhtml:strong>


 value to                                                     <xhtml:span class="inline_block">0</xhtml:span>


 to enable dynamic port assignment and then click                                                     <xhtml:strong>OK</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


In the console pane, click                                                     <xhtml:strong>SQL Server Services</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


In the details pane, right-click                                                     <xhtml:strong>


SQL Server (                                                          <xhtml:em>&lt;InstanceName&gt;</xhtml:em>


)                                                    </xhtml:strong>


 and then click                                                     <xhtml:strong>Restart</xhtml:strong>


, to stop and restart SQL Server.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Changing the default port will force the DAC (Dedicated Administrator Connection) to listen on a random port. Also, it might make benign applications, such as application firewalls, require special configuration. In general, you should set a static port for consistent usage by applications, including firewalls, instead of using dynamic ports which will be chosen randomly at each SQL Server start up.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.12_Ensure_Hide_Instance_option_is_set_to_Yes_for_Production_SQL_Server_instances" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Hide Instance' option is set to 'Yes' for Production SQL Server instances</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Non-clustered SQL Server instances within production environments should be designated as hidden to prevent advertisement by the SQL Server Browser service.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Designating production SQL Server instances as hidden leads to a more secure installation because they cannot be enumerated. However, clustered instances may break if this option is selected.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/hide-an-instance-of-sql-server-database-engine</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either the GUI or T-SQL method shown:</xhtml:p>
                        <xhtml:h4>GUI Method</xhtml:h4>
                        <xhtml:ol>
                           <xhtml:li>


In                                                     <xhtml:strong>SQL Server 2022 Configuration Manager</xhtml:strong>


, expand                                                     <xhtml:strong>SQL Server Network Configuration</xhtml:strong>


, right-click                                                     <xhtml:strong>


Protocols for                                                           <xhtml:em>&lt;InstanceName&gt;</xhtml:em>
                              </xhtml:strong>


, and then select                                                     <xhtml:strong>Properties</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


On the                                                     <xhtml:strong>Flags</xhtml:strong>


 tab, in the                                                     <xhtml:strong>Hide Instance</xhtml:strong>


 box, select                                                     <xhtml:span class="inline_block">Yes</xhtml:span>


, and then click                                                     <xhtml:strong>OK</xhtml:strong>


 to close the dialog box. The change takes effect immediately for new connections.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:h4>T-SQL Method</xhtml:h4>
                        <xhtml:p>Execute the following T-SQL to remediate:</xhtml:p>
                        <xhtml:code class="code_block">


EXEC master.sys.xp_instance_regwrite                                              <br></br>


      @rootkey = N'HKEY_LOCAL_MACHINE',                                              <br></br>


      @key = N'SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib',                                              <br></br>


      @value_name = N'HideInstance',                                              <br></br>


      @type = N'REG_DWORD',                                              <br></br>


      @value = 1;
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This method only prevents the instance from being listed on the network. If the instance is hidden (not exposed by SQL Browser), then connections will need to specify the server and port in order to connect. It does not prevent users from connecting to server if they know the instance name and port.</xhtml:p>
                           <xhtml:p>If you hide a clustered named instance, the cluster service may not be able to connect to the SQL Server. Please refer to the Microsoft documentation reference.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422332" value-id="xccdf_org.cisecurity.benchmarks_value_34223321_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422332"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_the_sa_Login_Account_is_set_to_Disabled" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the 'sa' Login Account is set to 'Disabled'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">sa</xhtml:span>


 account is a widely known and often widely used SQL Server account with sysadmin privileges. This is the original login created during installation and always has the                                   <xhtml:span class="inline_block">principal_id=1</xhtml:span>


 and                                   <xhtml:span class="inline_block">sid=0x01</xhtml:span>


.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Disable Any Unassociated Accounts" urn="urn:cisecurity.org:controls:7.0:16:8">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


In the case of AWS RDS the default name for this account is                                         <xhtml:span class="inline_block">rdsa</xhtml:span>


 instead of                                         <xhtml:span class="inline_block">sa</xhtml:span>


.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enforcing this control reduces the probability of an attacker executing brute force attacks against a well-known principal.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-server-principals-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/t-sql/statements/alter-login-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Execute the following T-SQL query:</xhtml:p>
                        <xhtml:code class="code_block">


USE [master]                                              <br></br>


GO                                              <br></br>


DECLARE @tsql nvarchar(max)                                              <br></br>


SET @tsql = 'ALTER LOGIN ' + SUSER_NAME(0x01) + ' DISABLE'                                              <br></br>


EXEC (@tsql)                                              <br></br>


GO
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


It is not a good security practice to code applications or scripts to use the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 account. However, if this has been done, disabling the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 account will prevent scripts and applications from authenticating to the database server and executing required tasks or functions.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376035" value-id="xccdf_org.cisecurity.benchmarks_value_33760351_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376035"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the 'sa' Login Account has been renamed</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">sa</xhtml:span>


 account is a widely known and often widely used SQL Server login with sysadmin privileges. The                                   <xhtml:span class="inline_block">sa</xhtml:span>


 login is the original login created during installation and always has                                   <xhtml:span class="inline_block">principal_id=1</xhtml:span>


 and                                   <xhtml:span class="inline_block">sid=0x01</xhtml:span>


.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


In the case of AWS RDS the default name for this account is                                         <xhtml:span class="inline_block">rdsa</xhtml:span>


 instead of                                         <xhtml:span class="inline_block">sa</xhtml:span>


.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


It is more difficult to launch password-guessing and brute-force attacks against the                                   <xhtml:span class="inline_block">sa</xhtml:span>


 login if the name is not known.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Replace the                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;different_user&gt;</xhtml:span>
                           </xhtml:em>


 value within the below syntax and execute to rename the                                               <xhtml:span class="inline_block">sa</xhtml:span>


 login.                                        </xhtml:p>
                        <xhtml:code class="code_block">ALTER LOGIN sa WITH NAME = &lt;different_user&gt;;
</xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


It is not a good security practice to code applications or scripts to use the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 login. However, if this has been done, renaming the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 login will prevent scripts and applications from authenticating to the database server and executing required tasks or functions.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376036" value-id="xccdf_org.cisecurity.benchmarks_value_33760361_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376036"></check-content-ref>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376038" value-id="xccdf_org.cisecurity.benchmarks_value_33760381_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376038"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.15_Ensure_AUTO_CLOSE_is_set_to_OFF_on_contained_databases" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'AUTO_CLOSE' is set to 'OFF' on contained databases</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>
                     <xhtml:span class="inline_block">AUTO_CLOSE</xhtml:span>


 determines if a given database is closed or not after a connection terminates. If enabled, subsequent connections to the given database will require the database to be reopened and relevant procedure caches to be rebuilt.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Because authentication of users for contained databases occurs within the database not at the server\instance level, the database must be opened every time to authenticate a user. The frequent opening/closing of the database consumes additional server resources and may contribute to a denial of service.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/databases/security-best-practices-with-contained-databases</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Execute the following T-SQL, replacing                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;database_name&gt;</xhtml:span>
                           </xhtml:em>


 with each database name found by the Audit Procedure:                                        </xhtml:p>
                        <xhtml:code class="code_block">ALTER DATABASE &lt;database_name&gt; SET AUTO_CLOSE OFF;
</xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376040"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.16_Ensure_no_login_exists_with_the_name_sa" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure no login exists with the name 'sa'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">sa</xhtml:span>


 login (e.g. principal) is a widely known and often widely used SQL Server account. Therefore, there should not be a login called                                   <xhtml:span class="inline_block">sa</xhtml:span>


 even when the original                                   <xhtml:span class="inline_block">sa</xhtml:span>


 login (                                  <xhtml:span class="inline_block">principal_id = 1</xhtml:span>


) has been renamed.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enforcing this control reduces the probability of an attacker executing brute force attacks against a well-known principal name.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Execute the appropriate                                               <xhtml:span class="inline_block">ALTER</xhtml:span>


 statement below based on the                                               <xhtml:span class="inline_block">principal_id</xhtml:span>


 returned for the login named                                               <xhtml:span class="inline_block">sa</xhtml:span>


. Replace the                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;different_name&gt;</xhtml:span>
                           </xhtml:em>


 value within the below syntax and execute to rename the                                               <xhtml:span class="inline_block">sa</xhtml:span>


 login.                                        </xhtml:p>
                        <xhtml:code class="code_block">


USE [master]                                              <br></br>


GO                                              <br></br>


-- If principal_id = 1 or the login owns database objects, rename the sa login                                               <br></br>


ALTER LOGIN [sa] WITH NAME = &lt;different_name&gt;;                                              <br></br>


GO
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


It is not a good security practice to code applications or scripts to use the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 account. Given that it is a best practice to rename and disable the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 account, some 3rd party applications check for the existence of a login named                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 and if it doesn't exist, creates one. Removing the                                                     <xhtml:span class="inline_block">sa</xhtml:span>


 login will prevent these scripts and applications from authenticating to the database server and executing required tasks or functions.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3562569"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'clr strict security' Server Configuration Option is set to '1'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">clr strict security</xhtml:span>


 option specifies whether the engine applies the                                   <xhtml:span class="inline_block">PERMISSION_SET</xhtml:span>


 on the assemblies.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:8.0:16:8">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:7.0:18:9">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type></controls:asset_type>
                           <controls:security_function></controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Use Standard Hardening Configuration Templates for Databases" urn="urn:cisecurity.org:controls:7.0:18:11">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type></controls:asset_type>
                           <controls:security_function></controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enabling use of CLR assemblies widens the attack surface of SQL Server and puts it at risk from both inadvertent and malicious assemblies.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/clr-strict-security</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'clr strict security', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE;
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


If CLR assemblies are in use, applications may need to be rearchitected to eliminate their usage before enabling this setting. To find user-created assemblies, run the following query in all databases, replacing                                                     <xhtml:span class="inline_block">&lt;database_name&gt;</xhtml:span>


 with each database name:                                              </xhtml:p>
                           <xhtml:code class="code_block">


USE [&lt;database_name&gt;]                                                    <br></br>


GO                                                    <br></br>


SELECT name AS Assembly_Name, permission_set_desc                                                    <br></br>


FROM sys.assemblies                                                    <br></br>


WHERE is_user_defined = 1;                                                    <br></br>


GO
                                              </xhtml:code>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376042" value-id="xccdf_org.cisecurity.benchmarks_value_33760421_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376042"></check-content-ref>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376043" value-id="xccdf_org.cisecurity.benchmarks_value_33760431_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376043"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Authentication_and_Authorization">
            <xccdf:title xml:lang="en">Authentication and Authorization</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations related to SQL Server's authentication and authorization mechanisms.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Server_Authentication_Property_is_set_to_Windows_Authentication_Mode" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Server Authentication' Property is set to 'Windows Authentication Mode'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Uses                                   <xhtml:strong>Windows Authentication</xhtml:strong>


 to validate attempted connections.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Windows provides a more robust authentication mechanism than SQL Server authentication.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/server-properties-security-page</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either the GUI or T-SQL method shown:</xhtml:p>
                        <xhtml:h4>GUI Method</xhtml:h4>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:strong>SQL Server Management Studio</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Open the                                                     <xhtml:strong>Object Explorer</xhtml:strong>


 tab and connect to the target SQL Server instance.                                              </xhtml:li>
                           <xhtml:li>


Right click the instance name and select                                                     <xhtml:strong>Properties</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Select the                                                     <xhtml:strong>Security</xhtml:strong>


 page from the left menu.                                              </xhtml:li>
                           <xhtml:li>


Set the                                                     <xhtml:strong>Server authentication</xhtml:strong>


 setting to                                                     <xhtml:strong>Windows Authentication Mode</xhtml:strong>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:h4>T-SQL Method</xhtml:h4>
                        <xhtml:p>Run the following T-SQL in a Query Window:</xhtml:p>
                        <xhtml:code class="code_block">


USE [master]                                              <br></br>


GO                                              <br></br>


EXEC xp_instance_regwrite N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'LoginMode', REG_DWORD, 1                                              <br></br>


GO
                                        </xhtml:code>
                        <xhtml:p>Restart the SQL Server service for the change to take effect.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Changing the login mode configuration requires a restart of the service.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376000" value-id="xccdf_org.cisecurity.benchmarks_value_33760001_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376000"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_CONNECT_permissions_on_the_guest_user_is_Revoked_within_all_SQL_Server_databases" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure CONNECT permissions on the 'guest' user is Revoked within all SQL Server databases</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Remove the right of the                                   <xhtml:span class="inline_block">guest</xhtml:span>


 user to connect to SQL Server databases, except for                                   <xhtml:span class="inline_block">master</xhtml:span>


,                                   <xhtml:span class="inline_block">msdb</xhtml:span>


,                                   <xhtml:span class="inline_block">tempdb</xhtml:span>


, and, on AWS RDS instances,                                   <xhtml:span class="inline_block">rdsadmin</xhtml:span>


.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


The                                         <xhtml:span class="inline_block">guest</xhtml:span>


 user cannot have the                                         <xhtml:span class="inline_block">CONNECT</xhtml:span>


 permission revoked in                                         <xhtml:span class="inline_block">master</xhtml:span>


,                                         <xhtml:span class="inline_block">msdb</xhtml:span>


 and                                         <xhtml:span class="inline_block">tempdb</xhtml:span>


, but this permission should be revoked in all other databases on the SQL Server instance.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


A login assumes the identity of the                                   <xhtml:span class="inline_block">guest</xhtml:span>


 user when a login has access to SQL Server but does not have access to a database through its own account and the database has a                                   <xhtml:span class="inline_block">guest</xhtml:span>


 user account. Revoking the                                   <xhtml:span class="inline_block">CONNECT</xhtml:span>


 permission for the                                   <xhtml:span class="inline_block">guest</xhtml:span>


 user will ensure that a login is not able to access database information without explicit access to do so.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/policy-based-management/guest-permissions-on-user-databases</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


The following code snippet revokes                                               <xhtml:span class="inline_block">CONNECT</xhtml:span>


 permissions from the                                               <xhtml:span class="inline_block">guest</xhtml:span>


 user in a database. Replace                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;database_name&gt;</xhtml:span>
                           </xhtml:em>


 as appropriate:                                        </xhtml:p>
                        <xhtml:code class="code_block">


USE &lt;database_name&gt;;                                              <br></br>


GO                                              <br></br>


REVOKE CONNECT FROM guest;
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


When                                                     <xhtml:span class="inline_block">CONNECT</xhtml:span>


 permission to the                                                     <xhtml:span class="inline_block">guest</xhtml:span>


 user is revoked, a SQL Server instance login must be mapped to a database user explicitly in order to have access to the database.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3422333"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_Orphaned_Users_are_Dropped_From_SQL_Server_Databases" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Orphaned Users' are Dropped From SQL Server Databases</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>A database user for which the corresponding SQL Server login is undefined or is incorrectly defined on a server instance cannot log in to the instance and is referred to as orphaned and should be removed.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Disable Any Unassociated Accounts" urn="urn:cisecurity.org:controls:7.0:16:8">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Orphan users should be removed to avoid potential misuse of those broken users in any way.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/sql-server/failover-clusters/troubleshoot-orphaned-users-sql-server</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>If the orphaned user cannot or should not be matched to an existing or new login using the Microsoft documented process referenced below, run the following T-SQL query in the appropriate database to remove an orphan user:</xhtml:p>
                        <xhtml:code class="code_block">


USE &lt;database_name&gt;;                                              <br></br>


GO                                              <br></br>


DROP USER &lt;username&gt;;
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376004"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_SQL_Authentication_is_not_used_in_contained_databases" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure SQL Authentication is not used in contained databases</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Contained databases do not enforce password complexity rules for SQL Authenticated users.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Centralize Account Management" urn="urn:cisecurity.org:controls:8.0:5:6">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The absence of an enforced password policy may increase the likelihood of a weak credential being established in a contained database.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/databases/security-best-practices-with-contained-databases</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Leverage Windows Authenticated users in contained databases.</xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>While contained databases provide flexibility in relocating databases to different instances and different environments, this must be balanced with the consideration that no password policy mechanism exists for SQL Authenticated users in contained databases.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376007"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_the_SQL_Servers_MSSQL_Service_Account_is_Not_an_Administrator" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure the SQL Servers MSSQL Service Account is Not an Administrator</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The service account and/or service SID used by the                                   <xhtml:span class="inline_block">MSSQLSERVER</xhtml:span>


 service for a default instance or                                   <xhtml:em>
                        <xhtml:span class="inline_block">&lt;InstanceName&gt;</xhtml:span>
                     </xhtml:em>


 service for a named instance should not be a member of the Windows Administrator group either directly or indirectly (via a group). This also means that the account known as                                   <xhtml:span class="inline_block">LocalSystem</xhtml:span>


 (aka                                   <xhtml:span class="inline_block">NT AUTHORITY\SYSTEM</xhtml:span>


) should not be used for the                                   <xhtml:span class="inline_block">MSSQL</xhtml:span>


 service as this account has higher privileges than the SQL Server service requires.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Following the principle of least privilege, the service account should have no more privileges than required to do its job. For SQL Server services, the SQL Server Setup will assign the required permissions directly to the service                                   <xhtml:span class="inline_block">SID</xhtml:span>


. No additional permissions or privileges should be necessary.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/configure-windows-service-accounts-and-permissions</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


In the case where                                               <xhtml:span class="inline_block">LocalSystem</xhtml:span>


 is used, use                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 to change to a less privileged account. Otherwise, remove the account or service                                               <xhtml:span class="inline_block">SID</xhtml:span>


 from the Administrators group. You may need to run the                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 if underlying permissions had been changed or if                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 was not originally used to set the service account.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


The                                                     <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 tool should always be used to change the SQL Servers service account. This will ensure that the account has the necessary privileges. If the service needs access to resources other than the standard Microsoft defined directories and registry, then additional permissions may need to be granted separately to those resources.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_the_SQL_Servers_SQLAgent_Service_Account_is_Not_an_Administrator" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure the SQL Servers SQLAgent Service Account is Not an Administrator</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The service account and/or service                                   <xhtml:span class="inline_block">SID</xhtml:span>


 used by the                                   <xhtml:span class="inline_block">SQLSERVERAGENT</xhtml:span>


 service for a default instance or                                   <xhtml:span class="inline_block">SQLAGENT$</xhtml:span>
                     <xhtml:em>
                        <xhtml:span class="inline_block">&lt;InstanceName&gt;</xhtml:span>
                     </xhtml:em>


 service for a named instance should not be a member of the Windows Administrator group either directly or indirectly (via a group). This also means that the account known as                                   <xhtml:span class="inline_block">LocalSystem</xhtml:span>


 (AKA                                   <xhtml:span class="inline_block">NT AUTHORITY\SYSTEM</xhtml:span>


) should not be used for the                                   <xhtml:span class="inline_block">SQLAGENT</xhtml:span>


 service as this account has higher privileges than the SQL Server service requires.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Following the principle of least privilege, the service account should have no more privileges than required to do its job. For SQL Server services, the SQL Server Setup will assign the required permissions directly to the service                                   <xhtml:span class="inline_block">SID</xhtml:span>


. No additional permissions or privileges should be necessary.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/configure-windows-service-accounts-and-permissions</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


In the case where                                               <xhtml:span class="inline_block">LocalSystem</xhtml:span>


 is used, use                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 to change to a less privileged account. Otherwise, remove the account or service                                               <xhtml:span class="inline_block">SID</xhtml:span>


 from the Administrators group. You may need to run the                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 if underlying permissions had been changed or if                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 was not originally used to set the service account.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


The                                                     <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 tool should always be used to change the SQL Servers service account. This will ensure that the account has the necessary privileges. If the service needs access to resources other than the standard Microsoft-defined directories and registry, then additional permissions may need to be granted separately to those resources.                                              </xhtml:p>
                           <xhtml:p>


If using the auto restart feature, then the                                                     <xhtml:span class="inline_block">SQLAGENT</xhtml:span>


 service must be an Administrator.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_the_SQL_Servers_Full-Text_Service_Account_is_Not_an_Administrator" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure the SQL Servers Full-Text Service Account is Not an Administrator</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The service account and/or service                                   <xhtml:span class="inline_block">SID</xhtml:span>


 used by the                                   <xhtml:span class="inline_block">MSSQLFDLauncher</xhtml:span>


 service for a default instance or                                   <xhtml:span class="inline_block">MSSQLFDLauncher$</xhtml:span>
                     <xhtml:em>
                        <xhtml:span class="inline_block">&lt;InstanceName&gt;</xhtml:span>
                     </xhtml:em>


 service for a named instance should not be a member of the Windows Administrator group either directly or indirectly (via a group). This also means that the account known as                                   <xhtml:span class="inline_block">LocalSystem</xhtml:span>


 (aka                                   <xhtml:span class="inline_block">NT AUTHORITY\SYSTEM</xhtml:span>


) should not be used for the Full-Text service as this account has higher privileges than the SQL Server service requires.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Following the principle of least privilege, the service account should have no more privileges than required to do its job. For SQL Server services, the SQL Server Setup will assign the required permissions directly to the service                                   <xhtml:span class="inline_block">SID</xhtml:span>


. No additional permissions or privileges should be necessary.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/configure-windows-service-accounts-and-permissions</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


In the case where                                               <xhtml:span class="inline_block">LocalSystem</xhtml:span>


 is used, use                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 to change to a less privileged account. Otherwise, remove the account or service                                               <xhtml:span class="inline_block">SID</xhtml:span>


 from the Administrators group. You may need to run the                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 if underlying permissions had been changed or if                                               <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 was not originally used to set the service account.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


The                                                     <xhtml:strong>SQL Server Configuration Manager</xhtml:strong>


 tool should always be used to change the SQL Servers service account. This will ensure that the account has the necessary privileges. If the service needs access to resources other than the standard Microsoft-defined directories and registry, then additional permissions may need to be granted separately to those resources.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_only_the_default_permissions_specified_by_Microsoft_are_granted_to_the_public_server_role" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure only the default permissions specified by Microsoft are granted to the public server role</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>
                     <xhtml:span class="inline_block">public</xhtml:span>


 is a special fixed server role containing all logins. Unlike other fixed server roles, permissions can be changed for the                                   <xhtml:span class="inline_block">public</xhtml:span>


 role. In keeping with the principle of least privileges, the                                   <xhtml:span class="inline_block">public</xhtml:span>


 server role should not be used to grant permissions at the server scope as these would be inherited by all users.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Every SQL Server login belongs to the                                   <xhtml:span class="inline_block">public</xhtml:span>


 role and cannot be removed from this role. Therefore, any permissions granted to this role will be available to all logins unless they have been explicitly denied to specific logins or user-defined server roles.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/authentication-access/server-level-roles</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/authentication-access/server-level-roles#permissions-of-fixed-server-roles</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>Add the extraneous permissions found in the Audit query results to the specific logins to user-defined server roles which require the access.</xhtml:li>
                           <xhtml:li>


Revoke the                                                     <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;permission_name&gt;</xhtml:span>
                              </xhtml:em>


 from the                                                     <xhtml:span class="inline_block">public</xhtml:span>


 role as shown below
                                                    <xhtml:code class="code_block">USE [master]
GO
REVOKE &lt;permission_name&gt; FROM public;
GO
</xhtml:code>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


When the extraneous permissions are revoked from the                                                     <xhtml:span class="inline_block">public</xhtml:span>


 server role, access may be lost unless the permissions are granted to the explicit logins or to user-defined server roles containing the logins which require the access.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376009"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_Windows_BUILTIN_groups_are_not_SQL_Logins" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Windows BUILTIN groups are not SQL Logins</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Prior to SQL Server 2008, the                                   <xhtml:span class="inline_block">BUILTIN\Administrators</xhtml:span>


 group was added as a SQL Server login with sysadmin privileges during installation by default. Best practices promote creating an Active Directory level group containing approved DBA staff accounts and using this controlled AD group as the login with sysadmin privileges. The AD group should be specified during SQL Server installation and the                                   <xhtml:span class="inline_block">BUILTIN\Administrators</xhtml:span>


 group would therefore have no need to be a login.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


In AWS RDS instances                                         <xhtml:span class="inline_block">[BUILTIN]\Administrators</xhtml:span>


 can't be dropped. Dropping                                         <xhtml:span class="inline_block">[Builtin]\Administrators</xhtml:span>


 is blocked in AWS RDS by the server-level trigger                                         <xhtml:span class="inline_block">rds_drop_login_trigger</xhtml:span>


.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">BUILTIN</xhtml:span>


 groups (Administrators, Everyone, Authenticated Users, Guests, etc.) generally contain very broad memberships which would not meet the best practice of ensuring only the necessary users have been granted access to a SQL Server instance. These groups should not be used for any level of access into a SQL Server Database Engine instance.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For each                                                     <xhtml:span class="inline_block">BUILTIN</xhtml:span>


 login, if needed create a more restrictive AD group containing only the required user accounts.                                              </xhtml:li>
                           <xhtml:li>Add the AD group or individual Windows accounts as a SQL Server login and grant it the permissions required.</xhtml:li>
                           <xhtml:li>


Drop the                                                     <xhtml:span class="inline_block">BUILTIN</xhtml:span>


 login using the syntax below after replacing                                                     <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;name&gt;</xhtml:span>
                              </xhtml:em>


 in                                                     <xhtml:span class="inline_block">[BUILTIN\</xhtml:span>
                              <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;name&gt;</xhtml:span>
                              </xhtml:em>
                              <xhtml:span class="inline_block">]</xhtml:span>


.
                                                    <xhtml:code class="code_block">USE [master]
GO
DROP LOGIN [BUILTIN\&lt;name&gt;]
GO
</xhtml:code>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


Before dropping the                                                     <xhtml:span class="inline_block">BUILTIN</xhtml:span>


 group logins, ensure that alternative AD Groups or Windows logins have been added with equivalent permissions. Otherwise, the SQL Server instance may become totally inaccessible.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3422334"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_Windows_local_groups_are_not_SQL_Logins" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Windows local groups are not SQL Logins</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Local Windows groups should not be used as logins for SQL Server instances.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Allowing local Windows groups as SQL Logins provides a loophole whereby anyone with OS level administrator rights (and no SQL Server rights) could add users to the local Windows groups and thereby give themselves or others access to the SQL Server instance.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


For each                                                     <xhtml:span class="inline_block">LocalGroupName</xhtml:span>


 login, if needed create an equivalent AD group containing only the required user accounts.                                              </xhtml:li>
                           <xhtml:li>Add the AD group or individual Windows accounts as a SQL Server login and grant it the permissions required.</xhtml:li>
                           <xhtml:li>


Drop the                                                     <xhtml:span class="inline_block">LocalGroupName</xhtml:span>


 login using the syntax below after replacing                                                     <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;name&gt;</xhtml:span>
                              </xhtml:em>


.
                                                    <xhtml:code class="code_block">USE [master]
GO
DROP LOGIN [&lt;name&gt;]
GO
</xhtml:code>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Before dropping the local group logins, ensure that alternative AD Groups or Windows logins have been added with equivalent permissions. Otherwise, the SQL Server instance may become totally inaccessible.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3614776"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_the_public_role_in_the_msdb_database_is_not_granted_access_to_SQL_Agent_proxies" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure the public role in the msdb database is not granted access to SQL Agent proxies</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">public</xhtml:span>


 database role contains every user in the                                   <xhtml:span class="inline_block">msdb</xhtml:span>


 database. SQL Agent proxies define a security context in which a job step can run.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Granting access to SQL Agent proxies for the                                   <xhtml:span class="inline_block">public</xhtml:span>


 role would allow all users to utilize the proxy which may have high privileges. This would likely break the principle of least privileges.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-US/sql/ssms/agent/create-a-sql-server-agent-proxy</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>


Ensure the required security principals are explicitly granted access to the proxy (use                                                     <xhtml:span class="inline_block">sp_grant_login_to_proxy</xhtml:span>


).                                              </xhtml:li>
                           <xhtml:li>


Revoke access to the                                                     <xhtml:em>
                                 <xhtml:span class="inline_block">&lt;proxyname&gt;</xhtml:span>
                              </xhtml:em>


 from the                                                     <xhtml:span class="inline_block">public</xhtml:span>


 role.
                                                    <xhtml:code class="code_block">USE [msdb]
GO
EXEC dbo.sp_revoke_login_from_proxy @name = N'public', @proxy_name = N'&lt;proxyname&gt;';
GO
</xhtml:code>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


Before revoking the                                                     <xhtml:span class="inline_block">public</xhtml:span>


 role from the proxy, ensure that alternative logins or appropriate user-defined database roles have been added with equivalent permissions. Otherwise, SQL Agent job steps dependent upon this access will fail.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376015"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Password_Policies">
            <xccdf:title xml:lang="en">Password Policies</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations related to SQL Server's password policies.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Ensure_MUST_CHANGE_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure 'MUST_CHANGE' Option is set to 'ON' for All SQL Authenticated Logins</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Whenever this option is set to                                   <xhtml:span class="inline_block">ON</xhtml:span>


, SQL Server will prompt for an updated password the first time the new or altered login is used.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Manage Default Accounts on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:7">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Change Default Passwords" urn="urn:cisecurity.org:controls:7.0:4:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Enforcing a password change after a reset or new login creation will prevent the account administrators or anyone accessing the initial password from misuse of the SQL login created without being noticed.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-login-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://docs.microsoft.com/en-us/sql/t-sql/statements/create-login-transact-sql</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Set the                                               <xhtml:span class="inline_block">MUST_CHANGE</xhtml:span>


 option for SQL Authenticated logins when creating a login initially:                                        </xhtml:p>
                        <xhtml:code class="code_block">CREATE LOGIN &lt;login_name&gt; WITH PASSWORD = '&lt;password_value&gt;' MUST_CHANGE, CHECK_EXPIRATION = ON, CHECK_POLICY = ON;
</xhtml:code>
                        <xhtml:p>


Set the                                               <xhtml:span class="inline_block">MUST_CHANGE</xhtml:span>


 option for SQL Authenticated logins when resetting a password:                                        </xhtml:p>
                        <xhtml:code class="code_block">ALTER LOGIN &lt;login_name&gt; WITH PASSWORD = '&lt;new_password_value&gt;' MUST_CHANGE;
</xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>
                              <xhtml:span class="inline_block">CHECK_EXPIRATION</xhtml:span>


 and                                                     <xhtml:span class="inline_block">CHECK_POLICY</xhtml:span>


 options must both be                                                     <xhtml:span class="inline_block">ON</xhtml:span>


. End users must have the means (application) to change the password when forced.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_CHECK_EXPIRATION_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins_Within_the_Sysadmin_Role" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'CHECK_EXPIRATION' Option is set to 'ON' for All SQL Authenticated Logins Within the Sysadmin Role</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Applies the same password expiration policy used in Windows to passwords used inside SQL Server.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Respond</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure All Accounts Have An Expiration Date" urn="urn:cisecurity.org:controls:7.0:16:10">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


The                                         <xhtml:span class="inline_block">rdsa</xhtml:span>


 account created by AWS RDS cannot be altered. It has the                                         <xhtml:span class="inline_block">Sysadmin</xhtml:span>


 role but its password cannot be changed to allow it to expire.                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Ensuring SQL logins comply with the secure password policy applied by the Windows Server Benchmark will ensure the passwords for SQL logins with                                   <xhtml:span class="inline_block">sysadmin</xhtml:span>


 privileges are changed on a frequent basis to help prevent compromise via a brute force attack.                                   <xhtml:span class="inline_block">CONTROL SERVER</xhtml:span>


 is an equivalent permission to                                   <xhtml:span class="inline_block">sysadmin</xhtml:span>


 and logins with that permission should also be required to have expiring passwords.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/10" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/password-policy</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


For each                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;login_name&gt;</xhtml:span>
                           </xhtml:em>


 found by the Audit Procedure, execute the following T-SQL statement:                                        </xhtml:p>
                        <xhtml:code class="code_block">ALTER LOGIN [&lt;login_name&gt;] WITH CHECK_EXPIRATION = ON;
</xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This is a mitigating recommendation for systems which cannot follow the recommendation to use only Windows Authenticated logins.</xhtml:p>
                           <xhtml:p>


Regarding limiting this rule to only logins with                                                     <xhtml:span class="inline_block">sysadmin</xhtml:span>


 and                                                     <xhtml:span class="inline_block">CONTROL SERVER</xhtml:span>


 privileges, there are too many cases of applications that run with less than sysadmin level privileges that have hard-coded passwords or effectively hard-coded passwords (whatever is set the first time is nearly impossible to change). There are several line-of-business applications that are considered best of breed which have this failing.                                              </xhtml:p>
                           <xhtml:p>Also, keep in mind that the password policy is taken from the computer's local policy, which is taken from the Default Domain Policy setting. Many organizations have a different password policy regarding the service accounts. These are handled in AD by setting the account's password to not expire and having some other process track when the password needs to be changed. With this second control in place, this is perfectly acceptable from an audit perspective. If you treat a SQL Server login as a service account, then you have to do the same. This ensures that the password change happens during a communicated downtime window and not arbitrarily.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3422335"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_CHECK_POLICY_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'CHECK_POLICY' Option is set to 'ON' for All SQL Authenticated Logins</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Applies the same password complexity policy used in Windows to passwords used inside SQL Server.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Ensure SQL authenticated login passwords comply with the secure password policy applied by the Windows Server Benchmark so that they cannot be easily compromised via brute force attack.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/password-policy</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


For each                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;login_name&gt;</xhtml:span>
                           </xhtml:em>


 found by the Audit Procedure, execute the following T-SQL statement:                                        </xhtml:p>
                        <xhtml:code class="code_block">ALTER LOGIN [&lt;login_name&gt;] WITH CHECK_POLICY = ON;
</xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 In the case of AWS RDS do not perform this remediation for the Master account.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>This is a mitigating recommendation for systems which cannot follow the recommendation to use only Windows Authenticated logins.</xhtml:p>
                           <xhtml:p>Weak passwords can lead to compromised systems. SQL Server authenticated logins will utilize the password policy set in the computer's local policy, which is typically set by the Default Domain Policy setting.</xhtml:p>
                           <xhtml:p>The setting is only enforced when the password is changed. This setting does not force existing weak passwords to be changed.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376019"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Auditing_and_Logging">
            <xccdf:title xml:lang="en">Auditing and Logging</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations related to SQL Server's audit and logging mechanisms.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Maximum_number_of_error_log_files_is_set_to_greater_than_or_equal_to_12" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Maximum number of error log files' is set to greater than or equal to '12'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SQL Server error log files must be protected from loss. The log files must be backed up before they are overwritten. Retaining more error logs helps prevent loss from frequent recycling before backups can occur.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>The SQL Server error log contains important information about major server events and login attempt information as well.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/scm-services-configure-sql-server-error-logs</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Adjust the number of logs to prevent data loss. The default value of                                               <xhtml:span class="inline_block">6</xhtml:span>


 may be insufficient for a production environment.  Perform either the GUI or T-SQL method shown:                                        </xhtml:p>
                        <xhtml:h4>GUI Method</xhtml:h4>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:strong>SQL Server Management Studio</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Open                                                     <xhtml:strong>Object Explorer</xhtml:strong>


 and connect to the target instance.                                              </xhtml:li>
                           <xhtml:li>


Navigate to the                                                     <xhtml:strong>Management</xhtml:strong>


 tab in                                                     <xhtml:strong>Object Explorer</xhtml:strong>


 and expand. Right click on the                                                     <xhtml:strong>SQL Server Logs</xhtml:strong>


 file and select                                                     <xhtml:strong>Configure</xhtml:strong>
                           </xhtml:li>
                           <xhtml:li>


Check the                                                     <xhtml:strong>Limit the number of error log files before they are recycled</xhtml:strong>
                           </xhtml:li>
                           <xhtml:li>


Set the                                                     <xhtml:strong>Maximum number of error log files</xhtml:strong>


 to greater than or equal to                                                     <xhtml:span class="inline_block">12</xhtml:span>
                           </xhtml:li>
                        </xhtml:ol>
                        <xhtml:h4>T-SQL Method</xhtml:h4>
                        <xhtml:p>


Run the following T-SQL to change the number of error log files, replace                                               <xhtml:em>
                              <xhtml:span class="inline_block">&lt;NumberAbove12&gt;</xhtml:span>
                           </xhtml:em>


 with your desired number of error log files:                                        </xhtml:p>
                        <xhtml:code class="code_block">


EXEC master.sys.xp_instance_regwrite                                              <br></br>


N'HKEY_LOCAL_MACHINE',                                              <br></br>


N'Software\Microsoft\MSSQLServer\MSSQLServer',                                              <br></br>


N'NumErrorLogs',                                              <br></br>


REG_DWORD,                                              <br></br>


&lt;NumberAbove12&gt;;
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


Once the max number of error logs is reached, the oldest error log file is deleted each time SQL Server restarts or                                                     <xhtml:span class="inline_block">sp_cycle_errorlog</xhtml:span>


 is executed.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376021" value-id="xccdf_org.cisecurity.benchmarks_value_33760211_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376021"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>The default trace provides audit logging of database activity including account creations, privilege elevation and execution of DBCC commands.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Default trace provides valuable audit information regarding security-related activities on the server.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/default-trace-enabled-server-configuration-option</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Run the following T-SQL command:</xhtml:p>
                        <xhtml:code class="code_block">


EXECUTE sp_configure 'show advanced options', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


EXECUTE sp_configure 'default trace enabled', 1;                                              <br></br>


RECONFIGURE;                                              <br></br>


GO                                              <br></br>


EXECUTE sp_configure 'show advanced options', 0;                                              <br></br>


RECONFIGURE;
                                        </xhtml:code>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376023" value-id="xccdf_org.cisecurity.benchmarks_value_33760231_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376023"></check-content-ref>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376025" value-id="xccdf_org.cisecurity.benchmarks_value_33760251_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376025"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Login_Auditing_is_set_to_failed_logins" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Login Auditing' is set to 'failed logins'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


This setting will record failed authentication attempts for SQL Server logins to the                                   <xhtml:strong>SQL Server Errorlog</xhtml:strong>


. This is the default setting for SQL Server.                            </xhtml:p>
                  <xhtml:p>


Historically, this setting has been available in all versions and editions of SQL Server. Prior to the availability of                                   <xhtml:strong>SQL Server Audit</xhtml:strong>


, this was the only provided mechanism for capturing logins (successful or failed).                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain an Audit Log Management Process" urn="urn:cisecurity.org:controls:8.0:8:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Alert on Account Login Behavior Deviation" urn="urn:cisecurity.org:controls:7.0:16:13">
                           <controls:implementation_groups ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Capturing failed logins provides key information that can be used to detect\confirm password guessing attacks. Capturing successful login attempts can be used to confirm server access during forensic investigations, but using this audit level setting to also capture successful logins creates excessive noise in the                                   <xhtml:strong>SQL Server Errorlog</xhtml:strong>


 which can hamper a DBA trying to troubleshoot problems. Elsewhere in this benchmark, we recommend using the newer lightweight SQL Server Audit feature to capture both successful and failed logins.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/13" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/server-properties-security-page</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Perform either the GUI or T-SQL method shown:</xhtml:p>
                        <xhtml:h4>GUI Method</xhtml:h4>
                        <xhtml:ol>
                           <xhtml:li>


Open                                                     <xhtml:strong>SQL Server Management Studio</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Right click the target instance and select                                                     <xhtml:strong>Properties</xhtml:strong>


 and navigate to the                                                     <xhtml:strong>Security</xhtml:strong>


 tab.                                              </xhtml:li>
                           <xhtml:li>


Select the option                                                     <xhtml:strong>Failed logins only</xhtml:strong>


 under the                                                     <xhtml:strong>Login Auditing</xhtml:strong>


 section and click                                                     <xhtml:strong>OK</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>Restart the SQL Server instance.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:h4>T-SQL Method</xhtml:h4>
                        <xhtml:ol>
                           <xhtml:li>


Run:
                                                    <xhtml:code class="code_block">EXEC xp_instance_regwrite N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'AuditLevel', REG_DWORD, 2
</xhtml:code>
                           </xhtml:li>
                           <xhtml:li>Restart the SQL Server instance.</xhtml:li>
                        </xhtml:ol>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>At a minimum, we want to ensure failed logins are captured in order to detect if an adversary is attempting to brute force passwords or otherwise attempting to access a SQL Server improperly.</xhtml:p>
                           <xhtml:p>Changing the setting requires a restart of the SQL Server service.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376027" value-id="xccdf_org.cisecurity.benchmarks_value_33760271_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376027"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>SQL Server Audit is capable of capturing both failed and successful logins and writing them to one of three places: the application event log, the security event log, or the file system. We will use it to capture any login attempt to SQL Server, as well as any attempts to change audit policy. This will also serve to be a second source to record failed login attempts.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Network</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Log and Alert on Unsuccessful Administrative Account Login" urn="urn:cisecurity.org:controls:7.0:4:9">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Users</controls:asset_type>
                           <controls:security_function>Detect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


By utilizing Audit instead of the traditional setting under the Security tab to capture successful logins, we reduce the noise in the                                   <xhtml:span class="inline_block">ERRORLOG</xhtml:span>


. This keeps it smaller and easier to read for DBAs who are attempting to troubleshoot issues with the SQL Server. Also, the Audit object can write to the security event log, though this requires operating system configuration. This gives an additional option for where to store login events, especially in conjunction with an SIEM.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/security/auditing/create-a-server-audit-and-server-audit-specification</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


For AWS RDS Instances, please refer to the documentation for configuring SQL Server Audit here:                                               <xhtml:a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.SQLServer.Options.Audit.html">SQL Server Audit</xhtml:a>
                        </xhtml:p>
                        <xhtml:p>Perform either the GUI or T-SQL method shown:</xhtml:p>
                        <xhtml:h4>GUI Method</xhtml:h4>
                        <xhtml:ol>
                           <xhtml:li>


Expand the                                                     <xhtml:strong>SQL Server</xhtml:strong>


 in                                                     <xhtml:strong>Object Explorer</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Expand the                                                     <xhtml:strong>Security Folder</xhtml:strong>
                           </xhtml:li>
                           <xhtml:li>


Right-click on the                                                     <xhtml:strong>Audits</xhtml:strong>


 folder and choose                                                     <xhtml:strong>New Audit...</xhtml:strong>
                           </xhtml:li>
                           <xhtml:li>


Specify a name for the                                                     <xhtml:strong>Server Audit</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Specify the audit destination details and then click                                                     <xhtml:strong>OK</xhtml:strong>


 to save the                                                     <xhtml:strong>Server Audit</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Right-click on                                                     <xhtml:strong>Server Audit Specifications</xhtml:strong>


 and choose                                                     <xhtml:strong>New Server Audit Specification...</xhtml:strong>
                           </xhtml:li>
                           <xhtml:li>


Name the                                                     <xhtml:strong>Server Audit Specification</xhtml:strong>
                           </xhtml:li>
                           <xhtml:li>


Select the just created                                                     <xhtml:strong>Server Audit</xhtml:strong>


 in the                                                     <xhtml:strong>Audit</xhtml:strong>


 drop-down selection.                                              </xhtml:li>
                           <xhtml:li>


Click the drop-down under                                                     <xhtml:strong>Audit Action Type</xhtml:strong>


 and select                                                     <xhtml:span class="inline_block">AUDIT_CHANGE_GROUP</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Click the new drop-down                                                     <xhtml:strong>Audit Action Type</xhtml:strong>


 and select                                                     <xhtml:span class="inline_block">FAILED_LOGIN_GROUP</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Click the new drop-down under                                                     <xhtml:strong>Audit Action Type</xhtml:strong>


 and select                                                     <xhtml:span class="inline_block">SUCCESSFUL_LOGIN_GROUP</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Click the new drop-down under                                                     <xhtml:strong>Audit Action Type</xhtml:strong>


 and select                                                     <xhtml:span class="inline_block">SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Click the new drop-down under                                                     <xhtml:strong>Audit Action Type</xhtml:strong>


 and select                                                     <xhtml:span class="inline_block">FAILED_DATABASE_AUTHENTICATION_GROUP</xhtml:span>


.                                              </xhtml:li>
                           <xhtml:li>


Click OK to save the                                                     <xhtml:strong>Server Audit Specification</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Right-click on the new                                                     <xhtml:strong>Server Audit Specification</xhtml:strong>


 and select                                                     <xhtml:strong>Enable Server Audit Specification</xhtml:strong>


.                                              </xhtml:li>
                           <xhtml:li>


Right-click on the new                                                     <xhtml:strong>Server Audit</xhtml:strong>


 and select                                                     <xhtml:strong>Enable Server Audit</xhtml:strong>


.                                              </xhtml:li>
                        </xhtml:ol>
                        <xhtml:h4>T-SQL Method</xhtml:h4>
                        <xhtml:p>Execute code similar to:</xhtml:p>
                        <xhtml:code class="code_block">


CREATE SERVER AUDIT TrackLogins                                              <br></br>


TO APPLICATION_LOG;                                              <br></br>


GO                                              <br></br>


CREATE SERVER AUDIT SPECIFICATION TrackAllLogins                                              <br></br>


FOR SERVER AUDIT TrackLogins                                              <br></br>


  ADD (FAILED_LOGIN_GROUP),                                              <br></br>


  ADD (SUCCESSFUL_LOGIN_GROUP),                                              <br></br>


  ADD (AUDIT_CHANGE_GROUP),                                              <br></br>


  ADD (SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP),                                              <br></br>


  ADD (FAILED_DATABASE_AUTHENTICATION_GROUP)                                              <br></br>


WITH (STATE = ON);                                              <br></br>


GO                                              <br></br>


ALTER SERVER AUDIT TrackLogins                                              <br></br>


WITH (STATE = ON);                                              <br></br>


GO
                                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:strong>Note:</xhtml:strong>


 If the write destination for the Audit object is to be the security event log, see the Books Online topic                                               <xhtml:a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/auditing/write-sql-server-audit-events-to-the-security-log">Write SQL Server Audit Events to the Security Log</xhtml:a>


 and follow the appropriate steps.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>With the previous recommendation, only failed logins are captured. If the Audit object is not implemented with the appropriate setting, SQL Server will not capture successful logins, which might prove of use for forensics.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3562573"></check-content-ref>
                  </check>
                  <xccdf:complex-check operator="AND">
                     <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                        <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                        <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3562574"></check-content-ref>
                     </check>
                     <xccdf:complex-check operator="AND">
                        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                           <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                           <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3562575"></check-content-ref>
                        </check>
                        <xccdf:complex-check operator="AND">
                           <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                              <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                              <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3589002"></check-content-ref>
                           </check>
                           <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                              <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                              <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3589003"></check-content-ref>
                           </check>
                        </xccdf:complex-check>
                     </xccdf:complex-check>
                  </xccdf:complex-check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_Application_Development">
            <xccdf:title xml:lang="en">Application Development</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section contains recommendations related to developing applications that interface with SQL Server.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_Database_and_Application_User_Input_is_Sanitized" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure Database and Application User Input is Sanitized</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Always validate user input received from a database client or application by testing type, length, format, and range prior to transmitting it to the database server.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Application DevelopmentProcess" urn="urn:cisecurity.org:controls:8.0:16:1">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Explicit Error Checking is Performed for All In-house Developed Software" urn="urn:cisecurity.org:controls:7.0:18:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type></controls:asset_type>
                           <controls:security_function></controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Sanitizing user input drastically minimizes risk of SQL injection.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://owasp.org/www-community/attacks/SQL_Injection</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>The following steps can be taken to remediate SQL injection vulnerabilities:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>Review TSQL and application code for SQL Injection</xhtml:li>
                           <xhtml:li>Only permit minimally privileged accounts to send user input to the server</xhtml:li>
                           <xhtml:li>Minimize the risk of SQL injection attack by using parameterized commands and stored procedures</xhtml:li>
                           <xhtml:li>Reject user input containing binary data, escape sequences, and comment characters</xhtml:li>
                           <xhtml:li>Always validate user input and do not use it directly to build SQL statements</xhtml:li>
                        </xhtml:ul>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Sanitize user input may require changes to application code or database object syntax. These changes can require applications or databases to be taken temporarily off-line. Any change to TSQL or application code should be thoroughly tested in testing environment before production implementation.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_CLR_Assembly_Permission_Set_is_set_to_SAFE_ACCESS_for_All_CLR_Assemblies" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Setting CLR Assembly Permission Sets to                                   <xhtml:span class="inline_block">SAFE_ACCESS</xhtml:span>


 will hinder assemblies from accessing external system resources such as files, the network, environment variables, or the registry.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Establish and Maintain a Secure Configuration Process" urn="urn:cisecurity.org:controls:8.0:4:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Applications</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
                  <notes:notes xml:lang="en">
                     <xhtml:p>


Per Microsoft documentation, "SQL Server contains CLR assemblies that the database engine uses to provide certain functionality. The                                         <xhtml:span class="inline_block">Microsoft.SQLServer.Types</xhtml:span>


 assembly that is included with SQL Server installation appears in the metadata as an                                         <xhtml:span class="inline_block">UNSAFE</xhtml:span>


 assembly. This is by design. These assemblies are considered trusted &amp;amp; secure by default."                                  </xhtml:p>
                  </notes:notes>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


Assemblies with                                   <xhtml:span class="inline_block">EXTERNAL_ACCESS</xhtml:span>


 or                                   <xhtml:span class="inline_block">UNSAFE</xhtml:span>


 permission sets can be used to access sensitive areas of the operating system, steal and/or transmit data and alter the state and other protection measures of the underlying Windows Operating System.                            </xhtml:p>
                  <xhtml:p>


Assemblies which are Microsoft-created (                                  <xhtml:span class="inline_block">is_user_defined = 0</xhtml:span>


) are excluded from this check as they are required for overall system functionality.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/clr-integration/security/clr-integration-code-access-security</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-assemblies-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/t-sql/statements/alter-assembly-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/relational-databases/clr-integration/security/clr-integration-code-access-security#recommended-permission-settings</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:code class="code_block">


USE &lt;database_name&gt;;                                              <br></br>


GO                                              <br></br>


ALTER ASSEMBLY &lt;assembly_name&gt; WITH PERMISSION_SET = SAFE;
                                        </xhtml:code>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>


The remediation measure should first be tested within a test environment prior to production to ensure the assembly still functions as designed with                                                     <xhtml:span class="inline_block">SAFE</xhtml:span>


 permission setting.                                              </xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3422336"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Encryption">
            <xccdf:title xml:lang="en">Encryption</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>These recommendations pertain to encryption-related aspects of SQL Server.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_Symmetric_Key_encryption_algorithm_is_set_to_AES_128_or_higher_in_non-system_databases" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure 'Symmetric Key encryption algorithm' is set to 'AES_128' or higher in non-system databases</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>


Per the Microsoft Best Practices, only the SQL Server AES algorithm options,                                   <xhtml:span class="inline_block">AES_128</xhtml:span>


,                                   <xhtml:span class="inline_block">AES_192</xhtml:span>


, and                                   <xhtml:span class="inline_block">AES_256</xhtml:span>


, should be used for a symmetric key encryption algorithm.                            </xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The following algorithms (as referred to by SQL Server) are considered weak or deprecated and should no longer be used in SQL Server:                                   <xhtml:span class="inline_block">DES</xhtml:span>


,                                   <xhtml:span class="inline_block">DESX</xhtml:span>


,                                   <xhtml:span class="inline_block">RC2</xhtml:span>


,                                   <xhtml:span class="inline_block">RC4</xhtml:span>


,                                   <xhtml:span class="inline_block">RC4_128</xhtml:span>


.                            </xhtml:p>
                  <xhtml:p>


Many organizations may accept the Triple DES algorithms (                                  <xhtml:span class="inline_block">TDEA</xhtml:span>


) which use keying options 1 (3 key aka                                   <xhtml:span class="inline_block">3TDEA</xhtml:span>


) or keying option 2 (2 key aka                                   <xhtml:span class="inline_block">2TDEA</xhtml:span>


). In SQL Server, these are referred to as                                   <xhtml:span class="inline_block">TRIPLE_DES_3KEY</xhtml:span>


 and                                   <xhtml:span class="inline_block">TRIPLE_DES</xhtml:span>


 respectively. Additionally, the SQL Server algorithm named DESX is actually the same implementation as the                                   <xhtml:span class="inline_block">TRIPLE_DES_3KEY</xhtml:span>


 option. However, using the DESX identifier as the algorithm type has been deprecated and its usage is now discouraged.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/t-sql/statements/alter-symmetric-key-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-US/sql/relational-databases/security/encryption/choose-an-encryption-algorithm</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Refer to Microsoft SQL Server Books Online ALTER SYMMETRIC KEY entry:                                               <xhtml:a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-symmetric-key-transact-sql">https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-symmetric-key-transact-sql</xhtml:a>
                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>Eliminates use of weak and deprecated algorithms which may put a system at higher risk of an attacker breaking the key.</xhtml:p>
                           <xhtml:p>Encrypted data cannot be compressed, but compressed data can be encrypted. If you use compression, you should compress data before encrypting it.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376037"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_Asymmetric_Key_Size_is_set_to_greater_than_or_equal_to_2048_in_non-system_databases" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Asymmetric Key Size is set to 'greater than or equal to 2048' in non-system databases</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Microsoft Best Practices recommend to use at least a 2048-bit encryption algorithm for asymmetric keys.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>


The                                   <xhtml:span class="inline_block">RSA_2048</xhtml:span>


 encryption algorithm for asymmetric keys in SQL Server is the highest bit-level provided and therefore the most secure available choice (other choices are                                   <xhtml:span class="inline_block">RSA_512</xhtml:span>


 and                                   <xhtml:span class="inline_block">RSA_1024</xhtml:span>


).                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/t-sql/statements/alter-symmetric-key-transact-sql</xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-US/sql/relational-databases/security/encryption/choose-an-encryption-algorithm</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


Refer to Microsoft SQL Server Books Online ALTER ASYMMETRIC KEY entry:                                               <xhtml:a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-asymmetric-key-transact-sql">https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-asymmetric-key-transact-sql</xhtml:a>
                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>The higher-bit level may result in slower performance, but reduces the likelihood of an attacker breaking the key.</xhtml:p>
                           <xhtml:p>Encrypted data cannot be compressed, but compressed data can be encrypted. If you use compression, you should compress data before encrypting it.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarks:def:3376039"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_Database_Backups_are_Encrypted" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">Ensure Database Backups are Encrypted</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>Ensure Database Backups are Encrypted</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Protect Recovery Data" urn="urn:cisecurity.org:controls:8.0:11:3">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                           <controls:implementation_groups ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Data</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>Databases may contain sensitive.  Backups of this data allow the data to easily leave the Enterprise and secure environments. Encrypting the backup makes accessing the data much more difficult.</xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/11/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>


SQL Server backups need to 'Back up to a new media set', not 'Back up to the existing media set' in order to allow for encryption.  The backup option to                                               <xhtml:span class="inline_block">Encrypt Backup</xhtml:span>


 can be implemented after a Certificate or Asymmetric key has been applied to the SQL Server for this purpose.                                        </xhtml:p>
                        <xhtml:p class="bold">Impact:</xhtml:p>
                        <xhtml:p>
                           <xhtml:p>A database backup accidentally exposed to the Internet or transmitted outside a secure environment can be easily restored to a SQL Server anywhere and its contents discovered.</xhtml:p>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3619299" value-id="xccdf_org.cisecurity.benchmarks_value_36192991_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3619299"></check-content-ref>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3619300" value-id="xccdf_org.cisecurity.benchmarks_value_36193001_var"></check-export>
                     <check-export export-name="oval:org.cisecurity.benchmarks:var:2000000" value-id="xccdf_org.cisecurity_value_jdbc.url"></check-export>
                     <check-content-ref href="scap_org.cisecurity_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-OVAL" name="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3619300"></check-content-ref>
                  </check>
               </xccdf:complex-check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8_Appendix_Additional_Considerations">
            <xccdf:title xml:lang="en">Appendix: Additional Considerations</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This appendix discusses possible configuration options for which no recommendation is being given.</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.1_Ensure_SQL_Server_Browser_Service_is_configured_correctly" role="unscored" selected="false" weight="0.0">
               <xccdf:title xml:lang="en">Ensure 'SQL Server Browser Service' is configured correctly</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>No recommendation is being given on disabling the SQL Server Browser service.</xhtml:p>
               </xccdf:description>
               <xccdf:metadata>
                  <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
                     <controls:framework urn="urn:cisecurity.org:controls:8.0">
                        <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                        <controls:safeguard title="Implement and Manage a Firewall on End-User Devices" urn="urn:cisecurity.org:controls:8.0:4:5">
                           <controls:implementation_groups ig1="true" ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                     <controls:framework urn="urn:cisecurity.org:controls:7.0">
                        <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                           <controls:implementation_groups ig2="true" ig3="true"></controls:implementation_groups>
                           <controls:asset_type>Devices</controls:asset_type>
                           <controls:security_function>Protect</controls:security_function>
                        </controls:safeguard>
                     </controls:framework>
                  </controls:cis_controls>
               </xccdf:metadata>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>In the case of a default instance installation, the SQL Server Browser service is disabled by default. Unless there is a named instance on the same server, there is typically no reason for the SQL Server Browser service to be running. In this case it is strongly suggested that the SQL Server Browser service remain disabled.</xhtml:p>
                  <xhtml:p>When it comes to named instances, given that a security scan can fingerprint a SQL Server listening on any port, it's therefore of limited benefit to disable the SQL Server Browser service.</xhtml:p>
                  <xhtml:p>However, if all connections against the named instance are via applications and are not visible to end users, then configuring the named instance to listening on a static port, disabling the SQL Server Browser service, and configuring the apps to connect to the specified port should be the direction taken. This follows the general practice of reducing the surface area, especially for an unneeded feature.</xhtml:p>
                  <xhtml:p>


On the other hand, if end users are directly connecting to databases on the instance, then typically having them use                                   <xhtml:em>
                        <xhtml:span class="inline_block">ServerName\InstanceName</xhtml:span>
                     </xhtml:em>


 is best. This requires the SQL Server Browser service to be running. Disabling the SQL Server Browser service would mean the end users would have to remember port numbers for the instances. When they don't that will generate service calls to IT staff. Given the limited benefit of disabling the service, the trade-off is probably not worth it, meaning it makes more business sense to leave the SQL Server Browser service enabled.                            </xhtml:p>
               </xccdf:rationale>
               <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"></xccdf:ident>
               <xccdf:ident system="URL">https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas</xccdf:ident>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Enable or disable the service as needed for your environment.</xhtml:p>
                     </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
            </xccdf:Rule>
         </xccdf:Group>
      </xccdf:Benchmark>
   </ds:component>
   <ds:component id="scap_org.cisecurity_comp_1.0.0_CIS_Microsoft_SQL_Server_2022_Benchmark-oval" timestamp="2025-04-23T16:10:58">
      <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://oval.cisecurity.org/schemas/validator-oval-definitions-5.11.2.xsd">
         <generator>
            <oval:product_name>Center for Internet Security - Optimus</oval:product_name>
            <oval:schema_version>5.11.2</oval:schema_version>
            <oval:timestamp>2025-04-23T16:10:55.973Z</oval:timestamp>
         </generator>
         <definitions>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422324" version="1">
               <metadata>
                  <title>Ensure 'Ad Hoc Distributed Queries' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Ad_Hoc_Distributed_Queries_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_Ad_Hoc_Distributed_Queries_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Ad Hoc Distributed Queries' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422324"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422325" version="1">
               <metadata>
                  <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422325"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422326" version="1">
               <metadata>
                  <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422326"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422327" version="1">
               <metadata>
                  <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422327"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422328" version="1">
               <metadata>
                  <title>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_CLR_Enabled_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'CLR Enabled' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422328"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422329" version="1">
               <metadata>
                  <title>Ensure 'Cross DB Ownership Chaining' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_Cross_DB_Ownership_Chaining_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_Cross_DB_Ownership_Chaining_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Cross DB Ownership Chaining' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422329"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376012" version="1">
               <metadata>
                  <title>Ensure 'Database Mail XPs' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_Database_Mail_XPs_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_Database_Mail_XPs_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Database Mail XPs' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376012"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376014" version="1">
               <metadata>
                  <title>Ensure 'Ole Automation Procedures' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_Ole_Automation_Procedures_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_Ole_Automation_Procedures_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Ole Automation Procedures' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376014"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422330" version="1">
               <metadata>
                  <title>Ensure 'Remote Access' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Remote Access' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422330"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422331" version="1">
               <metadata>
                  <title>Ensure 'Remote Access' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_Remote_Access_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Remote Access' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422331"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3602350" version="1">
               <metadata>
                  <title>Ensure 'Remote Admin Connections' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_Remote_Admin_Connections_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_Remote_Admin_Connections_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Remote Admin Connections' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3602350"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376022" version="1">
               <metadata>
                  <title>Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376022"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376024" version="1">
               <metadata>
                  <title>Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.8_Ensure_Scan_For_Startup_Procs_Server_Configuration_Option_is_set_to_0"></reference>
                  <description>Ensure 'Scan For Startup Procs' Server Configuration Option is set to '0'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376024"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376026" version="1">
               <metadata>
                  <title>Ensure 'Trustworthy' Database Property is set to 'Off'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Trustworthy_Database_Property_is_set_to_Off" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.9_Ensure_Trustworthy_Database_Property_is_set_to_Off"></reference>
                  <description>Ensure 'Trustworthy' Database Property is set to 'Off'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376026"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3422332" version="1">
               <metadata>
                  <title>Ensure 'Hide Instance' option is set to 'Yes' for Production SQL Server instances</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.12_Ensure_Hide_Instance_option_is_set_to_Yes_for_Production_SQL_Server_instances" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.12_Ensure_Hide_Instance_option_is_set_to_Yes_for_Production_SQL_Server_instances"></reference>
                  <description>Ensure 'Hide Instance' option is set to 'Yes' for Production SQL Server instances</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422332"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376035" version="1">
               <metadata>
                  <title>Ensure the 'sa' Login Account is set to 'Disabled'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_the_sa_Login_Account_is_set_to_Disabled" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_the_sa_Login_Account_is_set_to_Disabled"></reference>
                  <description>Ensure the 'sa' Login Account is set to 'Disabled'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376035"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376036" version="1">
               <metadata>
                  <title>Ensure the 'sa' Login Account has been renamed</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed"></reference>
                  <description>Ensure the 'sa' Login Account has been renamed</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376036"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376038" version="1">
               <metadata>
                  <title>Ensure the 'sa' Login Account has been renamed</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.14_Ensure_the_sa_Login_Account_has_been_renamed"></reference>
                  <description>Ensure the 'sa' Login Account has been renamed</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376038"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376040" version="1">
               <metadata>
                  <title>Ensure 'AUTO_CLOSE' is set to 'OFF' on contained databases</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.15_Ensure_AUTO_CLOSE_is_set_to_OFF_on_contained_databases" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.15_Ensure_AUTO_CLOSE_is_set_to_OFF_on_contained_databases"></reference>
                  <description>Ensure 'AUTO_CLOSE' is set to 'OFF' on contained databases</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376040"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3562569" version="1">
               <metadata>
                  <title>Ensure no login exists with the name 'sa'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.16_Ensure_no_login_exists_with_the_name_sa" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.16_Ensure_no_login_exists_with_the_name_sa"></reference>
                  <description>Ensure no login exists with the name 'sa'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3562569"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376042" version="1">
               <metadata>
                  <title>Ensure 'clr strict security' Server Configuration Option is set to '1'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1"></reference>
                  <description>Ensure 'clr strict security' Server Configuration Option is set to '1'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376042"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376043" version="1">
               <metadata>
                  <title>Ensure 'clr strict security' Server Configuration Option is set to '1'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_2.17_Ensure_clr_strict_security_Server_Configuration_Option_is_set_to_1"></reference>
                  <description>Ensure 'clr strict security' Server Configuration Option is set to '1'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376043"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376000" version="1">
               <metadata>
                  <title>Ensure 'Server Authentication' Property is set to 'Windows Authentication Mode'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Server_Authentication_Property_is_set_to_Windows_Authentication_Mode" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_Server_Authentication_Property_is_set_to_Windows_Authentication_Mode"></reference>
                  <description>Ensure 'Server Authentication' Property is set to 'Windows Authentication Mode'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376000"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376009" version="1">
               <metadata>
                  <title>Ensure only the default permissions specified by Microsoft are granted to the public server role</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_only_the_default_permissions_specified_by_Microsoft_are_granted_to_the_public_server_role" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.8_Ensure_only_the_default_permissions_specified_by_Microsoft_are_granted_to_the_public_server_role"></reference>
                  <description>Ensure only the default permissions specified by Microsoft are granted to the public server role</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376009"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3422334" version="1">
               <metadata>
                  <title>Ensure Windows BUILTIN groups are not SQL Logins</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_Windows_BUILTIN_groups_are_not_SQL_Logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.9_Ensure_Windows_BUILTIN_groups_are_not_SQL_Logins"></reference>
                  <description>Ensure Windows BUILTIN groups are not SQL Logins</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3422334"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3614776" version="1">
               <metadata>
                  <title>Ensure Windows local groups are not SQL Logins</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_Windows_local_groups_are_not_SQL_Logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.10_Ensure_Windows_local_groups_are_not_SQL_Logins"></reference>
                  <description>Ensure Windows local groups are not SQL Logins</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3614776"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376015" version="1">
               <metadata>
                  <title>Ensure the public role in the msdb database is not granted access to SQL Agent proxies</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_the_public_role_in_the_msdb_database_is_not_granted_access_to_SQL_Agent_proxies" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.11_Ensure_the_public_role_in_the_msdb_database_is_not_granted_access_to_SQL_Agent_proxies"></reference>
                  <description>Ensure the public role in the msdb database is not granted access to SQL Agent proxies</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376015"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3422335" version="1">
               <metadata>
                  <title>Ensure 'CHECK_EXPIRATION' Option is set to 'ON' for All SQL Authenticated Logins Within the Sysadmin Role</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_CHECK_EXPIRATION_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins_Within_the_Sysadmin_Role" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.2_Ensure_CHECK_EXPIRATION_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins_Within_the_Sysadmin_Role"></reference>
                  <description>Ensure 'CHECK_EXPIRATION' Option is set to 'ON' for All SQL Authenticated Logins Within the Sysadmin Role</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3422335"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376019" version="1">
               <metadata>
                  <title>Ensure 'CHECK_POLICY' Option is set to 'ON' for All SQL Authenticated Logins</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_CHECK_POLICY_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_4.3_Ensure_CHECK_POLICY_Option_is_set_to_ON_for_All_SQL_Authenticated_Logins"></reference>
                  <description>Ensure 'CHECK_POLICY' Option is set to 'ON' for All SQL Authenticated Logins</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376019"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376021" version="1">
               <metadata>
                  <title>Ensure 'Maximum number of error log files' is set to greater than or equal to '12'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Maximum_number_of_error_log_files_is_set_to_greater_than_or_equal_to_12" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.1_Ensure_Maximum_number_of_error_log_files_is_set_to_greater_than_or_equal_to_12"></reference>
                  <description>Ensure 'Maximum number of error log files' is set to greater than or equal to '12'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376021"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376023" version="1">
               <metadata>
                  <title>Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1"></reference>
                  <description>Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376023"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376025" version="1">
               <metadata>
                  <title>Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_Default_Trace_Enabled_Server_Configuration_Option_is_set_to_1"></reference>
                  <description>Ensure 'Default Trace Enabled' Server Configuration Option is set to '1'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376025"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3376027" version="1">
               <metadata>
                  <title>Ensure 'Login Auditing' is set to 'failed logins'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Login_Auditing_is_set_to_failed_logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_Login_Auditing_is_set_to_failed_logins"></reference>
                  <description>Ensure 'Login Auditing' is set to 'failed logins'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376027"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3562573" version="1">
               <metadata>
                  <title>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins"></reference>
                  <description>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3562573"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3562574" version="1">
               <metadata>
                  <title>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins"></reference>
                  <description>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3562574"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3562575" version="1">
               <metadata>
                  <title>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins"></reference>
                  <description>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3562575"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3589002" version="1">
               <metadata>
                  <title>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins"></reference>
                  <description>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3589002"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3589003" version="1">
               <metadata>
                  <title>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_SQL_Server_Audit_is_set_to_capture_both_failed_and_successful_logins"></reference>
                  <description>Ensure 'SQL Server Audit' is set to capture both 'failed' and 'successful logins'</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3589003"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3619299" version="1">
               <metadata>
                  <title>Ensure Database Backups are Encrypted</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_Database_Backups_are_Encrypted" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_Database_Backups_are_Encrypted"></reference>
                  <description>Ensure Database Backups are Encrypted</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3619299"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:def:3619300" version="1">
               <metadata>
                  <title>Ensure Database Backups are Encrypted</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_Database_Backups_are_Encrypted" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_7.3_Ensure_Database_Backups_are_Encrypted"></reference>
                  <description>Ensure Database Backups are Encrypted</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3619300"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3422333" version="1">
               <metadata>
                  <title>Ensure CONNECT permissions on the 'guest' user is Revoked within all SQL Server databases</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_CONNECT_permissions_on_the_guest_user_is_Revoked_within_all_SQL_Server_databases" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_CONNECT_permissions_on_the_guest_user_is_Revoked_within_all_SQL_Server_databases"></reference>
                  <description>Ensure CONNECT permissions on the 'guest' user is Revoked within all SQL Server databases</description>
               </metadata>
               <criteria negate="false" operator="OR">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:2000000"></criterion>
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3422333"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376004" version="1">
               <metadata>
                  <title>Ensure 'Orphaned Users' are Dropped From SQL Server Databases</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_Orphaned_Users_are_Dropped_From_SQL_Server_Databases" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_Orphaned_Users_are_Dropped_From_SQL_Server_Databases"></reference>
                  <description>Ensure 'Orphaned Users' are Dropped From SQL Server Databases</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376004"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376007" version="1">
               <metadata>
                  <title>Ensure SQL Authentication is not used in contained databases</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_SQL_Authentication_is_not_used_in_contained_databases" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_SQL_Authentication_is_not_used_in_contained_databases"></reference>
                  <description>Ensure SQL Authentication is not used in contained databases</description>
               </metadata>
               <criteria negate="false" operator="OR">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:2000000"></criterion>
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376007"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3422336" version="1">
               <metadata>
                  <title>Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_CLR_Assembly_Permission_Set_is_set_to_SAFE_ACCESS_for_All_CLR_Assemblies" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_CLR_Assembly_Permission_Set_is_set_to_SAFE_ACCESS_for_All_CLR_Assemblies"></reference>
                  <description>Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies</description>
               </metadata>
               <criteria negate="false" operator="AND">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3422336"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376037" version="1">
               <metadata>
                  <title>Ensure 'Symmetric Key encryption algorithm' is set to 'AES_128' or higher in non-system databases</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_Symmetric_Key_encryption_algorithm_is_set_to_AES_128_or_higher_in_non-system_databases" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_7.1_Ensure_Symmetric_Key_encryption_algorithm_is_set_to_AES_128_or_higher_in_non-system_databases"></reference>
                  <description>Ensure 'Symmetric Key encryption algorithm' is set to 'AES_128' or higher in non-system databases</description>
               </metadata>
               <criteria negate="false" operator="OR">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:2000000"></criterion>
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376037"></criterion>
               </criteria>
            </definition>
            <definition class="compliance" id="oval:org.cisecurity.benchmarks:def:3376039" version="1">
               <metadata>
                  <title>Ensure Asymmetric Key Size is set to 'greater than or equal to 2048' in non-system databases</title>
                  <reference ref_id="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_Asymmetric_Key_Size_is_set_to_greater_than_or_equal_to_2048_in_non-system_databases" ref_url="http://benchmarks.cisecurity.org" source="xccdf_org.cisecurity.benchmarks_rule_7.2_Ensure_Asymmetric_Key_Size_is_set_to_greater_than_or_equal_to_2048_in_non-system_databases"></reference>
                  <description>Ensure Asymmetric Key Size is set to 'greater than or equal to 2048' in non-system databases</description>
               </metadata>
               <criteria negate="false" operator="OR">
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:2000000"></criterion>
                  <criterion test_ref="oval:org.cisecurity.benchmarks:tst:3376039"></criterion>
               </criteria>
            </definition>
         </definitions>
         <tests>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Ad Hoc Distributed Queries' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422324" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422324"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422324"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure value configured for 'CLR Enabled' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422325" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422325"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422325"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure value in use for 'CLR Enabled' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422326" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422326"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422326"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure value configured for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422327" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422327"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422327"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure value in use for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422328" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422328"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422328"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Cross DB Ownership Chaining' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422329" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422329"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422329"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Database Mail XPs' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376012" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376012"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376012"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Ole Automation Procedures' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376014" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376014"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376014"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'remote access' in use is set to 0" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422330" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422330"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422330"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'remote access' is configured to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422331" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422331"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422331"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Remote Admin Connections' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3602350" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3602350"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3602350"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Scan For Startup Procs' in use is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376022" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376022"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376022"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Scan For Startup Procs' is configured to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376024" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376024"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376024"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure 'Trustworthy' is set to 'Off'" id="oval:org.cisecurity.benchmarks:tst:3376026" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376026"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure Hide Instance option is 1" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3422332" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422332"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422332"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'is_disabled' for the 'sa' account is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376035" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376035"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376035"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="only_one_exists" comment="Ensure sid 0x01 is not named sa" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376036" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376036"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376036"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="only_one_exists" comment="Ensure sid 0x01 is not named 'rdsa'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376038" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376038"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376038"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure auto_close is off for contained databases" id="oval:org.cisecurity.benchmarks:tst:3376040" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376040"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure no login exists with the name sa" id="oval:org.cisecurity.benchmarks:tst:3562569" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3562569"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure value configured for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376042" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376042"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376042"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure value in use for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376043" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376043"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376043"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'IsIntegratedSecurityOnly' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376000" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376000"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376000"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure no extra permissions granted to public" id="oval:org.cisecurity.benchmarks:tst:3376009" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376009"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure no Builtin groups are logins" id="oval:org.cisecurity.benchmarks:tst:3422334" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3422334"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure Windows local groups are not SQL Logins" id="oval:org.cisecurity.benchmarks:tst:3614776" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3614776"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure the public role in the msdb database is not granted access to SQL Agent proxies" id="oval:org.cisecurity.benchmarks:tst:3376015" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376015"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure Check_Expiration is ON for High Privilege Logins" id="oval:org.cisecurity.benchmarks:tst:3422335" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3422335"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure Check_Policy is ON for all SQL Authenticated Logins" id="oval:org.cisecurity.benchmarks:tst:3376019" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376019"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure number of error logs is greater than or equal to 12" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376021" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376021"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376021"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'Default Trace Enabled' is configured to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376023" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376023"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376023"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure the 'Default Trace Enabled' value in use '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376025" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376025"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376025"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure audit level is failure or all" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3376027" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376027"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376027"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure Audit_Change_Group is part of an audit" id="oval:org.cisecurity.benchmarks:tst:3562573" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3562573"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure Failed_Login_Group is part of an audit" id="oval:org.cisecurity.benchmarks:tst:3562574" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3562574"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure Successful_Login_Group is part of an audit" id="oval:org.cisecurity.benchmarks:tst:3562575" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3562575"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure Successful_Database_Authentication_Group is part of an audit" id="oval:org.cisecurity.benchmarks:tst:3589002" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3589002"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure Failed_Database_Authentication_Group is part of an audit" id="oval:org.cisecurity.benchmarks:tst:3589003" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3589003"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'key_algorithm' is not null" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3619299" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3619299"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3619299"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure 'encryptor_type' is not null" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:tst:3619300" version="1">
               <object object_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3619300"></object>
               <state state_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3619300"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure user databases don't exist" id="oval:org.cisecurity.benchmarks:tst:2000000" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:2000001"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure guest user does not have Connect permission in user databases" id="oval:org.cisecurity.benchmarks:tst:3422333" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3422333"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="at_least_one_exists" comment="Ensure no database users are orphaned" id="oval:org.cisecurity.benchmarks:tst:3376004" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376004"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:3376004"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure SQL Authentication is not used in contained databases" id="oval:org.cisecurity.benchmarks:tst:3376007" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376007"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="any_exist" comment="Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies" id="oval:org.cisecurity.benchmarks:tst:3422336" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3422336"></object>
               <state state_ref="oval:org.cisecurity.benchmarks:ste:3422336"></state>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure Symmetric Key encryption algorithm is set to AES_128 or higher in non-system databases" id="oval:org.cisecurity.benchmarks:tst:3376037" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376037"></object>
            </sql57_test>
            <sql57_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="none_exist" comment="Ensure Asymmetric Key Size is set to greater than or equal to 2048 in non-system databases" id="oval:org.cisecurity.benchmarks:tst:3376039" version="1">
               <object object_ref="oval:org.cisecurity.benchmarks:obj:3376039"></object>
            </sql57_test>
         </tests>
         <objects>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Ad Hoc Distributed Queries' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422324" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'Ad Hoc Distributed Queries';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value configured for 'CLR Enabled' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422325" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured FROM sys.configurations WHERE name = 'clr enabled';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value in use for 'CLR Enabled' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422326" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'clr enabled';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value configured for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422327" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured FROM sys.configurations WHERE name = 'clr strict security';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value in use for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422328" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'clr strict security';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Cross DB Ownership Chaining' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422329" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'cross db ownership chaining';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Database Mail XPs' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376012" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'Database Mail XPs';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Ole Automation Procedures' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376014" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'Ole Automation Procedures';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'remote access' in use is set to 0" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422330" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'remote access';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'remote access' is configured to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422331" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured FROM sys.configurations WHERE name = 'remote access';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Remote Admin Connections' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3602350" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'remote admin connections' AND SERVERPROPERTY('IsClustered') = 0;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Scan For Startup Procs' in use is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376022" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'scan for startup procs';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Scan For Startup Procs' is configured to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376024" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured FROM sys.configurations WHERE name = 'scan for startup procs';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Trustworthy' is set to 'Off'" id="oval:org.cisecurity.benchmarks:obj:3376026" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT name FROM sys.databases WHERE is_trustworthy_on = 1 AND name != 'msdb';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Hide Instance option is 1" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3422332" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>BEGIN EXEC master.sys.xp_instance_regread @rootkey = N'HKEY_LOCAL_MACHINE', @key = N'SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib', @value_name = N'HideInstance' END</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'is_disabled' for the 'sa' account is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376035" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT name, is_disabled   FROM sys.server_principals WHERE sid = 0x01;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure sid 0x01 is not named sa" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376036" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT name FROM sys.server_principals WHERE sid = 0x01;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure sid 0x01 is not named 'rdsa'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376038" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT name  FROM sys.server_principals WHERE sid = 0x01;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure auto_close is off for contained databases" id="oval:org.cisecurity.benchmarks:obj:3376040" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.databases WHERE containment &lt;&gt; 0 and is_auto_close_on = 1;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure no login exists with the name sa" id="oval:org.cisecurity.benchmarks:obj:3562569" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_principals WHERE name = 'sa';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value configured for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376042" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'clr strict security';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value in use for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376043" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'clr strict security';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'IsIntegratedSecurityOnly' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376000" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT SERVERPROPERTY('IsIntegratedSecurityOnly') as "login_mode";</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure no extra permissions granted to public" id="oval:org.cisecurity.benchmarks:obj:3376009" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM master.sys.server_permissions WHERE (grantee_principal_id = SUSER_SID(N'public') and state_desc LIKE 'GRANT%') AND NOT (state_desc = 'GRANT' and [permission_name] = 'VIEW ANY DATABASE' and class_desc = 'SERVER') AND NOT (state_desc = 'GRANT' and [permission_name] = 'CONNECT' and class_desc = 'ENDPOINT' and major_id = 2) AND NOT (state_desc = 'GRANT' and [permission_name] = 'CONNECT' and class_desc = 'ENDPOINT' and major_id = 3) AND NOT (state_desc = 'GRANT' and [permission_name] = 'CONNECT' and class_desc = 'ENDPOINT' and major_id = 4) AND NOT (state_desc = 'GRANT' and [permission_name] = 'CONNECT' and class_desc = 'ENDPOINT' and major_id = 5);</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure no Builtin groups are logins" id="oval:org.cisecurity.benchmarks:obj:3422334" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_principals pr JOIN sys.server_permissions pe ON pr.principal_id = pe.grantee_principal_id WHERE pr.name like 'BUILTIN%';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Windows local groups are not SQL Logins" id="oval:org.cisecurity.benchmarks:obj:3614776" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_principals pr JOIN sys.server_permissions pe ON pr.[principal_id] = pe.[grantee_principal_id] WHERE pr.[type_desc] = 'WINDOWS_GROUP' AND pr.[name] like CAST(SERVERPROPERTY('MachineName') AS nvarchar) + '%';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure the public role in the msdb database is not granted access to SQL Agent proxies" id="oval:org.cisecurity.benchmarks:obj:3376015" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM msdb.dbo.sysproxylogin spl JOIN msdb.sys.database_principals dp ON dp.sid = spl.sid JOIN msdb.dbo.sysproxies sp ON sp.proxy_id = spl.proxy_id WHERE principal_id = USER_ID('public');</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Check_Expiration is ON for High Privilege Logins" id="oval:org.cisecurity.benchmarks:obj:3422335" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.sql_logins AS l WHERE IS_SRVROLEMEMBER('sysadmin',name) = 1 AND l.is_expiration_checked &lt;&gt; 1 UNION ALL SELECT 1 FROM sys.sql_logins AS l JOIN sys.server_permissions AS p ON l.principal_id = p.grantee_principal_id WHERE p.type = 'CL' AND p.state IN ('G', 'W') AND l.is_expiration_checked &lt;&gt; 1;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Check_Policy is ON for all SQL Authenticated Logins" id="oval:org.cisecurity.benchmarks:obj:3376019" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.sql_logins WHERE is_policy_checked = 0;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure number of error logs is greater than or equal to 12" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376021" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>BEGIN DECLARE @NumErrorLogs int; EXEC master.sys.xp_instance_regread N'HKEY_LOCAL_MACHINE',N'Software\Microsoft\MSSQLServer\MSSQLServer',N'NumErrorLogs',@NumErrorLogs OUTPUT; SELECT ISNULL(@NumErrorLogs, -1) AS [numberoflogfiles]; END</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Default Trace Enabled' is configured to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376023" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value as int) as value_configured FROM sys.configurations WHERE name = 'default trace enabled';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure the 'Default Trace Enabled' value in use '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376025" version="1">
               <engine>sqlserver</engine>
               <version>2019</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'default trace enabled';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure audit level is failure or all" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3376027" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>BEGIN exec xp_loginconfig 'audit level'; END</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Audit_Change_Group is part of an audit" id="oval:org.cisecurity.benchmarks:obj:3562573" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_audit_specification_details AS SAD JOIN sys.server_audit_specifications AS SA ON SAD.server_specification_id = SA.server_specification_id JOIN sys.server_audits AS S ON SA.audit_guid = S.audit_guid WHERE SAD.audit_action_id = 'CNAU' AND S.is_state_enabled = 1 AND SA.is_state_enabled = 1 AND SAD.audited_result = 'SUCCESS AND FAILURE';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Failed_Login_Group is part of an audit" id="oval:org.cisecurity.benchmarks:obj:3562574" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_audit_specification_details AS SAD JOIN sys.server_audit_specifications AS SA ON SAD.server_specification_id = SA.server_specification_id JOIN sys.server_audits AS S ON SA.audit_guid = S.audit_guid WHERE SAD.audit_action_id = 'LGFL' AND S.is_state_enabled = 1 AND SA.is_state_enabled = 1 AND SAD.audited_result = 'SUCCESS AND FAILURE';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Successful_Login_Group is part of an audit" id="oval:org.cisecurity.benchmarks:obj:3562575" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_audit_specification_details AS SAD JOIN sys.server_audit_specifications AS SA ON SAD.server_specification_id = SA.server_specification_id JOIN sys.server_audits AS S ON SA.audit_guid = S.audit_guid WHERE SAD.audit_action_id = 'LGSD' AND S.is_state_enabled = 1 AND SA.is_state_enabled = 1 AND SAD.audited_result = 'SUCCESS AND FAILURE';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Successful_Database_Authentication_Group is part of an audit" id="oval:org.cisecurity.benchmarks:obj:3589002" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_audit_specification_details AS SAD JOIN sys.server_audit_specifications AS SA ON SAD.server_specification_id = SA.server_specification_id JOIN sys.server_audits AS S ON SA.audit_guid = S.audit_guid WHERE SAD.audit_action_id = 'DAGS' AND S.is_state_enabled = 1 AND SA.is_state_enabled = 1 AND SAD.audited_result = 'SUCCESS AND FAILURE';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Failed_Database_Authentication_Group is part of an audit" id="oval:org.cisecurity.benchmarks:obj:3589003" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT 1 FROM sys.server_audit_specification_details AS SAD JOIN sys.server_audit_specifications AS SA ON SAD.server_specification_id = SA.server_specification_id JOIN sys.server_audits AS S ON SA.audit_guid = S.audit_guid WHERE SAD.audit_action_id = 'DAGF' AND S.is_state_enabled = 1 AND SA.is_state_enabled = 1 AND SAD.audited_result = 'SUCCESS AND FAILURE';</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'key_algorithm' is not null" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3619299" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT key_algorithm, database_name, server_name FROM msdb.dbo.backupset;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'encryptor_type' is not null" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:obj:3619300" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT encryptor_type, database_name, server_name FROM msdb.dbo.backupset;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:org.cisecurity.benchmarks:obj:2000001" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT name from sys.databases where database_id &gt; 4 ORDER BY name;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:org.cisecurity.benchmarks:obj:2000002" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql>SELECT name from sys.databases ORDER BY name;</sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure guest user does not have Connect permission in user databases" id="oval:org.cisecurity.benchmarks:obj:3422333" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql var_ref="oval:org.cisecurity.benchmarks:var:3422333"></sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure no database users are orphaned" id="oval:org.cisecurity.benchmarks:obj:3376004" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql var_ref="oval:org.cisecurity.benchmarks:var:3376004"></sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure SQL Authentication is not used in contained databases" id="oval:org.cisecurity.benchmarks:obj:3376007" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql var_ref="oval:org.cisecurity.benchmarks:var:3376007"></sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies" id="oval:org.cisecurity.benchmarks:obj:3422336" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql var_ref="oval:org.cisecurity.benchmarks:var:3422336"></sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Symmetric Key encryption algorithm is set to AES_128 or higher in non-system databases" id="oval:org.cisecurity.benchmarks:obj:3376037" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql var_ref="oval:org.cisecurity.benchmarks:var:3376037"></sql>
            </sql57_object>
            <sql57_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Asymmetric Key Size is set to greater than or equal to 2048 in non-system databases" id="oval:org.cisecurity.benchmarks:obj:3376039" version="1">
               <engine>sqlserver</engine>
               <version>2022</version>
               <connection_string var_ref="oval:org.cisecurity.benchmarks:var:2000000"></connection_string>
               <sql var_ref="oval:org.cisecurity.benchmarks:var:3376039"></sql>
            </sql57_object>
         </objects>
         <states>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Ad Hoc Distributed Queries' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422324" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422324"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value configured for 'CLR Enabled' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422325" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422325"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value in use for 'CLR Enabled' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422326" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_in_use" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422326"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value configured for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422327" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422327"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value in use for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422328" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_in_use" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422328"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Cross DB Ownership Chaining' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422329" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422329"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Database Mail XPs' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376012" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376012"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Ole Automation Procedures' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376014" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376014"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'remote access' in use is set to 0" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422330" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_in_use" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422330"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'remote access' is configured to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422331" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422331"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Remote Admin Connections' is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3602350" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3602350"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Scan For Startup Procs' in use is set to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376022" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_in_use" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376022"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Scan For Startup Procs' is configured to '0'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376024" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376024"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure Hide Instance option is 1" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3422332" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="data" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422332"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'is_disabled' for the 'sa' account is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376035" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="is_disabled" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376035"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure sid 0x01 is not named sa" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376036" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="string" name="name" operation="not equal" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376036"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure sid 0x01 is not named 'rdsa'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376038" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="string" name="name" operation="not equal" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376038"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value configured for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376042" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376042"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure value in use for 'clr strict security' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376043" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_in_use" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376043"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'IsIntegratedSecurityOnly' is set to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376000" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="login_mode" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376000"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure number of error logs is greater than or equal to 12" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376021" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="numberoflogfiles" operation="greater than or equal" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376021"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'Default Trace Enabled' is configured to '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376023" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_configured" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376023"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure the 'Default Trace Enabled' value in use '1'" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376025" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="value_in_use" operation="equals" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376025"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure audit level is failure or all" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3376027" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="string" name="config_value" operation="pattern match" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376027"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'key_algorithm' is not null" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3619299" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="string" name="key_algorithm" operation="pattern match" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3619299"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'encryptor_type' is not null" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:ste:3619300" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="string" name="encryptor_type" operation="pattern match" var_ref="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3619300"></field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure no database users are orphaned" id="oval:org.cisecurity.benchmarks:ste:3376004" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="int" name="count" operation="equals">0</field>
               </result>
            </sql57_state>
            <sql57_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" comment="Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies" id="oval:org.cisecurity.benchmarks:ste:3422336" version="1">
               <result datatype="record" entity_check="all">
                  <field xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" datatype="string" name="permission_set_desc" operation="case insensitive equals">SAFE_ACCESS</field>
               </result>
            </sql57_state>
         </states>
         <variables>
            <external_variable comment="SQL connection string" datatype="string" id="oval:org.cisecurity.benchmarks:var:2000000" version="1"></external_variable>
            <external_variable comment="Ensure 'Ad Hoc Distributed Queries' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422324" version="1"></external_variable>
            <external_variable comment="Ensure value configured for 'CLR Enabled' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422325" version="1"></external_variable>
            <external_variable comment="Ensure value in use for 'CLR Enabled' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422326" version="1"></external_variable>
            <external_variable comment="Ensure value configured for 'clr strict security' is set to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422327" version="1"></external_variable>
            <external_variable comment="Ensure value in use for 'clr strict security' is set to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422328" version="1"></external_variable>
            <external_variable comment="Ensure 'Cross DB Ownership Chaining' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422329" version="1"></external_variable>
            <external_variable comment="Ensure 'Database Mail XPs' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376012" version="1"></external_variable>
            <external_variable comment="Ensure 'Ole Automation Procedures' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376014" version="1"></external_variable>
            <external_variable comment="Ensure 'remote access' in use is set to 0" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422330" version="1"></external_variable>
            <external_variable comment="Ensure 'remote access' is configured to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422331" version="1"></external_variable>
            <external_variable comment="Ensure 'Remote Admin Connections' is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3602350" version="1"></external_variable>
            <external_variable comment="Ensure 'Scan For Startup Procs' in use is set to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376022" version="1"></external_variable>
            <external_variable comment="Ensure 'Scan For Startup Procs' is configured to '0'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376024" version="1"></external_variable>
            <external_variable comment="Ensure Hide Instance option is 1" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3422332" version="1"></external_variable>
            <external_variable comment="Ensure 'is_disabled' for the 'sa' account is set to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376035" version="1"></external_variable>
            <external_variable comment="Ensure sid 0x01 is not named sa" datatype="string" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376036" version="1"></external_variable>
            <external_variable comment="Ensure sid 0x01 is not named 'rdsa'" datatype="string" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376038" version="1"></external_variable>
            <external_variable comment="Ensure value configured for 'clr strict security' is set to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376042" version="1"></external_variable>
            <external_variable comment="Ensure value in use for 'clr strict security' is set to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376043" version="1"></external_variable>
            <external_variable comment="Ensure 'IsIntegratedSecurityOnly' is set to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376000" version="1"></external_variable>
            <external_variable comment="Ensure number of error logs is greater than or equal to 12" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376021" version="1"></external_variable>
            <external_variable comment="Ensure 'Default Trace Enabled' is configured to '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376023" version="1"></external_variable>
            <external_variable comment="Ensure the 'Default Trace Enabled' value in use '1'" datatype="int" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376025" version="1"></external_variable>
            <external_variable comment="Ensure audit level is failure or all" datatype="string" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3376027" version="1"></external_variable>
            <external_variable comment="Ensure 'key_algorithm' is not null" datatype="string" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3619299" version="1"></external_variable>
            <external_variable comment="Ensure 'encryptor_type' is not null" datatype="string" id="oval:org.cisecurity.benchmarksmicrosoft_sql_server:var:3619300" version="1"></external_variable>
            <local_variable comment="Multi-DB SQL connection string - exclude sys DBs" datatype="string" id="oval:org.cisecurity.benchmarks:var:2000001" version="1">
               <object_component item_field="result" object_ref="oval:org.cisecurity.benchmarks:obj:2000001" record_field="name"></object_component>
            </local_variable>
            <local_variable comment="Multi-DB SQL connection string - include sys DBs" datatype="string" id="oval:org.cisecurity.benchmarks:var:2000002" version="1">
               <object_component item_field="result" object_ref="oval:org.cisecurity.benchmarks:obj:2000002" record_field="name"></object_component>
            </local_variable>
            <local_variable comment="Ensure guest user does not have Connect permission in user databases" datatype="string" id="oval:org.cisecurity.benchmarks:var:3422333" version="1">
               <concat>
                  <literal_component>USE [</literal_component>
                  <variable_component var_ref="oval:org.cisecurity.benchmarks:var:2000001"></variable_component>
                  <literal_component>] SELECT DB_NAME() AS DatabaseName, 'guest' AS Database_User, [permission_name], [state_desc] FROM sys.database_permissions WHERE [grantee_principal_id] = DATABASE_PRINCIPAL_ID('guest') AND [state_desc] LIKE 'GRANT%' AND [permission_name] = 'CONNECT' AND DB_NAME() NOT IN ('master','tempdb','msdb');</literal_component>
               </concat>
            </local_variable>
            <local_variable comment="Ensure no database users are orphaned" datatype="string" id="oval:org.cisecurity.benchmarks:var:3376004" version="1">
               <concat>
                  <literal_component>USE [</literal_component>
                  <variable_component var_ref="oval:org.cisecurity.benchmarks:var:2000002"></variable_component>
                  <literal_component>] SELECT COUNT(*) AS COUNT FROM sys.database_principals DP WHERE DP.sid NOT IN (SELECT L.sid FROM sys.syslogins L WHERE L.sid = DP.sid) AND (SELECT containment FROM sys.databases WHERE name = DB_NAME()) = 0 AND DP.type_desc &lt;&gt; 'DATABASE_ROLE' AND DP.principal_id &gt; 4 and name not in ('dbo','guest','INFORMATION_SCHEMA','sys','MS_DataCollectorInternalUser');</literal_component>
               </concat>
            </local_variable>
            <local_variable comment="Ensure SQL Authentication is not used in contained databases" datatype="string" id="oval:org.cisecurity.benchmarks:var:3376007" version="1">
               <concat>
                  <literal_component>USE [</literal_component>
                  <variable_component var_ref="oval:org.cisecurity.benchmarks:var:2000001"></variable_component>
                  <literal_component>] SELECT name FROM sys.database_principals WHERE name NOT IN ('dbo','Information_Schema','sys','guest') AND type IN ('U','S','G') AND authentication_type = 2</literal_component>
               </concat>
            </local_variable>
            <local_variable comment="Ensure 'CLR Assembly Permission Set' is set to 'SAFE_ACCESS' for All CLR Assemblies" datatype="string" id="oval:org.cisecurity.benchmarks:var:3422336" version="1">
               <concat>
                  <literal_component>USE [</literal_component>
                  <variable_component var_ref="oval:org.cisecurity.benchmarks:var:2000002"></variable_component>
                  <literal_component>] SELECT name, permission_set_desc FROM sys.assemblies WHERE is_user_defined = 1 AND name &lt;&gt; 'Microsoft.SqlServer.Types';</literal_component>
               </concat>
            </local_variable>
            <local_variable comment="Ensure Symmetric Key encryption algorithm is set to AES_128 or higher in non-system databases" datatype="string" id="oval:org.cisecurity.benchmarks:var:3376037" version="1">
               <concat>
                  <literal_component>USE [</literal_component>
                  <variable_component var_ref="oval:org.cisecurity.benchmarks:var:2000001"></variable_component>
                  <literal_component>] SELECT DB_NAME() as DB_NAME, algorithm_desc AS ALGORITHM_DESC FROM sys.symmetric_keys WHERE algorithm_desc NOT IN ('AES_128', 'AES_192', 'AES_256') AND DB_ID() &gt; 4;</literal_component>
               </concat>
            </local_variable>
            <local_variable comment="Ensure Asymmetric Key Size is set to greater than or equal to 2048 in non-system databases" datatype="string" id="oval:org.cisecurity.benchmarks:var:3376039" version="1">
               <concat>
                  <literal_component>USE [</literal_component>
                  <variable_component var_ref="oval:org.cisecurity.benchmarks:var:2000001"></variable_component>
                  <literal_component>] SELECT DB_NAME() as DB_NAME, key_length AS KEY_LENGTH FROM sys.asymmetric_keys WHERE key_length &lt; 2048 AND DB_ID() &gt; 4;</literal_component>
               </concat>
            </local_variable>
         </variables>
      </oval_definitions>
   </ds:component>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>mzuAkdnbHq8hpd4SgGYfKuHcWoUOHsg/G7DmT9+50kM=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
oNUcommkXQvdCbK6N1Z94POkjkkDfekaoteoAkkXkO5ZEU0U0DJXQiacyjtB/wv1H/EOd0bQoHcI
Ws3ZmFKM3TVmc0h0r6/eMVBzIo8E/J2qkg4y+lPYEdNbuhJEsH+01a1Ca6vGnXM77H9VUoI+FnzW
i+/FRMV0P0bOwSOhVtEzm9dGMCXFDyDiSSJDzJs28PwytTm+Zacl/X7qyYTSLltjhLFsDGXq27qm
/sJu1nEh9IPnSY/AEoJGNrdR9AQaQaK+p9H6qLxFo57479RS+gAqHrGYbIZfgprydB/uujlwI7ZM
z7WeDxy64cguUVnP0fGhbb84CyEEukCgFKksWHt8I6cetCN/w9bMZGhpRy0jX95pEN8SmhZD4hZx
0N9s/bOYFhQnkF9/HxKvM4EG3YnhKMP103jR7ZiTHsfpMkbpGjbX1T2RkTiXKRakg421vQ9i5QtX
LPu2cWROZQlfBbEm203e3QMMrPoG2KTmzYPSH5vqvmObgOJCy/Cf0bZh
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIHbDCCBVSgAwIBAgIQCdceADCnzKkglkQGavVKYzANBgkqhkiG9w0BAQsFADBpMQswCQYDVQQG
EwJVUzEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xQTA/BgNVBAMTOERpZ2lDZXJ0IFRydXN0ZWQg
RzQgQ29kZSBTaWduaW5nIFJTQTQwOTYgU0hBMzg0IDIwMjEgQ0ExMB4XDTIzMTAxODAwMDAwMFoX
DTI2MTAxODIzNTk1OVowgfQxEzARBgsrBgEEAYI3PAIBAxMCVVMxGTAXBgsrBgEEAYI3PAIBAhMI
TWFyeWxhbmQxHTAbBgNVBA8MFFByaXZhdGUgT3JnYW5pemF0aW9uMRIwEAYDVQQFEwlEMDYwNTg4
MTIxCzAJBgNVBAYTAlVTMREwDwYDVQQIEwhOZXcgWW9yazEXMBUGA1UEBxMORWFzdCBHcmVlbmJ1
c2gxKjAoBgNVBAoTIUNlbnRlciBmb3IgSW50ZXJuZXQgU2VjdXJpdHksIEluYzEqMCgGA1UEAxMh
Q2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwgSW5jMIIBojANBgkqhkiG9w0BAQEFAAOCAY8A
MIIBigKCAYEAyZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIV
skIhy1vmnh61vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQz
NoOzV0LNCoZdahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgR
Lr1aieQdFy8haW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBX
ndxHgT4edRLz5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaA
ilB63yqbH42mnkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1As
rxBVfTw+Zf7jP1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNTAgMBAAGj
ggICMIIB/jAfBgNVHSMEGDAWgBRoN+Drtjv4XxGG+/5hewiIZfROQjAdBgNVHQ4EFgQUX2/J9FT5
5BNF7JqfAl9SJkv3pf0wPQYDVR0gBDYwNDAyBgVngQwBAzApMCcGCCsGAQUFBwIBFhtodHRwOi8v
d3d3LmRpZ2ljZXJ0LmNvbS9DUFMwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMD
MIG1BgNVHR8Ega0wgaowU6BRoE+GTWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFRy
dXN0ZWRHNENvZGVTaWduaW5nUlNBNDA5NlNIQTM4NDIwMjFDQTEuY3JsMFOgUaBPhk1odHRwOi8v
Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRUcnVzdGVkRzRDb2RlU2lnbmluZ1JTQTQwOTZTSEEz
ODQyMDIxQ0ExLmNybDCBlAYIKwYBBQUHAQEEgYcwgYQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3Nw
LmRpZ2ljZXJ0LmNvbTBcBggrBgEFBQcwAoZQaHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0Rp
Z2lDZXJ0VHJ1c3RlZEc0Q29kZVNpZ25pbmdSU0E0MDk2U0hBMzg0MjAyMUNBMS5jcnQwCQYDVR0T
BAIwADANBgkqhkiG9w0BAQsFAAOCAgEASLOHf1FQ7TrGqEoVXYoeNSkRWdVCUGd1JCDs7Hb9sLd3
eQuipZ4EorQS/9qMiVMhmlJfF75sNVQhr1K5UtjrDRFMTzYmh78hAyovowzgyVKdGFqiVVr5m+mb
vVyglLlA4V076LMBaKRknm1Dt8r0/5GSRCrkP2origpYMMaocN+iBX9+MImnh3J1Ehn0nRUhW86Q
mt3/YCVIaQZisv+KmOxyAq1m6fiIYIvXY+cH2dDIheoVteb/NjYnKVqE6xTpOsxF16pykXiM9yk3
Q9nlJS36KEGRP4wrySU4eIBnTcv4mimZjkWj6bIvk8otNJ14FbyltaPwIc3dE3oPGfSmCrkxs73j
iqBs2TXLvblEmOhY8ko3xVdTm0zMP50MQVO948fz9yF+xdnPdMPT1/lCmGp6iWYRzxnvEkA1+HFl
yy9YztrM8WNAhXirpUZg3HWQE2ONLKMtqQrkIHD2nikda77flk6oirqDuCf8Q7g8s86/KabTdxrw
pRmsRjDkAfKVae58ctaKbmF32oU9BGk+9MPG8HF5Yfoh12DE1fLZcPzZrROrDFJGGxwhv5FlnxGg
6G7jKi68erZnpaOPayK0bXyZNunqkI9IbIuPqMw5qaCZZgN6AEHIbGTKdrWEf11DmR7MdTjv3/vu
JWtIXgk3kQFX27w9JhqV6QogVmzIfEQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>yZwTJr4Kb7QEDnVY3BEkPoS3fn+XoxhCTfFvlMk8zXDcR4pFMgPkXTrZ1KbENUIVskIhy1vmnh61
vwSL0lcdzesCekKSxLqrEA4xunZk1MB5mLbHXchSSpI1co1vaSzJjkTYP1UsUVQzNoOzV0LNCoZd
ahjGTHSduWvbrHTEeD6/jvUj3AVWrTx6krzgYA3ozAxtUnapK7IrZERuGOSwTrgRLr1aieQdFy8h
aW1YL+ks5HmLRvcoGp+J68GX/zfMTduvWxhcpXm4txKc4iJqGCRmyBU2XjGjpDBXndxHgT4edRLz
5PwWSeZUh8/tWOGFwnVw7njoOa0sFixy96H2BqEn+yPeRALyf59rjtPL66tsXuaAilB63yqbH42m
nkxHTX5zcEm337GzTOGRccsYzN/ApVuXDeMfsO+sSUosrimnxm9QTOyKcex5h1AsrxBVfTw+Zf7j
P1YRlmMlGPG1zffK2KjJhD6ivFi2sIDThEQLxIAC8XOjp2ZXvhx87yNT</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></ds:data-stream-collection>