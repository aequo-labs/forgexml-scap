<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
                  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns:win="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows"
                  xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent"
                  xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows windows-definitions-schema.xsd">

  <generator>
    <oval:product_name>Cimcor SCAP Content</oval:product_name>
    <oval:product_version>1.0</oval:product_version>
    <oval:schema_version>5.11.1</oval:schema_version>
    <oval:timestamp>2024-12-19T00:00:00</oval:timestamp>
  </generator>

  <definitions>
    <!-- Windows Server 2019 Platform Detection -->
    <definition class="inventory" id="oval:com.cimcor.agent.windows:def:100" version="1">
      <metadata>
        <title>Microsoft Windows Server 2019 is installed</title>
        <affected family="windows">
          <platform>Microsoft Windows Server 2019</platform>
        </affected>
        <description>The operating system installed on the system is Microsoft Windows Server 2019.</description>
      </metadata>
      <criteria>
        <criterion comment="the installed operating system is part of the Microsoft Windows family" test_ref="oval:com.cimcor.agent.windows:tst:99"/>
        <criterion comment="Check if Windows Server 2019 is installed" test_ref="oval:com.cimcor.agent.windows:tst:100"/>
      </criteria>
    </definition>

    <!-- Windows Server 2022 Platform Detection -->
    <definition class="inventory" id="oval:com.cimcor.agent.windows:def:101" version="1">
      <metadata>
        <title>Microsoft Windows Server 2022 is installed</title>
        <affected family="windows">
          <platform>Microsoft Windows Server 2022</platform>
        </affected>
        <description>The operating system installed on the system is Microsoft Windows Server 2022.</description>
      </metadata>
      <criteria>
        <criterion comment="the installed operating system is part of the Microsoft Windows family" test_ref="oval:com.cimcor.agent.windows:tst:99"/>
        <criterion comment="Check if Windows Server 2022 is installed" test_ref="oval:com.cimcor.agent.windows:tst:101"/>
      </criteria>
    </definition>

    <!-- Windows 10 Platform Detection -->
    <definition class="inventory" id="oval:com.cimcor.agent.windows:def:102" version="1">
      <metadata>
        <title>Microsoft Windows 10 is installed</title>
        <affected family="windows">
          <platform>Microsoft Windows 10</platform>
        </affected>
        <description>The operating system installed on the system is Microsoft Windows 10.</description>
      </metadata>
      <criteria>
        <criterion comment="the installed operating system is part of the Microsoft Windows family" test_ref="oval:com.cimcor.agent.windows:tst:99"/>
        <criterion comment="Check if Windows 10 is installed" test_ref="oval:com.cimcor.agent.windows:tst:102"/>
      </criteria>
    </definition>

    <!-- Windows 11 Platform Detection -->
    <definition class="inventory" id="oval:com.cimcor.agent.windows:def:103" version="1">
      <metadata>
        <title>Microsoft Windows 11 is installed</title>
        <affected family="windows">
          <platform>Microsoft Windows 11</platform>
        </affected>
        <description>The operating system installed on the system is Microsoft Windows 11.</description>
      </metadata>
      <criteria>
        <criterion comment="the installed operating system is part of the Microsoft Windows family" test_ref="oval:com.cimcor.agent.windows:tst:99"/>
        <criterion comment="Check if Windows 11 is installed" test_ref="oval:com.cimcor.agent.windows:tst:103"/>
      </criteria>
    </definition>

    <!-- x86 Architecture Detection -->
    <definition class="inventory" id="oval:com.cimcor.agent.windows:def:104" version="1">
      <metadata>
        <title>x86 architecture</title>
        <affected family="windows">
          <platform>Microsoft Windows Server 2019</platform>
          <platform>Microsoft Windows Server 2022</platform>
          <platform>Microsoft Windows 10</platform>
          <platform>Microsoft Windows 11</platform>
        </affected>
        <description>The system architecture is x86 (32-bit).</description>
      </metadata>
      <criteria>
        <criterion test_ref="oval:com.cimcor.agent.windows:tst:104" comment="Check for x86 architecture"/>
      </criteria>
    </definition>

    <!-- x64 Architecture Detection -->
    <definition class="inventory" id="oval:com.cimcor.agent.windows:def:105" version="1">
      <metadata>
        <title>x64 architecture</title>
        <affected family="windows">
          <platform>Microsoft Windows Server 2019</platform>
          <platform>Microsoft Windows Server 2022</platform>
          <platform>Microsoft Windows 10</platform>
          <platform>Microsoft Windows 11</platform>
        </affected>
        <description>The system architecture is x64 (64-bit).</description>
      </metadata>
      <criteria>
        <criterion test_ref="oval:com.cimcor.agent.windows:tst:105" comment="Check for x64 architecture"/>
      </criteria>
    </definition>
  </definitions>

  <tests>
    <!-- Windows Family Test -->
    <ind:family_test check="only one" check_existence="at_least_one_exists" 
                     comment="the installed operating system is part of the Microsoft Windows family" 
                     id="oval:com.cimcor.agent.windows:tst:99" version="1">
      <ind:object object_ref="oval:com.cimcor.agent.windows:obj:99"/>
      <ind:state state_ref="oval:com.cimcor.agent.windows:ste:99"/>
    </ind:family_test>

    <!-- Windows Server 2019 Test -->
    <win:registry_test check="all" check_existence="at_least_one_exists" 
                       comment="Check if Windows Server 2019 is installed" 
                       id="oval:com.cimcor.agent.windows:tst:100" version="1">
      <win:object object_ref="oval:com.cimcor.agent.windows:obj:100"/>
      <win:state state_ref="oval:com.cimcor.agent.windows:ste:100"/>
    </win:registry_test>

    <!-- Windows Server 2022 Test -->
    <win:registry_test check="all" check_existence="at_least_one_exists" 
                       comment="Check if Windows Server 2022 is installed" 
                       id="oval:com.cimcor.agent.windows:tst:101" version="1">
      <win:object object_ref="oval:com.cimcor.agent.windows:obj:100"/>
      <win:state state_ref="oval:com.cimcor.agent.windows:ste:101"/>
    </win:registry_test>

    <!-- Windows 10 Test -->
    <win:registry_test check="all" check_existence="at_least_one_exists" 
                       comment="Check if Windows 10 is installed" 
                       id="oval:com.cimcor.agent.windows:tst:102" version="1">
      <win:object object_ref="oval:com.cimcor.agent.windows:obj:100"/>
      <win:state state_ref="oval:com.cimcor.agent.windows:ste:102"/>
    </win:registry_test>

    <!-- Windows 11 Test -->
    <win:registry_test check="all" check_existence="at_least_one_exists" 
                       comment="Check if Windows 11 is installed" 
                       id="oval:com.cimcor.agent.windows:tst:103" version="1">
      <win:object object_ref="oval:com.cimcor.agent.windows:obj:100"/>
      <win:state state_ref="oval:com.cimcor.agent.windows:ste:103"/>
    </win:registry_test>

    <!-- Architecture Tests -->
    <win:registry_test check="all" check_existence="at_least_one_exists" 
                       comment="Check for x86 architecture" 
                       id="oval:com.cimcor.agent.windows:tst:104" version="1">
      <win:object object_ref="oval:com.cimcor.agent.windows:obj:101"/>
      <win:state state_ref="oval:com.cimcor.agent.windows:ste:104"/>
    </win:registry_test>

    <win:registry_test check="all" check_existence="at_least_one_exists" 
                       comment="Check for x64 architecture" 
                       id="oval:com.cimcor.agent.windows:tst:105" version="1">
      <win:object object_ref="oval:com.cimcor.agent.windows:obj:101"/>
      <win:state state_ref="oval:com.cimcor.agent.windows:ste:105"/>
    </win:registry_test>
  </tests>

  <objects>
    <!-- Family Object -->
    <ind:family_object comment="Default family object" 
                       id="oval:com.cimcor.agent.windows:obj:99" version="1"/>

    <!-- Product Name Registry Object -->
    <win:registry_object comment="Windows ProductName registry key" 
                         id="oval:com.cimcor.agent.windows:obj:100" version="1">
      <win:hive>HKEY_LOCAL_MACHINE</win:hive>
      <win:key>SOFTWARE\Microsoft\Windows NT\CurrentVersion</win:key>
      <win:name>ProductName</win:name>
    </win:registry_object>

    <!-- Architecture Registry Object -->
    <win:registry_object comment="System architecture registry key" 
                         id="oval:com.cimcor.agent.windows:obj:101" version="1">
      <win:hive>HKEY_LOCAL_MACHINE</win:hive>
      <win:key>SYSTEM\CurrentControlSet\Control\Session Manager\Environment</win:key>
      <win:name>PROCESSOR_ARCHITECTURE</win:name>
    </win:registry_object>
  </objects>

  <states>
    <!-- Windows Family State -->
    <ind:family_state comment="Microsoft Windows family" 
                      id="oval:com.cimcor.agent.windows:ste:99" version="1">
      <ind:family operation="case insensitive equals">windows</ind:family>
    </ind:family_state>

    <!-- Windows Server 2019 State -->
    <win:registry_state comment="Windows Server 2019 ProductName pattern" 
                        id="oval:com.cimcor.agent.windows:ste:100" version="1">
      <win:value operation="pattern match">^[a-zA-Z0-9\(\)\s]*2019\s[a-zA-Z0-9\(\)\s]*$</win:value>
    </win:registry_state>

    <!-- Windows Server 2022 State -->
    <win:registry_state comment="Windows Server 2022 ProductName pattern" 
                        id="oval:com.cimcor.agent.windows:ste:101" version="1">
      <win:value operation="pattern match">^[a-zA-Z0-9\(\)\s]*2022\s[a-zA-Z0-9\(\)\s]*$</win:value>
    </win:registry_state>

    <!-- Windows 10 State -->
    <win:registry_state comment="Windows 10 ProductName pattern" 
                        id="oval:com.cimcor.agent.windows:ste:102" version="1">
      <win:value operation="pattern match">^[a-zA-Z0-9\(\)\s]*10\s[a-zA-Z0-9\(\)\s]*$</win:value>
    </win:registry_state>

    <!-- Windows 11 State -->
    <win:registry_state comment="Windows 11 ProductName pattern" 
                        id="oval:com.cimcor.agent.windows:ste:103" version="1">
      <win:value operation="pattern match">^[a-zA-Z0-9\(\)\s]*11\s[a-zA-Z0-9\(\)\s]*$</win:value>
    </win:registry_state>

    <!-- x86 Architecture State -->
    <win:registry_state comment="x86 architecture" 
                        id="oval:com.cimcor.agent.windows:ste:104" version="1">
      <win:value>x86</win:value>
    </win:registry_state>

    <!-- x64 Architecture State -->
    <win:registry_state comment="x64 architecture" 
                        id="oval:com.cimcor.agent.windows:ste:105" version="1">
      <win:value operation="pattern match">(AMD64|x64)</win:value>
    </win:registry_state>
  </states>

</oval_definitions>